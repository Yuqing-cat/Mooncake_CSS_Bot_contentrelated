Answer,Question,Category,Source
hello,hi,,Editorial
答：不可以。 Azure AD 不支持 LDAP 协议。,问：是否可以通过 Azure AD 设置安全的 LDAP 连接？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n,问：SaaS 应用程序的自动用户预配是什么？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n,问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
\n\n答： Azure AD 提供多种方式供用户查看和访问其应用程序，例如：\n\n*   Azure AD 访问面板\n*   Office 365 应用程序启动器\n*   直接登录到联合应用\n*   联合、基于密码或现有应用的深层链接\n\n有关详细信息，请参阅[为用户部署 Azure AD 集成的应用程序](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#deploying-azure-ad-integrated-applications-to-users)。\n\n问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n,问：用户如何使用 Azure AD 来登录应用程序？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
\n\n答： 使用 Azure AD Premium，可以添加和配置所需的任何应用程序。 可以根据应用程序的功能和自己的喜好来配置 SSO 和自动预配。 \n\n问：用户如何使用 Azure AD 来登录应用程序？\n\n答： Azure AD 提供多种方式供用户查看和访问其应用程序，例如：\n\n*   Azure AD 访问面板\n*   Office 365 应用程序启动器\n*   直接登录到联合应用\n*   联合、基于密码或现有应用的深层链接\n\n有关详细信息，请参阅[为用户部署 Azure AD 集成的应用程序](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#deploying-azure-ad-integrated-applications-to-users)。\n\n问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n,问：如果 Azure AD 应用商店中没有我需要的应用程序怎么办？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
\n\n答： Azure AD 中包含 Microsoft、应用程序服务提供商和合作伙伴提供的 2600 多个预先集成的应用程序。 所有预先集成的应用程序都支持单一登录 (SSO)。 SSO 允许用户使用组织凭据来访问应用。 某些应用程序还支持自动预配和自动取消预配。\n\n有关预先集成的应用程序的完整列表，请参阅 [Active Directory Marketplace](https://azure.microsoft.com/marketplace/active-directory/)（Active Directory 应用商店）。\n\n问：如果 Azure AD 应用商店中没有我需要的应用程序怎么办？\n\n答： 使用 Azure AD Premium，可以添加和配置所需的任何应用程序。 可以根据应用程序的功能和自己的喜好来配置 SSO 和自动预配。 \n\n问：用户如何使用 Azure AD 来登录应用程序？\n\n答： Azure AD 提供多种方式供用户查看和访问其应用程序，例如：\n\n*   Azure AD 访问面板\n*   Office 365 应用程序启动器\n*   直接登录到联合应用\n*   联合、基于密码或现有应用的深层链接\n\n有关详细信息，请参阅[为用户部署 Azure AD 集成的应用程序](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#deploying-azure-ad-integrated-applications-to-users)。\n\n问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n,问：在哪里可以找到与 Azure AD 预先集成的应用程序及其功能的列表？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
"这是指全局通用的密码，例如""Password""和""123456""的任何变体。","问：某些（常用）密码被拒绝并显示消息""此密码已使用多次""，这是指当前 Active Directory 中使用的密码吗？",active directory,https://docs.azure.cn/active-directory/active-directory-faq
我们使用更复杂的策略锁定帐户。 此策略基于请求的 IP 和输入的密码。 根据存在攻击的可能性，锁定持续时间也会增加。,问：是将在失败尝试次数达到特定数字后锁定帐户，还是会使用更复杂的策略？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
"\n\n答： 对于这种情况，有几个选项。 在可用的情况下，使用自助密码重置 (SSPR)。 SSPR 是否适用取决于其配置方式。 \n\n对于 Office 365 用户，管理员可以使用 [重置用户密码](https://support.office.com/en-us/article/Admins-Reset-user-passwords-7A5D073B-7FAE-4AA5-8F96-9ECD041ABA9C?ui=en-US&rs=en-US&ad=US)中所述的步骤重置密码。\n\n对于 Azure AD 帐户，管理员可以使用以下选项之一重置密码：\n\n*   [在经典管理门户中重置帐户](https://docs.azure.cn/active-directory/active-directory-create-users-reset-password)\n*   [使用 PowerShell](https://docs.microsoft.com/powershell/module/msonline/set-msoluserpassword?view=azureadps-1.0)\n\n## ""安全""\n\n问：是将在失败尝试次数达到特定数字后锁定帐户，还是会使用更复杂的策略？ 我们使用更复杂的策略锁定帐户。 此策略基于请求的 IP 和输入的密码。 根据存在攻击的可能性，锁定持续时间也会增加。 \n\n问：某些（常用）密码被拒绝并显示消息""此密码已使用多次""，这是指当前 Active Directory 中使用的密码吗？ 这是指全局通用的密码，例如""Password""和""123456""的任何变体。\n\n## 应用程序访问\n\n问：在哪里可以找到与 Azure AD 预先集成的应用程序及其功能的列表？\n\n答： Azure AD 中包含 Microsoft、应用程序服务提供商和合作伙伴提供的 2600 多个预先集成的应用程序。 所有预先集成的应用程序都支持单一登录 (SSO)。 SSO 允许用户使用组织凭据来访问应用。 某些应用程序还支持自动预配和自动取消预配。\n\n有关预先集成的应用程序的完整列表，请参阅 [Active Directory Marketplace](https://azure.microsoft.com/marketplace/active-directory/)（Active Directory 应用商店）。\n\n问：如果 Azure AD 应用商店中没有我需要的应用程序怎么办？\n\n答： 使用 Azure AD Premium，可以添加和配置所需的任何应用程序。 可以根据应用程序的功能和自己的喜好来配置 SSO 和自动预配。 \n\n问：用户如何使用 Azure AD 来登录应用程序？\n\n答： Azure AD 提供多种方式供用户查看和访问其应用程序，例如：\n\n*   Azure AD 访问面板\n*   Office 365 应用程序启动器\n*   直接登录到联合应用\n*   联合、基于密码或现有应用的深层链接\n\n有关详细信息，请参阅[为用户部署 Azure AD 集成的应用程序](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#deploying-azure-ad-integrated-applications-to-users)。\n\n问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n",问：如果尝试更改 Office 365/Azure AD 密码时忘记了现有的密码，该怎么办？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
"\n\n答： 若要访问 Azure 经典管理门户，每个用户都需要 Azure 订阅的权限。 如果订阅为付费型 Office 365 订阅或 Azure AD 订阅，请访问 [https://account.windowsazure.cn/Home/Index](https://account.windowsazure.cn/Home/Index) ，了解一次性激活步骤。 否则需要激活 [Azure 帐户](https://www.azure.cn/pricing/1rmb-trial/) 或付费型订阅。\n\n有关详细信息，请参阅：\n\n*   [Azure 订阅与 Azure Active Directory 的关联方式](https://docs.azure.cn/active-directory/active-directory-how-subscriptions-associated-directory)\n\n问：Azure AD、Office 365 与 Azure 之间是什么关系？\n\n答： Azure AD 为所有 Web 服务提供通用的标识和访问功能。 不管使用的是 Office 365、Azure、Intune 还是其他服务，都是在使用 Azure AD 为上述所有服务启用登录和访问管理。\n\n可以将所有已设置为使用 Web 服务的用户定义为一个或多个 Azure AD 实例中的用户帐户。 可以在设置这些帐户时启用免费的 Azure AD 功能，例如云应用程序访问。\n\nAzure AD 付费型服务（例如企业移动性 + 安全性）可通过综合性的企业级管理和安全解决方案来弥补其他 Web 服务（例如 Office 365 和 Azure）的不足。\n\n问：为什么可以登录到 Azure 门户，但不能登录到 Azure 经典管理门户？\n\n答：Azure 门户不需要有效的订阅，而经典管理门户则需要有效的订阅。 如果没有订阅，则无法登录到经典管理门户。\n\n问：订阅管理员与目录管理员的区别是什么？\n\n答： 默认情况下，当用户注册 Azure 时，系统会为其分配订阅管理员角色。 订阅管理员可以使用 Microsoft 帐户，也可以使用 Azure 订阅与之关联的目录中的工作或学校帐户。 此角色有权在 Azure 门户中管理服务。\n\n如果其他人需要使用同一个订阅登录和访问服务，则可将其添加为共同管理员。 此角色具有与服务管理员一样的访问特权，但不能更改订阅与 Azure 目录之间的关联关系。 有关订阅管理员的其他信息，请参阅 [Azure 订阅与 Azure Active Directory 的关联方式](https://docs.azure.cn/active-directory/active-directory-how-subscriptions-associated-directory)。\n\nAzure AD 提供另一组管理员角色来管理与目录和标识相关的功能。 这些管理员将有权访问 Azure 门户或 Azure 经典管理门户中的各种功能。 管理员的角色决定了其所能执行的操作，例如创建或编辑用户、向其他用户分配管理角色、重置用户密码、管理用户许可证，或者管理域。 有关 Azure AD 目录管理员及其角色的其他信息，请参阅[在 Azure Active Directory 中分配管理员角色](https://docs.azure.cn/active-directory/active-directory-assign-admin-roles)。\n\n另外，Azure AD 付费型服务（例如企业移动性 + 安全性）可通过综合性的企业级管理和安全解决方案来弥补其他 Web 服务（例如 Office 365 和 Azure）的不足。\n\n问：是否可以通过报告来查看我的 Azure AD 用户许可证何时过期？\n\n答： 不可以。 此功能目前不可用。\n\n## 混合 Azure AD 入门\n\n问：如果我已被添加为协作者，该如何离开原来的租户？\n\n答：如果被作为协作者添加到另一组织的租户，可使用右上角的""租户切换器""在租户之间切换。 目前还无法主动离开邀请组织，Microsoft 正致力于提供该功能。 在该功能推出之前，可以请求邀请组织将你从其租户中删除。\n\n问：如何将我的本地目录连接到 Azure AD？\n\n答：可以使用 Azure AD Connect 将本地目录连接到 Azure AD。\n\n有关详细信息，请参阅[将本地标识与 Azure Active Directory 集成](https://docs.azure.cn/active-directory/connect/active-directory-aadconnect)。\n\n问：如何在本地目录与云应用程序之间设置 SSO？\n\n答：只需在本地目录与 Azure AD 之间设置单一登录 (SSO)。 只要通过 Azure AD 访问云应用程序，该服务就会自动让用户使用其本地凭据正确进行身份验证。\n\n可以通过联合身份验证解决方案（例如 Active Directory 联合身份验证服务 (AD FS)）或通过配置密码哈希同步，轻松地从本地实现 SSO。可以使用 Azure AD Connect 配置向导轻松部署这两个选项。\n\n有关详细信息，请参阅[将本地标识与 Azure Active Directory 集成](https://docs.azure.cn/active-directory/connect/active-directory-aadconnect)。\n\n问：Azure AD 是否为组织中的用户提供自助服务门户？\n\n答： 是的，Azure AD 提供 [Azure AD 访问面板](https://login.partner.microsoftonline.cn/) ，方便用户使用自助服务以及进行应用程序访问。 如果是 Office 365 客户，可以在 Office 365 门户中找到许多相同的功能。\n\n## 密码管理\n\n问：是否可以使用 Azure AD 密码写回但不使用密码同步？（在这种情况下，是否可以结合密码写回使用 Azure AD 自助密码重置 (SSPR)，而不将密码存储在云中？）\n\n答：无需将 Active Directory 密码同步到 Azure AD 即可启用写回。 在联合环境中，Azure AD 单一登录 (SSO) 依赖本地目录对用户进行身份验证。 在这种情况下，并不需要在 Azure AD 中跟踪本地密码。\n\n问：需要多长时间才能将密码写回到 Active Directory 本地？\n\n答： 密码写回实时运行。\n\n问：是否可以对管理员管理的密码使用密码写回？\n\n答：可以。如果已启用密码写回，管理员执行的密码操作将写回到用户的本地环境。 \n\n问：如果尝试更改 Office 365/Azure AD 密码时忘记了现有的密码，该怎么办？\n\n答： 对于这种情况，有几个选项。 在可用的情况下，使用自助密码重置 (SSPR)。 SSPR 是否适用取决于其配置方式。 \n\n对于 Office 365 用户，管理员可以使用 [重置用户密码](https://support.office.com/en-us/article/Admins-Reset-user-passwords-7A5D073B-7FAE-4AA5-8F96-9ECD041ABA9C?ui=en-US&rs=en-US&ad=US)中所述的步骤重置密码。\n\n对于 Azure AD 帐户，管理员可以使用以下选项之一重置密码：\n\n*   [在经典管理门户中重置帐户](https://docs.azure.cn/active-directory/active-directory-create-users-reset-password)\n*   [使用 PowerShell](https://docs.microsoft.com/powershell/module/msonline/set-msoluserpassword?view=azureadps-1.0)\n\n## ""安全""\n\n问：是将在失败尝试次数达到特定数字后锁定帐户，还是会使用更复杂的策略？ 我们使用更复杂的策略锁定帐户。 此策略基于请求的 IP 和输入的密码。 根据存在攻击的可能性，锁定持续时间也会增加。 \n\n问：某些（常用）密码被拒绝并显示消息""此密码已使用多次""，这是指当前 Active Directory 中使用的密码吗？ 这是指全局通用的密码，例如""Password""和""123456""的任何变体。\n\n## 应用程序访问\n\n问：在哪里可以找到与 Azure AD 预先集成的应用程序及其功能的列表？\n\n答： Azure AD 中包含 Microsoft、应用程序服务提供商和合作伙伴提供的 2600 多个预先集成的应用程序。 所有预先集成的应用程序都支持单一登录 (SSO)。 SSO 允许用户使用组织凭据来访问应用。 某些应用程序还支持自动预配和自动取消预配。\n\n有关预先集成的应用程序的完整列表，请参阅 [Active Directory Marketplace](https://azure.microsoft.com/marketplace/active-directory/)（Active Directory 应用商店）。\n\n问：如果 Azure AD 应用商店中没有我需要的应用程序怎么办？\n\n答： 使用 Azure AD Premium，可以添加和配置所需的任何应用程序。 可以根据应用程序的功能和自己的喜好来配置 SSO 和自动预配。 \n\n问：用户如何使用 Azure AD 来登录应用程序？\n\n答： Azure AD 提供多种方式供用户查看和访问其应用程序，例如：\n\n*   Azure AD 访问面板\n*   Office 365 应用程序启动器\n*   直接登录到联合应用\n*   联合、基于密码或现有应用的深层链接\n\n有关详细信息，请参阅[为用户部署 Azure AD 集成的应用程序](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#deploying-azure-ad-integrated-applications-to-users)。\n\n问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n","问：尝试在 Azure 经典管理门户中访问 Azure AD 时，为何收到""找不到订阅""？",active directory,https://docs.azure.cn/active-directory/active-directory-faq
"\n\n答： 密码写回实时运行。\n\n问：是否可以对管理员管理的密码使用密码写回？\n\n答：可以。如果已启用密码写回，管理员执行的密码操作将写回到用户的本地环境。 \n\n问：如果尝试更改 Office 365/Azure AD 密码时忘记了现有的密码，该怎么办？\n\n答： 对于这种情况，有几个选项。 在可用的情况下，使用自助密码重置 (SSPR)。 SSPR 是否适用取决于其配置方式。 \n\n对于 Office 365 用户，管理员可以使用 [重置用户密码](https://support.office.com/en-us/article/Admins-Reset-user-passwords-7A5D073B-7FAE-4AA5-8F96-9ECD041ABA9C?ui=en-US&rs=en-US&ad=US)中所述的步骤重置密码。\n\n对于 Azure AD 帐户，管理员可以使用以下选项之一重置密码：\n\n*   [在经典管理门户中重置帐户](https://docs.azure.cn/active-directory/active-directory-create-users-reset-password)\n*   [使用 PowerShell](https://docs.microsoft.com/powershell/module/msonline/set-msoluserpassword?view=azureadps-1.0)\n\n## ""安全""\n\n问：是将在失败尝试次数达到特定数字后锁定帐户，还是会使用更复杂的策略？ 我们使用更复杂的策略锁定帐户。 此策略基于请求的 IP 和输入的密码。 根据存在攻击的可能性，锁定持续时间也会增加。 \n\n问：某些（常用）密码被拒绝并显示消息""此密码已使用多次""，这是指当前 Active Directory 中使用的密码吗？ 这是指全局通用的密码，例如""Password""和""123456""的任何变体。\n\n## 应用程序访问\n\n问：在哪里可以找到与 Azure AD 预先集成的应用程序及其功能的列表？\n\n答： Azure AD 中包含 Microsoft、应用程序服务提供商和合作伙伴提供的 2600 多个预先集成的应用程序。 所有预先集成的应用程序都支持单一登录 (SSO)。 SSO 允许用户使用组织凭据来访问应用。 某些应用程序还支持自动预配和自动取消预配。\n\n有关预先集成的应用程序的完整列表，请参阅 [Active Directory Marketplace](https://azure.microsoft.com/marketplace/active-directory/)（Active Directory 应用商店）。\n\n问：如果 Azure AD 应用商店中没有我需要的应用程序怎么办？\n\n答： 使用 Azure AD Premium，可以添加和配置所需的任何应用程序。 可以根据应用程序的功能和自己的喜好来配置 SSO 和自动预配。 \n\n问：用户如何使用 Azure AD 来登录应用程序？\n\n答： Azure AD 提供多种方式供用户查看和访问其应用程序，例如：\n\n*   Azure AD 访问面板\n*   Office 365 应用程序启动器\n*   直接登录到联合应用\n*   联合、基于密码或现有应用的深层链接\n\n有关详细信息，请参阅[为用户部署 Azure AD 集成的应用程序](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#deploying-azure-ad-integrated-applications-to-users)。\n\n问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n",问：需要多长时间才能将密码写回到 Active Directory 本地？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
"\n\n答： Azure AD 为所有 Web 服务提供通用的标识和访问功能。 不管使用的是 Office 365、Azure、Intune 还是其他服务，都是在使用 Azure AD 为上述所有服务启用登录和访问管理。\n\n可以将所有已设置为使用 Web 服务的用户定义为一个或多个 Azure AD 实例中的用户帐户。 可以在设置这些帐户时启用免费的 Azure AD 功能，例如云应用程序访问。\n\nAzure AD 付费型服务（例如企业移动性 + 安全性）可通过综合性的企业级管理和安全解决方案来弥补其他 Web 服务（例如 Office 365 和 Azure）的不足。\n\n问：为什么可以登录到 Azure 门户，但不能登录到 Azure 经典管理门户？\n\n答：Azure 门户不需要有效的订阅，而经典管理门户则需要有效的订阅。 如果没有订阅，则无法登录到经典管理门户。\n\n问：订阅管理员与目录管理员的区别是什么？\n\n答： 默认情况下，当用户注册 Azure 时，系统会为其分配订阅管理员角色。 订阅管理员可以使用 Microsoft 帐户，也可以使用 Azure 订阅与之关联的目录中的工作或学校帐户。 此角色有权在 Azure 门户中管理服务。\n\n如果其他人需要使用同一个订阅登录和访问服务，则可将其添加为共同管理员。 此角色具有与服务管理员一样的访问特权，但不能更改订阅与 Azure 目录之间的关联关系。 有关订阅管理员的其他信息，请参阅 [Azure 订阅与 Azure Active Directory 的关联方式](https://docs.azure.cn/active-directory/active-directory-how-subscriptions-associated-directory)。\n\nAzure AD 提供另一组管理员角色来管理与目录和标识相关的功能。 这些管理员将有权访问 Azure 门户或 Azure 经典管理门户中的各种功能。 管理员的角色决定了其所能执行的操作，例如创建或编辑用户、向其他用户分配管理角色、重置用户密码、管理用户许可证，或者管理域。 有关 Azure AD 目录管理员及其角色的其他信息，请参阅[在 Azure Active Directory 中分配管理员角色](https://docs.azure.cn/active-directory/active-directory-assign-admin-roles)。\n\n另外，Azure AD 付费型服务（例如企业移动性 + 安全性）可通过综合性的企业级管理和安全解决方案来弥补其他 Web 服务（例如 Office 365 和 Azure）的不足。\n\n问：是否可以通过报告来查看我的 Azure AD 用户许可证何时过期？\n\n答： 不可以。 此功能目前不可用。\n\n## 混合 Azure AD 入门\n\n问：如果我已被添加为协作者，该如何离开原来的租户？\n\n答：如果被作为协作者添加到另一组织的租户，可使用右上角的""租户切换器""在租户之间切换。 目前还无法主动离开邀请组织，Microsoft 正致力于提供该功能。 在该功能推出之前，可以请求邀请组织将你从其租户中删除。\n\n问：如何将我的本地目录连接到 Azure AD？\n\n答：可以使用 Azure AD Connect 将本地目录连接到 Azure AD。\n\n有关详细信息，请参阅[将本地标识与 Azure Active Directory 集成](https://docs.azure.cn/active-directory/connect/active-directory-aadconnect)。\n\n问：如何在本地目录与云应用程序之间设置 SSO？\n\n答：只需在本地目录与 Azure AD 之间设置单一登录 (SSO)。 只要通过 Azure AD 访问云应用程序，该服务就会自动让用户使用其本地凭据正确进行身份验证。\n\n可以通过联合身份验证解决方案（例如 Active Directory 联合身份验证服务 (AD FS)）或通过配置密码哈希同步，轻松地从本地实现 SSO。可以使用 Azure AD Connect 配置向导轻松部署这两个选项。\n\n有关详细信息，请参阅[将本地标识与 Azure Active Directory 集成](https://docs.azure.cn/active-directory/connect/active-directory-aadconnect)。\n\n问：Azure AD 是否为组织中的用户提供自助服务门户？\n\n答： 是的，Azure AD 提供 [Azure AD 访问面板](https://login.partner.microsoftonline.cn/) ，方便用户使用自助服务以及进行应用程序访问。 如果是 Office 365 客户，可以在 Office 365 门户中找到许多相同的功能。\n\n## 密码管理\n\n问：是否可以使用 Azure AD 密码写回但不使用密码同步？（在这种情况下，是否可以结合密码写回使用 Azure AD 自助密码重置 (SSPR)，而不将密码存储在云中？）\n\n答：无需将 Active Directory 密码同步到 Azure AD 即可启用写回。 在联合环境中，Azure AD 单一登录 (SSO) 依赖本地目录对用户进行身份验证。 在这种情况下，并不需要在 Azure AD 中跟踪本地密码。\n\n问：需要多长时间才能将密码写回到 Active Directory 本地？\n\n答： 密码写回实时运行。\n\n问：是否可以对管理员管理的密码使用密码写回？\n\n答：可以。如果已启用密码写回，管理员执行的密码操作将写回到用户的本地环境。 \n\n问：如果尝试更改 Office 365/Azure AD 密码时忘记了现有的密码，该怎么办？\n\n答： 对于这种情况，有几个选项。 在可用的情况下，使用自助密码重置 (SSPR)。 SSPR 是否适用取决于其配置方式。 \n\n对于 Office 365 用户，管理员可以使用 [重置用户密码](https://support.office.com/en-us/article/Admins-Reset-user-passwords-7A5D073B-7FAE-4AA5-8F96-9ECD041ABA9C?ui=en-US&rs=en-US&ad=US)中所述的步骤重置密码。\n\n对于 Azure AD 帐户，管理员可以使用以下选项之一重置密码：\n\n*   [在经典管理门户中重置帐户](https://docs.azure.cn/active-directory/active-directory-create-users-reset-password)\n*   [使用 PowerShell](https://docs.microsoft.com/powershell/module/msonline/set-msoluserpassword?view=azureadps-1.0)\n\n## ""安全""\n\n问：是将在失败尝试次数达到特定数字后锁定帐户，还是会使用更复杂的策略？ 我们使用更复杂的策略锁定帐户。 此策略基于请求的 IP 和输入的密码。 根据存在攻击的可能性，锁定持续时间也会增加。 \n\n问：某些（常用）密码被拒绝并显示消息""此密码已使用多次""，这是指当前 Active Directory 中使用的密码吗？ 这是指全局通用的密码，例如""Password""和""123456""的任何变体。\n\n## 应用程序访问\n\n问：在哪里可以找到与 Azure AD 预先集成的应用程序及其功能的列表？\n\n答： Azure AD 中包含 Microsoft、应用程序服务提供商和合作伙伴提供的 2600 多个预先集成的应用程序。 所有预先集成的应用程序都支持单一登录 (SSO)。 SSO 允许用户使用组织凭据来访问应用。 某些应用程序还支持自动预配和自动取消预配。\n\n有关预先集成的应用程序的完整列表，请参阅 [Active Directory Marketplace](https://azure.microsoft.com/marketplace/active-directory/)（Active Directory 应用商店）。\n\n问：如果 Azure AD 应用商店中没有我需要的应用程序怎么办？\n\n答： 使用 Azure AD Premium，可以添加和配置所需的任何应用程序。 可以根据应用程序的功能和自己的喜好来配置 SSO 和自动预配。 \n\n问：用户如何使用 Azure AD 来登录应用程序？\n\n答： Azure AD 提供多种方式供用户查看和访问其应用程序，例如：\n\n*   Azure AD 访问面板\n*   Office 365 应用程序启动器\n*   直接登录到联合应用\n*   联合、基于密码或现有应用的深层链接\n\n有关详细信息，请参阅[为用户部署 Azure AD 集成的应用程序](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#deploying-azure-ad-integrated-applications-to-users)。\n\n问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n",问：Azure AD、Office 365 与 Azure 之间是什么关系？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
"\n\n答：Azure 门户不需要有效的订阅，而经典管理门户则需要有效的订阅。 如果没有订阅，则无法登录到经典管理门户。\n\n问：订阅管理员与目录管理员的区别是什么？\n\n答： 默认情况下，当用户注册 Azure 时，系统会为其分配订阅管理员角色。 订阅管理员可以使用 Microsoft 帐户，也可以使用 Azure 订阅与之关联的目录中的工作或学校帐户。 此角色有权在 Azure 门户中管理服务。\n\n如果其他人需要使用同一个订阅登录和访问服务，则可将其添加为共同管理员。 此角色具有与服务管理员一样的访问特权，但不能更改订阅与 Azure 目录之间的关联关系。 有关订阅管理员的其他信息，请参阅 [Azure 订阅与 Azure Active Directory 的关联方式](https://docs.azure.cn/active-directory/active-directory-how-subscriptions-associated-directory)。\n\nAzure AD 提供另一组管理员角色来管理与目录和标识相关的功能。 这些管理员将有权访问 Azure 门户或 Azure 经典管理门户中的各种功能。 管理员的角色决定了其所能执行的操作，例如创建或编辑用户、向其他用户分配管理角色、重置用户密码、管理用户许可证，或者管理域。 有关 Azure AD 目录管理员及其角色的其他信息，请参阅[在 Azure Active Directory 中分配管理员角色](https://docs.azure.cn/active-directory/active-directory-assign-admin-roles)。\n\n另外，Azure AD 付费型服务（例如企业移动性 + 安全性）可通过综合性的企业级管理和安全解决方案来弥补其他 Web 服务（例如 Office 365 和 Azure）的不足。\n\n问：是否可以通过报告来查看我的 Azure AD 用户许可证何时过期？\n\n答： 不可以。 此功能目前不可用。\n\n## 混合 Azure AD 入门\n\n问：如果我已被添加为协作者，该如何离开原来的租户？\n\n答：如果被作为协作者添加到另一组织的租户，可使用右上角的""租户切换器""在租户之间切换。 目前还无法主动离开邀请组织，Microsoft 正致力于提供该功能。 在该功能推出之前，可以请求邀请组织将你从其租户中删除。\n\n问：如何将我的本地目录连接到 Azure AD？\n\n答：可以使用 Azure AD Connect 将本地目录连接到 Azure AD。\n\n有关详细信息，请参阅[将本地标识与 Azure Active Directory 集成](https://docs.azure.cn/active-directory/connect/active-directory-aadconnect)。\n\n问：如何在本地目录与云应用程序之间设置 SSO？\n\n答：只需在本地目录与 Azure AD 之间设置单一登录 (SSO)。 只要通过 Azure AD 访问云应用程序，该服务就会自动让用户使用其本地凭据正确进行身份验证。\n\n可以通过联合身份验证解决方案（例如 Active Directory 联合身份验证服务 (AD FS)）或通过配置密码哈希同步，轻松地从本地实现 SSO。可以使用 Azure AD Connect 配置向导轻松部署这两个选项。\n\n有关详细信息，请参阅[将本地标识与 Azure Active Directory 集成](https://docs.azure.cn/active-directory/connect/active-directory-aadconnect)。\n\n问：Azure AD 是否为组织中的用户提供自助服务门户？\n\n答： 是的，Azure AD 提供 [Azure AD 访问面板](https://login.partner.microsoftonline.cn/) ，方便用户使用自助服务以及进行应用程序访问。 如果是 Office 365 客户，可以在 Office 365 门户中找到许多相同的功能。\n\n## 密码管理\n\n问：是否可以使用 Azure AD 密码写回但不使用密码同步？（在这种情况下，是否可以结合密码写回使用 Azure AD 自助密码重置 (SSPR)，而不将密码存储在云中？）\n\n答：无需将 Active Directory 密码同步到 Azure AD 即可启用写回。 在联合环境中，Azure AD 单一登录 (SSO) 依赖本地目录对用户进行身份验证。 在这种情况下，并不需要在 Azure AD 中跟踪本地密码。\n\n问：需要多长时间才能将密码写回到 Active Directory 本地？\n\n答： 密码写回实时运行。\n\n问：是否可以对管理员管理的密码使用密码写回？\n\n答：可以。如果已启用密码写回，管理员执行的密码操作将写回到用户的本地环境。 \n\n问：如果尝试更改 Office 365/Azure AD 密码时忘记了现有的密码，该怎么办？\n\n答： 对于这种情况，有几个选项。 在可用的情况下，使用自助密码重置 (SSPR)。 SSPR 是否适用取决于其配置方式。 \n\n对于 Office 365 用户，管理员可以使用 [重置用户密码](https://support.office.com/en-us/article/Admins-Reset-user-passwords-7A5D073B-7FAE-4AA5-8F96-9ECD041ABA9C?ui=en-US&rs=en-US&ad=US)中所述的步骤重置密码。\n\n对于 Azure AD 帐户，管理员可以使用以下选项之一重置密码：\n\n*   [在经典管理门户中重置帐户](https://docs.azure.cn/active-directory/active-directory-create-users-reset-password)\n*   [使用 PowerShell](https://docs.microsoft.com/powershell/module/msonline/set-msoluserpassword?view=azureadps-1.0)\n\n## ""安全""\n\n问：是将在失败尝试次数达到特定数字后锁定帐户，还是会使用更复杂的策略？ 我们使用更复杂的策略锁定帐户。 此策略基于请求的 IP 和输入的密码。 根据存在攻击的可能性，锁定持续时间也会增加。 \n\n问：某些（常用）密码被拒绝并显示消息""此密码已使用多次""，这是指当前 Active Directory 中使用的密码吗？ 这是指全局通用的密码，例如""Password""和""123456""的任何变体。\n\n## 应用程序访问\n\n问：在哪里可以找到与 Azure AD 预先集成的应用程序及其功能的列表？\n\n答： Azure AD 中包含 Microsoft、应用程序服务提供商和合作伙伴提供的 2600 多个预先集成的应用程序。 所有预先集成的应用程序都支持单一登录 (SSO)。 SSO 允许用户使用组织凭据来访问应用。 某些应用程序还支持自动预配和自动取消预配。\n\n有关预先集成的应用程序的完整列表，请参阅 [Active Directory Marketplace](https://azure.microsoft.com/marketplace/active-directory/)（Active Directory 应用商店）。\n\n问：如果 Azure AD 应用商店中没有我需要的应用程序怎么办？\n\n答： 使用 Azure AD Premium，可以添加和配置所需的任何应用程序。 可以根据应用程序的功能和自己的喜好来配置 SSO 和自动预配。 \n\n问：用户如何使用 Azure AD 来登录应用程序？\n\n答： Azure AD 提供多种方式供用户查看和访问其应用程序，例如：\n\n*   Azure AD 访问面板\n*   Office 365 应用程序启动器\n*   直接登录到联合应用\n*   联合、基于密码或现有应用的深层链接\n\n有关详细信息，请参阅[为用户部署 Azure AD 集成的应用程序](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#deploying-azure-ad-integrated-applications-to-users)。\n\n问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n",问：为什么可以登录到 Azure 门户，但不能登录到 Azure 经典管理门户？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
"\n\n答： 默认情况下，当用户注册 Azure 时，系统会为其分配订阅管理员角色。 订阅管理员可以使用 Microsoft 帐户，也可以使用 Azure 订阅与之关联的目录中的工作或学校帐户。 此角色有权在 Azure 门户中管理服务。\n\n如果其他人需要使用同一个订阅登录和访问服务，则可将其添加为共同管理员。 此角色具有与服务管理员一样的访问特权，但不能更改订阅与 Azure 目录之间的关联关系。 有关订阅管理员的其他信息，请参阅 [Azure 订阅与 Azure Active Directory 的关联方式](https://docs.azure.cn/active-directory/active-directory-how-subscriptions-associated-directory)。\n\nAzure AD 提供另一组管理员角色来管理与目录和标识相关的功能。 这些管理员将有权访问 Azure 门户或 Azure 经典管理门户中的各种功能。 管理员的角色决定了其所能执行的操作，例如创建或编辑用户、向其他用户分配管理角色、重置用户密码、管理用户许可证，或者管理域。 有关 Azure AD 目录管理员及其角色的其他信息，请参阅[在 Azure Active Directory 中分配管理员角色](https://docs.azure.cn/active-directory/active-directory-assign-admin-roles)。\n\n另外，Azure AD 付费型服务（例如企业移动性 + 安全性）可通过综合性的企业级管理和安全解决方案来弥补其他 Web 服务（例如 Office 365 和 Azure）的不足。\n\n问：是否可以通过报告来查看我的 Azure AD 用户许可证何时过期？\n\n答： 不可以。 此功能目前不可用。\n\n## 混合 Azure AD 入门\n\n问：如果我已被添加为协作者，该如何离开原来的租户？\n\n答：如果被作为协作者添加到另一组织的租户，可使用右上角的""租户切换器""在租户之间切换。 目前还无法主动离开邀请组织，Microsoft 正致力于提供该功能。 在该功能推出之前，可以请求邀请组织将你从其租户中删除。\n\n问：如何将我的本地目录连接到 Azure AD？\n\n答：可以使用 Azure AD Connect 将本地目录连接到 Azure AD。\n\n有关详细信息，请参阅[将本地标识与 Azure Active Directory 集成](https://docs.azure.cn/active-directory/connect/active-directory-aadconnect)。\n\n问：如何在本地目录与云应用程序之间设置 SSO？\n\n答：只需在本地目录与 Azure AD 之间设置单一登录 (SSO)。 只要通过 Azure AD 访问云应用程序，该服务就会自动让用户使用其本地凭据正确进行身份验证。\n\n可以通过联合身份验证解决方案（例如 Active Directory 联合身份验证服务 (AD FS)）或通过配置密码哈希同步，轻松地从本地实现 SSO。可以使用 Azure AD Connect 配置向导轻松部署这两个选项。\n\n有关详细信息，请参阅[将本地标识与 Azure Active Directory 集成](https://docs.azure.cn/active-directory/connect/active-directory-aadconnect)。\n\n问：Azure AD 是否为组织中的用户提供自助服务门户？\n\n答： 是的，Azure AD 提供 [Azure AD 访问面板](https://login.partner.microsoftonline.cn/) ，方便用户使用自助服务以及进行应用程序访问。 如果是 Office 365 客户，可以在 Office 365 门户中找到许多相同的功能。\n\n## 密码管理\n\n问：是否可以使用 Azure AD 密码写回但不使用密码同步？（在这种情况下，是否可以结合密码写回使用 Azure AD 自助密码重置 (SSPR)，而不将密码存储在云中？）\n\n答：无需将 Active Directory 密码同步到 Azure AD 即可启用写回。 在联合环境中，Azure AD 单一登录 (SSO) 依赖本地目录对用户进行身份验证。 在这种情况下，并不需要在 Azure AD 中跟踪本地密码。\n\n问：需要多长时间才能将密码写回到 Active Directory 本地？\n\n答： 密码写回实时运行。\n\n问：是否可以对管理员管理的密码使用密码写回？\n\n答：可以。如果已启用密码写回，管理员执行的密码操作将写回到用户的本地环境。 \n\n问：如果尝试更改 Office 365/Azure AD 密码时忘记了现有的密码，该怎么办？\n\n答： 对于这种情况，有几个选项。 在可用的情况下，使用自助密码重置 (SSPR)。 SSPR 是否适用取决于其配置方式。 \n\n对于 Office 365 用户，管理员可以使用 [重置用户密码](https://support.office.com/en-us/article/Admins-Reset-user-passwords-7A5D073B-7FAE-4AA5-8F96-9ECD041ABA9C?ui=en-US&rs=en-US&ad=US)中所述的步骤重置密码。\n\n对于 Azure AD 帐户，管理员可以使用以下选项之一重置密码：\n\n*   [在经典管理门户中重置帐户](https://docs.azure.cn/active-directory/active-directory-create-users-reset-password)\n*   [使用 PowerShell](https://docs.microsoft.com/powershell/module/msonline/set-msoluserpassword?view=azureadps-1.0)\n\n## ""安全""\n\n问：是将在失败尝试次数达到特定数字后锁定帐户，还是会使用更复杂的策略？ 我们使用更复杂的策略锁定帐户。 此策略基于请求的 IP 和输入的密码。 根据存在攻击的可能性，锁定持续时间也会增加。 \n\n问：某些（常用）密码被拒绝并显示消息""此密码已使用多次""，这是指当前 Active Directory 中使用的密码吗？ 这是指全局通用的密码，例如""Password""和""123456""的任何变体。\n\n## 应用程序访问\n\n问：在哪里可以找到与 Azure AD 预先集成的应用程序及其功能的列表？\n\n答： Azure AD 中包含 Microsoft、应用程序服务提供商和合作伙伴提供的 2600 多个预先集成的应用程序。 所有预先集成的应用程序都支持单一登录 (SSO)。 SSO 允许用户使用组织凭据来访问应用。 某些应用程序还支持自动预配和自动取消预配。\n\n有关预先集成的应用程序的完整列表，请参阅 [Active Directory Marketplace](https://azure.microsoft.com/marketplace/active-directory/)（Active Directory 应用商店）。\n\n问：如果 Azure AD 应用商店中没有我需要的应用程序怎么办？\n\n答： 使用 Azure AD Premium，可以添加和配置所需的任何应用程序。 可以根据应用程序的功能和自己的喜好来配置 SSO 和自动预配。 \n\n问：用户如何使用 Azure AD 来登录应用程序？\n\n答： Azure AD 提供多种方式供用户查看和访问其应用程序，例如：\n\n*   Azure AD 访问面板\n*   Office 365 应用程序启动器\n*   直接登录到联合应用\n*   联合、基于密码或现有应用的深层链接\n\n有关详细信息，请参阅[为用户部署 Azure AD 集成的应用程序](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#deploying-azure-ad-integrated-applications-to-users)。\n\n问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n",问：订阅管理员与目录管理员的区别是什么？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
"\n\n答： 不可以。 此功能目前不可用。\n\n## 混合 Azure AD 入门\n\n问：如果我已被添加为协作者，该如何离开原来的租户？\n\n答：如果被作为协作者添加到另一组织的租户，可使用右上角的""租户切换器""在租户之间切换。 目前还无法主动离开邀请组织，Microsoft 正致力于提供该功能。 在该功能推出之前，可以请求邀请组织将你从其租户中删除。\n\n问：如何将我的本地目录连接到 Azure AD？\n\n答：可以使用 Azure AD Connect 将本地目录连接到 Azure AD。\n\n有关详细信息，请参阅[将本地标识与 Azure Active Directory 集成](https://docs.azure.cn/active-directory/connect/active-directory-aadconnect)。\n\n问：如何在本地目录与云应用程序之间设置 SSO？\n\n答：只需在本地目录与 Azure AD 之间设置单一登录 (SSO)。 只要通过 Azure AD 访问云应用程序，该服务就会自动让用户使用其本地凭据正确进行身份验证。\n\n可以通过联合身份验证解决方案（例如 Active Directory 联合身份验证服务 (AD FS)）或通过配置密码哈希同步，轻松地从本地实现 SSO。可以使用 Azure AD Connect 配置向导轻松部署这两个选项。\n\n有关详细信息，请参阅[将本地标识与 Azure Active Directory 集成](https://docs.azure.cn/active-directory/connect/active-directory-aadconnect)。\n\n问：Azure AD 是否为组织中的用户提供自助服务门户？\n\n答： 是的，Azure AD 提供 [Azure AD 访问面板](https://login.partner.microsoftonline.cn/) ，方便用户使用自助服务以及进行应用程序访问。 如果是 Office 365 客户，可以在 Office 365 门户中找到许多相同的功能。\n\n## 密码管理\n\n问：是否可以使用 Azure AD 密码写回但不使用密码同步？（在这种情况下，是否可以结合密码写回使用 Azure AD 自助密码重置 (SSPR)，而不将密码存储在云中？）\n\n答：无需将 Active Directory 密码同步到 Azure AD 即可启用写回。 在联合环境中，Azure AD 单一登录 (SSO) 依赖本地目录对用户进行身份验证。 在这种情况下，并不需要在 Azure AD 中跟踪本地密码。\n\n问：需要多长时间才能将密码写回到 Active Directory 本地？\n\n答： 密码写回实时运行。\n\n问：是否可以对管理员管理的密码使用密码写回？\n\n答：可以。如果已启用密码写回，管理员执行的密码操作将写回到用户的本地环境。 \n\n问：如果尝试更改 Office 365/Azure AD 密码时忘记了现有的密码，该怎么办？\n\n答： 对于这种情况，有几个选项。 在可用的情况下，使用自助密码重置 (SSPR)。 SSPR 是否适用取决于其配置方式。 \n\n对于 Office 365 用户，管理员可以使用 [重置用户密码](https://support.office.com/en-us/article/Admins-Reset-user-passwords-7A5D073B-7FAE-4AA5-8F96-9ECD041ABA9C?ui=en-US&rs=en-US&ad=US)中所述的步骤重置密码。\n\n对于 Azure AD 帐户，管理员可以使用以下选项之一重置密码：\n\n*   [在经典管理门户中重置帐户](https://docs.azure.cn/active-directory/active-directory-create-users-reset-password)\n*   [使用 PowerShell](https://docs.microsoft.com/powershell/module/msonline/set-msoluserpassword?view=azureadps-1.0)\n\n## ""安全""\n\n问：是将在失败尝试次数达到特定数字后锁定帐户，还是会使用更复杂的策略？ 我们使用更复杂的策略锁定帐户。 此策略基于请求的 IP 和输入的密码。 根据存在攻击的可能性，锁定持续时间也会增加。 \n\n问：某些（常用）密码被拒绝并显示消息""此密码已使用多次""，这是指当前 Active Directory 中使用的密码吗？ 这是指全局通用的密码，例如""Password""和""123456""的任何变体。\n\n## 应用程序访问\n\n问：在哪里可以找到与 Azure AD 预先集成的应用程序及其功能的列表？\n\n答： Azure AD 中包含 Microsoft、应用程序服务提供商和合作伙伴提供的 2600 多个预先集成的应用程序。 所有预先集成的应用程序都支持单一登录 (SSO)。 SSO 允许用户使用组织凭据来访问应用。 某些应用程序还支持自动预配和自动取消预配。\n\n有关预先集成的应用程序的完整列表，请参阅 [Active Directory Marketplace](https://azure.microsoft.com/marketplace/active-directory/)（Active Directory 应用商店）。\n\n问：如果 Azure AD 应用商店中没有我需要的应用程序怎么办？\n\n答： 使用 Azure AD Premium，可以添加和配置所需的任何应用程序。 可以根据应用程序的功能和自己的喜好来配置 SSO 和自动预配。 \n\n问：用户如何使用 Azure AD 来登录应用程序？\n\n答： Azure AD 提供多种方式供用户查看和访问其应用程序，例如：\n\n*   Azure AD 访问面板\n*   Office 365 应用程序启动器\n*   直接登录到联合应用\n*   联合、基于密码或现有应用的深层链接\n\n有关详细信息，请参阅[为用户部署 Azure AD 集成的应用程序](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#deploying-azure-ad-integrated-applications-to-users)。\n\n问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n",问：是否可以通过报告来查看我的 Azure AD 用户许可证何时过期？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
"\n\n答：可以。如果已启用密码写回，管理员执行的密码操作将写回到用户的本地环境。 \n\n问：如果尝试更改 Office 365/Azure AD 密码时忘记了现有的密码，该怎么办？\n\n答： 对于这种情况，有几个选项。 在可用的情况下，使用自助密码重置 (SSPR)。 SSPR 是否适用取决于其配置方式。 \n\n对于 Office 365 用户，管理员可以使用 [重置用户密码](https://support.office.com/en-us/article/Admins-Reset-user-passwords-7A5D073B-7FAE-4AA5-8F96-9ECD041ABA9C?ui=en-US&rs=en-US&ad=US)中所述的步骤重置密码。\n\n对于 Azure AD 帐户，管理员可以使用以下选项之一重置密码：\n\n*   [在经典管理门户中重置帐户](https://docs.azure.cn/active-directory/active-directory-create-users-reset-password)\n*   [使用 PowerShell](https://docs.microsoft.com/powershell/module/msonline/set-msoluserpassword?view=azureadps-1.0)\n\n## ""安全""\n\n问：是将在失败尝试次数达到特定数字后锁定帐户，还是会使用更复杂的策略？ 我们使用更复杂的策略锁定帐户。 此策略基于请求的 IP 和输入的密码。 根据存在攻击的可能性，锁定持续时间也会增加。 \n\n问：某些（常用）密码被拒绝并显示消息""此密码已使用多次""，这是指当前 Active Directory 中使用的密码吗？ 这是指全局通用的密码，例如""Password""和""123456""的任何变体。\n\n## 应用程序访问\n\n问：在哪里可以找到与 Azure AD 预先集成的应用程序及其功能的列表？\n\n答： Azure AD 中包含 Microsoft、应用程序服务提供商和合作伙伴提供的 2600 多个预先集成的应用程序。 所有预先集成的应用程序都支持单一登录 (SSO)。 SSO 允许用户使用组织凭据来访问应用。 某些应用程序还支持自动预配和自动取消预配。\n\n有关预先集成的应用程序的完整列表，请参阅 [Active Directory Marketplace](https://azure.microsoft.com/marketplace/active-directory/)（Active Directory 应用商店）。\n\n问：如果 Azure AD 应用商店中没有我需要的应用程序怎么办？\n\n答： 使用 Azure AD Premium，可以添加和配置所需的任何应用程序。 可以根据应用程序的功能和自己的喜好来配置 SSO 和自动预配。 \n\n问：用户如何使用 Azure AD 来登录应用程序？\n\n答： Azure AD 提供多种方式供用户查看和访问其应用程序，例如：\n\n*   Azure AD 访问面板\n*   Office 365 应用程序启动器\n*   直接登录到联合应用\n*   联合、基于密码或现有应用的深层链接\n\n有关详细信息，请参阅[为用户部署 Azure AD 集成的应用程序](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#deploying-azure-ad-integrated-applications-to-users)。\n\n问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n",问：是否可以对管理员管理的密码使用密码写回？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
"\n\n答：可以使用 Azure AD Connect 将本地目录连接到 Azure AD。\n\n有关详细信息，请参阅[将本地标识与 Azure Active Directory 集成](https://docs.azure.cn/active-directory/connect/active-directory-aadconnect)。\n\n问：如何在本地目录与云应用程序之间设置 SSO？\n\n答：只需在本地目录与 Azure AD 之间设置单一登录 (SSO)。 只要通过 Azure AD 访问云应用程序，该服务就会自动让用户使用其本地凭据正确进行身份验证。\n\n可以通过联合身份验证解决方案（例如 Active Directory 联合身份验证服务 (AD FS)）或通过配置密码哈希同步，轻松地从本地实现 SSO。可以使用 Azure AD Connect 配置向导轻松部署这两个选项。\n\n有关详细信息，请参阅[将本地标识与 Azure Active Directory 集成](https://docs.azure.cn/active-directory/connect/active-directory-aadconnect)。\n\n问：Azure AD 是否为组织中的用户提供自助服务门户？\n\n答： 是的，Azure AD 提供 [Azure AD 访问面板](https://login.partner.microsoftonline.cn/) ，方便用户使用自助服务以及进行应用程序访问。 如果是 Office 365 客户，可以在 Office 365 门户中找到许多相同的功能。\n\n## 密码管理\n\n问：是否可以使用 Azure AD 密码写回但不使用密码同步？（在这种情况下，是否可以结合密码写回使用 Azure AD 自助密码重置 (SSPR)，而不将密码存储在云中？）\n\n答：无需将 Active Directory 密码同步到 Azure AD 即可启用写回。 在联合环境中，Azure AD 单一登录 (SSO) 依赖本地目录对用户进行身份验证。 在这种情况下，并不需要在 Azure AD 中跟踪本地密码。\n\n问：需要多长时间才能将密码写回到 Active Directory 本地？\n\n答： 密码写回实时运行。\n\n问：是否可以对管理员管理的密码使用密码写回？\n\n答：可以。如果已启用密码写回，管理员执行的密码操作将写回到用户的本地环境。 \n\n问：如果尝试更改 Office 365/Azure AD 密码时忘记了现有的密码，该怎么办？\n\n答： 对于这种情况，有几个选项。 在可用的情况下，使用自助密码重置 (SSPR)。 SSPR 是否适用取决于其配置方式。 \n\n对于 Office 365 用户，管理员可以使用 [重置用户密码](https://support.office.com/en-us/article/Admins-Reset-user-passwords-7A5D073B-7FAE-4AA5-8F96-9ECD041ABA9C?ui=en-US&rs=en-US&ad=US)中所述的步骤重置密码。\n\n对于 Azure AD 帐户，管理员可以使用以下选项之一重置密码：\n\n*   [在经典管理门户中重置帐户](https://docs.azure.cn/active-directory/active-directory-create-users-reset-password)\n*   [使用 PowerShell](https://docs.microsoft.com/powershell/module/msonline/set-msoluserpassword?view=azureadps-1.0)\n\n## ""安全""\n\n问：是将在失败尝试次数达到特定数字后锁定帐户，还是会使用更复杂的策略？ 我们使用更复杂的策略锁定帐户。 此策略基于请求的 IP 和输入的密码。 根据存在攻击的可能性，锁定持续时间也会增加。 \n\n问：某些（常用）密码被拒绝并显示消息""此密码已使用多次""，这是指当前 Active Directory 中使用的密码吗？ 这是指全局通用的密码，例如""Password""和""123456""的任何变体。\n\n## 应用程序访问\n\n问：在哪里可以找到与 Azure AD 预先集成的应用程序及其功能的列表？\n\n答： Azure AD 中包含 Microsoft、应用程序服务提供商和合作伙伴提供的 2600 多个预先集成的应用程序。 所有预先集成的应用程序都支持单一登录 (SSO)。 SSO 允许用户使用组织凭据来访问应用。 某些应用程序还支持自动预配和自动取消预配。\n\n有关预先集成的应用程序的完整列表，请参阅 [Active Directory Marketplace](https://azure.microsoft.com/marketplace/active-directory/)（Active Directory 应用商店）。\n\n问：如果 Azure AD 应用商店中没有我需要的应用程序怎么办？\n\n答： 使用 Azure AD Premium，可以添加和配置所需的任何应用程序。 可以根据应用程序的功能和自己的喜好来配置 SSO 和自动预配。 \n\n问：用户如何使用 Azure AD 来登录应用程序？\n\n答： Azure AD 提供多种方式供用户查看和访问其应用程序，例如：\n\n*   Azure AD 访问面板\n*   Office 365 应用程序启动器\n*   直接登录到联合应用\n*   联合、基于密码或现有应用的深层链接\n\n有关详细信息，请参阅[为用户部署 Azure AD 集成的应用程序](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#deploying-azure-ad-integrated-applications-to-users)。\n\n问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n",问：如何将我的本地目录连接到 Azure AD？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
"\n\n答：只需在本地目录与 Azure AD 之间设置单一登录 (SSO)。 只要通过 Azure AD 访问云应用程序，该服务就会自动让用户使用其本地凭据正确进行身份验证。\n\n可以通过联合身份验证解决方案（例如 Active Directory 联合身份验证服务 (AD FS)）或通过配置密码哈希同步，轻松地从本地实现 SSO。可以使用 Azure AD Connect 配置向导轻松部署这两个选项。\n\n有关详细信息，请参阅[将本地标识与 Azure Active Directory 集成](https://docs.azure.cn/active-directory/connect/active-directory-aadconnect)。\n\n问：Azure AD 是否为组织中的用户提供自助服务门户？\n\n答： 是的，Azure AD 提供 [Azure AD 访问面板](https://login.partner.microsoftonline.cn/) ，方便用户使用自助服务以及进行应用程序访问。 如果是 Office 365 客户，可以在 Office 365 门户中找到许多相同的功能。\n\n## 密码管理\n\n问：是否可以使用 Azure AD 密码写回但不使用密码同步？（在这种情况下，是否可以结合密码写回使用 Azure AD 自助密码重置 (SSPR)，而不将密码存储在云中？）\n\n答：无需将 Active Directory 密码同步到 Azure AD 即可启用写回。 在联合环境中，Azure AD 单一登录 (SSO) 依赖本地目录对用户进行身份验证。 在这种情况下，并不需要在 Azure AD 中跟踪本地密码。\n\n问：需要多长时间才能将密码写回到 Active Directory 本地？\n\n答： 密码写回实时运行。\n\n问：是否可以对管理员管理的密码使用密码写回？\n\n答：可以。如果已启用密码写回，管理员执行的密码操作将写回到用户的本地环境。 \n\n问：如果尝试更改 Office 365/Azure AD 密码时忘记了现有的密码，该怎么办？\n\n答： 对于这种情况，有几个选项。 在可用的情况下，使用自助密码重置 (SSPR)。 SSPR 是否适用取决于其配置方式。 \n\n对于 Office 365 用户，管理员可以使用 [重置用户密码](https://support.office.com/en-us/article/Admins-Reset-user-passwords-7A5D073B-7FAE-4AA5-8F96-9ECD041ABA9C?ui=en-US&rs=en-US&ad=US)中所述的步骤重置密码。\n\n对于 Azure AD 帐户，管理员可以使用以下选项之一重置密码：\n\n*   [在经典管理门户中重置帐户](https://docs.azure.cn/active-directory/active-directory-create-users-reset-password)\n*   [使用 PowerShell](https://docs.microsoft.com/powershell/module/msonline/set-msoluserpassword?view=azureadps-1.0)\n\n## ""安全""\n\n问：是将在失败尝试次数达到特定数字后锁定帐户，还是会使用更复杂的策略？ 我们使用更复杂的策略锁定帐户。 此策略基于请求的 IP 和输入的密码。 根据存在攻击的可能性，锁定持续时间也会增加。 \n\n问：某些（常用）密码被拒绝并显示消息""此密码已使用多次""，这是指当前 Active Directory 中使用的密码吗？ 这是指全局通用的密码，例如""Password""和""123456""的任何变体。\n\n## 应用程序访问\n\n问：在哪里可以找到与 Azure AD 预先集成的应用程序及其功能的列表？\n\n答： Azure AD 中包含 Microsoft、应用程序服务提供商和合作伙伴提供的 2600 多个预先集成的应用程序。 所有预先集成的应用程序都支持单一登录 (SSO)。 SSO 允许用户使用组织凭据来访问应用。 某些应用程序还支持自动预配和自动取消预配。\n\n有关预先集成的应用程序的完整列表，请参阅 [Active Directory Marketplace](https://azure.microsoft.com/marketplace/active-directory/)（Active Directory 应用商店）。\n\n问：如果 Azure AD 应用商店中没有我需要的应用程序怎么办？\n\n答： 使用 Azure AD Premium，可以添加和配置所需的任何应用程序。 可以根据应用程序的功能和自己的喜好来配置 SSO 和自动预配。 \n\n问：用户如何使用 Azure AD 来登录应用程序？\n\n答： Azure AD 提供多种方式供用户查看和访问其应用程序，例如：\n\n*   Azure AD 访问面板\n*   Office 365 应用程序启动器\n*   直接登录到联合应用\n*   联合、基于密码或现有应用的深层链接\n\n有关详细信息，请参阅[为用户部署 Azure AD 集成的应用程序](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#deploying-azure-ad-integrated-applications-to-users)。\n\n问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n",问：如何在本地目录与云应用程序之间设置 SSO？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
"\n\n答： 是的，Azure AD 提供 [Azure AD 访问面板](https://login.partner.microsoftonline.cn/) ，方便用户使用自助服务以及进行应用程序访问。 如果是 Office 365 客户，可以在 Office 365 门户中找到许多相同的功能。\n\n## 密码管理\n\n问：是否可以使用 Azure AD 密码写回但不使用密码同步？（在这种情况下，是否可以结合密码写回使用 Azure AD 自助密码重置 (SSPR)，而不将密码存储在云中？）\n\n答：无需将 Active Directory 密码同步到 Azure AD 即可启用写回。 在联合环境中，Azure AD 单一登录 (SSO) 依赖本地目录对用户进行身份验证。 在这种情况下，并不需要在 Azure AD 中跟踪本地密码。\n\n问：需要多长时间才能将密码写回到 Active Directory 本地？\n\n答： 密码写回实时运行。\n\n问：是否可以对管理员管理的密码使用密码写回？\n\n答：可以。如果已启用密码写回，管理员执行的密码操作将写回到用户的本地环境。 \n\n问：如果尝试更改 Office 365/Azure AD 密码时忘记了现有的密码，该怎么办？\n\n答： 对于这种情况，有几个选项。 在可用的情况下，使用自助密码重置 (SSPR)。 SSPR 是否适用取决于其配置方式。 \n\n对于 Office 365 用户，管理员可以使用 [重置用户密码](https://support.office.com/en-us/article/Admins-Reset-user-passwords-7A5D073B-7FAE-4AA5-8F96-9ECD041ABA9C?ui=en-US&rs=en-US&ad=US)中所述的步骤重置密码。\n\n对于 Azure AD 帐户，管理员可以使用以下选项之一重置密码：\n\n*   [在经典管理门户中重置帐户](https://docs.azure.cn/active-directory/active-directory-create-users-reset-password)\n*   [使用 PowerShell](https://docs.microsoft.com/powershell/module/msonline/set-msoluserpassword?view=azureadps-1.0)\n\n## ""安全""\n\n问：是将在失败尝试次数达到特定数字后锁定帐户，还是会使用更复杂的策略？ 我们使用更复杂的策略锁定帐户。 此策略基于请求的 IP 和输入的密码。 根据存在攻击的可能性，锁定持续时间也会增加。 \n\n问：某些（常用）密码被拒绝并显示消息""此密码已使用多次""，这是指当前 Active Directory 中使用的密码吗？ 这是指全局通用的密码，例如""Password""和""123456""的任何变体。\n\n## 应用程序访问\n\n问：在哪里可以找到与 Azure AD 预先集成的应用程序及其功能的列表？\n\n答： Azure AD 中包含 Microsoft、应用程序服务提供商和合作伙伴提供的 2600 多个预先集成的应用程序。 所有预先集成的应用程序都支持单一登录 (SSO)。 SSO 允许用户使用组织凭据来访问应用。 某些应用程序还支持自动预配和自动取消预配。\n\n有关预先集成的应用程序的完整列表，请参阅 [Active Directory Marketplace](https://azure.microsoft.com/marketplace/active-directory/)（Active Directory 应用商店）。\n\n问：如果 Azure AD 应用商店中没有我需要的应用程序怎么办？\n\n答： 使用 Azure AD Premium，可以添加和配置所需的任何应用程序。 可以根据应用程序的功能和自己的喜好来配置 SSO 和自动预配。 \n\n问：用户如何使用 Azure AD 来登录应用程序？\n\n答： Azure AD 提供多种方式供用户查看和访问其应用程序，例如：\n\n*   Azure AD 访问面板\n*   Office 365 应用程序启动器\n*   直接登录到联合应用\n*   联合、基于密码或现有应用的深层链接\n\n有关详细信息，请参阅[为用户部署 Azure AD 集成的应用程序](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#deploying-azure-ad-integrated-applications-to-users)。\n\n问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n",问：Azure AD 是否为组织中的用户提供自助服务门户？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
"\n\n答：如果被作为协作者添加到另一组织的租户，可使用右上角的""租户切换器""在租户之间切换。 目前还无法主动离开邀请组织，Microsoft 正致力于提供该功能。 在该功能推出之前，可以请求邀请组织将你从其租户中删除。\n\n问：如何将我的本地目录连接到 Azure AD？\n\n答：可以使用 Azure AD Connect 将本地目录连接到 Azure AD。\n\n有关详细信息，请参阅[将本地标识与 Azure Active Directory 集成](https://docs.azure.cn/active-directory/connect/active-directory-aadconnect)。\n\n问：如何在本地目录与云应用程序之间设置 SSO？\n\n答：只需在本地目录与 Azure AD 之间设置单一登录 (SSO)。 只要通过 Azure AD 访问云应用程序，该服务就会自动让用户使用其本地凭据正确进行身份验证。\n\n可以通过联合身份验证解决方案（例如 Active Directory 联合身份验证服务 (AD FS)）或通过配置密码哈希同步，轻松地从本地实现 SSO。可以使用 Azure AD Connect 配置向导轻松部署这两个选项。\n\n有关详细信息，请参阅[将本地标识与 Azure Active Directory 集成](https://docs.azure.cn/active-directory/connect/active-directory-aadconnect)。\n\n问：Azure AD 是否为组织中的用户提供自助服务门户？\n\n答： 是的，Azure AD 提供 [Azure AD 访问面板](https://login.partner.microsoftonline.cn/) ，方便用户使用自助服务以及进行应用程序访问。 如果是 Office 365 客户，可以在 Office 365 门户中找到许多相同的功能。\n\n## 密码管理\n\n问：是否可以使用 Azure AD 密码写回但不使用密码同步？（在这种情况下，是否可以结合密码写回使用 Azure AD 自助密码重置 (SSPR)，而不将密码存储在云中？）\n\n答：无需将 Active Directory 密码同步到 Azure AD 即可启用写回。 在联合环境中，Azure AD 单一登录 (SSO) 依赖本地目录对用户进行身份验证。 在这种情况下，并不需要在 Azure AD 中跟踪本地密码。\n\n问：需要多长时间才能将密码写回到 Active Directory 本地？\n\n答： 密码写回实时运行。\n\n问：是否可以对管理员管理的密码使用密码写回？\n\n答：可以。如果已启用密码写回，管理员执行的密码操作将写回到用户的本地环境。 \n\n问：如果尝试更改 Office 365/Azure AD 密码时忘记了现有的密码，该怎么办？\n\n答： 对于这种情况，有几个选项。 在可用的情况下，使用自助密码重置 (SSPR)。 SSPR 是否适用取决于其配置方式。 \n\n对于 Office 365 用户，管理员可以使用 [重置用户密码](https://support.office.com/en-us/article/Admins-Reset-user-passwords-7A5D073B-7FAE-4AA5-8F96-9ECD041ABA9C?ui=en-US&rs=en-US&ad=US)中所述的步骤重置密码。\n\n对于 Azure AD 帐户，管理员可以使用以下选项之一重置密码：\n\n*   [在经典管理门户中重置帐户](https://docs.azure.cn/active-directory/active-directory-create-users-reset-password)\n*   [使用 PowerShell](https://docs.microsoft.com/powershell/module/msonline/set-msoluserpassword?view=azureadps-1.0)\n\n## ""安全""\n\n问：是将在失败尝试次数达到特定数字后锁定帐户，还是会使用更复杂的策略？ 我们使用更复杂的策略锁定帐户。 此策略基于请求的 IP 和输入的密码。 根据存在攻击的可能性，锁定持续时间也会增加。 \n\n问：某些（常用）密码被拒绝并显示消息""此密码已使用多次""，这是指当前 Active Directory 中使用的密码吗？ 这是指全局通用的密码，例如""Password""和""123456""的任何变体。\n\n## 应用程序访问\n\n问：在哪里可以找到与 Azure AD 预先集成的应用程序及其功能的列表？\n\n答： Azure AD 中包含 Microsoft、应用程序服务提供商和合作伙伴提供的 2600 多个预先集成的应用程序。 所有预先集成的应用程序都支持单一登录 (SSO)。 SSO 允许用户使用组织凭据来访问应用。 某些应用程序还支持自动预配和自动取消预配。\n\n有关预先集成的应用程序的完整列表，请参阅 [Active Directory Marketplace](https://azure.microsoft.com/marketplace/active-directory/)（Active Directory 应用商店）。\n\n问：如果 Azure AD 应用商店中没有我需要的应用程序怎么办？\n\n答： 使用 Azure AD Premium，可以添加和配置所需的任何应用程序。 可以根据应用程序的功能和自己的喜好来配置 SSO 和自动预配。 \n\n问：用户如何使用 Azure AD 来登录应用程序？\n\n答： Azure AD 提供多种方式供用户查看和访问其应用程序，例如：\n\n*   Azure AD 访问面板\n*   Office 365 应用程序启动器\n*   直接登录到联合应用\n*   联合、基于密码或现有应用的深层链接\n\n有关详细信息，请参阅[为用户部署 Azure AD 集成的应用程序](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#deploying-azure-ad-integrated-applications-to-users)。\n\n问：Azure AD 可通过哪些不同的方式来启用对应用程序的身份验证和单一登录？\n\n答： Azure AD 支持使用多种标准化协议（例如 SAML 2.0、OpenID Connect、OAuth 2.0 和 WS-Federation）进行身份验证和授权。 对于仅支持基于窗体的身份验证的应用程序，Azure AD 还支持密码保管和自动化登录功能。 \n\n有关详细信息，请参阅：\n\n*   [Azure AD 的身份验证方案](https://docs.azure.cn/active-directory/develop/active-directory-authentication-scenarios)\n*   [Active Directory 身份验证协议](https://docs.azure.cn/active-directory/develop/active-directory-developers-guide)\n*   [Azure Active Directory 中单一登录的工作原理是什么？](https://docs.azure.cn/active-directory/active-directory-appssoaccess-whatis#how-does-single-sign-on-with-azure-active-directory-work)\n\n问：SaaS 应用程序的自动用户预配是什么？\n\n答： 使用 Azure AD 可在许多流行的云 (SaaS) 应用程序中自动创建、维护和删除用户标识。\n\n问：是否可以通过 Azure AD 设置安全的 LDAP 连接？\n\n答：不可以。 Azure AD 不支持 LDAP 协议。\n",问：如果我已被添加为协作者，该如何离开原来的租户？,active directory,https://docs.azure.cn/active-directory/active-directory-faq
"\n\n向多个地理位置进行部署时，API 管理使用[性能流量路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods#priority)。 传入流量将路由到最近的 API 网关。 如果一个区域处于脱机状态，则传入流量会自动路由到下一个最近的网关。 在[流量管理器路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods)中了解有关路由方法的详细信息。\n\n### 是否可以使用 Azure 资源管理器模板创建 API 管理服务实例？\n\n是的。 请参阅 [Azure API 管理服务](http://aka.ms/apimtemplate)快速入门模板。\n\n### 是否可以为后端使用自签名 SSL 证书？\n\n是的。 可以通过 PowerShell 或直接提交到 API 来完成此操作。 这将禁用证书链验证，并将允许在从 API 管理与后端服务进行通信时使用自签名或私人签名证书。\n\n#### Powershell 方法\n\n使用 [`New-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/new-azurermapimanagementbackend)（适用于新后端）或 [`Set-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/set-azurermapimanagementbackend)（适用于现有后端）PowerShell cmdlet 并将 `-SkipCertificateChainValidation` 参数设置设为 `True`。 \n\n`$context = New-AzureRmApiManagementContext -resourcegroup 'ContosoResourceGroup' -servicename 'ContosoAPIMService' New-AzureRmApiManagementBackend -Context $context -Url 'https://contoso.com/myapi' -Protocol http -SkipCertificateChainValidation $true `\n\n#### 直接 API 更新方法\n\n1.  使用 API 管理创建[后端](https://msdn.microsoft.com/library/azure/dn935030.aspx)实体。 \n2.  将""skipCertificateChainValidation""属性设置为""true""。 \n3.  如果不再希望允许自签名证书，请删除后端实体，或将""skipCertificateChainValidation""属性设置为""false""。\n\n### 为何在尝试克隆 Git 存储库时出现身份验证失败？\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",向多个地理位置进行部署时，API 管理使用何种路由方法？,api management,https://docs.azure.cn/api-management/api-management-faq
[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。,导入 API 是否存在限制或已知问题？,api management,https://docs.azure.cn/api-management/api-management-faq
\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n,是否可将 API 管理服务从一个订阅移到另一个订阅？,api management,https://docs.azure.cn/api-management/api-management-faq
\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n,在 VNET 中部署 API 管理时所需的最小子网大小是多少？,api management,https://docs.azure.cn/api-management/api-management-faq
\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n,为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？,api management,https://docs.azure.cn/api-management/api-management-faq
\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n,API 管理是否适用于 Azure ExpressRoute？,api management,https://docs.azure.cn/api-management/api-management-faq
"\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",为何在尝试克隆 Git 存储库时出现身份验证失败？,api management,https://docs.azure.cn/api-management/api-management-faq
"\n\n是的。 可以通过 PowerShell 或直接提交到 API 来完成此操作。 这将禁用证书链验证，并将允许在从 API 管理与后端服务进行通信时使用自签名或私人签名证书。\n\n#### Powershell 方法\n\n使用 [`New-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/new-azurermapimanagementbackend)（适用于新后端）或 [`Set-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/set-azurermapimanagementbackend)（适用于现有后端）PowerShell cmdlet 并将 `-SkipCertificateChainValidation` 参数设置设为 `True`。 \n\n`$context = New-AzureRmApiManagementContext -resourcegroup 'ContosoResourceGroup' -servicename 'ContosoAPIMService' New-AzureRmApiManagementBackend -Context $context -Url 'https://contoso.com/myapi' -Protocol http -SkipCertificateChainValidation $true `\n\n#### 直接 API 更新方法\n\n1.  使用 API 管理创建[后端](https://msdn.microsoft.com/library/azure/dn935030.aspx)实体。 \n2.  将""skipCertificateChainValidation""属性设置为""true""。 \n3.  如果不再希望允许自签名证书，请删除后端实体，或将""skipCertificateChainValidation""属性设置为""false""。\n\n### 为何在尝试克隆 Git 存储库时出现身份验证失败？\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",是否可以为后端使用自签名 SSL 证书？,api management,https://docs.azure.cn/api-management/api-management-faq
"\n\n是的。 请参阅 [Azure API 管理服务](http://aka.ms/apimtemplate)快速入门模板。\n\n### 是否可以为后端使用自签名 SSL 证书？\n\n是的。 可以通过 PowerShell 或直接提交到 API 来完成此操作。 这将禁用证书链验证，并将允许在从 API 管理与后端服务进行通信时使用自签名或私人签名证书。\n\n#### Powershell 方法\n\n使用 [`New-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/new-azurermapimanagementbackend)（适用于新后端）或 [`Set-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/set-azurermapimanagementbackend)（适用于现有后端）PowerShell cmdlet 并将 `-SkipCertificateChainValidation` 参数设置设为 `True`。 \n\n`$context = New-AzureRmApiManagementContext -resourcegroup 'ContosoResourceGroup' -servicename 'ContosoAPIMService' New-AzureRmApiManagementBackend -Context $context -Url 'https://contoso.com/myapi' -Protocol http -SkipCertificateChainValidation $true `\n\n#### 直接 API 更新方法\n\n1.  使用 API 管理创建[后端](https://msdn.microsoft.com/library/azure/dn935030.aspx)实体。 \n2.  将""skipCertificateChainValidation""属性设置为""true""。 \n3.  如果不再希望允许自签名证书，请删除后端实体，或将""skipCertificateChainValidation""属性设置为""false""。\n\n### 为何在尝试克隆 Git 存储库时出现身份验证失败？\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",是否可以使用 Azure 资源管理器模板创建 API 管理服务实例？,api management,https://docs.azure.cn/api-management/api-management-faq
"\n\n若要了解如何使用 Active Directory 联合身份验证服务 (AD FS) 安全配置 OAuth 2.0 授权服务器，请参阅[在 API 管理中使用 ADFS](https://phvbaars.wordpress.com/2016/02/06/using-adfs-in-api-management/)。\n\n### 向多个地理位置进行部署时，API 管理使用何种路由方法？\n\n向多个地理位置进行部署时，API 管理使用[性能流量路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods#priority)。 传入流量将路由到最近的 API 网关。 如果一个区域处于脱机状态，则传入流量会自动路由到下一个最近的网关。 在[流量管理器路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods)中了解有关路由方法的详细信息。\n\n### 是否可以使用 Azure 资源管理器模板创建 API 管理服务实例？\n\n是的。 请参阅 [Azure API 管理服务](http://aka.ms/apimtemplate)快速入门模板。\n\n### 是否可以为后端使用自签名 SSL 证书？\n\n是的。 可以通过 PowerShell 或直接提交到 API 来完成此操作。 这将禁用证书链验证，并将允许在从 API 管理与后端服务进行通信时使用自签名或私人签名证书。\n\n#### Powershell 方法\n\n使用 [`New-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/new-azurermapimanagementbackend)（适用于新后端）或 [`Set-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/set-azurermapimanagementbackend)（适用于现有后端）PowerShell cmdlet 并将 `-SkipCertificateChainValidation` 参数设置设为 `True`。 \n\n`$context = New-AzureRmApiManagementContext -resourcegroup 'ContosoResourceGroup' -servicename 'ContosoAPIMService' New-AzureRmApiManagementBackend -Context $context -Url 'https://contoso.com/myapi' -Protocol http -SkipCertificateChainValidation $true `\n\n#### 直接 API 更新方法\n\n1.  使用 API 管理创建[后端](https://msdn.microsoft.com/library/azure/dn935030.aspx)实体。 \n2.  将""skipCertificateChainValidation""属性设置为""true""。 \n3.  如果不再希望允许自签名证书，请删除后端实体，或将""skipCertificateChainValidation""属性设置为""false""。\n\n### 为何在尝试克隆 Git 存储库时出现身份验证失败？\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",是否可以使用 AD FS 安全配置 OAuth 2.0 授权服务器？,api management,https://docs.azure.cn/api-management/api-management-faq
"\n\n当前已提供 [SOAP 传递](http://blogs.msdn.microsoft.com/apimanagement/2016/10/13/soap-pass-through/)支持。 管理员可以导入其 SOAP 服务的 WSDL，以便 Azure API 管理创建一个 SOAP 前端。 开发人员门户文档、测试控制台、策略和分析都可用于 SOAP 服务。\n\n### API 管理网关 IP 地址是否不变？ 是否可以在防火墙规则中使用它？\n\n在标准层和高级层中，API 管理租户的公共 IP 地址 (VIP) 在租户生存期内是静态的，但有一些例外。 IP 地址在以下情况下更改：\n\n*   服务被删除并重新创建。\n*   服务订阅被[暂停](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)或[警告](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)（例如，由于未付款），然后被恢复。\n*   添加或删除 Azure 虚拟网络（只能在开发人员层和高级层使用虚拟网络）。\n\n对于多区域部署，仅当区域先空出然后恢复时，区域地址会更改（只能在高级层使用多区域部署）。\n\n对于为多区域部署配置的高级层租户，每个区域分配一个公共 IP 地址。\n\n可在 Azure 门户中的租户页面上获取一个 IP 地址（或者在多区域部署中获取多个 IP 地址）。\n\n### 是否可以使用 AD FS 安全配置 OAuth 2.0 授权服务器？\n\n若要了解如何使用 Active Directory 联合身份验证服务 (AD FS) 安全配置 OAuth 2.0 授权服务器，请参阅[在 API 管理中使用 ADFS](https://phvbaars.wordpress.com/2016/02/06/using-adfs-in-api-management/)。\n\n### 向多个地理位置进行部署时，API 管理使用何种路由方法？\n\n向多个地理位置进行部署时，API 管理使用[性能流量路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods#priority)。 传入流量将路由到最近的 API 网关。 如果一个区域处于脱机状态，则传入流量会自动路由到下一个最近的网关。 在[流量管理器路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods)中了解有关路由方法的详细信息。\n\n### 是否可以使用 Azure 资源管理器模板创建 API 管理服务实例？\n\n是的。 请参阅 [Azure API 管理服务](http://aka.ms/apimtemplate)快速入门模板。\n\n### 是否可以为后端使用自签名 SSL 证书？\n\n是的。 可以通过 PowerShell 或直接提交到 API 来完成此操作。 这将禁用证书链验证，并将允许在从 API 管理与后端服务进行通信时使用自签名或私人签名证书。\n\n#### Powershell 方法\n\n使用 [`New-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/new-azurermapimanagementbackend)（适用于新后端）或 [`Set-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/set-azurermapimanagementbackend)（适用于现有后端）PowerShell cmdlet 并将 `-SkipCertificateChainValidation` 参数设置设为 `True`。 \n\n`$context = New-AzureRmApiManagementContext -resourcegroup 'ContosoResourceGroup' -servicename 'ContosoAPIMService' New-AzureRmApiManagementBackend -Context $context -Url 'https://contoso.com/myapi' -Protocol http -SkipCertificateChainValidation $true `\n\n#### 直接 API 更新方法\n\n1.  使用 API 管理创建[后端](https://msdn.microsoft.com/library/azure/dn935030.aspx)实体。 \n2.  将""skipCertificateChainValidation""属性设置为""true""。 \n3.  如果不再希望允许自签名证书，请删除后端实体，或将""skipCertificateChainValidation""属性设置为""false""。\n\n### 为何在尝试克隆 Git 存储库时出现身份验证失败？\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",是否可将 SOAP 用于 API 管理？,api management,https://docs.azure.cn/api-management/api-management-faq
"\n\n若要在单个 API 中设置多个环境（例如，一个测试环境和一个生产环境），则有两个选项。 可以：\n\n*   在同一租户上托管不同的 API。\n*   在不同租户上托管相同的 API。\n\n### 是否可将 SOAP 用于 API 管理？\n\n当前已提供 [SOAP 传递](http://blogs.msdn.microsoft.com/apimanagement/2016/10/13/soap-pass-through/)支持。 管理员可以导入其 SOAP 服务的 WSDL，以便 Azure API 管理创建一个 SOAP 前端。 开发人员门户文档、测试控制台、策略和分析都可用于 SOAP 服务。\n\n### API 管理网关 IP 地址是否不变？ 是否可以在防火墙规则中使用它？\n\n在标准层和高级层中，API 管理租户的公共 IP 地址 (VIP) 在租户生存期内是静态的，但有一些例外。 IP 地址在以下情况下更改：\n\n*   服务被删除并重新创建。\n*   服务订阅被[暂停](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)或[警告](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)（例如，由于未付款），然后被恢复。\n*   添加或删除 Azure 虚拟网络（只能在开发人员层和高级层使用虚拟网络）。\n\n对于多区域部署，仅当区域先空出然后恢复时，区域地址会更改（只能在高级层使用多区域部署）。\n\n对于为多区域部署配置的高级层租户，每个区域分配一个公共 IP 地址。\n\n可在 Azure 门户中的租户页面上获取一个 IP 地址（或者在多区域部署中获取多个 IP 地址）。\n\n### 是否可以使用 AD FS 安全配置 OAuth 2.0 授权服务器？\n\n若要了解如何使用 Active Directory 联合身份验证服务 (AD FS) 安全配置 OAuth 2.0 授权服务器，请参阅[在 API 管理中使用 ADFS](https://phvbaars.wordpress.com/2016/02/06/using-adfs-in-api-management/)。\n\n### 向多个地理位置进行部署时，API 管理使用何种路由方法？\n\n向多个地理位置进行部署时，API 管理使用[性能流量路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods#priority)。 传入流量将路由到最近的 API 网关。 如果一个区域处于脱机状态，则传入流量会自动路由到下一个最近的网关。 在[流量管理器路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods)中了解有关路由方法的详细信息。\n\n### 是否可以使用 Azure 资源管理器模板创建 API 管理服务实例？\n\n是的。 请参阅 [Azure API 管理服务](http://aka.ms/apimtemplate)快速入门模板。\n\n### 是否可以为后端使用自签名 SSL 证书？\n\n是的。 可以通过 PowerShell 或直接提交到 API 来完成此操作。 这将禁用证书链验证，并将允许在从 API 管理与后端服务进行通信时使用自签名或私人签名证书。\n\n#### Powershell 方法\n\n使用 [`New-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/new-azurermapimanagementbackend)（适用于新后端）或 [`Set-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/set-azurermapimanagementbackend)（适用于现有后端）PowerShell cmdlet 并将 `-SkipCertificateChainValidation` 参数设置设为 `True`。 \n\n`$context = New-AzureRmApiManagementContext -resourcegroup 'ContosoResourceGroup' -servicename 'ContosoAPIMService' New-AzureRmApiManagementBackend -Context $context -Url 'https://contoso.com/myapi' -Protocol http -SkipCertificateChainValidation $true `\n\n#### 直接 API 更新方法\n\n1.  使用 API 管理创建[后端](https://msdn.microsoft.com/library/azure/dn935030.aspx)实体。 \n2.  将""skipCertificateChainValidation""属性设置为""true""。 \n3.  如果不再希望允许自签名证书，请删除后端实体，或将""skipCertificateChainValidation""属性设置为""false""。\n\n### 为何在尝试克隆 Git 存储库时出现身份验证失败？\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",如何在单个 API 中设置多个环境？,api management,https://docs.azure.cn/api-management/api-management-faq
"\n\n有几种选项可用于在 API 管理中使用 API 版本控制：\n\n*   在 API 管理中，可将 API 配置为表示不同版本。 例如，可具有两个不同的 API，MyAPIv1 和 MyAPIv2。 开发人员可选择其要使用的版本。\n*   还可使用不包含版本段的服务 URL 配置 API，例如 [https://my.api。](https://my.api。/) 然后，在每个操作的[重写 URL](https://msdn.microsoft.com/library/azure/dn894083.aspx#RewriteURL) 模板上配置版本段。 例如，可使操作带有名为 /resource 的 [URL 模板](https://docs.azure.cn/api-management/api-management-howto-add-operations#url-template)和名为 /v1/Resource 的[重写 URL](https://docs.azure.cn/api-management/api-management-howto-add-operations#rewrite-url-template) 模板。 可为每个操作单独更改版本段值。\n*   如果希望在 API 的服务 URL 中保留""默认""版本段，请在选定操作上设置使用[设置后端服务](https://msdn.microsoft.com/library/azure/dn894083.aspx#SetBackendService)策略的策略以更改后端请求路径。\n\n### 如何在单个 API 中设置多个环境？\n\n若要在单个 API 中设置多个环境（例如，一个测试环境和一个生产环境），则有两个选项。 可以：\n\n*   在同一租户上托管不同的 API。\n*   在不同租户上托管相同的 API。\n\n### 是否可将 SOAP 用于 API 管理？\n\n当前已提供 [SOAP 传递](http://blogs.msdn.microsoft.com/apimanagement/2016/10/13/soap-pass-through/)支持。 管理员可以导入其 SOAP 服务的 WSDL，以便 Azure API 管理创建一个 SOAP 前端。 开发人员门户文档、测试控制台、策略和分析都可用于 SOAP 服务。\n\n### API 管理网关 IP 地址是否不变？ 是否可以在防火墙规则中使用它？\n\n在标准层和高级层中，API 管理租户的公共 IP 地址 (VIP) 在租户生存期内是静态的，但有一些例外。 IP 地址在以下情况下更改：\n\n*   服务被删除并重新创建。\n*   服务订阅被[暂停](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)或[警告](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)（例如，由于未付款），然后被恢复。\n*   添加或删除 Azure 虚拟网络（只能在开发人员层和高级层使用虚拟网络）。\n\n对于多区域部署，仅当区域先空出然后恢复时，区域地址会更改（只能在高级层使用多区域部署）。\n\n对于为多区域部署配置的高级层租户，每个区域分配一个公共 IP 地址。\n\n可在 Azure 门户中的租户页面上获取一个 IP 地址（或者在多区域部署中获取多个 IP 地址）。\n\n### 是否可以使用 AD FS 安全配置 OAuth 2.0 授权服务器？\n\n若要了解如何使用 Active Directory 联合身份验证服务 (AD FS) 安全配置 OAuth 2.0 授权服务器，请参阅[在 API 管理中使用 ADFS](https://phvbaars.wordpress.com/2016/02/06/using-adfs-in-api-management/)。\n\n### 向多个地理位置进行部署时，API 管理使用何种路由方法？\n\n向多个地理位置进行部署时，API 管理使用[性能流量路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods#priority)。 传入流量将路由到最近的 API 网关。 如果一个区域处于脱机状态，则传入流量会自动路由到下一个最近的网关。 在[流量管理器路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods)中了解有关路由方法的详细信息。\n\n### 是否可以使用 Azure 资源管理器模板创建 API 管理服务实例？\n\n是的。 请参阅 [Azure API 管理服务](http://aka.ms/apimtemplate)快速入门模板。\n\n### 是否可以为后端使用自签名 SSL 证书？\n\n是的。 可以通过 PowerShell 或直接提交到 API 来完成此操作。 这将禁用证书链验证，并将允许在从 API 管理与后端服务进行通信时使用自签名或私人签名证书。\n\n#### Powershell 方法\n\n使用 [`New-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/new-azurermapimanagementbackend)（适用于新后端）或 [`Set-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/set-azurermapimanagementbackend)（适用于现有后端）PowerShell cmdlet 并将 `-SkipCertificateChainValidation` 参数设置设为 `True`。 \n\n`$context = New-AzureRmApiManagementContext -resourcegroup 'ContosoResourceGroup' -servicename 'ContosoAPIMService' New-AzureRmApiManagementBackend -Context $context -Url 'https://contoso.com/myapi' -Protocol http -SkipCertificateChainValidation $true `\n\n#### 直接 API 更新方法\n\n1.  使用 API 管理创建[后端](https://msdn.microsoft.com/library/azure/dn935030.aspx)实体。 \n2.  将""skipCertificateChainValidation""属性设置为""true""。 \n3.  如果不再希望允许自签名证书，请删除后端实体，或将""skipCertificateChainValidation""属性设置为""false""。\n\n### 为何在尝试克隆 Git 存储库时出现身份验证失败？\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",如何在 API 管理中使用 API 版本控制？,api management,https://docs.azure.cn/api-management/api-management-faq
"\n\n如果要添加的策略在策略管理器中显示为变暗或有阴影，请确保你处于该策略的正确范围内。 每个策略声明都设计为在特定范围和策略部分中使用。 若要查看策略部分和策略范围，请参阅 [API 管理策略](https://msdn.microsoft.com/library/azure/dn894080.aspx)中的策略的用法部分。\n\n### 如何在 API 管理中使用 API 版本控制？\n\n有几种选项可用于在 API 管理中使用 API 版本控制：\n\n*   在 API 管理中，可将 API 配置为表示不同版本。 例如，可具有两个不同的 API，MyAPIv1 和 MyAPIv2。 开发人员可选择其要使用的版本。\n*   还可使用不包含版本段的服务 URL 配置 API，例如 [https://my.api。](https://my.api。/) 然后，在每个操作的[重写 URL](https://msdn.microsoft.com/library/azure/dn894083.aspx#RewriteURL) 模板上配置版本段。 例如，可使操作带有名为 /resource 的 [URL 模板](https://docs.azure.cn/api-management/api-management-howto-add-operations#url-template)和名为 /v1/Resource 的[重写 URL](https://docs.azure.cn/api-management/api-management-howto-add-operations#rewrite-url-template) 模板。 可为每个操作单独更改版本段值。\n*   如果希望在 API 的服务 URL 中保留""默认""版本段，请在选定操作上设置使用[设置后端服务](https://msdn.microsoft.com/library/azure/dn894083.aspx#SetBackendService)策略的策略以更改后端请求路径。\n\n### 如何在单个 API 中设置多个环境？\n\n若要在单个 API 中设置多个环境（例如，一个测试环境和一个生产环境），则有两个选项。 可以：\n\n*   在同一租户上托管不同的 API。\n*   在不同租户上托管相同的 API。\n\n### 是否可将 SOAP 用于 API 管理？\n\n当前已提供 [SOAP 传递](http://blogs.msdn.microsoft.com/apimanagement/2016/10/13/soap-pass-through/)支持。 管理员可以导入其 SOAP 服务的 WSDL，以便 Azure API 管理创建一个 SOAP 前端。 开发人员门户文档、测试控制台、策略和分析都可用于 SOAP 服务。\n\n### API 管理网关 IP 地址是否不变？ 是否可以在防火墙规则中使用它？\n\n在标准层和高级层中，API 管理租户的公共 IP 地址 (VIP) 在租户生存期内是静态的，但有一些例外。 IP 地址在以下情况下更改：\n\n*   服务被删除并重新创建。\n*   服务订阅被[暂停](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)或[警告](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)（例如，由于未付款），然后被恢复。\n*   添加或删除 Azure 虚拟网络（只能在开发人员层和高级层使用虚拟网络）。\n\n对于多区域部署，仅当区域先空出然后恢复时，区域地址会更改（只能在高级层使用多区域部署）。\n\n对于为多区域部署配置的高级层租户，每个区域分配一个公共 IP 地址。\n\n可在 Azure 门户中的租户页面上获取一个 IP 地址（或者在多区域部署中获取多个 IP 地址）。\n\n### 是否可以使用 AD FS 安全配置 OAuth 2.0 授权服务器？\n\n若要了解如何使用 Active Directory 联合身份验证服务 (AD FS) 安全配置 OAuth 2.0 授权服务器，请参阅[在 API 管理中使用 ADFS](https://phvbaars.wordpress.com/2016/02/06/using-adfs-in-api-management/)。\n\n### 向多个地理位置进行部署时，API 管理使用何种路由方法？\n\n向多个地理位置进行部署时，API 管理使用[性能流量路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods#priority)。 传入流量将路由到最近的 API 网关。 如果一个区域处于脱机状态，则传入流量会自动路由到下一个最近的网关。 在[流量管理器路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods)中了解有关路由方法的详细信息。\n\n### 是否可以使用 Azure 资源管理器模板创建 API 管理服务实例？\n\n是的。 请参阅 [Azure API 管理服务](http://aka.ms/apimtemplate)快速入门模板。\n\n### 是否可以为后端使用自签名 SSL 证书？\n\n是的。 可以通过 PowerShell 或直接提交到 API 来完成此操作。 这将禁用证书链验证，并将允许在从 API 管理与后端服务进行通信时使用自签名或私人签名证书。\n\n#### Powershell 方法\n\n使用 [`New-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/new-azurermapimanagementbackend)（适用于新后端）或 [`Set-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/set-azurermapimanagementbackend)（适用于现有后端）PowerShell cmdlet 并将 `-SkipCertificateChainValidation` 参数设置设为 `True`。 \n\n`$context = New-AzureRmApiManagementContext -resourcegroup 'ContosoResourceGroup' -servicename 'ContosoAPIMService' New-AzureRmApiManagementBackend -Context $context -Url 'https://contoso.com/myapi' -Protocol http -SkipCertificateChainValidation $true `\n\n#### 直接 API 更新方法\n\n1.  使用 API 管理创建[后端](https://msdn.microsoft.com/library/azure/dn935030.aspx)实体。 \n2.  将""skipCertificateChainValidation""属性设置为""true""。 \n3.  如果不再希望允许自签名证书，请删除后端实体，或将""skipCertificateChainValidation""属性设置为""false""。\n\n### 为何在尝试克隆 Git 存储库时出现身份验证失败？\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",想要添加的策略为何在策略编辑器中不可用？,api management,https://docs.azure.cn/api-management/api-management-faq
"\n\n下面是向管理员组添加用户的方法：\n\n1.  登录到 [Azure 门户](https://portal.azure.cn/)。\n2.  转到具有要更新的 API 管理实例的资源组。\n3.  在 API 管理中，将 API 管理参与者角色分配给该用户。\n\n现在，新添加的参与者可以使用 Azure PowerShell [cmdlet](https://msdn.microsoft.com/library/mt613507.aspx)。 下面是以管理员身份登录的方法：\n\n1.  使用 `Login-AzureRmAccount -Environment $(Get-AzureRmEnvironment -Name AzureChinaCloud)` cmdlet 登录。\n2.  使用 `` 将上下文设置为具有该服务的订阅。\n3.  使用 `` 获取单一登录 URL。\n4.  使用 URL 访问管理门户。\n\n### 想要添加的策略为何在策略编辑器中不可用？\n\n如果要添加的策略在策略管理器中显示为变暗或有阴影，请确保你处于该策略的正确范围内。 每个策略声明都设计为在特定范围和策略部分中使用。 若要查看策略部分和策略范围，请参阅 [API 管理策略](https://msdn.microsoft.com/library/azure/dn894080.aspx)中的策略的用法部分。\n\n### 如何在 API 管理中使用 API 版本控制？\n\n有几种选项可用于在 API 管理中使用 API 版本控制：\n\n*   在 API 管理中，可将 API 配置为表示不同版本。 例如，可具有两个不同的 API，MyAPIv1 和 MyAPIv2。 开发人员可选择其要使用的版本。\n*   还可使用不包含版本段的服务 URL 配置 API，例如 [https://my.api。](https://my.api。/) 然后，在每个操作的[重写 URL](https://msdn.microsoft.com/library/azure/dn894083.aspx#RewriteURL) 模板上配置版本段。 例如，可使操作带有名为 /resource 的 [URL 模板](https://docs.azure.cn/api-management/api-management-howto-add-operations#url-template)和名为 /v1/Resource 的[重写 URL](https://docs.azure.cn/api-management/api-management-howto-add-operations#rewrite-url-template) 模板。 可为每个操作单独更改版本段值。\n*   如果希望在 API 的服务 URL 中保留""默认""版本段，请在选定操作上设置使用[设置后端服务](https://msdn.microsoft.com/library/azure/dn894083.aspx#SetBackendService)策略的策略以更改后端请求路径。\n\n### 如何在单个 API 中设置多个环境？\n\n若要在单个 API 中设置多个环境（例如，一个测试环境和一个生产环境），则有两个选项。 可以：\n\n*   在同一租户上托管不同的 API。\n*   在不同租户上托管相同的 API。\n\n### 是否可将 SOAP 用于 API 管理？\n\n当前已提供 [SOAP 传递](http://blogs.msdn.microsoft.com/apimanagement/2016/10/13/soap-pass-through/)支持。 管理员可以导入其 SOAP 服务的 WSDL，以便 Azure API 管理创建一个 SOAP 前端。 开发人员门户文档、测试控制台、策略和分析都可用于 SOAP 服务。\n\n### API 管理网关 IP 地址是否不变？ 是否可以在防火墙规则中使用它？\n\n在标准层和高级层中，API 管理租户的公共 IP 地址 (VIP) 在租户生存期内是静态的，但有一些例外。 IP 地址在以下情况下更改：\n\n*   服务被删除并重新创建。\n*   服务订阅被[暂停](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)或[警告](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)（例如，由于未付款），然后被恢复。\n*   添加或删除 Azure 虚拟网络（只能在开发人员层和高级层使用虚拟网络）。\n\n对于多区域部署，仅当区域先空出然后恢复时，区域地址会更改（只能在高级层使用多区域部署）。\n\n对于为多区域部署配置的高级层租户，每个区域分配一个公共 IP 地址。\n\n可在 Azure 门户中的租户页面上获取一个 IP 地址（或者在多区域部署中获取多个 IP 地址）。\n\n### 是否可以使用 AD FS 安全配置 OAuth 2.0 授权服务器？\n\n若要了解如何使用 Active Directory 联合身份验证服务 (AD FS) 安全配置 OAuth 2.0 授权服务器，请参阅[在 API 管理中使用 ADFS](https://phvbaars.wordpress.com/2016/02/06/using-adfs-in-api-management/)。\n\n### 向多个地理位置进行部署时，API 管理使用何种路由方法？\n\n向多个地理位置进行部署时，API 管理使用[性能流量路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods#priority)。 传入流量将路由到最近的 API 网关。 如果一个区域处于脱机状态，则传入流量会自动路由到下一个最近的网关。 在[流量管理器路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods)中了解有关路由方法的详细信息。\n\n### 是否可以使用 Azure 资源管理器模板创建 API 管理服务实例？\n\n是的。 请参阅 [Azure API 管理服务](http://aka.ms/apimtemplate)快速入门模板。\n\n### 是否可以为后端使用自签名 SSL 证书？\n\n是的。 可以通过 PowerShell 或直接提交到 API 来完成此操作。 这将禁用证书链验证，并将允许在从 API 管理与后端服务进行通信时使用自签名或私人签名证书。\n\n#### Powershell 方法\n\n使用 [`New-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/new-azurermapimanagementbackend)（适用于新后端）或 [`Set-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/set-azurermapimanagementbackend)（适用于现有后端）PowerShell cmdlet 并将 `-SkipCertificateChainValidation` 参数设置设为 `True`。 \n\n`$context = New-AzureRmApiManagementContext -resourcegroup 'ContosoResourceGroup' -servicename 'ContosoAPIMService' New-AzureRmApiManagementBackend -Context $context -Url 'https://contoso.com/myapi' -Protocol http -SkipCertificateChainValidation $true `\n\n#### 直接 API 更新方法\n\n1.  使用 API 管理创建[后端](https://msdn.microsoft.com/library/azure/dn935030.aspx)实体。 \n2.  将""skipCertificateChainValidation""属性设置为""true""。 \n3.  如果不再希望允许自签名证书，请删除后端实体，或将""skipCertificateChainValidation""属性设置为""false""。\n\n### 为何在尝试克隆 Git 存储库时出现身份验证失败？\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",如何向管理员组添加用户？,api management,https://docs.azure.cn/api-management/api-management-faq
"\n\n是，可使用以下工具以编程方式管理 API 管理：\n\n*   [API 管理 REST API](https://msdn.microsoft.com/library/azure/dn776326.aspx)。\n*   [Microsoft Azure API 管理服务管理库 SDK](http://aka.ms/apimsdk)。\n*   [服务部署](https://msdn.microsoft.com/library/mt619282.aspx)和[服务管理](https://msdn.microsoft.com/library/mt613507.aspx) PowerShell cmdlet。\n\n### 如何向管理员组添加用户？\n\n下面是向管理员组添加用户的方法：\n\n1.  登录到 [Azure 门户](https://portal.azure.cn/)。\n2.  转到具有要更新的 API 管理实例的资源组。\n3.  在 API 管理中，将 API 管理参与者角色分配给该用户。\n\n现在，新添加的参与者可以使用 Azure PowerShell [cmdlet](https://msdn.microsoft.com/library/mt613507.aspx)。 下面是以管理员身份登录的方法：\n\n1.  使用 `Login-AzureRmAccount -Environment $(Get-AzureRmEnvironment -Name AzureChinaCloud)` cmdlet 登录。\n2.  使用 `` 将上下文设置为具有该服务的订阅。\n3.  使用 `` 获取单一登录 URL。\n4.  使用 URL 访问管理门户。\n\n### 想要添加的策略为何在策略编辑器中不可用？\n\n如果要添加的策略在策略管理器中显示为变暗或有阴影，请确保你处于该策略的正确范围内。 每个策略声明都设计为在特定范围和策略部分中使用。 若要查看策略部分和策略范围，请参阅 [API 管理策略](https://msdn.microsoft.com/library/azure/dn894080.aspx)中的策略的用法部分。\n\n### 如何在 API 管理中使用 API 版本控制？\n\n有几种选项可用于在 API 管理中使用 API 版本控制：\n\n*   在 API 管理中，可将 API 配置为表示不同版本。 例如，可具有两个不同的 API，MyAPIv1 和 MyAPIv2。 开发人员可选择其要使用的版本。\n*   还可使用不包含版本段的服务 URL 配置 API，例如 [https://my.api。](https://my.api。/) 然后，在每个操作的[重写 URL](https://msdn.microsoft.com/library/azure/dn894083.aspx#RewriteURL) 模板上配置版本段。 例如，可使操作带有名为 /resource 的 [URL 模板](https://docs.azure.cn/api-management/api-management-howto-add-operations#url-template)和名为 /v1/Resource 的[重写 URL](https://docs.azure.cn/api-management/api-management-howto-add-operations#rewrite-url-template) 模板。 可为每个操作单独更改版本段值。\n*   如果希望在 API 的服务 URL 中保留""默认""版本段，请在选定操作上设置使用[设置后端服务](https://msdn.microsoft.com/library/azure/dn894083.aspx#SetBackendService)策略的策略以更改后端请求路径。\n\n### 如何在单个 API 中设置多个环境？\n\n若要在单个 API 中设置多个环境（例如，一个测试环境和一个生产环境），则有两个选项。 可以：\n\n*   在同一租户上托管不同的 API。\n*   在不同租户上托管相同的 API。\n\n### 是否可将 SOAP 用于 API 管理？\n\n当前已提供 [SOAP 传递](http://blogs.msdn.microsoft.com/apimanagement/2016/10/13/soap-pass-through/)支持。 管理员可以导入其 SOAP 服务的 WSDL，以便 Azure API 管理创建一个 SOAP 前端。 开发人员门户文档、测试控制台、策略和分析都可用于 SOAP 服务。\n\n### API 管理网关 IP 地址是否不变？ 是否可以在防火墙规则中使用它？\n\n在标准层和高级层中，API 管理租户的公共 IP 地址 (VIP) 在租户生存期内是静态的，但有一些例外。 IP 地址在以下情况下更改：\n\n*   服务被删除并重新创建。\n*   服务订阅被[暂停](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)或[警告](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)（例如，由于未付款），然后被恢复。\n*   添加或删除 Azure 虚拟网络（只能在开发人员层和高级层使用虚拟网络）。\n\n对于多区域部署，仅当区域先空出然后恢复时，区域地址会更改（只能在高级层使用多区域部署）。\n\n对于为多区域部署配置的高级层租户，每个区域分配一个公共 IP 地址。\n\n可在 Azure 门户中的租户页面上获取一个 IP 地址（或者在多区域部署中获取多个 IP 地址）。\n\n### 是否可以使用 AD FS 安全配置 OAuth 2.0 授权服务器？\n\n若要了解如何使用 Active Directory 联合身份验证服务 (AD FS) 安全配置 OAuth 2.0 授权服务器，请参阅[在 API 管理中使用 ADFS](https://phvbaars.wordpress.com/2016/02/06/using-adfs-in-api-management/)。\n\n### 向多个地理位置进行部署时，API 管理使用何种路由方法？\n\n向多个地理位置进行部署时，API 管理使用[性能流量路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods#priority)。 传入流量将路由到最近的 API 网关。 如果一个区域处于脱机状态，则传入流量会自动路由到下一个最近的网关。 在[流量管理器路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods)中了解有关路由方法的详细信息。\n\n### 是否可以使用 Azure 资源管理器模板创建 API 管理服务实例？\n\n是的。 请参阅 [Azure API 管理服务](http://aka.ms/apimtemplate)快速入门模板。\n\n### 是否可以为后端使用自签名 SSL 证书？\n\n是的。 可以通过 PowerShell 或直接提交到 API 来完成此操作。 这将禁用证书链验证，并将允许在从 API 管理与后端服务进行通信时使用自签名或私人签名证书。\n\n#### Powershell 方法\n\n使用 [`New-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/new-azurermapimanagementbackend)（适用于新后端）或 [`Set-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/set-azurermapimanagementbackend)（适用于现有后端）PowerShell cmdlet 并将 `-SkipCertificateChainValidation` 参数设置设为 `True`。 \n\n`$context = New-AzureRmApiManagementContext -resourcegroup 'ContosoResourceGroup' -servicename 'ContosoAPIMService' New-AzureRmApiManagementBackend -Context $context -Url 'https://contoso.com/myapi' -Protocol http -SkipCertificateChainValidation $true `\n\n#### 直接 API 更新方法\n\n1.  使用 API 管理创建[后端](https://msdn.microsoft.com/library/azure/dn935030.aspx)实体。 \n2.  将""skipCertificateChainValidation""属性设置为""true""。 \n3.  如果不再希望允许自签名证书，请删除后端实体，或将""skipCertificateChainValidation""属性设置为""false""。\n\n### 为何在尝试克隆 Git 存储库时出现身份验证失败？\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",是否可以编程方式管理 API 管理实例？,api management,https://docs.azure.cn/api-management/api-management-faq
"\n\n如果要将 API 管理实例复制到新实例，则有多个选项。 可以：\n\n*   使用 API 管理中的备份和还原功能。 有关详细信息，请参阅[如何使用 Azure API 管理中的服务备份和还原实现灾难恢复](https://docs.azure.cn/api-management/api-management-howto-disaster-recovery-backup-restore)。\n*   使用 [API 管理 REST API](https://msdn.microsoft.com/library/azure/dn776326.aspx) 创建自己的备份和还原功能。 使用 REST API 保存和还原所需服务实例中的实体。\n*   使用 Git 下载服务配置，然后将其上传到新实例。 有关详细信息，请参阅[如何使用 Git 保存和配置 API 管理服务](https://docs.azure.cn/api-management/api-management-configuration-repository-git)。\n\n### 是否可以编程方式管理 API 管理实例？\n\n是，可使用以下工具以编程方式管理 API 管理：\n\n*   [API 管理 REST API](https://msdn.microsoft.com/library/azure/dn776326.aspx)。\n*   [Microsoft Azure API 管理服务管理库 SDK](http://aka.ms/apimsdk)。\n*   [服务部署](https://msdn.microsoft.com/library/mt619282.aspx)和[服务管理](https://msdn.microsoft.com/library/mt613507.aspx) PowerShell cmdlet。\n\n### 如何向管理员组添加用户？\n\n下面是向管理员组添加用户的方法：\n\n1.  登录到 [Azure 门户](https://portal.azure.cn/)。\n2.  转到具有要更新的 API 管理实例的资源组。\n3.  在 API 管理中，将 API 管理参与者角色分配给该用户。\n\n现在，新添加的参与者可以使用 Azure PowerShell [cmdlet](https://msdn.microsoft.com/library/mt613507.aspx)。 下面是以管理员身份登录的方法：\n\n1.  使用 `Login-AzureRmAccount -Environment $(Get-AzureRmEnvironment -Name AzureChinaCloud)` cmdlet 登录。\n2.  使用 `` 将上下文设置为具有该服务的订阅。\n3.  使用 `` 获取单一登录 URL。\n4.  使用 URL 访问管理门户。\n\n### 想要添加的策略为何在策略编辑器中不可用？\n\n如果要添加的策略在策略管理器中显示为变暗或有阴影，请确保你处于该策略的正确范围内。 每个策略声明都设计为在特定范围和策略部分中使用。 若要查看策略部分和策略范围，请参阅 [API 管理策略](https://msdn.microsoft.com/library/azure/dn894080.aspx)中的策略的用法部分。\n\n### 如何在 API 管理中使用 API 版本控制？\n\n有几种选项可用于在 API 管理中使用 API 版本控制：\n\n*   在 API 管理中，可将 API 配置为表示不同版本。 例如，可具有两个不同的 API，MyAPIv1 和 MyAPIv2。 开发人员可选择其要使用的版本。\n*   还可使用不包含版本段的服务 URL 配置 API，例如 [https://my.api。](https://my.api。/) 然后，在每个操作的[重写 URL](https://msdn.microsoft.com/library/azure/dn894083.aspx#RewriteURL) 模板上配置版本段。 例如，可使操作带有名为 /resource 的 [URL 模板](https://docs.azure.cn/api-management/api-management-howto-add-operations#url-template)和名为 /v1/Resource 的[重写 URL](https://docs.azure.cn/api-management/api-management-howto-add-operations#rewrite-url-template) 模板。 可为每个操作单独更改版本段值。\n*   如果希望在 API 的服务 URL 中保留""默认""版本段，请在选定操作上设置使用[设置后端服务](https://msdn.microsoft.com/library/azure/dn894083.aspx#SetBackendService)策略的策略以更改后端请求路径。\n\n### 如何在单个 API 中设置多个环境？\n\n若要在单个 API 中设置多个环境（例如，一个测试环境和一个生产环境），则有两个选项。 可以：\n\n*   在同一租户上托管不同的 API。\n*   在不同租户上托管相同的 API。\n\n### 是否可将 SOAP 用于 API 管理？\n\n当前已提供 [SOAP 传递](http://blogs.msdn.microsoft.com/apimanagement/2016/10/13/soap-pass-through/)支持。 管理员可以导入其 SOAP 服务的 WSDL，以便 Azure API 管理创建一个 SOAP 前端。 开发人员门户文档、测试控制台、策略和分析都可用于 SOAP 服务。\n\n### API 管理网关 IP 地址是否不变？ 是否可以在防火墙规则中使用它？\n\n在标准层和高级层中，API 管理租户的公共 IP 地址 (VIP) 在租户生存期内是静态的，但有一些例外。 IP 地址在以下情况下更改：\n\n*   服务被删除并重新创建。\n*   服务订阅被[暂停](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)或[警告](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)（例如，由于未付款），然后被恢复。\n*   添加或删除 Azure 虚拟网络（只能在开发人员层和高级层使用虚拟网络）。\n\n对于多区域部署，仅当区域先空出然后恢复时，区域地址会更改（只能在高级层使用多区域部署）。\n\n对于为多区域部署配置的高级层租户，每个区域分配一个公共 IP 地址。\n\n可在 Azure 门户中的租户页面上获取一个 IP 地址（或者在多区域部署中获取多个 IP 地址）。\n\n### 是否可以使用 AD FS 安全配置 OAuth 2.0 授权服务器？\n\n若要了解如何使用 Active Directory 联合身份验证服务 (AD FS) 安全配置 OAuth 2.0 授权服务器，请参阅[在 API 管理中使用 ADFS](https://phvbaars.wordpress.com/2016/02/06/using-adfs-in-api-management/)。\n\n### 向多个地理位置进行部署时，API 管理使用何种路由方法？\n\n向多个地理位置进行部署时，API 管理使用[性能流量路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods#priority)。 传入流量将路由到最近的 API 网关。 如果一个区域处于脱机状态，则传入流量会自动路由到下一个最近的网关。 在[流量管理器路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods)中了解有关路由方法的详细信息。\n\n### 是否可以使用 Azure 资源管理器模板创建 API 管理服务实例？\n\n是的。 请参阅 [Azure API 管理服务](http://aka.ms/apimtemplate)快速入门模板。\n\n### 是否可以为后端使用自签名 SSL 证书？\n\n是的。 可以通过 PowerShell 或直接提交到 API 来完成此操作。 这将禁用证书链验证，并将允许在从 API 管理与后端服务进行通信时使用自签名或私人签名证书。\n\n#### Powershell 方法\n\n使用 [`New-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/new-azurermapimanagementbackend)（适用于新后端）或 [`Set-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/set-azurermapimanagementbackend)（适用于现有后端）PowerShell cmdlet 并将 `-SkipCertificateChainValidation` 参数设置设为 `True`。 \n\n`$context = New-AzureRmApiManagementContext -resourcegroup 'ContosoResourceGroup' -servicename 'ContosoAPIMService' New-AzureRmApiManagementBackend -Context $context -Url 'https://contoso.com/myapi' -Protocol http -SkipCertificateChainValidation $true `\n\n#### 直接 API 更新方法\n\n1.  使用 API 管理创建[后端](https://msdn.microsoft.com/library/azure/dn935030.aspx)实体。 \n2.  将""skipCertificateChainValidation""属性设置为""true""。 \n3.  如果不再希望允许自签名证书，请删除后端实体，或将""skipCertificateChainValidation""属性设置为""false""。\n\n### 为何在尝试克隆 Git 存储库时出现身份验证失败？\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",如何将 API 管理服务实例复制到新实例？,api management,https://docs.azure.cn/api-management/api-management-faq
"\n\n有多个选项可确保 API 管理网关和后端服务之间的连接安全。 可以：\n\n*   使用 HTTP 基本身份验证。 有关详细信息，请参阅[配置 API 设置](https://docs.azure.cn/api-management/api-management-howto-create-apis#configure-api-settings)。\n*   使用[如何使用 Azure API 管理中的客户端证书身份验证确保后端服务安全](https://docs.azure.cn/api-management/api-management-howto-mutual-certificates)中所述的 SSL 相互身份验证。\n*   在后端服务上使用 IP 允许列表。 如果有标准或高级层 API 管理实例，则网关的 IP 地址保持不变。 可设置允许列表以允许此 IP 地址。 可在 Azure 门户中的仪表板上获取 API 管理实例的 IP 地址。\n*   将 API 管理实例连接到 Azure 虚拟网络。\n\n### 如何将 API 管理服务实例复制到新实例？\n\n如果要将 API 管理实例复制到新实例，则有多个选项。 可以：\n\n*   使用 API 管理中的备份和还原功能。 有关详细信息，请参阅[如何使用 Azure API 管理中的服务备份和还原实现灾难恢复](https://docs.azure.cn/api-management/api-management-howto-disaster-recovery-backup-restore)。\n*   使用 [API 管理 REST API](https://msdn.microsoft.com/library/azure/dn776326.aspx) 创建自己的备份和还原功能。 使用 REST API 保存和还原所需服务实例中的实体。\n*   使用 Git 下载服务配置，然后将其上传到新实例。 有关详细信息，请参阅[如何使用 Git 保存和配置 API 管理服务](https://docs.azure.cn/api-management/api-management-configuration-repository-git)。\n\n### 是否可以编程方式管理 API 管理实例？\n\n是，可使用以下工具以编程方式管理 API 管理：\n\n*   [API 管理 REST API](https://msdn.microsoft.com/library/azure/dn776326.aspx)。\n*   [Microsoft Azure API 管理服务管理库 SDK](http://aka.ms/apimsdk)。\n*   [服务部署](https://msdn.microsoft.com/library/mt619282.aspx)和[服务管理](https://msdn.microsoft.com/library/mt613507.aspx) PowerShell cmdlet。\n\n### 如何向管理员组添加用户？\n\n下面是向管理员组添加用户的方法：\n\n1.  登录到 [Azure 门户](https://portal.azure.cn/)。\n2.  转到具有要更新的 API 管理实例的资源组。\n3.  在 API 管理中，将 API 管理参与者角色分配给该用户。\n\n现在，新添加的参与者可以使用 Azure PowerShell [cmdlet](https://msdn.microsoft.com/library/mt613507.aspx)。 下面是以管理员身份登录的方法：\n\n1.  使用 `Login-AzureRmAccount -Environment $(Get-AzureRmEnvironment -Name AzureChinaCloud)` cmdlet 登录。\n2.  使用 `` 将上下文设置为具有该服务的订阅。\n3.  使用 `` 获取单一登录 URL。\n4.  使用 URL 访问管理门户。\n\n### 想要添加的策略为何在策略编辑器中不可用？\n\n如果要添加的策略在策略管理器中显示为变暗或有阴影，请确保你处于该策略的正确范围内。 每个策略声明都设计为在特定范围和策略部分中使用。 若要查看策略部分和策略范围，请参阅 [API 管理策略](https://msdn.microsoft.com/library/azure/dn894080.aspx)中的策略的用法部分。\n\n### 如何在 API 管理中使用 API 版本控制？\n\n有几种选项可用于在 API 管理中使用 API 版本控制：\n\n*   在 API 管理中，可将 API 配置为表示不同版本。 例如，可具有两个不同的 API，MyAPIv1 和 MyAPIv2。 开发人员可选择其要使用的版本。\n*   还可使用不包含版本段的服务 URL 配置 API，例如 [https://my.api。](https://my.api。/) 然后，在每个操作的[重写 URL](https://msdn.microsoft.com/library/azure/dn894083.aspx#RewriteURL) 模板上配置版本段。 例如，可使操作带有名为 /resource 的 [URL 模板](https://docs.azure.cn/api-management/api-management-howto-add-operations#url-template)和名为 /v1/Resource 的[重写 URL](https://docs.azure.cn/api-management/api-management-howto-add-operations#rewrite-url-template) 模板。 可为每个操作单独更改版本段值。\n*   如果希望在 API 的服务 URL 中保留""默认""版本段，请在选定操作上设置使用[设置后端服务](https://msdn.microsoft.com/library/azure/dn894083.aspx#SetBackendService)策略的策略以更改后端请求路径。\n\n### 如何在单个 API 中设置多个环境？\n\n若要在单个 API 中设置多个环境（例如，一个测试环境和一个生产环境），则有两个选项。 可以：\n\n*   在同一租户上托管不同的 API。\n*   在不同租户上托管相同的 API。\n\n### 是否可将 SOAP 用于 API 管理？\n\n当前已提供 [SOAP 传递](http://blogs.msdn.microsoft.com/apimanagement/2016/10/13/soap-pass-through/)支持。 管理员可以导入其 SOAP 服务的 WSDL，以便 Azure API 管理创建一个 SOAP 前端。 开发人员门户文档、测试控制台、策略和分析都可用于 SOAP 服务。\n\n### API 管理网关 IP 地址是否不变？ 是否可以在防火墙规则中使用它？\n\n在标准层和高级层中，API 管理租户的公共 IP 地址 (VIP) 在租户生存期内是静态的，但有一些例外。 IP 地址在以下情况下更改：\n\n*   服务被删除并重新创建。\n*   服务订阅被[暂停](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)或[警告](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)（例如，由于未付款），然后被恢复。\n*   添加或删除 Azure 虚拟网络（只能在开发人员层和高级层使用虚拟网络）。\n\n对于多区域部署，仅当区域先空出然后恢复时，区域地址会更改（只能在高级层使用多区域部署）。\n\n对于为多区域部署配置的高级层租户，每个区域分配一个公共 IP 地址。\n\n可在 Azure 门户中的租户页面上获取一个 IP 地址（或者在多区域部署中获取多个 IP 地址）。\n\n### 是否可以使用 AD FS 安全配置 OAuth 2.0 授权服务器？\n\n若要了解如何使用 Active Directory 联合身份验证服务 (AD FS) 安全配置 OAuth 2.0 授权服务器，请参阅[在 API 管理中使用 ADFS](https://phvbaars.wordpress.com/2016/02/06/using-adfs-in-api-management/)。\n\n### 向多个地理位置进行部署时，API 管理使用何种路由方法？\n\n向多个地理位置进行部署时，API 管理使用[性能流量路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods#priority)。 传入流量将路由到最近的 API 网关。 如果一个区域处于脱机状态，则传入流量会自动路由到下一个最近的网关。 在[流量管理器路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods)中了解有关路由方法的详细信息。\n\n### 是否可以使用 Azure 资源管理器模板创建 API 管理服务实例？\n\n是的。 请参阅 [Azure API 管理服务](http://aka.ms/apimtemplate)快速入门模板。\n\n### 是否可以为后端使用自签名 SSL 证书？\n\n是的。 可以通过 PowerShell 或直接提交到 API 来完成此操作。 这将禁用证书链验证，并将允许在从 API 管理与后端服务进行通信时使用自签名或私人签名证书。\n\n#### Powershell 方法\n\n使用 [`New-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/new-azurermapimanagementbackend)（适用于新后端）或 [`Set-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/set-azurermapimanagementbackend)（适用于现有后端）PowerShell cmdlet 并将 `-SkipCertificateChainValidation` 参数设置设为 `True`。 \n\n`$context = New-AzureRmApiManagementContext -resourcegroup 'ContosoResourceGroup' -servicename 'ContosoAPIMService' New-AzureRmApiManagementBackend -Context $context -Url 'https://contoso.com/myapi' -Protocol http -SkipCertificateChainValidation $true `\n\n#### 直接 API 更新方法\n\n1.  使用 API 管理创建[后端](https://msdn.microsoft.com/library/azure/dn935030.aspx)实体。 \n2.  将""skipCertificateChainValidation""属性设置为""true""。 \n3.  如果不再希望允许自签名证书，请删除后端实体，或将""skipCertificateChainValidation""属性设置为""false""。\n\n### 为何在尝试克隆 Git 存储库时出现身份验证失败？\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",如何确保 API 管理网关和后端服务之间的连接安全？,api management,https://docs.azure.cn/api-management/api-management-faq
"\n\n当功能处于预览状态时，这意味着我们正在积极寻求关于功能效果如何的反馈。 处于预览状态的功能具备完整功能，但我们可能为了响应客户反馈而进行重大更改。 建议不要在生产环境中依赖处于预览状态的功能。 如果有任何关于预览功能的反馈，请通过[如何向 Microsoft Azure API 管理团队提问？](https://docs.azure.cn/api-management/#how-can-i-ask-the-microsoft-azure-api-management-team-a-question)中的联系选项之一告知我们。\n\n### 如何确保 API 管理网关和后端服务之间的连接安全？\n\n有多个选项可确保 API 管理网关和后端服务之间的连接安全。 可以：\n\n*   使用 HTTP 基本身份验证。 有关详细信息，请参阅[配置 API 设置](https://docs.azure.cn/api-management/api-management-howto-create-apis#configure-api-settings)。\n*   使用[如何使用 Azure API 管理中的客户端证书身份验证确保后端服务安全](https://docs.azure.cn/api-management/api-management-howto-mutual-certificates)中所述的 SSL 相互身份验证。\n*   在后端服务上使用 IP 允许列表。 如果有标准或高级层 API 管理实例，则网关的 IP 地址保持不变。 可设置允许列表以允许此 IP 地址。 可在 Azure 门户中的仪表板上获取 API 管理实例的 IP 地址。\n*   将 API 管理实例连接到 Azure 虚拟网络。\n\n### 如何将 API 管理服务实例复制到新实例？\n\n如果要将 API 管理实例复制到新实例，则有多个选项。 可以：\n\n*   使用 API 管理中的备份和还原功能。 有关详细信息，请参阅[如何使用 Azure API 管理中的服务备份和还原实现灾难恢复](https://docs.azure.cn/api-management/api-management-howto-disaster-recovery-backup-restore)。\n*   使用 [API 管理 REST API](https://msdn.microsoft.com/library/azure/dn776326.aspx) 创建自己的备份和还原功能。 使用 REST API 保存和还原所需服务实例中的实体。\n*   使用 Git 下载服务配置，然后将其上传到新实例。 有关详细信息，请参阅[如何使用 Git 保存和配置 API 管理服务](https://docs.azure.cn/api-management/api-management-configuration-repository-git)。\n\n### 是否可以编程方式管理 API 管理实例？\n\n是，可使用以下工具以编程方式管理 API 管理：\n\n*   [API 管理 REST API](https://msdn.microsoft.com/library/azure/dn776326.aspx)。\n*   [Microsoft Azure API 管理服务管理库 SDK](http://aka.ms/apimsdk)。\n*   [服务部署](https://msdn.microsoft.com/library/mt619282.aspx)和[服务管理](https://msdn.microsoft.com/library/mt613507.aspx) PowerShell cmdlet。\n\n### 如何向管理员组添加用户？\n\n下面是向管理员组添加用户的方法：\n\n1.  登录到 [Azure 门户](https://portal.azure.cn/)。\n2.  转到具有要更新的 API 管理实例的资源组。\n3.  在 API 管理中，将 API 管理参与者角色分配给该用户。\n\n现在，新添加的参与者可以使用 Azure PowerShell [cmdlet](https://msdn.microsoft.com/library/mt613507.aspx)。 下面是以管理员身份登录的方法：\n\n1.  使用 `Login-AzureRmAccount -Environment $(Get-AzureRmEnvironment -Name AzureChinaCloud)` cmdlet 登录。\n2.  使用 `` 将上下文设置为具有该服务的订阅。\n3.  使用 `` 获取单一登录 URL。\n4.  使用 URL 访问管理门户。\n\n### 想要添加的策略为何在策略编辑器中不可用？\n\n如果要添加的策略在策略管理器中显示为变暗或有阴影，请确保你处于该策略的正确范围内。 每个策略声明都设计为在特定范围和策略部分中使用。 若要查看策略部分和策略范围，请参阅 [API 管理策略](https://msdn.microsoft.com/library/azure/dn894080.aspx)中的策略的用法部分。\n\n### 如何在 API 管理中使用 API 版本控制？\n\n有几种选项可用于在 API 管理中使用 API 版本控制：\n\n*   在 API 管理中，可将 API 配置为表示不同版本。 例如，可具有两个不同的 API，MyAPIv1 和 MyAPIv2。 开发人员可选择其要使用的版本。\n*   还可使用不包含版本段的服务 URL 配置 API，例如 [https://my.api。](https://my.api。/) 然后，在每个操作的[重写 URL](https://msdn.microsoft.com/library/azure/dn894083.aspx#RewriteURL) 模板上配置版本段。 例如，可使操作带有名为 /resource 的 [URL 模板](https://docs.azure.cn/api-management/api-management-howto-add-operations#url-template)和名为 /v1/Resource 的[重写 URL](https://docs.azure.cn/api-management/api-management-howto-add-operations#rewrite-url-template) 模板。 可为每个操作单独更改版本段值。\n*   如果希望在 API 的服务 URL 中保留""默认""版本段，请在选定操作上设置使用[设置后端服务](https://msdn.microsoft.com/library/azure/dn894083.aspx#SetBackendService)策略的策略以更改后端请求路径。\n\n### 如何在单个 API 中设置多个环境？\n\n若要在单个 API 中设置多个环境（例如，一个测试环境和一个生产环境），则有两个选项。 可以：\n\n*   在同一租户上托管不同的 API。\n*   在不同租户上托管相同的 API。\n\n### 是否可将 SOAP 用于 API 管理？\n\n当前已提供 [SOAP 传递](http://blogs.msdn.microsoft.com/apimanagement/2016/10/13/soap-pass-through/)支持。 管理员可以导入其 SOAP 服务的 WSDL，以便 Azure API 管理创建一个 SOAP 前端。 开发人员门户文档、测试控制台、策略和分析都可用于 SOAP 服务。\n\n### API 管理网关 IP 地址是否不变？ 是否可以在防火墙规则中使用它？\n\n在标准层和高级层中，API 管理租户的公共 IP 地址 (VIP) 在租户生存期内是静态的，但有一些例外。 IP 地址在以下情况下更改：\n\n*   服务被删除并重新创建。\n*   服务订阅被[暂停](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)或[警告](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)（例如，由于未付款），然后被恢复。\n*   添加或删除 Azure 虚拟网络（只能在开发人员层和高级层使用虚拟网络）。\n\n对于多区域部署，仅当区域先空出然后恢复时，区域地址会更改（只能在高级层使用多区域部署）。\n\n对于为多区域部署配置的高级层租户，每个区域分配一个公共 IP 地址。\n\n可在 Azure 门户中的租户页面上获取一个 IP 地址（或者在多区域部署中获取多个 IP 地址）。\n\n### 是否可以使用 AD FS 安全配置 OAuth 2.0 授权服务器？\n\n若要了解如何使用 Active Directory 联合身份验证服务 (AD FS) 安全配置 OAuth 2.0 授权服务器，请参阅[在 API 管理中使用 ADFS](https://phvbaars.wordpress.com/2016/02/06/using-adfs-in-api-management/)。\n\n### 向多个地理位置进行部署时，API 管理使用何种路由方法？\n\n向多个地理位置进行部署时，API 管理使用[性能流量路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods#priority)。 传入流量将路由到最近的 API 网关。 如果一个区域处于脱机状态，则传入流量会自动路由到下一个最近的网关。 在[流量管理器路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods)中了解有关路由方法的详细信息。\n\n### 是否可以使用 Azure 资源管理器模板创建 API 管理服务实例？\n\n是的。 请参阅 [Azure API 管理服务](http://aka.ms/apimtemplate)快速入门模板。\n\n### 是否可以为后端使用自签名 SSL 证书？\n\n是的。 可以通过 PowerShell 或直接提交到 API 来完成此操作。 这将禁用证书链验证，并将允许在从 API 管理与后端服务进行通信时使用自签名或私人签名证书。\n\n#### Powershell 方法\n\n使用 [`New-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/new-azurermapimanagementbackend)（适用于新后端）或 [`Set-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/set-azurermapimanagementbackend)（适用于现有后端）PowerShell cmdlet 并将 `-SkipCertificateChainValidation` 参数设置设为 `True`。 \n\n`$context = New-AzureRmApiManagementContext -resourcegroup 'ContosoResourceGroup' -servicename 'ContosoAPIMService' New-AzureRmApiManagementBackend -Context $context -Url 'https://contoso.com/myapi' -Protocol http -SkipCertificateChainValidation $true `\n\n#### 直接 API 更新方法\n\n1.  使用 API 管理创建[后端](https://msdn.microsoft.com/library/azure/dn935030.aspx)实体。 \n2.  将""skipCertificateChainValidation""属性设置为""true""。 \n3.  如果不再希望允许自签名证书，请删除后端实体，或将""skipCertificateChainValidation""属性设置为""false""。\n\n### 为何在尝试克隆 Git 存储库时出现身份验证失败？\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",功能处于预览状态意味着什么？,api management,https://docs.azure.cn/api-management/api-management-faq
"\n\n可使用以下选项之一联系我们：\n\n*   在 [API 管理 MSDN 论坛](https://social.msdn.microsoft.com/forums/azure/home?forum=azureapimgmt)中发布问题。\n*   向 [apimgmt@microsoft.com](mailto:apimgmt@microsoft.com) 发送电子邮件。\n*   在 [Azure 反馈论坛](https://feedback.azure.com/forums/248703-api-management)中向我们发送功能请求。\n\n### 功能处于预览状态意味着什么？\n\n当功能处于预览状态时，这意味着我们正在积极寻求关于功能效果如何的反馈。 处于预览状态的功能具备完整功能，但我们可能为了响应客户反馈而进行重大更改。 建议不要在生产环境中依赖处于预览状态的功能。 如果有任何关于预览功能的反馈，请通过[如何向 Microsoft Azure API 管理团队提问？](https://docs.azure.cn/api-management/#how-can-i-ask-the-microsoft-azure-api-management-team-a-question)中的联系选项之一告知我们。\n\n### 如何确保 API 管理网关和后端服务之间的连接安全？\n\n有多个选项可确保 API 管理网关和后端服务之间的连接安全。 可以：\n\n*   使用 HTTP 基本身份验证。 有关详细信息，请参阅[配置 API 设置](https://docs.azure.cn/api-management/api-management-howto-create-apis#configure-api-settings)。\n*   使用[如何使用 Azure API 管理中的客户端证书身份验证确保后端服务安全](https://docs.azure.cn/api-management/api-management-howto-mutual-certificates)中所述的 SSL 相互身份验证。\n*   在后端服务上使用 IP 允许列表。 如果有标准或高级层 API 管理实例，则网关的 IP 地址保持不变。 可设置允许列表以允许此 IP 地址。 可在 Azure 门户中的仪表板上获取 API 管理实例的 IP 地址。\n*   将 API 管理实例连接到 Azure 虚拟网络。\n\n### 如何将 API 管理服务实例复制到新实例？\n\n如果要将 API 管理实例复制到新实例，则有多个选项。 可以：\n\n*   使用 API 管理中的备份和还原功能。 有关详细信息，请参阅[如何使用 Azure API 管理中的服务备份和还原实现灾难恢复](https://docs.azure.cn/api-management/api-management-howto-disaster-recovery-backup-restore)。\n*   使用 [API 管理 REST API](https://msdn.microsoft.com/library/azure/dn776326.aspx) 创建自己的备份和还原功能。 使用 REST API 保存和还原所需服务实例中的实体。\n*   使用 Git 下载服务配置，然后将其上传到新实例。 有关详细信息，请参阅[如何使用 Git 保存和配置 API 管理服务](https://docs.azure.cn/api-management/api-management-configuration-repository-git)。\n\n### 是否可以编程方式管理 API 管理实例？\n\n是，可使用以下工具以编程方式管理 API 管理：\n\n*   [API 管理 REST API](https://msdn.microsoft.com/library/azure/dn776326.aspx)。\n*   [Microsoft Azure API 管理服务管理库 SDK](http://aka.ms/apimsdk)。\n*   [服务部署](https://msdn.microsoft.com/library/mt619282.aspx)和[服务管理](https://msdn.microsoft.com/library/mt613507.aspx) PowerShell cmdlet。\n\n### 如何向管理员组添加用户？\n\n下面是向管理员组添加用户的方法：\n\n1.  登录到 [Azure 门户](https://portal.azure.cn/)。\n2.  转到具有要更新的 API 管理实例的资源组。\n3.  在 API 管理中，将 API 管理参与者角色分配给该用户。\n\n现在，新添加的参与者可以使用 Azure PowerShell [cmdlet](https://msdn.microsoft.com/library/mt613507.aspx)。 下面是以管理员身份登录的方法：\n\n1.  使用 `Login-AzureRmAccount -Environment $(Get-AzureRmEnvironment -Name AzureChinaCloud)` cmdlet 登录。\n2.  使用 `` 将上下文设置为具有该服务的订阅。\n3.  使用 `` 获取单一登录 URL。\n4.  使用 URL 访问管理门户。\n\n### 想要添加的策略为何在策略编辑器中不可用？\n\n如果要添加的策略在策略管理器中显示为变暗或有阴影，请确保你处于该策略的正确范围内。 每个策略声明都设计为在特定范围和策略部分中使用。 若要查看策略部分和策略范围，请参阅 [API 管理策略](https://msdn.microsoft.com/library/azure/dn894080.aspx)中的策略的用法部分。\n\n### 如何在 API 管理中使用 API 版本控制？\n\n有几种选项可用于在 API 管理中使用 API 版本控制：\n\n*   在 API 管理中，可将 API 配置为表示不同版本。 例如，可具有两个不同的 API，MyAPIv1 和 MyAPIv2。 开发人员可选择其要使用的版本。\n*   还可使用不包含版本段的服务 URL 配置 API，例如 [https://my.api。](https://my.api。/) 然后，在每个操作的[重写 URL](https://msdn.microsoft.com/library/azure/dn894083.aspx#RewriteURL) 模板上配置版本段。 例如，可使操作带有名为 /resource 的 [URL 模板](https://docs.azure.cn/api-management/api-management-howto-add-operations#url-template)和名为 /v1/Resource 的[重写 URL](https://docs.azure.cn/api-management/api-management-howto-add-operations#rewrite-url-template) 模板。 可为每个操作单独更改版本段值。\n*   如果希望在 API 的服务 URL 中保留""默认""版本段，请在选定操作上设置使用[设置后端服务](https://msdn.microsoft.com/library/azure/dn894083.aspx#SetBackendService)策略的策略以更改后端请求路径。\n\n### 如何在单个 API 中设置多个环境？\n\n若要在单个 API 中设置多个环境（例如，一个测试环境和一个生产环境），则有两个选项。 可以：\n\n*   在同一租户上托管不同的 API。\n*   在不同租户上托管相同的 API。\n\n### 是否可将 SOAP 用于 API 管理？\n\n当前已提供 [SOAP 传递](http://blogs.msdn.microsoft.com/apimanagement/2016/10/13/soap-pass-through/)支持。 管理员可以导入其 SOAP 服务的 WSDL，以便 Azure API 管理创建一个 SOAP 前端。 开发人员门户文档、测试控制台、策略和分析都可用于 SOAP 服务。\n\n### API 管理网关 IP 地址是否不变？ 是否可以在防火墙规则中使用它？\n\n在标准层和高级层中，API 管理租户的公共 IP 地址 (VIP) 在租户生存期内是静态的，但有一些例外。 IP 地址在以下情况下更改：\n\n*   服务被删除并重新创建。\n*   服务订阅被[暂停](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)或[警告](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)（例如，由于未付款），然后被恢复。\n*   添加或删除 Azure 虚拟网络（只能在开发人员层和高级层使用虚拟网络）。\n\n对于多区域部署，仅当区域先空出然后恢复时，区域地址会更改（只能在高级层使用多区域部署）。\n\n对于为多区域部署配置的高级层租户，每个区域分配一个公共 IP 地址。\n\n可在 Azure 门户中的租户页面上获取一个 IP 地址（或者在多区域部署中获取多个 IP 地址）。\n\n### 是否可以使用 AD FS 安全配置 OAuth 2.0 授权服务器？\n\n若要了解如何使用 Active Directory 联合身份验证服务 (AD FS) 安全配置 OAuth 2.0 授权服务器，请参阅[在 API 管理中使用 ADFS](https://phvbaars.wordpress.com/2016/02/06/using-adfs-in-api-management/)。\n\n### 向多个地理位置进行部署时，API 管理使用何种路由方法？\n\n向多个地理位置进行部署时，API 管理使用[性能流量路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods#priority)。 传入流量将路由到最近的 API 网关。 如果一个区域处于脱机状态，则传入流量会自动路由到下一个最近的网关。 在[流量管理器路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods)中了解有关路由方法的详细信息。\n\n### 是否可以使用 Azure 资源管理器模板创建 API 管理服务实例？\n\n是的。 请参阅 [Azure API 管理服务](http://aka.ms/apimtemplate)快速入门模板。\n\n### 是否可以为后端使用自签名 SSL 证书？\n\n是的。 可以通过 PowerShell 或直接提交到 API 来完成此操作。 这将禁用证书链验证，并将允许在从 API 管理与后端服务进行通信时使用自签名或私人签名证书。\n\n#### Powershell 方法\n\n使用 [`New-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/new-azurermapimanagementbackend)（适用于新后端）或 [`Set-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/set-azurermapimanagementbackend)（适用于现有后端）PowerShell cmdlet 并将 `-SkipCertificateChainValidation` 参数设置设为 `True`。 \n\n`$context = New-AzureRmApiManagementContext -resourcegroup 'ContosoResourceGroup' -servicename 'ContosoAPIMService' New-AzureRmApiManagementBackend -Context $context -Url 'https://contoso.com/myapi' -Protocol http -SkipCertificateChainValidation $true `\n\n#### 直接 API 更新方法\n\n1.  使用 API 管理创建[后端](https://msdn.microsoft.com/library/azure/dn935030.aspx)实体。 \n2.  将""skipCertificateChainValidation""属性设置为""true""。 \n3.  如果不再希望允许自签名证书，请删除后端实体，或将""skipCertificateChainValidation""属性设置为""false""。\n\n### 为何在尝试克隆 Git 存储库时出现身份验证失败？\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",如何向 Microsoft Azure API 管理团队提问？,api management,https://docs.azure.cn/api-management/api-management-faq
"\n\n在标准层和高级层中，API 管理租户的公共 IP 地址 (VIP) 在租户生存期内是静态的，但有一些例外。 IP 地址在以下情况下更改：\n\n*   服务被删除并重新创建。\n*   服务订阅被[暂停](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)或[警告](https://github.com/Azure/azure-resource-manager-rpc/blob/master/v1.0/subscription-lifecycle-api-reference.md#subscription-states)（例如，由于未付款），然后被恢复。\n*   添加或删除 Azure 虚拟网络（只能在开发人员层和高级层使用虚拟网络）。\n\n对于多区域部署，仅当区域先空出然后恢复时，区域地址会更改（只能在高级层使用多区域部署）。\n\n对于为多区域部署配置的高级层租户，每个区域分配一个公共 IP 地址。\n\n可在 Azure 门户中的租户页面上获取一个 IP 地址（或者在多区域部署中获取多个 IP 地址）。\n\n### 是否可以使用 AD FS 安全配置 OAuth 2.0 授权服务器？\n\n若要了解如何使用 Active Directory 联合身份验证服务 (AD FS) 安全配置 OAuth 2.0 授权服务器，请参阅[在 API 管理中使用 ADFS](https://phvbaars.wordpress.com/2016/02/06/using-adfs-in-api-management/)。\n\n### 向多个地理位置进行部署时，API 管理使用何种路由方法？\n\n向多个地理位置进行部署时，API 管理使用[性能流量路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods#priority)。 传入流量将路由到最近的 API 网关。 如果一个区域处于脱机状态，则传入流量会自动路由到下一个最近的网关。 在[流量管理器路由方法](https://docs.azure.cn/traffic-manager/traffic-manager-routing-methods)中了解有关路由方法的详细信息。\n\n### 是否可以使用 Azure 资源管理器模板创建 API 管理服务实例？\n\n是的。 请参阅 [Azure API 管理服务](http://aka.ms/apimtemplate)快速入门模板。\n\n### 是否可以为后端使用自签名 SSL 证书？\n\n是的。 可以通过 PowerShell 或直接提交到 API 来完成此操作。 这将禁用证书链验证，并将允许在从 API 管理与后端服务进行通信时使用自签名或私人签名证书。\n\n#### Powershell 方法\n\n使用 [`New-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/new-azurermapimanagementbackend)（适用于新后端）或 [`Set-AzureRmApiManagementBackend`](https://docs.microsoft.com/en-us/powershell/module/azurerm.apimanagement/set-azurermapimanagementbackend)（适用于现有后端）PowerShell cmdlet 并将 `-SkipCertificateChainValidation` 参数设置设为 `True`。 \n\n`$context = New-AzureRmApiManagementContext -resourcegroup 'ContosoResourceGroup' -servicename 'ContosoAPIMService' New-AzureRmApiManagementBackend -Context $context -Url 'https://contoso.com/myapi' -Protocol http -SkipCertificateChainValidation $true `\n\n#### 直接 API 更新方法\n\n1.  使用 API 管理创建[后端](https://msdn.microsoft.com/library/azure/dn935030.aspx)实体。 \n2.  将""skipCertificateChainValidation""属性设置为""true""。 \n3.  如果不再希望允许自签名证书，请删除后端实体，或将""skipCertificateChainValidation""属性设置为""false""。\n\n### 为何在尝试克隆 Git 存储库时出现身份验证失败？\n\n如果使用 Git 凭据管理器，或者正在尝试使用 Visual Studio 克隆 Git 存储库，可能遇到""Windows 凭据""对话框的已知问题。 该对话框将密码长度限制为 127 个字符，并截断 Microsoft 生成的密码。 我们正致力于缩短密码。 目前请使用 Git Bash 克隆 Git 存储库。\n\n### API 管理是否适用于 Azure ExpressRoute？\n\n是的。 API 管理适用于 Azure ExpressRoute。\n\n### 为什么在资源管理器模式的 VNET 中部署 API 管理时需要专用子网？\n\nAPI 管理需要专用子网，因为它建立在经典（PAAS V1 层）部署模型之上。 虽然也可以在资源管理器 VNET（V2 层）中进行部署，但这样会导致后续问题。 Azure 中的经典部署模型与资源管理器模型结合不紧密，因此如果在 V2 层中创建资源，V1 层会毫不知情，这样会发生问题，例如 API 管理会尝试使用已经分配给 NIC（在 V2 上构建）的 IP。 若要深入了解 Azure 中经典模型和资源管理器模型的差异，请参阅[部署模型的差异](https://docs.azure.cn/azure-resource-manager/resource-manager-deployment-model)。\n\n### 在 VNET 中部署 API 管理时所需的最小子网大小是多少？\n\n部署 API 管理所需的最小子网大小为 [/29](https://docs.azure.cn/virtual-network/virtual-networks-faq#configuration)，这是 Azure 支持的最小子网大小。\n\n### 是否可将 API 管理服务从一个订阅移到另一个订阅？\n\n是的。 要了解操作方法，请参阅[将资源移动到新资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources)。\n\n### 导入 API 是否存在限制或已知问题？\n\n[Open API(Swagger)、WSDL 和 WADL 格式的已知问题和限制](https://docs.azure.cn/api-management/api-management-api-import-restrictions)。\n",API 管理网关 IP 地址是否不变？ 是否可以在防火墙规则中使用它？,api management,https://docs.azure.cn/api-management/api-management-faq
有应用服务应用的文件结构信息，请参阅 [File structure in Azure](https://github.com/projectkudu/kudu/wiki/File-structure-on-azure)（Azure 中的文件结构）。,应用服务 Web 应用中采用怎样的文件或目录结构？,app service,https://docs.azure.cn/app-service/app-service-web-deployment-faq
"\n\n可通过以下几种方式发布 Web 应用代码：\n\n*   使用 Visual Studio 进行部署。 如果拥有 Visual Studio 解决方案，请右键单击 Web 应用程序项目，然后选择""发布""。\n*   使用 FTP 客户端进行部署。 在 Azure 门户中，下载要向其部署代码的 Web 应用的发布配置文件。 然后，使用相同的发布配置文件 FTP 凭据将文件上传到 \site\wwwroot。\n\n有关详细信息，请参阅[将应用部署到应用服务](https://docs.azure.cn/app-service/app-service-deploy-local-git)\n",我刚开始使用应用服务 Web 应用。 如何发布代码？,app service,https://docs.azure.cn/app-service/app-service-web-deployment-faq
"\n\n如果看到以下消息，则可能使用的是旧版 SDK：""在资源组 ""YourResourceGroup"" 中部署资源 ""YourResourceName"" 时出错: MissingRegistrationForLocation : 未针对位置""中国北部""中的资源类型""组件""注册订阅。 若要访问此位置，请重新注册此提供程序。"" \n\n若要解决此错误，请升级到[最新 SDK](https://docs.azure.cn/zh-cn/downloads/)。 如果使用的是最新 SDK 但也收到了此消息，请提交支持请求。\n",尝试从 Visual Studio 进行部署时，收到了一条错误消息。 如何解决此问题？,app service,https://docs.azure.cn/app-service/app-service-web-deployment-faq
教程[五分钟内在 Azure 中创建第一个 ASP.NET Web 应用](https://docs.azure.cn/app-service/app-service-web-get-started-dotnet)演示如何使用 Visual Studio 2017 将 ASP.NET Web 应用程序部署到应用服务中的 Web 应用。,如何将 ASP.NET 应用程序从 Visual Studio 部署到应用服务？,app service,https://docs.azure.cn/app-service/app-service-web-deployment-faq
应用服务支持两种类型的凭据，分别适用于本地 GIT 部署和 FTP/S 部署。 有关如何配置部署凭据的详细信息，请参阅[为 Azure 应用服务配置部署凭据](https://docs.azure.cn/app-service/app-service-deployment-credentials),有哪些不同类型的部署凭据？,app service,https://docs.azure.cn/app-service/app-service-web-deployment-faq
如果看到此消息，磁盘空间可能即将达到 Web 应用服务计划中的磁盘配额。 可能需要根据磁盘空间需求扩展到更高的服务层。 有关定价计划和资源限制的详细信息，请参阅[应用服务定价](https://www.azure.cn/pricing/details/app-service/),"尝试通过 FTP 传输文件时出现""FTP 错误 550 - 磁盘空间不足""，应如何解决？",app service,https://docs.azure.cn/app-service/app-service-web-deployment-faq
有关如何使用 FTP 或 FTPS 将 Web 应用部署到应用服务的信息，请参阅[使用 FTP/S 将应用部署到应用服务](https://docs.azure.cn/app-service/app-service-deploy-ftp),如何使用 FTP 或 FTPS 将应用部署到应用服务？,app service,https://docs.azure.cn/app-service/app-service-web-deployment-faq
若要帮助调查从 GitHub 进行持续部署的问题，请参阅[调查持续部署](https://github.com/projectkudu/kudu/wiki/Investigating-continuous-deployment),如何排查从 GitHub 进行连续部署的问题？,app service,https://docs.azure.cn/app-service/app-service-web-deployment-faq
\n\n若要解决 FTP 问题，请执行以下步骤：\n\n1.  验证是否输入了正确的主机名和凭据。 有关不同类型的凭据及其使用方法的详细信息，请参阅 [Deployment credentials](https://github.com/projectkudu/kudu/wiki/Deployment-credentials)（部署凭据）。\n2.  验证防火墙是否阻止了 FTP 端口。 端口应具有以下设置：\n\n    *   FTP 控制连接端口：21\n    *   FTP 数据连接端口：989、10001-10300,无法通过 FTP 传输到我的站点并发布代码。 如何解决此问题？,app service,https://docs.azure.cn/app-service/app-service-web-deployment-faq
"Azure 快速入门旨在帮助用户使用所选的部署堆栈和方法部署应用。 若要使用快速入门，请在 Azure 门户中转到""设置"" > ""应用部署""。",如何将代码发布到应用服务？,app service,https://docs.azure.cn/app-service/app-service-web-deployment-faq
若要了解应用程序部署在哪些情况下可能导致重启，请参阅 [Deployment vs. runtime issues](https://github.com/projectkudu/kudu/wiki/Deployment-vs-runtime-issues#deployments-and-web-app-restarts)（部署与运行时问题）。 如本文所述，应用服务将文件部署到 wwwroot 文件夹。 这决不会直接重启应用。,为什么应用有时会在部署到应用服务后重启？,app service,https://docs.azure.cn/app-service/app-service-web-deployment-faq
可从 GitHub 设置连续部署。 [连续部署到应用服务](https://docs.azure.cn/app-service/app-service-continuous-deployment)教程非常有用，它介绍了设置连续部署的方法。,如何为应用服务 Web 应用设置连续部署？,app service,https://docs.azure.cn/app-service/app-service-web-deployment-faq
"\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：是否可以配置 SSL 策略来控制 SSL 协议版本？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：我是否可以配置密码套件和策略顺序？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：支持多少个 SSL 证书？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：支持使用多少个身份验证证书进行后端重新加密？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关是否原生与 Azure Key Vault 集成？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：WAF SKU 是否提供标准 SKU 所提供的全部功能？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关支持哪个 CRS 版本？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：如何监视 WAF？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：检测模式是否会阻止流量？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：目前支持哪些规则？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：WAF 是否也支持 DDoS 防护？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关可以使用哪些类型的日志？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：如何知道后端池成员是否正常？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：什么是诊断日志的保留策略？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：如何获取应用程序网关的审核日志？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：是否可以使用应用程序网关设置警报？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：后端运行状况返回未知状态，什么原因导致此状态？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关是否也支持重新加密发往后端的流量？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：如何自定义 WAF 规则？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关支持哪些最新的加密套件？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：如何处理规则？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n支持。应用程序网关会将 x-forwarded-for、x-forwarded-proto 和 x-forwarded-port 标头插入转发到后端的请求中。 x-forwarded-for 标头的格式是逗号分隔的""IP:端口""列表。 x-forwarded-proto 的有效值为 http 或 https。 x-forwarded-port 指定请求抵达应用程序网关时所在的端口。\n\n问：部署应用程序网关需要多长时间？更新时应用程序网关是否仍正常工作？\n\n预配新应用程序网关部署最多需 20 分钟。 更改实例大小/计数不会出现中断，且在此期间网关仍处于活动状态。\n\n## 配置\n\n问：应用程序网关是否始终部署在虚拟网络中？\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关是否支持 x-forwarded-for 标头？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n应用程序网关仅支持一个公共 IP 地址。\n\n问：应用程序网关是否支持 x-forwarded-for 标头？\n\n支持。应用程序网关会将 x-forwarded-for、x-forwarded-proto 和 x-forwarded-port 标头插入转发到后端的请求中。 x-forwarded-for 标头的格式是逗号分隔的""IP:端口""列表。 x-forwarded-proto 的有效值为 http 或 https。 x-forwarded-port 指定请求抵达应用程序网关时所在的端口。\n\n问：部署应用程序网关需要多长时间？更新时应用程序网关是否仍正常工作？\n\n预配新应用程序网关部署最多需 20 分钟。 更改实例大小/计数不会出现中断，且在此期间网关仍处于活动状态。\n\n## 配置\n\n问：应用程序网关是否始终部署在虚拟网络中？\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关是否支持在网关上使用多个公共 IP？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n应用程序网关不支持静态公共 IP 地址，但支持静态内部 IP。\n\n问：应用程序网关是否支持在网关上使用多个公共 IP？\n\n应用程序网关仅支持一个公共 IP 地址。\n\n问：应用程序网关是否支持 x-forwarded-for 标头？\n\n支持。应用程序网关会将 x-forwarded-for、x-forwarded-proto 和 x-forwarded-port 标头插入转发到后端的请求中。 x-forwarded-for 标头的格式是逗号分隔的""IP:端口""列表。 x-forwarded-proto 的有效值为 http 或 https。 x-forwarded-port 指定请求抵达应用程序网关时所在的端口。\n\n问：部署应用程序网关需要多长时间？更新时应用程序网关是否仍正常工作？\n\n预配新应用程序网关部署最多需 20 分钟。 更改实例大小/计数不会出现中断，且在此期间网关仍处于活动状态。\n\n## 配置\n\n问：应用程序网关是否始终部署在虚拟网络中？\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关是否支持静态 IP？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n如果客户停止再启动网关，VIP 可能会变化。 与应用程序网关关联的 DNS 在网关的整个生命周期内不会变化。 出于此原因，建议使用 CNAME 别名并使其指向应用程序网关的 DNS 地址。\n\n问：应用程序网关是否支持静态 IP？\n\n应用程序网关不支持静态公共 IP 地址，但支持静态内部 IP。\n\n问：应用程序网关是否支持在网关上使用多个公共 IP？\n\n应用程序网关仅支持一个公共 IP 地址。\n\n问：应用程序网关是否支持 x-forwarded-for 标头？\n\n支持。应用程序网关会将 x-forwarded-for、x-forwarded-proto 和 x-forwarded-port 标头插入转发到后端的请求中。 x-forwarded-for 标头的格式是逗号分隔的""IP:端口""列表。 x-forwarded-proto 的有效值为 http 或 https。 x-forwarded-port 指定请求抵达应用程序网关时所在的端口。\n\n问：部署应用程序网关需要多长时间？更新时应用程序网关是否仍正常工作？\n\n预配新应用程序网关部署最多需 20 分钟。 更改实例大小/计数不会出现中断，且在此期间网关仍处于活动状态。\n\n## 配置\n\n问：应用程序网关是否始终部署在虚拟网络中？\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：在应用程序网关的生存期内，其 IP 或 DNS 是否会变化？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关支持哪些证书？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n按侦听器的显示顺序进行处理。 因此，如果基本侦听器与传入请求匹配，它会先处理该请求。 应将多站点侦听器配置在基本侦听器之前，以确保将流量路由到正确的后端。\n\n问：在何处可以找到应用程序网关的 IP 和 DNS？\n\n使用公共 IP 地址作为终结点时，可在公共 IP 地址资源中，或者在门户中应用程序网关的""概述""页上找到此信息。 对于内部 IP 地址，可在""概述""页上找到此信息。\n\n问：在应用程序网关的生存期内，其 IP 或 DNS 是否会变化？\n\n如果客户停止再启动网关，VIP 可能会变化。 与应用程序网关关联的 DNS 在网关的整个生命周期内不会变化。 出于此原因，建议使用 CNAME 别名并使其指向应用程序网关的 DNS 地址。\n\n问：应用程序网关是否支持静态 IP？\n\n应用程序网关不支持静态公共 IP 地址，但支持静态内部 IP。\n\n问：应用程序网关是否支持在网关上使用多个公共 IP？\n\n应用程序网关仅支持一个公共 IP 地址。\n\n问：应用程序网关是否支持 x-forwarded-for 标头？\n\n支持。应用程序网关会将 x-forwarded-for、x-forwarded-proto 和 x-forwarded-port 标头插入转发到后端的请求中。 x-forwarded-for 标头的格式是逗号分隔的""IP:端口""列表。 x-forwarded-proto 的有效值为 http 或 https。 x-forwarded-port 指定请求抵达应用程序网关时所在的端口。\n\n问：部署应用程序网关需要多长时间？更新时应用程序网关是否仍正常工作？\n\n预配新应用程序网关部署最多需 20 分钟。 更改实例大小/计数不会出现中断，且在此期间网关仍处于活动状态。\n\n## 配置\n\n问：应用程序网关是否始终部署在虚拟网络中？\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：按什么顺序处理侦听器？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n预配新应用程序网关部署最多需 20 分钟。 更改实例大小/计数不会出现中断，且在此期间网关仍处于活动状态。\n\n## 配置\n\n问：应用程序网关是否始终部署在虚拟网络中？\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：部署应用程序网关需要多长时间？更新时应用程序网关是否仍正常工作？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n支持重定向。 若要了解详细信息，请访问[应用程序网关重定向概述](https://docs.azure.cn/application-gateway/application-gateway-redirect-overview)。\n\n问：按什么顺序处理侦听器？\n\n按侦听器的显示顺序进行处理。 因此，如果基本侦听器与传入请求匹配，它会先处理该请求。 应将多站点侦听器配置在基本侦听器之前，以确保将流量路由到正确的后端。\n\n问：在何处可以找到应用程序网关的 IP 和 DNS？\n\n使用公共 IP 地址作为终结点时，可在公共 IP 地址资源中，或者在门户中应用程序网关的""概述""页上找到此信息。 对于内部 IP 地址，可在""概述""页上找到此信息。\n\n问：在应用程序网关的生存期内，其 IP 或 DNS 是否会变化？\n\n如果客户停止再启动网关，VIP 可能会变化。 与应用程序网关关联的 DNS 在网关的整个生命周期内不会变化。 出于此原因，建议使用 CNAME 别名并使其指向应用程序网关的 DNS 地址。\n\n问：应用程序网关是否支持静态 IP？\n\n应用程序网关不支持静态公共 IP 地址，但支持静态内部 IP。\n\n问：应用程序网关是否支持在网关上使用多个公共 IP？\n\n应用程序网关仅支持一个公共 IP 地址。\n\n问：应用程序网关是否支持 x-forwarded-for 标头？\n\n支持。应用程序网关会将 x-forwarded-for、x-forwarded-proto 和 x-forwarded-port 标头插入转发到后端的请求中。 x-forwarded-for 标头的格式是逗号分隔的""IP:端口""列表。 x-forwarded-proto 的有效值为 http 或 https。 x-forwarded-port 指定请求抵达应用程序网关时所在的端口。\n\n问：部署应用程序网关需要多长时间？更新时应用程序网关是否仍正常工作？\n\n预配新应用程序网关部署最多需 20 分钟。 更改实例大小/计数不会出现中断，且在此期间网关仍处于活动状态。\n\n## 配置\n\n问：应用程序网关是否始终部署在虚拟网络中？\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：是否支持 HTTP 到 HTTPS 的重定向？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n应用程序网关已在公共 Azure 的所有区域推出。\n\n问：应用程序网关是订阅专门的部署，还是在所有客户之间共享？\n\n应用程序网关是虚拟网络中的专用部署。\n\n问：是否支持 HTTP 到 HTTPS 的重定向？\n\n支持重定向。 若要了解详细信息，请访问[应用程序网关重定向概述](https://docs.azure.cn/application-gateway/application-gateway-redirect-overview)。\n\n问：按什么顺序处理侦听器？\n\n按侦听器的显示顺序进行处理。 因此，如果基本侦听器与传入请求匹配，它会先处理该请求。 应将多站点侦听器配置在基本侦听器之前，以确保将流量路由到正确的后端。\n\n问：在何处可以找到应用程序网关的 IP 和 DNS？\n\n使用公共 IP 地址作为终结点时，可在公共 IP 地址资源中，或者在门户中应用程序网关的""概述""页上找到此信息。 对于内部 IP 地址，可在""概述""页上找到此信息。\n\n问：在应用程序网关的生存期内，其 IP 或 DNS 是否会变化？\n\n如果客户停止再启动网关，VIP 可能会变化。 与应用程序网关关联的 DNS 在网关的整个生命周期内不会变化。 出于此原因，建议使用 CNAME 别名并使其指向应用程序网关的 DNS 地址。\n\n问：应用程序网关是否支持静态 IP？\n\n应用程序网关不支持静态公共 IP 地址，但支持静态内部 IP。\n\n问：应用程序网关是否支持在网关上使用多个公共 IP？\n\n应用程序网关仅支持一个公共 IP 地址。\n\n问：应用程序网关是否支持 x-forwarded-for 标头？\n\n支持。应用程序网关会将 x-forwarded-for、x-forwarded-proto 和 x-forwarded-port 标头插入转发到后端的请求中。 x-forwarded-for 标头的格式是逗号分隔的""IP:端口""列表。 x-forwarded-proto 的有效值为 http 或 https。 x-forwarded-port 指定请求抵达应用程序网关时所在的端口。\n\n问：部署应用程序网关需要多长时间？更新时应用程序网关是否仍正常工作？\n\n预配新应用程序网关部署最多需 20 分钟。 更改实例大小/计数不会出现中断，且在此期间网关仍处于活动状态。\n\n## 配置\n\n问：应用程序网关是否始终部署在虚拟网络中？\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：该服务已在哪些区域推出？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n后端池可以包含 NIC、虚拟机规模集、公共 IP、内部 IP、完全限定的域名 (FQDN) 和多租户后端（比如 Azure Web 应用）。 应用程序网关后端池成员不会绑定到可用性集。 后端池的成员可以跨群集、数据中心，或者在 Azure 外部，前提是它们建立了 IP 连接。\n\n问：该服务已在哪些区域推出？\n\n应用程序网关已在公共 Azure 的所有区域推出。\n\n问：应用程序网关是订阅专门的部署，还是在所有客户之间共享？\n\n应用程序网关是虚拟网络中的专用部署。\n\n问：是否支持 HTTP 到 HTTPS 的重定向？\n\n支持重定向。 若要了解详细信息，请访问[应用程序网关重定向概述](https://docs.azure.cn/application-gateway/application-gateway-redirect-overview)。\n\n问：按什么顺序处理侦听器？\n\n按侦听器的显示顺序进行处理。 因此，如果基本侦听器与传入请求匹配，它会先处理该请求。 应将多站点侦听器配置在基本侦听器之前，以确保将流量路由到正确的后端。\n\n问：在何处可以找到应用程序网关的 IP 和 DNS？\n\n使用公共 IP 地址作为终结点时，可在公共 IP 地址资源中，或者在门户中应用程序网关的""概述""页上找到此信息。 对于内部 IP 地址，可在""概述""页上找到此信息。\n\n问：在应用程序网关的生存期内，其 IP 或 DNS 是否会变化？\n\n如果客户停止再启动网关，VIP 可能会变化。 与应用程序网关关联的 DNS 在网关的整个生命周期内不会变化。 出于此原因，建议使用 CNAME 别名并使其指向应用程序网关的 DNS 地址。\n\n问：应用程序网关是否支持静态 IP？\n\n应用程序网关不支持静态公共 IP 地址，但支持静态内部 IP。\n\n问：应用程序网关是否支持在网关上使用多个公共 IP？\n\n应用程序网关仅支持一个公共 IP 地址。\n\n问：应用程序网关是否支持 x-forwarded-for 标头？\n\n支持。应用程序网关会将 x-forwarded-for、x-forwarded-proto 和 x-forwarded-port 标头插入转发到后端的请求中。 x-forwarded-for 标头的格式是逗号分隔的""IP:端口""列表。 x-forwarded-proto 的有效值为 http 或 https。 x-forwarded-port 指定请求抵达应用程序网关时所在的端口。\n\n问：部署应用程序网关需要多长时间？更新时应用程序网关是否仍正常工作？\n\n预配新应用程序网关部署最多需 20 分钟。 更改实例大小/计数不会出现中断，且在此期间网关仍处于活动状态。\n\n## 配置\n\n问：应用程序网关是否始终部署在虚拟网络中？\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：目前支持在后端池中添加哪些资源？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n应用程序网关支持 HTTP、HTTPS 和 WebSocket。\n\n问：目前支持在后端池中添加哪些资源？\n\n后端池可以包含 NIC、虚拟机规模集、公共 IP、内部 IP、完全限定的域名 (FQDN) 和多租户后端（比如 Azure Web 应用）。 应用程序网关后端池成员不会绑定到可用性集。 后端池的成员可以跨群集、数据中心，或者在 Azure 外部，前提是它们建立了 IP 连接。\n\n问：该服务已在哪些区域推出？\n\n应用程序网关已在公共 Azure 的所有区域推出。\n\n问：应用程序网关是订阅专门的部署，还是在所有客户之间共享？\n\n应用程序网关是虚拟网络中的专用部署。\n\n问：是否支持 HTTP 到 HTTPS 的重定向？\n\n支持重定向。 若要了解详细信息，请访问[应用程序网关重定向概述](https://docs.azure.cn/application-gateway/application-gateway-redirect-overview)。\n\n问：按什么顺序处理侦听器？\n\n按侦听器的显示顺序进行处理。 因此，如果基本侦听器与传入请求匹配，它会先处理该请求。 应将多站点侦听器配置在基本侦听器之前，以确保将流量路由到正确的后端。\n\n问：在何处可以找到应用程序网关的 IP 和 DNS？\n\n使用公共 IP 地址作为终结点时，可在公共 IP 地址资源中，或者在门户中应用程序网关的""概述""页上找到此信息。 对于内部 IP 地址，可在""概述""页上找到此信息。\n\n问：在应用程序网关的生存期内，其 IP 或 DNS 是否会变化？\n\n如果客户停止再启动网关，VIP 可能会变化。 与应用程序网关关联的 DNS 在网关的整个生命周期内不会变化。 出于此原因，建议使用 CNAME 别名并使其指向应用程序网关的 DNS 地址。\n\n问：应用程序网关是否支持静态 IP？\n\n应用程序网关不支持静态公共 IP 地址，但支持静态内部 IP。\n\n问：应用程序网关是否支持在网关上使用多个公共 IP？\n\n应用程序网关仅支持一个公共 IP 地址。\n\n问：应用程序网关是否支持 x-forwarded-for 标头？\n\n支持。应用程序网关会将 x-forwarded-for、x-forwarded-proto 和 x-forwarded-port 标头插入转发到后端的请求中。 x-forwarded-for 标头的格式是逗号分隔的""IP:端口""列表。 x-forwarded-proto 的有效值为 http 或 https。 x-forwarded-port 指定请求抵达应用程序网关时所在的端口。\n\n问：部署应用程序网关需要多长时间？更新时应用程序网关是否仍正常工作？\n\n预配新应用程序网关部署最多需 20 分钟。 更改实例大小/计数不会出现中断，且在此期间网关仍处于活动状态。\n\n## 配置\n\n问：应用程序网关是否始终部署在虚拟网络中？\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关支持哪些协议？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n应用程序网关是第 7 层负载均衡器，这意味着，它只处理 Web 流量 (HTTP/HTTPS/WebSocket)。 它支持 SSL 终止、基于 Cookie 的会话相关性以及对流量进行负载均衡的轮循机制等功能。 负载均衡器在第 4 层对流量进行负载均衡 (TCP/UDP)。\n\n问：应用程序网关支持哪些协议？\n\n应用程序网关支持 HTTP、HTTPS 和 WebSocket。\n\n问：目前支持在后端池中添加哪些资源？\n\n后端池可以包含 NIC、虚拟机规模集、公共 IP、内部 IP、完全限定的域名 (FQDN) 和多租户后端（比如 Azure Web 应用）。 应用程序网关后端池成员不会绑定到可用性集。 后端池的成员可以跨群集、数据中心，或者在 Azure 外部，前提是它们建立了 IP 连接。\n\n问：该服务已在哪些区域推出？\n\n应用程序网关已在公共 Azure 的所有区域推出。\n\n问：应用程序网关是订阅专门的部署，还是在所有客户之间共享？\n\n应用程序网关是虚拟网络中的专用部署。\n\n问：是否支持 HTTP 到 HTTPS 的重定向？\n\n支持重定向。 若要了解详细信息，请访问[应用程序网关重定向概述](https://docs.azure.cn/application-gateway/application-gateway-redirect-overview)。\n\n问：按什么顺序处理侦听器？\n\n按侦听器的显示顺序进行处理。 因此，如果基本侦听器与传入请求匹配，它会先处理该请求。 应将多站点侦听器配置在基本侦听器之前，以确保将流量路由到正确的后端。\n\n问：在何处可以找到应用程序网关的 IP 和 DNS？\n\n使用公共 IP 地址作为终结点时，可在公共 IP 地址资源中，或者在门户中应用程序网关的""概述""页上找到此信息。 对于内部 IP 地址，可在""概述""页上找到此信息。\n\n问：在应用程序网关的生存期内，其 IP 或 DNS 是否会变化？\n\n如果客户停止再启动网关，VIP 可能会变化。 与应用程序网关关联的 DNS 在网关的整个生命周期内不会变化。 出于此原因，建议使用 CNAME 别名并使其指向应用程序网关的 DNS 地址。\n\n问：应用程序网关是否支持静态 IP？\n\n应用程序网关不支持静态公共 IP 地址，但支持静态内部 IP。\n\n问：应用程序网关是否支持在网关上使用多个公共 IP？\n\n应用程序网关仅支持一个公共 IP 地址。\n\n问：应用程序网关是否支持 x-forwarded-for 标头？\n\n支持。应用程序网关会将 x-forwarded-for、x-forwarded-proto 和 x-forwarded-port 标头插入转发到后端的请求中。 x-forwarded-for 标头的格式是逗号分隔的""IP:端口""列表。 x-forwarded-proto 的有效值为 http 或 https。 x-forwarded-port 指定请求抵达应用程序网关时所在的端口。\n\n问：部署应用程序网关需要多长时间？更新时应用程序网关是否仍正常工作？\n\n预配新应用程序网关部署最多需 20 分钟。 更改实例大小/计数不会出现中断，且在此期间网关仍处于活动状态。\n\n## 配置\n\n问：应用程序网关是否始终部署在虚拟网络中？\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关与 Azure 负载均衡器之间有什么区别？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n应用程序网关支持 SSL 卸载和端到端 SSL、Web 应用程序防火墙、基于 Cookie 的会话相关性、基于 URL 路径的路由、多站点托管，等等。 有关受支持功能的完整列表，请访问[应用程序网关简介](https://docs.azure.cn/application-gateway/application-gateway-introduction)\n\n问：应用程序网关与 Azure 负载均衡器之间有什么区别？\n\n应用程序网关是第 7 层负载均衡器，这意味着，它只处理 Web 流量 (HTTP/HTTPS/WebSocket)。 它支持 SSL 终止、基于 Cookie 的会话相关性以及对流量进行负载均衡的轮循机制等功能。 负载均衡器在第 4 层对流量进行负载均衡 (TCP/UDP)。\n\n问：应用程序网关支持哪些协议？\n\n应用程序网关支持 HTTP、HTTPS 和 WebSocket。\n\n问：目前支持在后端池中添加哪些资源？\n\n后端池可以包含 NIC、虚拟机规模集、公共 IP、内部 IP、完全限定的域名 (FQDN) 和多租户后端（比如 Azure Web 应用）。 应用程序网关后端池成员不会绑定到可用性集。 后端池的成员可以跨群集、数据中心，或者在 Azure 外部，前提是它们建立了 IP 连接。\n\n问：该服务已在哪些区域推出？\n\n应用程序网关已在公共 Azure 的所有区域推出。\n\n问：应用程序网关是订阅专门的部署，还是在所有客户之间共享？\n\n应用程序网关是虚拟网络中的专用部署。\n\n问：是否支持 HTTP 到 HTTPS 的重定向？\n\n支持重定向。 若要了解详细信息，请访问[应用程序网关重定向概述](https://docs.azure.cn/application-gateway/application-gateway-redirect-overview)。\n\n问：按什么顺序处理侦听器？\n\n按侦听器的显示顺序进行处理。 因此，如果基本侦听器与传入请求匹配，它会先处理该请求。 应将多站点侦听器配置在基本侦听器之前，以确保将流量路由到正确的后端。\n\n问：在何处可以找到应用程序网关的 IP 和 DNS？\n\n使用公共 IP 地址作为终结点时，可在公共 IP 地址资源中，或者在门户中应用程序网关的""概述""页上找到此信息。 对于内部 IP 地址，可在""概述""页上找到此信息。\n\n问：在应用程序网关的生存期内，其 IP 或 DNS 是否会变化？\n\n如果客户停止再启动网关，VIP 可能会变化。 与应用程序网关关联的 DNS 在网关的整个生命周期内不会变化。 出于此原因，建议使用 CNAME 别名并使其指向应用程序网关的 DNS 地址。\n\n问：应用程序网关是否支持静态 IP？\n\n应用程序网关不支持静态公共 IP 地址，但支持静态内部 IP。\n\n问：应用程序网关是否支持在网关上使用多个公共 IP？\n\n应用程序网关仅支持一个公共 IP 地址。\n\n问：应用程序网关是否支持 x-forwarded-for 标头？\n\n支持。应用程序网关会将 x-forwarded-for、x-forwarded-proto 和 x-forwarded-port 标头插入转发到后端的请求中。 x-forwarded-for 标头的格式是逗号分隔的""IP:端口""列表。 x-forwarded-proto 的有效值为 http 或 https。 x-forwarded-port 指定请求抵达应用程序网关时所在的端口。\n\n问：部署应用程序网关需要多长时间？更新时应用程序网关是否仍正常工作？\n\n预配新应用程序网关部署最多需 20 分钟。 更改实例大小/计数不会出现中断，且在此期间网关仍处于活动状态。\n\n## 配置\n\n问：应用程序网关是否始终部署在虚拟网络中？\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关支持哪些功能？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\nAzure 应用程序网关是服务形式的应用程序传送控制器 (ADC)，借此为应用程序提供各种第 7 层负载均衡功能。 它提供完全由 Azure 管理的高度可用、可缩放的服务。\n\n问：应用程序网关支持哪些功能？\n\n应用程序网关支持 SSL 卸载和端到端 SSL、Web 应用程序防火墙、基于 Cookie 的会话相关性、基于 URL 路径的路由、多站点托管，等等。 有关受支持功能的完整列表，请访问[应用程序网关简介](https://docs.azure.cn/application-gateway/application-gateway-introduction)\n\n问：应用程序网关与 Azure 负载均衡器之间有什么区别？\n\n应用程序网关是第 7 层负载均衡器，这意味着，它只处理 Web 流量 (HTTP/HTTPS/WebSocket)。 它支持 SSL 终止、基于 Cookie 的会话相关性以及对流量进行负载均衡的轮循机制等功能。 负载均衡器在第 4 层对流量进行负载均衡 (TCP/UDP)。\n\n问：应用程序网关支持哪些协议？\n\n应用程序网关支持 HTTP、HTTPS 和 WebSocket。\n\n问：目前支持在后端池中添加哪些资源？\n\n后端池可以包含 NIC、虚拟机规模集、公共 IP、内部 IP、完全限定的域名 (FQDN) 和多租户后端（比如 Azure Web 应用）。 应用程序网关后端池成员不会绑定到可用性集。 后端池的成员可以跨群集、数据中心，或者在 Azure 外部，前提是它们建立了 IP 连接。\n\n问：该服务已在哪些区域推出？\n\n应用程序网关已在公共 Azure 的所有区域推出。\n\n问：应用程序网关是订阅专门的部署，还是在所有客户之间共享？\n\n应用程序网关是虚拟网络中的专用部署。\n\n问：是否支持 HTTP 到 HTTPS 的重定向？\n\n支持重定向。 若要了解详细信息，请访问[应用程序网关重定向概述](https://docs.azure.cn/application-gateway/application-gateway-redirect-overview)。\n\n问：按什么顺序处理侦听器？\n\n按侦听器的显示顺序进行处理。 因此，如果基本侦听器与传入请求匹配，它会先处理该请求。 应将多站点侦听器配置在基本侦听器之前，以确保将流量路由到正确的后端。\n\n问：在何处可以找到应用程序网关的 IP 和 DNS？\n\n使用公共 IP 地址作为终结点时，可在公共 IP 地址资源中，或者在门户中应用程序网关的""概述""页上找到此信息。 对于内部 IP 地址，可在""概述""页上找到此信息。\n\n问：在应用程序网关的生存期内，其 IP 或 DNS 是否会变化？\n\n如果客户停止再启动网关，VIP 可能会变化。 与应用程序网关关联的 DNS 在网关的整个生命周期内不会变化。 出于此原因，建议使用 CNAME 别名并使其指向应用程序网关的 DNS 地址。\n\n问：应用程序网关是否支持静态 IP？\n\n应用程序网关不支持静态公共 IP 地址，但支持静态内部 IP。\n\n问：应用程序网关是否支持在网关上使用多个公共 IP？\n\n应用程序网关仅支持一个公共 IP 地址。\n\n问：应用程序网关是否支持 x-forwarded-for 标头？\n\n支持。应用程序网关会将 x-forwarded-for、x-forwarded-proto 和 x-forwarded-port 标头插入转发到后端的请求中。 x-forwarded-for 标头的格式是逗号分隔的""IP:端口""列表。 x-forwarded-proto 的有效值为 http 或 https。 x-forwarded-port 指定请求抵达应用程序网关时所在的端口。\n\n问：部署应用程序网关需要多长时间？更新时应用程序网关是否仍正常工作？\n\n预配新应用程序网关部署最多需 20 分钟。 更改实例大小/计数不会出现中断，且在此期间网关仍处于活动状态。\n\n## 配置\n\n问：应用程序网关是否始终部署在虚拟网络中？\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：什么是应用程序网关？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n应用程序网关是虚拟网络中的专用部署。\n\n问：是否支持 HTTP 到 HTTPS 的重定向？\n\n支持重定向。 若要了解详细信息，请访问[应用程序网关重定向概述](https://docs.azure.cn/application-gateway/application-gateway-redirect-overview)。\n\n问：按什么顺序处理侦听器？\n\n按侦听器的显示顺序进行处理。 因此，如果基本侦听器与传入请求匹配，它会先处理该请求。 应将多站点侦听器配置在基本侦听器之前，以确保将流量路由到正确的后端。\n\n问：在何处可以找到应用程序网关的 IP 和 DNS？\n\n使用公共 IP 地址作为终结点时，可在公共 IP 地址资源中，或者在门户中应用程序网关的""概述""页上找到此信息。 对于内部 IP 地址，可在""概述""页上找到此信息。\n\n问：在应用程序网关的生存期内，其 IP 或 DNS 是否会变化？\n\n如果客户停止再启动网关，VIP 可能会变化。 与应用程序网关关联的 DNS 在网关的整个生命周期内不会变化。 出于此原因，建议使用 CNAME 别名并使其指向应用程序网关的 DNS 地址。\n\n问：应用程序网关是否支持静态 IP？\n\n应用程序网关不支持静态公共 IP 地址，但支持静态内部 IP。\n\n问：应用程序网关是否支持在网关上使用多个公共 IP？\n\n应用程序网关仅支持一个公共 IP 地址。\n\n问：应用程序网关是否支持 x-forwarded-for 标头？\n\n支持。应用程序网关会将 x-forwarded-for、x-forwarded-proto 和 x-forwarded-port 标头插入转发到后端的请求中。 x-forwarded-for 标头的格式是逗号分隔的""IP:端口""列表。 x-forwarded-proto 的有效值为 http 或 https。 x-forwarded-port 指定请求抵达应用程序网关时所在的端口。\n\n问：部署应用程序网关需要多长时间？更新时应用程序网关是否仍正常工作？\n\n预配新应用程序网关部署最多需 20 分钟。 更改实例大小/计数不会出现中断，且在此期间网关仍处于活动状态。\n\n## 配置\n\n问：应用程序网关是否始终部署在虚拟网络中？\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关是订阅专门的部署，还是在所有客户之间共享？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关是否始终部署在虚拟网络中？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n使用公共 IP 地址作为终结点时，可在公共 IP 地址资源中，或者在门户中应用程序网关的""概述""页上找到此信息。 对于内部 IP 地址，可在""概述""页上找到此信息。\n\n问：在应用程序网关的生存期内，其 IP 或 DNS 是否会变化？\n\n如果客户停止再启动网关，VIP 可能会变化。 与应用程序网关关联的 DNS 在网关的整个生命周期内不会变化。 出于此原因，建议使用 CNAME 别名并使其指向应用程序网关的 DNS 地址。\n\n问：应用程序网关是否支持静态 IP？\n\n应用程序网关不支持静态公共 IP 地址，但支持静态内部 IP。\n\n问：应用程序网关是否支持在网关上使用多个公共 IP？\n\n应用程序网关仅支持一个公共 IP 地址。\n\n问：应用程序网关是否支持 x-forwarded-for 标头？\n\n支持。应用程序网关会将 x-forwarded-for、x-forwarded-proto 和 x-forwarded-port 标头插入转发到后端的请求中。 x-forwarded-for 标头的格式是逗号分隔的""IP:端口""列表。 x-forwarded-proto 的有效值为 http 或 https。 x-forwarded-port 指定请求抵达应用程序网关时所在的端口。\n\n问：部署应用程序网关需要多长时间？更新时应用程序网关是否仍正常工作？\n\n预配新应用程序网关部署最多需 20 分钟。 更改实例大小/计数不会出现中断，且在此期间网关仍处于活动状态。\n\n## 配置\n\n问：应用程序网关是否始终部署在虚拟网络中？\n\n是的，应用程序网关始终部署在虚拟网络子网中。 此子网只能包含应用程序网关。\n\n问：应用程序网关是否能够与其虚拟网络外部的实例通信？\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：在何处可以找到应用程序网关的 IP 和 DNS？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：是否可以在应用程序网关子网中部署其他任何组件？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n应用程序网关可与其所在的虚拟网络外部的实例通信，前提是已建立 IP 连接。 如果打算使用内部 IP 作为后端池成员，则需要使用 [VNET 对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)或 [VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n\n问：是否可以在应用程序网关子网中部署其他任何组件？\n\n不可以，但可以在子网中部署其他应用程序网关。\n\n问：网关应用程序网关子网是否支持网络安全组？\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关是否能够与其虚拟网络外部的实例通信？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：是否支持自动缩放？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：应用程序网关如何支持高可用性和可伸缩性？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：自定义探测的 Host 字段是什么意思？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：手动扩展/缩减是否导致停机？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：自定义探测是否支持对响应数据使用通配符/正则表达式？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：是否支持 VNet 对等互连？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：是否可以同时对外部和内部流量使用应用程序网关？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n应用程序网关子网支持网络安全组，但具有以下限制：\n\n*   \n\n必须提交端口 65503-65534 上传入流量的异常，以便后台运行状况正常工作。\n\n*   \n\n不能阻止出站 Internet 连接。\n\n*   \n\n必须允许来自 AzureLoadBalancer 标记的流量。\n\n问：是否可以同时对外部和内部流量使用应用程序网关？\n\n可以。每个应用程序网关支持一个内部 IP 和一个外部 IP。\n\n问：是否支持 VNet 对等互连？\n\n是的，支持 VNet 对等互连，这有助于对其他虚拟网络中的流量进行负载均衡。\n\n问：如果通过 ExpressRoute 或 VPN 隧道连接本地服务器，是否可与这些服务器通信？\n\n可以，只要允许这种流量。\n\n问：是否可以使用一个后端池来为不同端口上的许多应用程序提供服务？\n\n支持微服务体系结构。 需要配置多个 http 设置才能探测不同的端口。\n\n问：自定义探测是否支持对响应数据使用通配符/正则表达式？\n\n自定义探测不支持对响应数据使用通配符或正则表达式。 \n\n问：如何处理规则？\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：网关应用程序网关子网是否支持网络安全组？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n按配置规则的顺序处理规则。 建议将多站点规则配置在基本规则之前，以降低将流量路由到错误后端的可能性，因为基本规则会在评估多站点规则之前根据端口匹配流量。\n\n问：如何处理规则？\n\n规则按照其创建的顺序进行处理。 建议先配置多站点规则，再配置基本规则。 通过先配置多站点侦听器，此配置可以减少将流量路由到错误后端的机会。 由于在评估多站点规则之前，基本规则会基于端口匹配流量，因此可能出现此路由问题。\n\n问：自定义探测的 Host 字段是什么意思？\n\nHost 字段指定要将探测发送到的名称。 仅在应用程序网关上配置了多站点的情况下适用，否则使用""127.0.0.1""。 此值不同于 VM 主机名，它采用 ://: 格式。\n\n问：我可以将某些源 IP 的应用程序网关访问权限列入允许列表吗？\n\n对应用程序网关子网使用 NSG 可以完成此方案。 应按列出的优先顺序对子网采取以下限制：\n\n*   \n\n允许来自源 IP/IP 范围的传入流量。\n\n*   \n\n允许来自所有源的请求传入端口 65503-65534，进行[后端运行状况通信](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   \n\n允许 [NSG](https://docs.azure.cn/virtual-network/virtual-networks-nsg) 上的传入 Azure 负载均衡器探测（AzureLoadBalancer 标记）和入站虚拟网络流量（VirtualNetwork 标记）。\n\n*   \n\n使用""全部拒绝""规则阻止其他所有传入流量。\n\n*   \n\n允许发往 Internet 的所有目标的出站流量。\n\n## 性能\n\n问：应用程序网关如何支持高可用性和可伸缩性？\n\n如果已部署两个或更多个实例，则应用程序网关支持高可用性方案。 Azure 将跨更新域和容错域分配这些实例，确保所有实例不会同时发生故障。 为了支持可伸缩性，应用程序网关会添加同一网关的多个实例来分担负载。\n\n问：如何使用应用程序网关实现跨数据中心的灾难恢复方案？\n\n客户可以使用流量管理器跨不同数据中心内的多个应用程序网关分配流量。\n\n问：是否支持自动缩放？\n\n不支持，但应用程序网关提供吞吐量指标，达到阈值时，可使用该指标发出警报。 手动添加实例或更改大小不会重新启动网关，且不会影响现有流量。\n\n问：手动扩展/缩减是否导致停机？\n\n不会出现停机，实例将分布在升级域和容错域上。\n\n问：是否可以在不造成中断的情况下，将实例大小从中型更改为大型？\n\n可以。Azure 将跨更新域和容错域分配实例，确保所有实例不会同时发生故障。 为了支持缩放，应用程序网关可添加同一网关的多个实例来分担负载。\n\n## SSL 配置\n\n问：应用程序网关支持哪些证书？\n\n支持自签名证书、CA 证书和通配符证书。 不支持 EV 证书。\n\n问：应用程序网关支持哪些最新的加密套件？\n\n应用程序网关当前支持以下密码套件。 请访问[在应用程序网关上配置 SSL 策略版本和密码套件](https://docs.azure.cn/application-gateway/application-gateway-configure-ssl-policy-powershell)，了解如何自定义 SSL 选项。\n\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_DHE_RSA_WITH_AES_256_CBC_SHA\n*   TLS_DHE_RSA_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_AES_256_GCM_SHA384\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA\n*   TLS_RSA_WITH_AES_128_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n*   TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\n*   TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_DSS_WITH_AES_256_CBC_SHA\n*   TLS_DHE_DSS_WITH_AES_128_CBC_SHA\n*   TLS_RSA_WITH_3DES_EDE_CBC_SHA\n*   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\n\n问：应用程序网关是否也支持重新加密发往后端的流量？\n\n是的，应用程序网关支持 SSL 卸载和端到端 SSL，因此支持重新加密发往后端的流量。\n\n问：是否可以配置 SSL 策略来控制 SSL 协议版本？\n\n是的，可将应用程序网关配置为拒绝 TLS1.0、TLS1.1 和 TLS1.2。 SSL 2.0 和 3.0 默认已禁用，并且不可配置。\n\n问：我是否可以配置密码套件和策略顺序？\n\n是，支持[配置密码套件](https://docs.azure.cn/application-gateway/application-gateway-ssl-policy-overview)。 定义自定义策略时，必须至少启用以下其中一个密码套件。 应用程序网关使用 SHA256 进行后端管理。\n\n*   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 \n*   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n*   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_128_GCM_SHA256\n*   TLS_RSA_WITH_AES_256_CBC_SHA256\n*   TLS_RSA_WITH_AES_128_CBC_SHA256\n\n问：支持多少个 SSL 证书？\n\n最多支持 20 个 SSL 证书。\n\n问：支持使用多少个身份验证证书进行后端重新加密？\n\n最多支持 10 个身份验证证书，默认为 5 个。\n\n问：应用程序网关是否原生与 Azure Key Vault 集成？\n\n不是，它没有与 Azure Key Vault 集成。\n\n## Web 应用程序防火墙 (WAF) 配置\n\n问：WAF SKU 是否提供标准 SKU 所提供的全部功能？\n\n是的，WAF 支持标准 SKU 中的所有功能。\n\n问：应用程序网关支持哪个 CRS 版本？\n\n应用程序网关支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)。\n\n问：如何监视 WAF？\n\n可通过诊断日志记录监视 WAF。有关诊断日志记录的详细信息，请参阅 [Diagnostics Logging and Metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的诊断日志记录和指标）\n\n问：检测模式是否会阻止流量？\n\n不会。检测模式仅记录触发了 WAF 规则的流量。\n\n问：如何自定义 WAF 规则？\n\n是的，WAF 规则可自定义，有关如何自定义这些规则的详细信息，请访问[自定义 WAF 规则组和规则](https://docs.azure.cn/application-gateway/application-gateway-customize-waf-rules-portal)\n\n问：目前支持哪些规则？\n\nWAF 目前支持 CRS [2.2.9](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp229) 和 CRS [3.0](https://docs.azure.cn/application-gateway/application-gateway-crs-rulegroups-rules#owasp30)，这些规则针对开放 Web 应用程序安全项目 (OWASP) 识别到的 10 大漏洞中的大多数漏洞提供基准安全要求，相关信息请参阅 [OWASP top 10 Vulnerabilities](https://www.owasp.org/index.php/Top10#OWASP_Top_10_for_2013)（OWASP 10 大漏洞）\n\n*   \n\nSQL 注入保护\n\n*   \n\n跨站点脚本保护\n\n*   \n\n常见 Web 攻击保护，例如命令注入、HTTP 请求走私、HTTP 响应拆分和远程文件包含攻击\n\n*   \n\n防止 HTTP 协议违反行为\n\n*   \n\n防止 HTTP 协议异常行为，例如缺少主机用户代理和接受标头\n\n*   \n\n防止自动程序、爬网程序和扫描程序\n\n*   \n\n检测常见应用程序错误配置（即 Apache、IIS 等）\n\n问：WAF 是否也支持 DDoS 防护？\n\n否，WAF 不提供 DDoS 防护。\n\n## 诊断和日志记录\n\n问：应用程序网关可以使用哪些类型的日志？\n\n应用程序网关可以使用三种日志。 有关这些日志和其他诊断功能的详细信息，请访问[应用程序网关的后端运行状况、诊断日志和指标](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)。\n\n*   ApplicationGatewayAccessLog：访问日志包含提交到应用程序网关前端的每个请求。 数据包括调用方的 IP、请求的 URL、响应延迟、返回代码，以及传入和传出的字节数。每隔 300 秒会收集一次访问日志。 此日志包含每个应用程序网关实例的一条记录。\n*   ApplicationGatewayPerformanceLog：性能日志捕获每个实例的性能信息，包括提供的请求总数、吞吐量（以字节为单位）、失败的请求计数、正常和不正常的后端实例计数。\n*   ApplicationGatewayFirewallLog：防火墙日志包含通过应用程序网关（配置有 Web 应用程序防火墙）的检测或阻止模式记录的请求。\n\n问：如何知道后端池成员是否正常？\n\n可以使用 PowerShell cmdlet `Get-AzureRmApplicationGatewayBackendHealth`，或者在门户中访问[应用程序网关诊断](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)来验证运行状况\n\n问：什么是诊断日志的保留策略？\n\n诊断日志发往客户存储帐户，客户可以根据偏好设置保留策略。 此外，可将诊断日志发送到事件中心或 Log Analytics。 有关详细信息，请访问 [Application Gateway Diagnostics](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关诊断）。\n\n问：如何获取应用程序网关的审核日志？\n\n应用程序网关有相应的审核日志。 在门户上的应用程序网关菜单边栏选项卡中单击""活动日志""即可访问审核日志。 \n\n问：是否可以使用应用程序网关设置警报？\n\n可以，应用程序网关确实支持警报。可以基于指标设置警报。 应用程序网关目前提供""吞吐量""指标，可以使用它来配置警报。 \n\n问：后端运行状况返回未知状态，什么原因导致此状态？\n\n最常见的原因是访问的后端被 NSG 或自定义 DNS 阻止。 有关详细信息，请访问 [Backend health, diagnostics logging, and metrics for Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-diagnostics)（应用程序网关的后端运行状况、诊断日志记录和指标）。\n\n## 后续步骤\n\n若要了解有关应用程序网关的详细信息，请访问 [Introduction to Application Gateway](https://docs.azure.cn/application-gateway/application-gateway-introduction)（应用程序网关简介）。\n",问：如何处理规则？,application gateway,https://docs.azure.cn/application-gateway/application-gateway-faq
"\n\n可以备份到保管库的数据量没有限制。 Azure 备份限制数据源的大小上限，但是这些上限很高。 截至 2015 年 8 月，受支持操作系统的数据源大小上限为：\nS.No操作系统数据源的最大大小1Windows Server 2012 或更高版本54,400 GB2Windows 8 或更高版本54,400 GB3Windows Server 2008、Windows Server 2008 R21700 GB4Windows 71700 GB\n\n下表说明了如何确定每个数据源大小。\n数据源详细信息数据量(Volume)从服务器或客户端计算机的单个卷备份的数据量Hyper-V 虚拟机所备份虚拟机的所有 VHD 的数据总和Microsoft SQL Server 数据库所备份的单个 SQL 数据库的大小Microsoft SharePoint所备份 SharePoint 场中内容和配置数据库的总和Microsoft Exchange所备份 Exchange 服务器中所有 Exchange 数据库的总和BMR/系统状态所备份计算机的 BMR 或系统状态的每个副本\n\n就 Azure VM 备份来说，每个 VM 最多可以有 16 个数据磁盘，每个数据磁盘的大小不得超出 1023GB。 \n\n## 保留策略和恢复点\n\n",要备份的每个数据源的大小是否有限制？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
否，DPM 和 Windows Server/客户端都有每日、每周、每月和每年保留策略。,DPM 和 Windows Server/客户端（即，在不带 DPM 的 Windows Server 上）的保留策略是否有差别？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
是的，Azure 备份保留结构允许根据自己的要求十分灵活地定义保留策略。,是否可以选择性地配置我的保留策略 - 例如，配置每周和每日保留策略，但不配置每年和每月保留策略？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
否。 只能在备份时间点应用保留策略。 在下图中，保留策略是针对上午 12 点和下午 6 点生成的备份指定的。,我是否可以计划下午 6 点的备份，同时指定不同时间的保留策略？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
否，恢复最旧或最新时间点所需的时间相同。 每个恢复点的行为类似一个完整的点。,如果备份保留了很长一段时间，是否需要更多时间才能恢复较旧的数据点？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
典型的长期保留点产品将备份数据存储为完整的点。 完整点的存储 效率不高 ，但能使还原变得更方便和快速。 增量复制是 高效 存储，但要求还原数据链，这会影响恢复时间。 Azure 备份存储体系结构在这两方面都能提供最佳性能，它以最佳方式存储数据，以便快速还原，且产生的存储成本低。 这种数据存储方法可确保提高（入口和出口）带宽使用效率。 数据存储量和恢复数据所需的时间都会尽量减少。 详细了解[增量备份](https://azure.microsoft.com/blog/microsoft-azure-backup-save-on-long-term-storage/)的效用。,如果每个恢复点相当于完整的点，它会影响总体可计费备份存储吗？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
是的。 数据会在本地 SCDPM 服务器/客户端/SCDPM 计算机上使用 AES256 加密，并通过安全的 HTTPS 链接发送。,发送到 Azure 的数据会加密吗？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
从 Azure 备份执行恢复的次数没有限制。,对于已备份到 Azure 的数据，可以执行多少次恢复？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
\n\n不可以。 恢复是免费的，不收取传出流量费。\n\n## Azure 备份加密\n\n,还原数据时，Azure 的出口流量是否需要付费？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
是的。 发送到 Azure 的数据将保持加密（静态加密）。 Microsoft 不会解密任何位置的备份数据。 备份 Azure VM 时，Azure 备份依赖于对虚拟机的加密。 例如，如果使用 Azure 磁盘加密或其他某种加密技术对 VM 进行了加密，则 Azure 备份会使用同样的加密技术来保护数据。,Azure 中的备份数据也会加密吗？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
使用 Azure 备份代理时，加密密钥至少应该为 16 个字符。 就 Azure VM 来说，Azure KeyVault 所使用的密钥没有长度限制。,用于加密备份数据的加密密钥的最小长度是多少？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
用于加密备份数据的密钥只能放置在客户场地。 Microsoft 不会在 Azure 中保留副本，并且无权访问密钥。 如果客户丢失了密钥，Microsoft 将无法恢复备份的数据。,如果我丢失了加密密钥，会发生什么情况？ 是否可以恢复数据（或者）Microsoft 是否可以恢复数据？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
最多可为单个受保护实例创建 9999 个恢复点。 受保护的实例是计算机、服务器（物理或虚拟）或配置为向 Azure 备份数据的工作负荷。 有关详细信息，请参阅[备份和保留](https://docs.azure.cn/backup/backup-introduction-to-azure-backup#backup-and-retention)和[什么是受保护实例？](https://docs.azure.cn/backup/backup-introduction-to-azure-backup#what-is-a-protected-instance)的说明,可创建的恢复点数量是否有限制？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
\n\nAzure 备份支持以下列表中的操作系统使用 Azure 备份服务器和 System Center Data Protection Manager (DPM) 对文件和文件夹以及受保护的工作负荷应用程序进行备份。\n操作系统平台SKUWindows 8 和最新的 SP64 位Enterprise、ProWindows 7 和最新的 SP64 位Ultimate、Enterprise、Professional、Home Premium、Home Basic、StarterWindows 8.1 和最新的 SP64 位Enterprise、ProWindows 1064 位Enterprise、Pro、HomeWindows Server 201664 位Standard、Datacenter、EssentialsWindows Server 2012 R2 和最新的 SP64 位Standard、Datacenter、FoundationWindows Server 2012 和最新的 SP64 位Datacenter、Foundation、StandardWindows Storage Server 2016 和最新的 SP64 位Standard、WorkgroupWindows Storage Server 2012 R2 和最新的 SP64 位Standard、WorkgroupWindows Storage Server 2012 和最新的 SP64 位Standard、WorkgroupWindows Server 2012 R2 和最新的 SP64 位EssentialWindows Server 2008 R2 SP164 位Standard、Enterprise、Datacenter、FoundationWindows Server 2008 SP264 位Standard、Enterprise、Datacenter、Foundation\n\n对于 Azure VM 备份：\n\n*   Linux：Azure 备份支持 [Azure 认可的分发版列表](https://docs.azure.cn/virtual-machines/linux/endorsed-distros) ，但 Core OS Linux 除外。 只要虚拟机上装有 VM 代理且支持 Python，其他自带 Linux 分发版应该也能正常运行。\n*   Windows Server：不支持低于 Windows Server 2008 R2 的版本。,Azure 备份支持哪些操作系统？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
建议在适用于 System Center Data Protection Manager (DPM) 的最新更新汇总版本 (UR) 上安装[最新](http://aka.ms/azurebackup_agent)的 Azure 备份代理。 到 2016 年 8 月为止，更新汇总版本 11 是最新的更新。,支持哪个版本的 System Center Data Protection Manager？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
是的。 一天可以在 Windows Server 或 Windows 工作站上运行备份操作最多三次。 一天可以在 System Center DPM 上运行备份操作最多两次。 一天可以运行 IaaS VM 的备份作业一次。 可以将计划策略用于 Windows Server 或 Windows 工作站，以便指定每日或每周计划。 使用 System Center DPM 时，可以指定每日、每周、每月和每年计划。,备份作业可计划的时间或次数是否有限制？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
是的。 从 2016 年 9 月起，可以为每个订阅创建 25 个恢复服务或备份保管库。 在 Azure 备份支持的区域中，可以为每个订阅最多创建 25 个恢复服务保管库。 如果需要更多保管库，请创建另一订阅。,在每个 Azure 订阅中可以创建的保管库数量是否有任何限制？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
是的，最多可为每个保管库注册 50 个计算机。 对于 Azure IaaS 虚拟机，限制为每个保管库 200 个 VM。 如果需要注册更多的计算机，请创建另一个保管库。,可针对每个保管库注册的服务器/计算机数量是否有限制？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
注册到同一个保管库的所有服务器都能够恢复由 使用同一密码的其他服务器备份的数据。 如果想要隔离服务器中的备份数据与组织中的其他服务器，请对其使用指定通行短语。 例如，人力资源服务器可能使用一个加密通行短语，会计结算服务器使用另一个通行短语，而存储服务器使用第三个通行短语。,如果本组织有一个保管库，如何在还原数据时会一个服务器的数据与另一个服务器隔离？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
仍然支持[经典管理门户](https://manage.windowsazure.cn/)中所有现有的备份保管库。 但是，无法再使用经典管理门户来部署新的备份保管库。 Microsoft 建议对所有部署使用恢复服务保管库，因为将来只会对恢复服务保管库进行增强。 如果尝试在经典管理门户中创建备份保管库，系统会重定向到 [Azure 门户](https://portal.azure.cn/)。,恢复服务保管库基于 Resource Manager。 是否仍支持备份保管库（经典模式）？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
可以，现在可将备份保管库升级到恢复服务保管库。 有关详细信息，请参阅文章[将备份保管库升级到恢复服务保管库](https://docs.azure.cn/backup/backup-azure-upgrade-backup-to-recovery-services)。,是否可以将备份保管库迁移到恢复服务保管库？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
"\n\n将 VM 从经典模式迁移到 Resource Manager 模式时，备份保管库中的经典 VM 恢复点不会自动迁移到恢复服务保管库。 可以按照以下步骤传输 VM 备份：\n\n1.  在备份保管库中，转到""受保护的项""选项卡并选择 VM。 单击[停止保护](https://docs.azure.cn/backup/backup-azure-manage-vms-classic#stop-protecting-virtual-machines)。 将"" 删除关联的备份数据 ""选项保留为 取消选中状态。\n2.  从 VM 中删除备份/快照扩展。\n3.  将虚拟机从经典模式迁移到 Resource Manager 模式。 确保与虚拟机对应的存储和网络信息也已迁移到 Resource Manager 模式。\n4.  创建一个恢复服务保管库，并使用保管库仪表板顶部的""备份""操作在迁移的虚拟机上配置备份。 有关将 VM 备份到恢复服务保管库的详细信息，请参阅文章[使用恢复服务保管库保护 Azure VM](https://docs.azure.cn/backup/backup-azure-vms-first-look-arm)。\n\n## Azure 备份代理\n\n[Azure 文件-文件夹备份常见问题解答](https://docs.azure.cn/backup/backup-azure-file-folder-backup-faq)中提供了问题的详细列表\n\n## Azure VM 备份\n\n[Azure VM 备份常见问题解答](https://docs.azure.cn/backup/backup-azure-vm-backup-faq)中提供了问题的详细列表\n\n## 备份 VMware 服务器\n\n",我已在备份保管库中备份了经典 VM。 是否可以将 VM 从经典模式迁移到 Resource Manager 模式并在恢复服务保管库中保护它们？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
不可以。 保管库是在订阅级别创建的，在创建后无法重新分配到另一订阅。,是否可以在订阅之间迁移备份数据或保管库？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
是的。,是否可以使用 Azure 备份服务器为物理服务器创建裸机恢复 (BMR) 备份？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
否。 一个 DPM 或 MABS 服务器只能注册到一个保管库。,是否可以向多个保管库注册 DPM 服务器？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
\n\n 从 Azure 备份代理、SCDPM 或 Azure 备份服务器备份的所有数据都会在传输之前进行压缩和加密。 应用压缩和加密后，备份保管库中的数据将减少 30-40%。\n\n## 我能够备份的内容\n\n,为什么传输到恢复服务保管库的数据的大小小于我备份的数据？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
\n\n要将 Azure 备份与 System Center Data Protection Manager (DPM) 一起使用，请先安装 DPM，然后再安装 Azure 备份代理。 以这种顺序安装 Azure 备份组件可确保 Azure 备份代理与 DPM 配合使用。 不建议也不支持在安装 DPM 之前安装 Azure 备份代理。\n\n## Azure 备份工作原理\n\n,我已安装 Azure 备份代理来保护我的文件和文件夹。 现在可以安装 System Center DPM 来与 Azure 备份代理配合使用，以便在 Azure 中保护本地应用程序/VM 工作负荷吗？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
\n\n否。 在备份作业取消之前传输到保管库中的所有数据将保留在保管库中。 Azure 备份使用检查点机制，在备份过程中偶尔要对备份数据添加检查点。 由于备份数据中有检查点，下次备份过程可以验证文件的完整性。 下一备份作业会在已备份数据的基础上进行增量备份。 增量备份仅传输新的或已更改的数据，这相当于更好地利用带宽。\n\n如果取消 Azure VM 的备份作业，则会忽略任何已传输的数据。 下次备份作业将传输上次成功的备份作业之后的增量数据。\n,如果在备份作业开始后取消，是否会删除已传输的备份数据？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
\n\n是的。 可以使用 Azure 备份服务器将 VMware vCenter 和 ESXi 备份到 Azure。 若要了解支持的 VMware 版本，请参阅 [Azure 备份服务器保护矩阵](https://docs.azure.cn/backup/backup-mabs-protection-matrix)一文。 有关分步说明，请参阅[使用 Azure 备份服务器备份 VMware 服务器](https://docs.azure.cn/backup/backup-azure-backup-server-vmware)。\n\n## Azure 备份服务器和 System Center Data Protection Manager\n\n,是否可以将 VMware vCenter 服务器备份到 Azure？,backup,https://docs.azure.cn/backup/backup-azure-backup-faq
是，仍然支持备份保管库。可以在[经典管理门户](https://manage.windowsazure.cn/)中创建备份保管库。,恢复服务保管库基于资源管理器。备份保管库（经典模式）是否仍受支持？,backup,https://docs.azure.cn/backup/backup-azure-backup-ibiza-faq
很遗憾不可以，目前无法将备份保管库的内容迁移到恢复服务保管库。我们正着手添加此功能，但公共预览中并未提供。,是否可以将备份保管库迁移到恢复服务保管库？,backup,https://docs.azure.cn/backup/backup-azure-backup-ibiza-faq
恢复服务保管库支持这两种模型。可以将经典管理门户中创建的 VM（经典模式 VM）或 Azure 门户中创建的 VM（基于资源管理器）备份到恢复服务保管库。,恢复服务保管库是否支持经典 VM 或基于资源管理器的 VM？,backup,https://docs.azure.cn/backup/backup-azure-backup-ibiza-faq
"\n\n是的。 如果该备份作业处于""拍摄快照""阶段，则可以取消。 如果此作业正在从快照传输数据，则无法取消。 \n\n## 还原\n\n",可以取消正在进行的备份作业吗？,backup,https://docs.azure.cn/backup/backup-azure-vm-backup-faq
在 VM 上应用新策略时，将遵循新策略的计划和保留期。 如果延长保留期，则会对现有的恢复点进行标记，按新策略要求保留它们。 如果缩短保留期，则会将其标记为在下一清理作业中删除，随后会将其删除。,在 VM 上更改备份策略时，会发生什么情况？,backup,https://docs.azure.cn/backup/backup-azure-vm-backup-faq
\n\n是，可以使用将磁盘从非托管迁移到托管之前创建的备份。 默认情况下，还原 VM 作业会使用非托管磁盘创建 VM。 可以使用还原磁盘功能还原磁盘，并使用它们在托管磁盘上创建 VM。 \n\n## 管理 VM 备份\n\n,将磁盘升级到托管磁盘后，是否可以使用非托管磁盘 VM 的备份进行还原？,backup,https://docs.azure.cn/backup/backup-azure-vm-backup-faq
"\n\n可以将 Azure 的完整 VM 还原视为一种快速创建选项。 ""还原 VM""选项会更改磁盘名称、这些磁盘使用的容器、公共 IP 地址和网络接口名称。 需要更改，才能保持 VM 创建期间创建的资源的唯一性。 但它不会将 VM 添加到可用性集。 \n\n""还原磁盘""可以用于：\n\n*   自定义根据时间点配置创建的 VM，例如更改大小\n*   添加在备份时不存在的配置 \n*   控制所要创建资源的命名约定\n*   将 VM 添加到可用性集\n*   适用于只能通过 PowerShell/声明性模板定义实现的任何其他配置",如何决定是进行磁盘还原，还是进行完整的 VM 还原？,backup,https://docs.azure.cn/backup/backup-azure-vm-backup-faq
是的。 即使计算机已关闭，备份也会运行，恢复点将标记为崩溃一致。 有关更多详细信息，请参阅[此文](https://docs.azure.cn/backup/backup-azure-vms-introduction#how-does-azure-back-up-virtual-machines)中的数据一致性部分,我的 VM 已关闭。 按需备份或计划备份会运行吗？,backup,https://docs.azure.cn/backup/backup-azure-vm-backup-faq
不可以。 应为按需备份作业指定保留期。 默认情况下，从门户触发时，该作业会保留 30 天。,按需备份作业是否与计划内备份遵循相同的保留计划？,backup,https://docs.azure.cn/backup/backup-azure-vm-backup-faq
"需提供 Azure 备份服务访问 Key Vault 所需的权限。 可以在 PowerShell 中使用 [PowerShell](https://docs.azure.cn/backup/backup-azure-vms-automation) 文档的""启用备份""部分所述步骤提供这些权限。",我最近在一些 VM 上启用了 Azure 磁盘加密。 我的备份是否继续有效？,backup,https://docs.azure.cn/backup/backup-azure-vm-backup-faq
"\n\n在配置备份向导中，Azure 备份只列出符合以下条件的 VM：\n\n*   尚未进行保护 - 可以验证 VM 的备份状态，方法是：转到 VM 边栏选项卡，从""设置""菜单查看备份状态。 详细了解如何[查看 VM 的备份状态](https://docs.azure.cn/backup/backup-azure-vms-first-look-arm)。\n*   与 VM 属于同一区域\n\n## 备份\n\n",为什么在配置备份向导中看不到我的 VM？,backup,https://docs.azure.cn/backup/backup-azure-vm-backup-faq
请参阅[支持的操作系统](https://docs.azure.cn/backup/backup-azure-arm-vms-prepare#supported-operating-system-for-backup)和 [VM 备份限制](https://docs.azure.cn/backup/backup-azure-arm-vms-prepare#limitations-when-backing-up-and-restoring-a-vm),Azure VM 备份不支持哪些配置？,backup,https://docs.azure.cn/backup/backup-azure-vm-backup-faq
恢复服务保管库同时支持这两种模型。 可以将经典 VM（在经典管理门户中创建）或 Resource Manager VM（在 Azure 门户中创建）备份到恢复服务保管库。,恢复服务保管库是支持基于经典 VM 还是支持基于 Resource Manager 的 VM？,backup,https://docs.azure.cn/backup/backup-azure-vm-backup-faq
是的，备份可以无缝工作，无需重新配置备份。,我将 VM 的磁盘迁移到了托管磁盘。 我的备份是否继续有效？,backup,https://docs.azure.cn/backup/backup-azure-vm-backup-faq
\n\n如果某个云服务在任一槽中存在部署，则会将整个云服务固定到特定的群集。 这意味着，如果生产槽中已存在部署，则只能将新的过渡部署分配到与生产槽相同的群集中。\n\n如果云服务所在的群集没有足够的物理计算资源用于满足部署请求，则会发生分配失败。\n,如果生产槽中存在现有的部署，将云服务部署到过渡槽为何有时失败并出现资源分配错误？,cloud services,https://docs.azure.cn/cloud-services/cloud-services-deployment-faq
部署云服务后，该服务通常会固定到特定的群集。 这意味着，纵向扩展/横向扩展现有的云服务时必须在同一群集中分配新实例。 如果群集接近容量限制或所需的 VM 大小/类型不可用，则请求可能会失败。,为何纵向扩展或横向扩展云服务部署有时会导致分配失败？,cloud services,https://docs.azure.cn/cloud-services/cloud-services-deployment-faq
进行新的目标为空云服务的部署时，可以通过该区域任何群集中的结构对部署进行分配，除非已将云服务固定到地缘组。 将会在相同的群集中尝试部署到相同的地缘组。 如果群集已接近容量限制，则请求可能失败。,为何将云服务部署到地缘组有时会导致分配失败？,cloud services,https://docs.azure.cn/cloud-services/cloud-services-deployment-faq
数据中心内的群集可能使用不同的计算机类型配置（例如，A 系列、Av2 系列、D 系列、Dv2 系列，等等）。 但是，并非所有群集都一定要包含所有类型的 VM。 例如，如果尝试将 D 系列 VM 添加到已在仅限 A 系列的群集中部署的云服务，则会发生分配失败。 如果尝试更改 VM SKU 大小（例如，从 A 系列切换到 D 系列），也会发生此问题。,为何更改 VM 大小或将新 VM 添加到现有云服务有时会导致分配失败？,cloud services,https://docs.azure.cn/cloud-services/cloud-services-deployment-faq
"\n\n如果需要分配的资源超过区域/数据中心级别的服务允许的默认或最大配额，部署云服务可能会失败。 有关详细信息，请参阅[云服务限制](https://docs.azure.cn/azure-subscription-service-limits#cloud-services-limits)。\n\n也可以在门户中跟踪订阅的当前用量/配额：Azure 门户 = >""订阅""=>  =>""用量 + 配额""。\n\n",部署云服务时，有时为何由于订阅或服务上的限制/配额/约束而发生失败？,cloud services,https://docs.azure.cn/cloud-services/cloud-services-deployment-faq
\n\n在不重新部署的情况下，无法更改已部署的云服务的 VM 大小。 VM 大小内置在 CSDEF 中，只能通过重新部署来更新。\n\n有关详细信息，请参阅[如何更新云服务](https://docs.azure.cn/cloud-services/cloud-services-update-azure-service)\n,如何更改已部署的云服务 VM 的大小而不用重新部署它？,cloud services,https://docs.azure.cn/cloud-services/cloud-services-deployment-faq
\n\n由于云服务不是直接与 Azure 资源管理器模型兼容的经典资源，因此不能将其与 Azure 资源管理器存储帐户相关联。 下面是几个选项： \n\n*   \n\n通过 REST API 部署。\n\n 通过服务管理 REST API 部署时，可以通过指定指向 blob 存储（同时使用经典和 Azure 资源管理器存储帐户）的 SAS URL 绕过限制。 在[此处](https://msdn.microsoft.com/library/azure/ee460813.aspx)阅读有关 PackageUrl 属性的详细信息。\n\n*   \n\n通过 [Azure 门户](https://portal.azure.cn/)部署。\n\n 这将从 [Azure 门户](https://portal.azure.cn/)进行，因为调用将通过一个代理/填充程序完成，该代理/填充程序使得 Azure 资源管理器可以与经典资源通信。 \n,使用 Azure 资源管理器存储帐户时，为什么不能够通过服务管理 API 或 PowerShell 部署云服务？,cloud services,https://docs.azure.cn/cloud-services/cloud-services-deployment-faq
\n\n答：手写识别操作以独行的形式返回此类文本。\n\n问：手写识别技术如何处理划掉的单词或行？\n\n答：如果使用多条删除线划掉了单词，以至无法识别这些单词，则手写识别操作不会拾取这些单词。 但是，如果单词是使用单条删除线划掉的，则这种划线被视为干扰元素，手写识别操作仍会拾取这些单词。\n\n问：手写识别技术支持哪些文本方向？\n\n答：手写识别操作可以拾取朝向最大约为 30 度到 40 度角排列的文本。\n,问：手写识别技术如何处理在一行中间使用脱字号插入的文本？,Computer-vision,https://docs.azure.cn/cognitive-services/Computer-vision/FAQ
答：手写识别操作可以拾取朝向最大约为 30 度到 40 度角排列的文本。,问：手写识别技术支持哪些文本方向？,Computer-vision,https://docs.azure.cn/cognitive-services/Computer-vision/FAQ
\n\n答：如果使用多条删除线划掉了单词，以至无法识别这些单词，则手写识别操作不会拾取这些单词。 但是，如果单词是使用单条删除线划掉的，则这种划线被视为干扰元素，手写识别操作仍会拾取这些单词。\n\n问：手写识别技术支持哪些文本方向？\n\n答：手写识别操作可以拾取朝向最大约为 30 度到 40 度角排列的文本。\n,问：手写识别技术如何处理划掉的单词或行？,Computer-vision,https://docs.azure.cn/cognitive-services/Computer-vision/FAQ
"\n\n答：所需的时间取决于文本长度。 对于较长的文本，可能要花费几秒钟时间。 因此，在完成""识别手写文本""操作后，可能需要等待一段时间，然后才能使用""获取手写文本操作结果""操作检索结果。\n\n问：手写识别技术如何处理在一行中间使用脱字号插入的文本？\n\n答：手写识别操作以独行的形式返回此类文本。\n\n问：手写识别技术如何处理划掉的单词或行？\n\n答：如果使用多条删除线划掉了单词，以至无法识别这些单词，则手写识别操作不会拾取这些单词。 但是，如果单词是使用单条删除线划掉的，则这种划线被视为干扰元素，手写识别操作仍会拾取这些单词。\n\n问：手写识别技术支持哪些文本方向？\n\n答：手写识别操作可以拾取朝向最大约为 30 度到 40 度角排列的文本。\n",问：手写识别操作需要多长时间？,Computer-vision,https://docs.azure.cn/cognitive-services/Computer-vision/FAQ
"\n\n答：视觉 API 通过 OCR 提供良好的文本检测，但目前未针对牌照进行优化。 我们正在不断尝试改进服务，并在功能请求列表中添加了用于自动识别牌照的 OCR。\n\n问：手写识别支持哪些语言？\n\n答：目前仅支持英语。\n\n问：手写识别支持哪些类型的书写表面？\n\n答：该技术适用于不同种类的表面，包括白板、白纸和黄色便笺。\n\n问：手写识别操作需要多长时间？\n\n答：所需的时间取决于文本长度。 对于较长的文本，可能要花费几秒钟时间。 因此，在完成""识别手写文本""操作后，可能需要等待一段时间，然后才能使用""获取手写文本操作结果""操作检索结果。\n\n问：手写识别技术如何处理在一行中间使用脱字号插入的文本？\n\n答：手写识别操作以独行的形式返回此类文本。\n\n问：手写识别技术如何处理划掉的单词或行？\n\n答：如果使用多条删除线划掉了单词，以至无法识别这些单词，则手写识别操作不会拾取这些单词。 但是，如果单词是使用单条删除线划掉的，则这种划线被视为干扰元素，手写识别操作仍会拾取这些单词。\n\n问：手写识别技术支持哪些文本方向？\n\n答：手写识别操作可以拾取朝向最大约为 30 度到 40 度角排列的文本。\n",问：是否可以使用计算机视觉来读取牌照？,Computer-vision,https://docs.azure.cn/cognitive-services/Computer-vision/FAQ
"\n\n答：目前仅支持英语。\n\n问：手写识别支持哪些类型的书写表面？\n\n答：该技术适用于不同种类的表面，包括白板、白纸和黄色便笺。\n\n问：手写识别操作需要多长时间？\n\n答：所需的时间取决于文本长度。 对于较长的文本，可能要花费几秒钟时间。 因此，在完成""识别手写文本""操作后，可能需要等待一段时间，然后才能使用""获取手写文本操作结果""操作检索结果。\n\n问：手写识别技术如何处理在一行中间使用脱字号插入的文本？\n\n答：手写识别操作以独行的形式返回此类文本。\n\n问：手写识别技术如何处理划掉的单词或行？\n\n答：如果使用多条删除线划掉了单词，以至无法识别这些单词，则手写识别操作不会拾取这些单词。 但是，如果单词是使用单条删除线划掉的，则这种划线被视为干扰元素，手写识别操作仍会拾取这些单词。\n\n问：手写识别技术支持哪些文本方向？\n\n答：手写识别操作可以拾取朝向最大约为 30 度到 40 度角排列的文本。\n",问：手写识别支持哪些语言？,Computer-vision,https://docs.azure.cn/cognitive-services/Computer-vision/FAQ
"\n\n答：该技术适用于不同种类的表面，包括白板、白纸和黄色便笺。\n\n问：手写识别操作需要多长时间？\n\n答：所需的时间取决于文本长度。 对于较长的文本，可能要花费几秒钟时间。 因此，在完成""识别手写文本""操作后，可能需要等待一段时间，然后才能使用""获取手写文本操作结果""操作检索结果。\n\n问：手写识别技术如何处理在一行中间使用脱字号插入的文本？\n\n答：手写识别操作以独行的形式返回此类文本。\n\n问：手写识别技术如何处理划掉的单词或行？\n\n答：如果使用多条删除线划掉了单词，以至无法识别这些单词，则手写识别操作不会拾取这些单词。 但是，如果单词是使用单条删除线划掉的，则这种划线被视为干扰元素，手写识别操作仍会拾取这些单词。\n\n问：手写识别技术支持哪些文本方向？\n\n答：手写识别操作可以拾取朝向最大约为 30 度到 40 度角排列的文本。\n",问：手写识别支持哪些类型的书写表面？,Computer-vision,https://docs.azure.cn/cognitive-services/Computer-vision/FAQ
"\n\n答：支持的语言包括：\n支持的语言丹麦语 (da-DK)荷兰语 (nl-NL)英语芬兰语 (fi-FI)法语 (fr-FR)德语 (de-DE)希腊语 (el-GR)匈牙利语 (hu-HU)意大利语 (it-IT)日语 (ja-JP)韩语 (ko-KR)挪威语 (nb-NO)波兰语 (pl-PL)葡萄牙语 (pt-BR) (pt-PT)俄语 (ru-RU)西班牙语 (es-ES)瑞典语 (sv-SV)土耳其语 (tr-TU)\n\n问：是否可以使用计算机视觉来读取牌照？\n\n答：视觉 API 通过 OCR 提供良好的文本检测，但目前未针对牌照进行优化。 我们正在不断尝试改进服务，并在功能请求列表中添加了用于自动识别牌照的 OCR。\n\n问：手写识别支持哪些语言？\n\n答：目前仅支持英语。\n\n问：手写识别支持哪些类型的书写表面？\n\n答：该技术适用于不同种类的表面，包括白板、白纸和黄色便笺。\n\n问：手写识别操作需要多长时间？\n\n答：所需的时间取决于文本长度。 对于较长的文本，可能要花费几秒钟时间。 因此，在完成""识别手写文本""操作后，可能需要等待一段时间，然后才能使用""获取手写文本操作结果""操作检索结果。\n\n问：手写识别技术如何处理在一行中间使用脱字号插入的文本？\n\n答：手写识别操作以独行的形式返回此类文本。\n\n问：手写识别技术如何处理划掉的单词或行？\n\n答：如果使用多条删除线划掉了单词，以至无法识别这些单词，则手写识别操作不会拾取这些单词。 但是，如果单词是使用单条删除线划掉的，则这种划线被视为干扰元素，手写识别操作仍会拾取这些单词。\n\n问：手写识别技术支持哪些文本方向？\n\n答：手写识别操作可以拾取朝向最大约为 30 度到 40 度角排列的文本。\n",问：计算机视觉支持哪些语言？,Computer-vision,https://docs.azure.cn/cognitive-services/Computer-vision/FAQ
"\n\n答：我们目前不提供本地解决方案。\n\n问：计算机视觉支持哪些语言？\n\n答：支持的语言包括：\n支持的语言丹麦语 (da-DK)荷兰语 (nl-NL)英语芬兰语 (fi-FI)法语 (fr-FR)德语 (de-DE)希腊语 (el-GR)匈牙利语 (hu-HU)意大利语 (it-IT)日语 (ja-JP)韩语 (ko-KR)挪威语 (nb-NO)波兰语 (pl-PL)葡萄牙语 (pt-BR) (pt-PT)俄语 (ru-RU)西班牙语 (es-ES)瑞典语 (sv-SV)土耳其语 (tr-TU)\n\n问：是否可以使用计算机视觉来读取牌照？\n\n答：视觉 API 通过 OCR 提供良好的文本检测，但目前未针对牌照进行优化。 我们正在不断尝试改进服务，并在功能请求列表中添加了用于自动识别牌照的 OCR。\n\n问：手写识别支持哪些语言？\n\n答：目前仅支持英语。\n\n问：手写识别支持哪些类型的书写表面？\n\n答：该技术适用于不同种类的表面，包括白板、白纸和黄色便笺。\n\n问：手写识别操作需要多长时间？\n\n答：所需的时间取决于文本长度。 对于较长的文本，可能要花费几秒钟时间。 因此，在完成""识别手写文本""操作后，可能需要等待一段时间，然后才能使用""获取手写文本操作结果""操作检索结果。\n\n问：手写识别技术如何处理在一行中间使用脱字号插入的文本？\n\n答：手写识别操作以独行的形式返回此类文本。\n\n问：手写识别技术如何处理划掉的单词或行？\n\n答：如果使用多条删除线划掉了单词，以至无法识别这些单词，则手写识别操作不会拾取这些单词。 但是，如果单词是使用单条删除线划掉的，则这种划线被视为干扰元素，手写识别操作仍会拾取这些单词。\n\n问：手写识别技术支持哪些文本方向？\n\n答：手写识别操作可以拾取朝向最大约为 30 度到 40 度角排列的文本。\n",问：是否可以在不连接 Internet 的情况下在本地使用计算机视觉？,Computer-vision,https://docs.azure.cn/cognitive-services/Computer-vision/FAQ
"\n\n答：使用无遮挡、完整的正面人脸图像可以获取最佳结果。 使用不完整的正面人脸图像会降低可靠性，在人脸被旋转 45 度或以上的图像中，情感 API 可能识别不到情感。\n\n问：情感 API 可以识别多少种情感？\n\n答：情感 API 识别八个不同的、全球认可的情感： \n\n*   快乐\n*   悲伤\n*   惊讶\n*   愤怒\n*   恐惧\n*   蔑视\n*   厌恶 \n*   中性 \n\n问：是否有任何方法可将实时视频流传递到该 API 并同时获取结果？\n\n答：使用基于图像的情感 API，并针对每个帧调用该 API，或跳帧以提高性能。 我们提供了视频逐帧分析示例。\n\n问：我正在传入二进制图像数据，但出现消息：""人脸图像无效""。*\n\n答：这意味着算法在分析图像时出现问题。 \n\n*   支持的输入图像格式包括 JPEG、PNG、GIF（第一帧）和 BMP。 \n*   图像文件的大小不应超过 4MB\n*   可检测的面部大小范围为 36x36 到 4096x4096 像素。 不会检测超过此范围的人脸\n*   某些人脸可能因技术难题而无法检测，例如非常大的人脸角度（头部姿势），以及较大的阻挡物。 正面和接近正面的人脸可提供最佳效果",问：情感 API 能够从哪些类型的图像中返回最佳结果？,Emotion,https://docs.azure.cn/cognitive-services/Emotion/FAQ
"\n\n答：情感 API 识别八个不同的、全球认可的情感： \n\n*   快乐\n*   悲伤\n*   惊讶\n*   愤怒\n*   恐惧\n*   蔑视\n*   厌恶 \n*   中性 \n\n问：是否有任何方法可将实时视频流传递到该 API 并同时获取结果？\n\n答：使用基于图像的情感 API，并针对每个帧调用该 API，或跳帧以提高性能。 我们提供了视频逐帧分析示例。\n\n问：我正在传入二进制图像数据，但出现消息：""人脸图像无效""。*\n\n答：这意味着算法在分析图像时出现问题。 \n\n*   支持的输入图像格式包括 JPEG、PNG、GIF（第一帧）和 BMP。 \n*   图像文件的大小不应超过 4MB\n*   可检测的面部大小范围为 36x36 到 4096x4096 像素。 不会检测超过此范围的人脸\n*   某些人脸可能因技术难题而无法检测，例如非常大的人脸角度（头部姿势），以及较大的阻挡物。 正面和接近正面的人脸可提供最佳效果",问：情感 API 可以识别多少种情感？,Emotion,https://docs.azure.cn/cognitive-services/Emotion/FAQ
"\n\n答：使用基于图像的情感 API，并针对每个帧调用该 API，或跳帧以提高性能。 我们提供了视频逐帧分析示例。\n\n问：我正在传入二进制图像数据，但出现消息：""人脸图像无效""。*\n\n答：这意味着算法在分析图像时出现问题。 \n\n*   支持的输入图像格式包括 JPEG、PNG、GIF（第一帧）和 BMP。 \n*   图像文件的大小不应超过 4MB\n*   可检测的面部大小范围为 36x36 到 4096x4096 像素。 不会检测超过此范围的人脸\n*   某些人脸可能因技术难题而无法检测，例如非常大的人脸角度（头部姿势），以及较大的阻挡物。 正面和接近正面的人脸可提供最佳效果",问：是否有任何方法可将实时视频流传递到该 API 并同时获取结果？,Emotion,https://docs.azure.cn/cognitive-services/Emotion/FAQ
根据设计，Azure Cosmos DB 是一个全局分布式的、基于 SLA 的系统，在可用性、延迟和吞吐量方面提供保证。 如果在 Azure Cosmos DB 中保留吞吐量，吞吐量就会获得保证，这与其他系统的吞吐量有所不同。 Azure Cosmos DB 会根据客户请求提供额外功能，例如辅助索引和全局分发。,Azure 表存储对我而言非常便宜，因为我只需支付数据的存储费用，并且我很少进行查询。 但是，即使我未执行任何事务或存储任何数据，Azure Cosmos DB 表 API 服务似乎也要收费。 能否请你解释一下？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是的。 由于表 API 的外围应用类似于 Azure 表存储 SDK，因此使用分区键可以高效地分发数据。 行键在该分区中是唯一的。 行键必须存在，且不能为 null（在标准 SDK 中可为 null）。 RowKey 的长度为 255 个字节，PartitionKey 的长度为 1 KB。,表 API 是否仍然需要 PartitionKey 和 RowKey？,cosmos db,https://docs.azure.cn/cosmos-db/faq
Azure 表存储和 Azure Cosmos DB 表 API 使用相同的 SDK，因此，大多数错误是相同的。,表 API 的错误消息有哪些？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\nAzure Cosmos DB 是基于 SLA 的系统，在可用性、延迟和吞吐量方面提供保障。 由于它是预配的系统，因此会保留资源来保证满足这些要求。 以极快的频率创建表会被系统检测到，因此会受到限制。 建议你查看表的创建频率，将其降到每分钟 5 个表以下。 请记住，表 API 是预配的系统。 计费从预配那一刻开始。 \n\n ## 使用 Apache Cassandra API（预览版）进行开发\n,在表 API 中尝试一个接一个地创建许多表时，为何会受到限制？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"\n\nAzure Cosmos DB 使用每秒请求单位数 (RU/s) 作为所提供的吞吐量的单位。 通过 CQL 创建的表具有 400 RU。 可以通过门户更改 RU。 \n\nCQL\n\n`CREATE TABLE keyspaceName.tablename (user_id int PRIMARY KEY, lastname text) WITH cosmosdb_provisioned_throughput=1200 `\n\n.NET\n\nint provisionedThroughput = 400; var simpleStatement = new SimpleStatement($""CREATE TABLE {keyspaceName}.{tableName} (user_id int PRIMARY KEY, lastname text)""); var outgoingPayload = new Dictionary(); outgoingPayload[""cosmosdb_provisioned_throughput""] = Encoding.UTF8.GetBytes(provisionedThroughput.ToString()); simpleStatement.SetOutgoingPayload(outgoingPayload); \n",通过 CQL 创建的表的默认吞吐量是多少 RU/s？ 如何更改该默认值？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\nAzure Cosmos DB 根据表的创建位置（门户或 CQL）设置容器的默认吞吐量。 Azure Cosmos DB 针对操作设置上限，在性能和延迟方面提供保证。 如果引擎可以针对租户的操作实施调控，则可以提供这样的保证。 设置吞吐量可确保在吞吐量和延迟方面获得保障，因为平台会保留此容量，并保证操作成功。 可以弹性更改吞吐量以便使季节性应用受益并节省成本。\n\n[Azure Cosmos DB 中的请求单位数](https://docs.azure.cn/cosmos-db/request-units)一文介绍了吞吐量概念。 表的吞吐量平均分布到各个基础物理分区中。 \n,为何要求选择表的吞吐量？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"\n\n如果未在 app.config 文件中或通过门户提供吞吐量，Azure Cosmos DB 将为容器设置默认的吞吐量。 \n\nAzure Cosmos DB 针对操作设置上限，在性能和延迟方面提供保证。 如果引擎可以针对租户的操作实施调控，则可以提供这样的保证。 设置 TableThroughput 可确保吞吐量和延迟值得到保证，因为平台会保留相应的容量，保证操作成功。 \n\n考虑到应用程序在使用需求方面存在""季节性""，可以通过吞吐量规范来弹性更改吞吐量，在满足吞吐量需求的同时节省成本。\n",为何需要选择吞吐量而不是 PartitionKey 和 RowKey 来利用 Azure Cosmos DB 的表 API 服务？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"\n\nAzure Cosmos DB 针对操作设置上限，在性能和延迟方面提供保证。 如果引擎可以针对租户的操作实施调控，则可以提供这样的保证。 这可以通过设置吞吐量来实现，并可确保在吞吐量和延迟方面获得保障，因为平台会保留此容量，并保证操作成功。 当超出此容量时，会收到超载错误消息，指出已超出了容量。 0x1001 超载：无法处理此请求，因为""请求速率太大""。 此时，必须查明是哪些操作及其数据量导致了此问题。 可以通过门户中的指标了解超出了预配容量的已消耗容量。 然后，你需要确保容量差不多是在所有基础分区中平均消耗的。 如果你看到大多数吞吐量是由一个分区消耗的，则说明存在工作负载倾斜。 \n\n相关指标显示了吞吐量在若干小时内、若干天内以及每七天内在各个分区中的使用情况或总体使用情况。 有关详细信息，请参阅[使用 Azure Cosmos DB 中的指标进行监视和调试](https://docs.azure.cn/cosmos-db/use-metrics)。\n\n[Azure Cosmos DB 诊断日志记录](https://docs.azure.cn/cosmos-db/logging)一文中介绍了诊断日志。\n",超出吞吐量时，会发生什么情况？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是，分区键用来将实体放置在正确位置。 在 Azure Cosmos DB 中，它用来查找存储在物理分区中的正确逻辑分区。 [在 Azure Cosmos DB 中分区和缩放](https://docs.azure.cn/cosmos-db/partition-data)一文中很好地解释了分区概念。 此处，必须记住的一点是，逻辑分区目前不应当超出 10 GB 限制。,主键是否映射到 Azure Cosmos DB 的分区键概念？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\nAzure Cosmos DB 是基于 SLA 的系统，可提供无限缩放，并在延迟、吞吐量、可用性和一致性方面提供保障。 它的 Cassandra API 也允许无限制的数据存储。 此无限制的存储是通过使用分区作为键概念的数据水平横向扩展实现的。 [在 Azure Cosmos DB 中分区和缩放](https://docs.azure.cn/cosmos-db/partition-data)一文中很好地解释了分区概念。\n\n应当遵循每个逻辑分区的实体数或项数不超过 10 GB 的限制。 为确保应用程序能够很好地进行缩放，建议不要创建热分区，即，将所有信息存储在一个分区内并查询它。 只有当存在数据倾斜时，也就是说，当一个分区键有大量数据（即超过 10 GB）时，才会发生此错误。 可以使用存储门户查明数据的分布。 若要修复此错误，请重新创建表并选择一个细粒度的主键（分区键），这可以实现更好的数据分布。\n,"当收到指示分区已满的""配额已满""通知时，会发生什么情况？",cosmos db,https://docs.azure.cn/cosmos-db/faq
Azure Cosmos DB 的 Apache Cassandra API 目前支持 CQL 版本 4。,个人预览版支持哪个协议版本？ 是否打算支持其他协议？,cosmos db,https://docs.azure.cn/cosmos-db/faq
如果请求速率超出了为基础容器预配的吞吐量容量，则会出现错误，SDK 会使用重试策略重试调用。,如何在表 API 服务中处理对表设置的任何限制？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是的，如果未通过 app.config 替代 TableThroughput，并且未使用 Azure Cosmos DB 中预先创建的容器，则该服务将创建吞吐量为 400 的表。,新预配的表是否设置了默认的 TableThroughput？,cosmos db,https://docs.azure.cn/cosmos-db/faq
无。 对于现有的 Azure 表存储客户，价格上没有任何更改。,对于 Azure 表存储服务的现有客户，定价是否有任何变化？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是的，可以使用 Azure Cosmos DB 门户的缩放窗格来缩放吞吐量。 有关详细信息，请参阅[设置吞吐量](https://docs.azure.cn/cosmos-db/set-throughput),是否可以提高或降低表 API 表的吞吐量？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\n应在符合以下某个条件时，更改 TableThroughput：\n\n*   要对数据执行提取、转换和加载 (ETL) 操作，或者需在短时间内上传大量数据。 \n*   需要来自后端容器的更多吞吐量。 例如，发现已用吞吐量超过预配吞吐量，且吞吐量已达到限制。 有关详细信息，请参阅[为 Azure Cosmos DB 容器设置吞吐量](https://docs.azure.cn/cosmos-db/set-throughput)。,何时应更改表 API 的 TableThroughput？,cosmos db,https://docs.azure.cn/cosmos-db/faq
表 API 提供与 Azure 表存储相同的查询功能。 Azure Cosmos DB 还支持排序、聚合、地理空间查询、层次结构和各种内置函数。 在将来的服务更新中，我们会在表 API 中提供更多的功能。 有关详细信息，请参阅 [Azure Cosmos DB DocumentDB API 的 SQL 查询](https://docs.azure.cn/documentdb/documentdb-sql-query),平台形式的 Azure Cosmos DB 似乎有许多的功能，例如排序、聚合、分层等。 是否要向表 API 添加这些功能？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"\n\n是的，可以通过提供索引定义来更改索引策略。 有关详细信息，请参阅 [Azure Cosmos DB 功能](https://docs.azure.cn/cosmos-db/tutorial-develop-table-dotnet#azure-cosmos-db-capabilities)。 需要在 app.config 文件中使用字符串 json 格式 \n\n对于非 .NET SDK，只能在门户中设置索引策略，方法是：打开""数据资源管理器""，导航到想要更改的特定表，转到""缩放和设置""->""索引策略""，进行所需的更改，并单击""保存""。\n\n对于 .NET SDK，可以在 app.config 文件中提交更改：\n\n`{ ""indexingMode"": ""consistent"", ""automatic"": true, ""includedPaths"": [ { ""path"": ""/somepath"", ""indexes"": [ { ""kind"": ""Range"", ""dataType"": ""Number"", ""precision"": -1 }, { ""kind"": ""Range"", ""dataType"": ""String"", ""precision"": -1 } ] } ], ""excludedPaths"": [ { ""path"": ""/anotherpath"" } ] } `\n",是否可以更改索引策略？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是，Azure Cosmos DB 表 API 针对所有属性提供自动索引，无需任何架构定义。 这种自动化操作可以让开发人员将工作重点放在应用程序上，不必考虑索引的创建和管理。 有关详细信息，请参阅,这是否意味着，无需创建多个索引来满足查询要求？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"使用 Azure Cosmos DB 时，可以在容器级别（在表上）设置一致性级别。 使用 .NET SDK，可以通过在 app.config 文件中提供 TableConsistencyLevel 键值来更改级别。 可能的值：Strong、Bounded Staleness、Session、ConsistentPrefix、Eventual。 有关详细信息，请参阅 [Azure Cosmos DB 中可以优化的数据一致性级别](https://docs.azure.cn/cosmos-db/consistency-levels)。 关键是，在设置请求一致性级别时，不能超出表的设置。 例如，不能将表的一致性级别设置为""Eventual""，将请求一致性级别设置为""Strong""。",是否可以更改读取请求一致性级别？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是的，默认情况下会为实体的所有属性编制索引。 有关详细信息，请参阅,表 API 是否默认对实体的所有属性编制索引？,cosmos db,https://docs.azure.cn/cosmos-db/faq
可以，表 API 利用 Azure Cosmos DB 的平台进行备份。 可自动进行备份。 有关详细信息，请参阅[使用 Azure Cosmos DB 进行联机备份和还原](https://docs.azure.cn/cosmos-db/online-backup-and-restore),是否能够为表 API 启用备份？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\n表 API 利用 Cosmos DB 的多个区域分布式平台。 若要确保应用程序能够容许数据中心停机，请在 Azure Cosmos DB 门户中为帐户额外启用至少一个区域。详见[使用多区域 Azure Cosmos DB 帐户进行开发](https://docs.azure.cn/cosmos-db/regional-failover)。 可以使用门户设置区域的优先级。请参阅[使用多区域 Azure Cosmos DB 帐户进行开发](https://docs.azure.cn/cosmos-db/regional-failover)。 \n\n可以视需要为帐户添加任意数目的区域，并通过提供故障转移优先级来控制可将该帐户故障转移到哪个位置。 当然，若要使用数据库，还需在其中提供应用程序。 这样操作时，客户不会遇到停机的情况。 [最新的 .NET 客户端 SDK](https://docs.azure.cn/cosmos-db/table-sdk-dotnet)可自动寻址，但其他 SDK 则不可以。 换句话说，它能够检测到有故障的区域，并自动故障转移到新区域。\n,在某个区域出现故障时，表 API 如何处理故障转移？,cosmos db,https://docs.azure.cn/cosmos-db/faq
Azure Cosmos DB 可以通过对存储进行横向扩展来存储无限的数据。 这与吞吐量无关。 你始终可以仅使用 Cassandra API 通过指定正确的主键/分区键来存储和检索键/值。 这些单独的键获取其自己的逻辑分区并存在于物理分区之上，且不会出现问题。,是否可以将 Cassandra API 作为键值存储用于数百万或数十亿单独的分区键？,cosmos db,https://docs.azure.cn/cosmos-db/faq
价格取决于分配的 TableThroughput。,表 API 的价格是如何计算的？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是，可以使用 Apache Cassandra API 创建多个表。 这些表中的每一个都被视为用于吞吐量和存储的单元。,是否可以使用 Azure Cosmos DB 的 Apache Cassandra API 创建多个表？,cosmos db,https://docs.azure.cn/cosmos-db/faq
不需要进行任何更改。 类、命名空间和 NuGet 包名称都没有变化。 与往常一样，我们建议你使用最新的 SDK，以利用最新的功能和改进项目。,要进行哪些更改才能让应用配合 Azure Cosmos DB 工作？,cosmos db,https://docs.azure.cn/cosmos-db/faq
表数目没有物理限制，如果需要创建数量很多（远远超过平常的数十个或数百个）的表（其中，稳定的总大小超过 10 TB 数据），请向 [Azure Support](https://www.azure.cn/support/contact/) 发送电子邮件。,最多可以创建几个表？,cosmos db,https://docs.azure.cn/cosmos-db/faq
Azure Cosmos DB 会在本地区域持续提交数据，然后在几毫秒内将数据立即推送到其他区域。 这种形式的复制只取决于数据中心的往返时间 (RTT)。 若要详细了解 Azure Cosmos DB 的全局分发功能，请参阅 [Azure Cosmos DB：Azure 上的全局分布式数据库服务](https://docs.azure.cn/cosmos-db/distribute-data-globally),启用全局分发后，需要花费多长时间复制数据？,cosmos db,https://docs.azure.cn/cosmos-db/faq
没有，有关可用性、一致性、延迟和吞吐量的 SLA 都保持不变，并且仍会显示在门户中。 有关详细信息，请参阅 [SLA for Azure Cosmos DB](https://www.azure.cn/support/sla/cosmos-db/)（Azure Cosmos DB 的 SLA）。,SLA 是否有变化？,cosmos db,https://docs.azure.cn/cosmos-db/faq
没有，在 Azure Cosmos DB 上运行应用的费用与以前相同。,价格是否有变化？,cosmos db,https://docs.azure.cn/cosmos-db/faq
DocumentDB 不再以 Azure 服务的形式显示在门户中。 代替它的是新的 Azure Cosmos DB 图标，如下图所示。 可以像以前一样使用所有集合，并且仍可缩放吞吐量、更改一致性级别和监视 SLA。 数据资源管理器（预览）的功能已得到增强。 现在，可以在一个页面中查看和编辑文档、创建和运行查询，以及使用存储过程、触发器和 UDF，如下图所示：,Azure 门户有哪些变化？,cosmos db,https://docs.azure.cn/cosmos-db/faq
不需要进行任何更改。 DocumentDB 资源现在称为 Azure Cosmos DB 资源，过渡后，服务不会发生任何中断。,如何确保 DocumentDB 资源可继续在 Azure Cosmos DB 上运行？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"\n\nAzure Cosmos DB 是全局分布式大规模云数据库的重大飞跃。 现在，DocumentDB 客户可以访问 Azure Cosmos DB 提供的突破性系统和功能。\n\nAzure Cosmos DB 在 2010 年以""Project Florence""的名义开始解决我们内部负责构建大型应用程序的开发人员所面临的难题。 构建全局分布式应用并不是只有我们才会遇到的难题，因此我们在 2015 年以 Azure DocumentDB 的形式向 Azure 开发人员提供了与此相关的第一代技术。 \n\n自此之后，我们添加了新的特性，并引入了重要的新功能。 成果就是 Azure Cosmos DB。 此版本的一项功能是允许 DocumentDB 客户自动且无缝地成为 Azure Cosmos DB 客户，不会丢失其数据。 这些功能涉及的领域包括核心数据库引擎以及全局分发、弹性可伸缩性，并享有行业领先的全面 SLA 保障。 具体而言，我们已改进了 Azure Cosmos DB 数据库引擎，使其能够有效地将所有热门数据模型、类型系统和 API 映射到 Azure Cosmos DB 的基础数据模型。 \n\n对于开发人员而言，此项工作的最新成果包括对[表存储 API](https://docs.azure.cn/cosmos-db/table-introduction) 的全新支持。 而这只是开端。 我们计划不断添加其他常用 API 和更新的数据模型，为多个区域规模的性能和存储技术带来更多进步。 \n\n必须指出的是，DocumentDB 的 [SQL 语言](https://docs.azure.cn/documentdb/documentdb-sql-query)始终是基础 Azure Cosmos DB 能够支持的多种 API 之一。 开发人员使用 Azure Cosmos DB 等完全托管的服务时，该服务的唯一接口就是该服务公开的 API。 现有 DocumentDB 客户在操作时与以往其实并无不同。 Azure Cosmos DB 提供的 SQL API 与 DocumentDB 提供的完全相同。 我们会在现在（以及未来）向你提供以前接触不到的其他功能。 \n\n我们持续努力的另一个成果是扩建了吞吐量和存储的全局分发与弹性缩放的基础。 我们对全局分发子系统做了几项基础性的增强。 在许多可供开发人员使用的功能中，其中之一就是前缀一致性模型（总共提供五个定义完善的一致性模型）。 我们还有许多其他的有用功能，一旦其成熟就会发布。 \n",为何要改用 Azure Cosmos DB？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\n请通过 [uservoice 反馈](https://feedback.azure.com/forums/263030-azure-cosmos-db)提供反馈。\n\n## 来自 DocumentDB 客户的问题\n\n,常规 Cassandra API 的功能 x 目前不工作，可以在哪里提供反馈？,cosmos db,https://docs.azure.cn/cosmos-db/faq
Apache Cassandra API 提供了与 Apache Cassandra 相同的 CQL 功能。 我们确实打算研究在将来支持各种功能的可行性。,平台形式的 Azure Cosmos DB 似乎拥有许多功能，例如，更改源和其他功能。 这些功能是否将添加到 Cassandra API 中？,cosmos db,https://docs.azure.cn/cosmos-db/faq
我们计划在将来支持此功能。,是否可以在本地将新的 Cassandra API SDK 用于模拟器？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是的，Azure Cosmos DB 针对所有属性提供自动索引，无需任何架构定义。 这种自动化操作可以让开发人员将工作重点放在应用程序上，不必考虑索引的创建和管理。 有关详细信息，请参阅,这是否意味着，无需创建多个索引来满足查询要求？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是，默认情况下 Azure Cosmos DB 会对实体的所有属性进行索引。 有关详细信息，请参阅 [Azure Cosmos DB：索引策略](https://docs.azure.cn/cosmos-db/indexing-policies)。 这样始终可以获得有保障的性能，以及一致的索引和持久的仲裁提交写入。,Apache Cassandra API 是否默认对实体的所有属性编制索引？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\nAzure Cosmos DB Cassandra API 借助 Azure Cosmos DB 的多个区域分布式平台。 若要确保应用程序能够容许数据中心停机，请在 Azure Cosmos DB 门户中为帐户额外启用至少一个区域。详见[使用多区域 Azure Cosmos DB 帐户进行开发](https://docs.azure.cn/cosmos-db/regional-failover)。 可以使用门户设置区域的优先级。请参阅[使用多区域 Azure Cosmos DB 帐户进行开发](https://docs.azure.cn/cosmos-db/regional-failover)。 \n\n可以视需要为帐户添加任意数目的区域，并通过提供故障转移优先级来控制可将该帐户故障转移到哪个位置。 若要使用数据库，还需要在那里提供一个应用程序。 这样操作时，客户不会遇到停机的情况。 \n,当某个区域出现故障时，Cassandra API 帐户如何处理故障转移？,cosmos db,https://docs.azure.cn/cosmos-db/faq
Azure Cosmos DB 的所有 API 目前都提供间隔四小时的两个免费完整备份。 这可确保你不需要设置备份计划等等。如果希望修改保留期和频率，请向 [Azure Support](https://www.azure.cn/support/contact/) 发送邮件或提交支持案例。 [Azure Cosmos DB 的自动联机备份和还原](https://docs.azure.cn/cosmos-db/online-backup-and-restore)一文中提供了有关备份功能的信息。,Cassandra API 是否提供完整备份？,cosmos db,https://docs.azure.cn/cosmos-db/faq
目前，Azure Cosmos DB 针对云环境提供了优化的体验，且不产生操作开销。 如果需要配对，请向 [Azure Support](https://www.azure.cn/support/contact/) 发送邮件并在其中提供你的方案的说明。,本地 Cassandra 群集是否可与 Azure Cosmos DB 的 Apache Cassandra API 配对？,cosmos db,https://docs.azure.cn/cosmos-db/faq
否，预览版不支持 sstable 加载程序。,是否可以使用 sstable 加载程序加载数据？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是的，可以使用正则语法创建复合分区键。,是否支持复合主键？,cosmos db,https://docs.azure.cn/cosmos-db/faq
在个人预览版中，Apache Cassandra SDK 的使用 CQLv3 的客户端驱动程序用于客户端程序。 如果你使用其他驱动程序或者遇到问题，请向 [Azure Support](https://www.azure.cn/support/contact/) 发送邮件。,哪些客户端 SDK 适用于 Azure Cosmos DB 的 Apache Cassandra API？,cosmos db,https://docs.azure.cn/cosmos-db/faq
Azure Cosmos DB 是一个平台服务，可帮助你提高工作效率，而无需担心如何管理和监视基础结构。 你只需要在门户指标中关注可用的吞吐量，以查明你是否受到限制并增大或减小该吞吐量。 监视 [SLA](https://docs.azure.cn/cosmos-db/monitor-accounts)。 使用[指标](https://docs.azure.cn/cosmos-db/use-metrics) 使用[诊断日志](https://docs.azure.cn/cosmos-db/logging)。,以前是否可以使用各种工具监视节点状态、副本状态、gc 和 OS 参数？ 现在需要监视什么？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是的，支持 TTL。,Cassandra 表是否支持生存时间 (TTL)？,cosmos db,https://docs.azure.cn/cosmos-db/faq
Azure Cosmos DB 为读/写操作提供性能和吞吐量，无需更改任何配置设置，也不会意外处理这些设置。,布隆筛选器、缓存、读取修复更改、gc_grace 和 compression memtable_flush_period 等表元数据的各项设置有什么变化？,cosmos db,https://docs.azure.cn/cosmos-db/faq
出于可用性和低延迟的原因，Azure Cosmos DB 提供现成的全局分发。 不需要设置副本等等。所有写入均在你进行写入的区域中经过仲裁永久认可，同时提供性能保障。,有关创建键空间的各项配置设置（例如简单/网络）会是怎样的？,cosmos db,https://docs.azure.cn/cosmos-db/faq
Apache Cassandra API 是一项平台服务，使用它可以轻松做出容量规划，以及应对吞吐量和存储方面的弹性需求。 借助 Azure Cosmos DB，可以预配所需的吞吐量。 然后，可以在一整天中多次上调和下调吞吐量，而无需担心如何添加/删除或管理节点。 这意味着也不需要使用节点、群集管理工具。,Azure Cosmos DB 的 Apache Cassandra API 是否支持节点添加/群集状态/节点状态命令？,cosmos db,https://docs.azure.cn/cosmos-db/faq
Azure Cosmos DB 的 Apache Cassandra API 是一项平台服务。 它提供协议级的兼容性来执行操作。 它消除了管理、监视和配置的复杂性。 开发人员/用户无需担心可用性、逻辑删除、键缓存、行缓存、布隆筛选器和其他许多设置。 Azure Cosmos DB 的 Apache Cassandra API 注重于提供所需的读取和写入性能，不会产生配置和管理开销。,是否可以提供 yaml 文件设置来配置 Azure Cosmos DB 的 Apache Casssandra API 行为？,cosmos db,https://docs.azure.cn/cosmos-db/faq
存储容量是自动管理的，推入更多的数据时，存储容量将会增大。 因此，您可以放心地导入所需数量的数据，不需要管理和预配节点等等。,从普通的表启动后，是否可以引入大量数据？,cosmos db,https://docs.azure.cn/cosmos-db/faq
键空间数目没有物理限制，因为它们是元数据容器，如果由于某种原因，你有大量的键空间，请向 [Azure Support](https://www.azure.cn/support/contact/) 发送电子邮件。,最多可以创建多少个键空间？,cosmos db,https://docs.azure.cn/cosmos-db/faq
Azure Cosmos DB 是资源调控的系统，适用于数据和控制平面活动。 与集合和表一样，容器是针对给定的吞吐量容量预配的运行时实体。 快速连续创建这些容器是非预期的活动，会被限制。 如果存在立即删除/创建表的测试，请尽量将它们隔开。,是否可以连续创建多个表？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是的。若要了解如何利用 Azure Cosmos DB 的分布式特性，请参阅[一致性级别](https://docs.azure.cn/cosmos-db/consistency-levels)。 由于一致性级别有充分的保证，因此可以放心使用。 有关详细信息，请参阅 [Azure Cosmos DB 功能](https://docs.azure.cn/cosmos-db/tutorial-develop-table-dotnet#azure-cosmos-db-capabilities),Azure Cosmos DB 表 API 是否比 Azure 表存储提供更多的一致性级别？,cosmos db,https://docs.azure.cn/cosmos-db/faq
Azure Cosmos DB 是基于 SLA 的系统，可提供无限缩放，并在延迟、吞吐量、可用性和一致性方面提供保证。 请确保数据大小和索引可管理且可缩放，这样才能获得有保障的高级性能。 针对每个分区键的实体或项数实施 10 GB 限制是为了确保提供优异的查找和查询性能。 若要确保即使针对 Azure 存储，应用程序也能很好地进行缩放，建议不要创建热分区，即，将所有信息存储在一个分区内并查询它。,"在向 Azure 表存储引入数据时，我从未收到过""配额已满""通知（指示分区已满）。 但使用表 API 时会收到此消息。 是此产品有限制，迫使我更改现有的应用程序吗？",cosmos db,https://docs.azure.cn/cosmos-db/faq
请使用 app.config 文件中的 PreferredLocation 键，方便从本地位置读取。 对于现有应用程序，如果设置 LocationMode，表 API 会引发错误。 请删除该代码，因为表 API 会从 app.config 文件中选取此信息。 有关详细信息，请参阅,如何配置首选的读取区域以降低分配数据时的延迟？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"\n\nDocumentDB API 支持通过 HTTP 实体标记（也称 ETag）来实现乐观并发控制 (OCC)。 每个 DocumentDB API 资源都有一个 ETag。每次更新文档时，都会在服务器上设置此 ETag。 ETag 标头和当前值包含在所有响应消息中。 ETag 可与 If-Match 标头配合使用，让服务器决定是否应更新资源。 If-Match 值是用作检查依据的 ETag 值。 如果 ETag 值与服务器的 ETag 值匹配，就会更新资源。 如果 ETag 不再是最新状态，则服务器会拒绝该操作，并提供""HTTP 412 不满足前提条件""响应代码。 客户端接着会重新提取资源，以获取该资源当前的 ETag 值。 此外，ETag 可以与 If-None-Match 标头配合使用，以确定是否需重新提取资源。\n\n若要在 .NET 中使用乐观并发，可以使用 [AccessCondition](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.client.accesscondition.aspx) 类。 如需 .NET 示例，请参阅 GitHub 上 DocumentManagement 示例中的 [Program.cs](https://github.com/Azure/azure-documentdb-dotnet/blob/master/samples/code-samples/DocumentManagement/Program.cs)\n",DocumentDB API 如何提供并发性？,cosmos db,https://docs.azure.cn/cosmos-db/faq
SQL 查询语言是 SQL 支持的查询功能增强子集。 Azure Cosmos DB SQL 查询语言通过基于 JavaScript 的用户定义函数 (UDF)，提供丰富的分层和关系运算符以及可扩展性。 JSON 语法允许将 JSON 文档模型化为带标签节点的树状，由 Azure Cosmos DB 的自动索引技术及 Azure Cosmos DB 的 SQL 查询方言使用。 若要了解如何使用 SQL 语法，请参阅 [QueryDocumentDB](https://docs.azure.cn/cosmos-db/documentdb-sql-query) 一文。,DocumentDB API 是否支持 SQL？,cosmos db,https://docs.azure.cn/cosmos-db/faq
可以使用某个 [Cosmos DB API SDK](https://docs.azure.cn/cosmos-db/documentdb-sdk-dotnet) 或 [REST API](https://docs.microsoft.com/rest/api/documentdb/) 来创建用户和权限。,我如何设置用户和权限？,cosmos db,https://docs.azure.cn/cosmos-db/faq
可以使用 [Azure 门户](https://portal.azure.cn/)（详见[添加集合](https://docs.azure.cn/cosmos-db/create-documentdb-dotnet#create-collection)中所述）、某个 [Azure Cosmos DB SDK](https://docs.azure.cn/cosmos-db/documentdb-sdk-dotnet) 或 [REST API](https://docs.microsoft.com/rest/api/documentdb/) 来创建数据库。,我如何创建数据库？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\n集合是一组文档及其关联的 JavaScript 应用程序逻辑。 集合是一个计费实体，其[成本](https://docs.azure.cn/cosmos-db/performance-levels)取决于吞吐量和所用存储。 集合可以跨一个或多个分区或服务器，并且可以通过伸缩处理几乎无限制增长的存储或吞吐量。\n\n集合也是 Azure Cosmos DB 的计费实体。 每个集合根据预配的吞吐量和已用的存储空间按小时计费。 有关详细信息，请参阅 [Azure Cosmos DB 定价](https://www.azure.cn/pricing/details/cosmos-db/)\n,什么是集合？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"是的，DocumentDB API 支持以 JavaScript 存储过程和触发器形式表示的跨文档事务。 事务以每个集合内的单个分区为范围，且以 ACID 语义执行，也就是""全或无""，与其他并发执行代码和用户请求隔离。 如果在服务器端执行 JavaScript 应用程序代码的过程中引发了异常，则会回滚整个事务。 有关事务的详细信息，请参阅[数据库程序事务](https://docs.azure.cn/cosmos-db/programming#database-program-transactions)",DocumentDB API 是否支持 ACID 事务？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是的，DocumentDB API 允许应用程序存储任意 JSON 文档，不需要架构定义或提示。 通过 Azure Cosmos DB SQL 查询接口可立即查询数据。,DocumentDB API 数据库是否支持无架构数据？,cosmos db,https://docs.azure.cn/cosmos-db/faq
GitHub 上提供 DocumentDB API [.NET](https://docs.azure.cn/cosmos-db/documentdb-dotnet-samples)、[Java](https://github.com/Azure/azure-documentdb-java)、[Node.js](https://docs.azure.cn/cosmos-db/documentdb-nodejs-samples) 和 [Python](https://docs.azure.cn/cosmos-db/documentdb-python-samples) SDK 的示例。,是否可以访问一些现成的示例来帮助自己入门？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\n提供 DocumentDB API。 首先必须注册 Azure 订阅。 注册 Azure 订阅后，即可将 DocumentDB API 容器添加到 Azure 订阅。 有关添加 Azure Cosmos DB 帐户的说明，请参阅[创建 Azure Cosmos DB 数据库帐户](https://docs.azure.cn/cosmos-db/create-documentdb-dotnet#create-account)。 如果以前已创建了一个 DocumentDB 帐户，则现在也有了一个 Azure Cosmos DB 帐户。 \n\n[SDK](https://docs.azure.cn/cosmos-db/documentdb-sdk-dotnet) 适用于 .NET、Python、Node.js、JavaScript 和 Java。 开发人员也可以利用 [RESTful HTTP API](https://docs.microsoft.com/rest/api/documentdb/)，从各种平台使用各种语言与 Azure Cosmos DB 资源进行交互。\n,如何开始针对 DocumentDB API 进行开发？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\nAzure Cosmos DB 存在于所有 Azure 区域，详见 [Azure 区域](https://www.azure.cn/support/service-dashboard/)页。 由于 Azure Cosmos DB 是核心服务，每个新数据中心都部署了它。 \n\n设置区域时，请记住，Azure Cosmos DB 遵从主权和政府云的要求。 也就是说，如果你在某个主权区域创建了一个帐户，则不能将数据从该主权区域复制到外部区域。 同样，你不能将数据从外部帐户复制到其他主权位置。 \n\n## 针对 DocumentDB API 进行开发\n\n,通过 Azure 数据中心在多个区域分配数据时需要注意什么？,cosmos db,https://docs.azure.cn/cosmos-db/faq
可以将 PreferredLocations 值设置为提供 Cosmos DB 的任何 Azure 区域。 有关可用区域的列表，请参阅 [Azure 区域](https://www.azure.cn/support/service-dashboard/),可以将 PreferredLocations 设置为哪些区域？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"主密钥是用于访问帐户的所有资源的安全令牌。 拥有此密钥的人对数据库帐户中的所有资源具有读取和写入访问权。 分发主密钥时需谨慎。 [Azure 门户](https://portal.azure.cn/)的""密钥""边栏选项卡中提供主要主密钥和辅助主密钥。 有关密钥的详细信息，请参阅[查看、复制和重新生成访问密钥](https://docs.azure.cn/cosmos-db/manage-account#keys)",什么是主密钥？,cosmos db,https://docs.azure.cn/cosmos-db/faq
可以在 Azure 门户中注册 Azure Cosmos DB。 首先，注册 Azure 订阅。 注册后即可将 Cosmos DB API、表 API 或 MongoDB API 帐户添加到 Azure 订阅。,如何注册 Azure Cosmos DB？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\n如需任何帮助，请在 [MSDN and CSDN](https://www.azure.cn/support/contact/)上联系我们，或者通过向 [Azure Support](https://www.azure.cn/support/contact/) 发送邮件安排与 Azure Cosmos DB 工程团队进行一对一交谈。 \n\n## 设置 Azure Cosmos DB\n\n,如何获取 Azure Cosmos DB 的更多帮助？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\n如果不熟悉 Azure，可以注册 [Azure 试用帐户](https://www.azure.cn/pricing/1rmb-trial/)，这样可以得到 30 天试用期和信用额度，以便试用所有 Azure 服务。 如果你有 Visual Studio 订阅，则还有资格[免费获取 Azure 信用额度](https://www.azure.cn/support/legal/offer-rate-plans/)，可用于任何 Azure 服务。 \n\n也可以使用 [Azure Cosmos DB 模拟器](https://docs.azure.cn/cosmos-db/local-emulator)在本地免费开发和测试应用程序，而无需创建 Azure 订阅。 如果对应用程序在 Azure Cosmos DB 模拟器中的工作情况感到满意，则可以切换到在云中使用 Azure Cosmos DB 帐户。\n,有免费帐户吗？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"有关详细信息，请参阅 [Azure Cosmos DB 定价详细信息](https://www.azure.cn/pricing/details/cosmos-db/)页。 Azure Cosmos DB 使用费取决于预配的容器数、容器的联机小时数，以及每个容器的预配吞吐量。 在这里，术语""容器""是指 DocumentDB API 集合、MongoDB API 集合以及表 API 表。",Azure Cosmos DB 的费用如何？,cosmos db,https://docs.azure.cn/cosmos-db/faq
在 Azure Cosmos DB 中，对于容器能够支持的总吞吐量并没有任何限制。 关键是要让工作负荷大致均匀地分布到足够多的分区键中。,Azure Cosmos DB 的吞吐量限制是什么？,cosmos db,https://docs.azure.cn/cosmos-db/faq
对于容器可以存储在 Azure Cosmos DB 中的数据总量并没有任何限制。,Azure Cosmos DB 的存储限制是什么？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是的，Azure Cosmos DB 符合 HIPAA。 HIPAA 针对可识别个人身份的健康信息的使用、泄露与保护制定了要求。 有关详细信息，请参阅 [信任中心](https://www.microsoft.com/TrustCenter/Compliance/HIPAA),Azure Cosmos DB 是否符合 HIPAA？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\n键/值（表）、纵栏表和文档数据模型都是原本就支持的，因为 Azure Cosmos DB 是基于 ARS（原子、记录和序列）设计构建的。 原子、记录和序列可以轻松映射和投影到各种数据模型。 现在提供了适用于一部分模型（Cosmos DB、MongoDB 和表 API）的 API，将来会提供特定于其他数据模型的其他 API。\n\nAzure Cosmos DB 有一个不受架构影响的索引编制引擎，能够自动为它引入的所有数据编制索引，不会要求开发者提供任何架构或辅助索引。 该引擎依赖于一组逻辑索引布局（倒置、纵栏表、树形），这些布局将存储布局从索引和查询处理子系统中分离出来。 Cosmos DB 还能够以可扩展方式支持一组连网协议和 API 并将它们高效地转换为核心数据模型 (1) 和逻辑索引布局 (2)，这使得它具有原本就支持多个数据模型的独特功能。\n,Azure Cosmos DB 如何支持各种数据模型（例如键/值、纵栏表和文档）？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"\n\n[请求单位](https://docs.azure.cn/cosmos-db/request-units) (RU) 是 Azure Cosmos DB 中吞吐量的衡量单位。 1 RU 吞吐量相当于通过 GET 操作获取 1 KB 文档的吞吐量。 在 Azure Cosmos DB 中进行的每个操作（包括读、写、SQL 查询和执行存储过程）都具有一个确定的 RU 值，该值基于完成该操作所需的吞吐量。 无需考虑 CPU、IO 和内存，以及它们会怎样影响应用程序吞吐量，只需从单个 RU 度量值的角度进行考虑即可。\n\n可以按照每秒吞吐量的 RU 数来保留每个 Azure Cosmos DB 容器的预配吞吐量。 对于任何规模的应用程序，都可以通过将单个请求设为基准来测量其 RU 值，并通过预配容器来处理所有请求的请求单位总和。 也可以随着应用程序的发展需求，扩展或缩减容器的吞吐量。 如需请求单位的详细信息以及确定容器需求方面的帮助，请参阅[估计吞吐量需求](https://docs.azure.cn/cosmos-db/request-units#estimating-throughput-needs)并尝试使用[吞吐量计算器](https://www.documentdb.com/capacityplanner)。 在这里，术语""容器""是指 DocumentDB API 集合、MongoDB API 集合以及表 API 表。 \n",Azure Cosmos DB 如何提供可预测的性能？,cosmos db,https://docs.azure.cn/cosmos-db/faq
对于侧重于以下要求的新 Web、移动、游戏和 IoT 应用程序而言，Azure Cosmos DB 是一个不错的选择：自动缩放、可预测的性能、毫秒响应时间的快速排序，以及查询无架构数据的能力。 Azure Cosmos DB 有助于快速开发，且支持应用程序数据模型的连续迭代。 用于管理用户生成的内容和数据的应用程序就是 [Azure Cosmos DB 的常见用例](https://docs.azure.cn/cosmos-db/use-cases),Azure Cosmos DB 的典型用例有哪些？,cosmos db,https://docs.azure.cn/cosmos-db/faq
在 Azure 门户的左侧窗格中，单击 Azure Cosmos DB 图标。 如果以前已创建了一个 DocumentDB 帐户，则现在也有了一个 Azure Cosmos DB 帐户，费用不会有任何变化。,如何在 Azure 门户中访问 DocumentDB 帐户？,cosmos db,https://docs.azure.cn/cosmos-db/faq
DocumentDB API 是适用于 Azure Cosmos DB 的受支持 API 和数据模型之一。 此外，Azure Cosmos DB 还支持表 API 和 MongoDB API。 有关详细信息，请参阅[来自 DocumentDB 客户的问题](https://docs.azure.cn/cosmos-db/#moving-to-cosmos-db),DocumentDB 有哪些变化？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"\n\nAzure Cosmos DB 在一致性、可用性和延迟之间提供合理的平衡。 Azure Cosmos DB 为表 API 开发人员提供五个一致性级别，因此可以在表级别选择合适的一致性模型，并在查询数据时发出相应的请求。 客户端可以在连接时指定一致性级别。 可以通过 CreateCloudTableClient 的 consistencyLevel 参数更改级别。 \n\n如果将""有限过时""一致性设置为默认值，表 API 可通过""读取自己写入的数据""提供低延迟的读取。 有关详细信息，请参阅[一致性级别](https://docs.azure.cn/cosmos-db/consistency-levels)。 \n\nAzure 表存储默认在区域中提供""强""一致性，在辅助位置提供""最终""一致性。 \n",如何理解表 API 中的一致性级别？,cosmos db,https://docs.azure.cn/cosmos-db/faq
DocumentDB API 支持通过 JavaScript 存储过程和触发器进行的语言集成式事务。 脚本中的所有数据库操作都是在进行快照隔离的情况下执行的。 如果是单分区集合，则执行范围为集合。 如果集合已分区，则执行范围为该集合中具有相同分区键值的文档。 文档版本 (ETag) 的快照是在事务开始时获取的，且只有当脚本成功运行时才会提交。 如果 JavaScript 引发错误，则会回滚事务。 有关详细信息，请参阅 [Azure Cosmos DB 的服务器端 JavaScript 编程](https://docs.azure.cn/cosmos-db/programming),如何在 DocumentDB API 中执行事务？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\n可以通过以下两种方法之一，将文档批量插入到 Azure Cosmos DB 中：\n\n*   数据集成工具，如 [Azure Cosmos DB 的数据迁移工具](https://docs.azure.cn/cosmos-db/import-data)中所述。\n*   存储过程，如 [Azure Cosmos DB 的服务器端 JavaScript 编程](https://docs.azure.cn/cosmos-db/programming)中所述。,如何将文档批量插入到 Document DB 中？,cosmos db,https://docs.azure.cn/cosmos-db/faq
DocumentDB API 支持使用 SQL 语法通过聚合函数 `COUNT`、`MIN`、`MAX`、`AVG` 和 `SUM` 实现的任何规模的低延迟聚合。 有关详细信息，请参阅[聚合函数](https://docs.azure.cn/cosmos-db/documentdb-sql-query#Aggregates)。,DocumentDB API 是否支持 SQL 聚合函数？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\n是的。 [Azure Cosmos DB 模拟器](https://docs.azure.cn/cosmos-db/local-emulator)提供对 Cosmos DB 服务的高保真模拟。 它支持与 Azure Cosmos DB 相同的功能，包括对创建和查询 JSON 文档、预配和缩放集合，以及执行存储过程和触发器的支持。 可以使用 Azure Cosmos DB 模拟器开发和测试应用程序，并通过对 Azure Cosmos DB 的连接终结点进行单一配置更改将其部署到多个区域范围的 Azure。\n\n## 针对 API for MongoDB 进行开发\n\n,DocumentDB API 的本地实例是否可用？,cosmos db,https://docs.azure.cn/cosmos-db/faq
可以使用 Azure Cosmos DB 的全局复制门户窗格来添加区域，然后故障转移到所需的区域。 有关说明，请参阅,如何在表 API 中更改帐户的主要写入区域？,cosmos db,https://docs.azure.cn/cosmos-db/faq
可以使用 Azure Cosmos DB 门户的[全局复制设置](https://docs.azure.cn/cosmos-db/tutorial-global-distribution-documentdb#portal)来添加适合应用程序的区域。 若要开发全局分布式应用程序，还应添加其 PreferredLocation 信息已设置为本地区域的应用程序，以减轻读取延迟。,如何在跨多个 Azure 区域的表 API 中添加数据复制？,cosmos db,https://docs.azure.cn/cosmos-db/faq
否，可以在没有任何干扰的情况下创建和使用现有 Azure 表存储资产。 但是，如果不使用表 API，则无法从自动索引、其他一致性选项或全局分发中受益。,如果我不想使用表 API 功能，是否需要将现有 Azure 表存储应用程序迁移到该 SDK？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是的，支持相同的 API。,现有的应用程序是否适用于表 API？,cosmos db,https://docs.azure.cn/cosmos-db/faq
目前没有。,是否可以在本地将表 API SDK 用于模拟器？,cosmos db,https://docs.azure.cn/cosmos-db/faq
可以使用容量估算器来计算操作所需的 TableThroughput。 有关详细信息，请参阅 [Estimate Request Units and Data Storage](https://www.documentdb.com/capacityplanner)（估算请求单位和数据存储）。 通常，可以将实体表示为 JSON，并为操作提供所需数量。,如何计算所需的吞吐量？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"可以使用表 API 的""指标""窗格来监视请求和存储使用情况。",如何监视表 API 服务？,cosmos db,https://docs.azure.cn/cosmos-db/faq
根据设计，可以通过横向缩放让 Azure Cosmos DB 提供无限的存储。 可以通过服务来监视并有效地增大存储。,如何在特定情况下为此服务扩展存储大小？比如，最初我有 n GB 的数据，但一段时间后我的数据会增长到 1 TB。,cosmos db,https://docs.azure.cn/cosmos-db/faq
支持使用 [AzCopy](https://docs.azure.cn/zh-cn/storage/common/storage-use-azcopy) 和 [Azure Cosmos DB 数据迁移工具](https://docs.azure.cn/cosmos-db/import-data),如何将现有 Azure 表存储应用程序迁移到此服务？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是的，可以通过创建两个不同的 CloudTableClient 实例进行连接，每个实例都通过连接字符串指向各自的 URI。,是否可以在同一应用程序中同时连接到 Azure 表存储和 Azure Cosmos DB 表 API？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"是的，因为 Azure Cosmos DB 是 RESTful 服务，而资源链接固定不变，所以可以缓存。 DocumentDB API 客户端可以通过指定""If-None-Match""标头来读取任何资源（例如文档或集合），然后在服务器版本更改后更新本地副本。",DocumentDB API 是否支持资源链接缓存？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是的，通过使用 ETag 机制提供乐观并发。,操作并发性是否受控制？,cosmos db,https://docs.azure.cn/cosmos-db/faq
支持 [PowerShell](https://docs.azure.cn/cosmos-db/table-powershell)。 目前不支持 Azure CLI。,PowerShell 或 Azure CLI 是否适用于表 API？,cosmos db,https://docs.azure.cn/cosmos-db/faq
是，表 API 支持 OData 查询和 LINQ 查询。,是否支持针对实体的 OData 查询模型？,cosmos db,https://docs.azure.cn/cosmos-db/faq
可以使用 Azure 门户浏览数据。 也可以使用表 API 代码或下一个问题答案中提到的工具。,如何查看 Azure Cosmos DB 中存储的用于表 API 的表数据？,cosmos db,https://docs.azure.cn/cosmos-db/faq
无。 使用现有 Azure 表存储 SDK 的现有客户或新客户无需进行任何更改。,使用现有 Azure 表存储 SDK 的客户是否需要进行任何更改？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\nAzure Cosmos DB 是全局复制的多模型数据库服务，可针对无架构数据提供丰富的查询，帮助提供可靠的可配置性能，并支持快速开发。 这一切都通过一个托管平台来实现，而该平台有 Azure 强大的功能与影响力作为后盾。 \n\n如果 Web、移动、游戏和 IoT 应用程序的关键要求是可预测的吞吐量、高可用性、低延迟和无架构数据模型，那么，Azure Cosmos DB 无疑是最合适的解决方案。 它提供了架构灵活性和丰富的索引，并且对集成的 JavaScript 提供了多文档事务性支持。 \n\n有关部署和使用此服务的更多数据库问题、解答及说明，请参阅 [Azure Cosmos DB 文档页面](([https://docs.azure.cn/cosmos-db/)。](https://docs.azure.cn/cosmos-db/)。)\n,什么是 Azure Cosmos DB？,cosmos db,https://docs.azure.cn/cosmos-db/faq
有关配置设置的信息，请参阅 [Azure Cosmos DB 功能](https://docs.azure.cn/cosmos-db/tutorial-develop-table-dotnet#azure-cosmos-db-capabilities)。 有些设置是通过 CreateCloudTableClient 方法处理的，还有一些设置是通过客户端应用程序中 appSettings 节的 app.config 处理的。,如何在表 API 的 .NET SDK 中替代请求选项的配置设置？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"\n\n连接字符串为：\n\n``\n\n可以通过 Azure 门户中的""连接字符串""页获取连接字符串。 \n",连接到表 API 需要使用哪个连接字符串？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\n可通过以下途径提供反馈：\n\n*   [Azure 支持](https://www.azure.cn/support/contact/),如何提供有关 SDK 或 Bug 的反馈？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"\n\n想要使用 Azure Cosmos DB 表 API 创建表的 Azure 表存储用户应注意以下这些行为差异：\n\n*   Azure Cosmos DB 表 API 使用保留容量模型来保障性能，但这意味着，一旦创建了表，就必须立即支付容量费用，即使容量未被使用。 使用 Azure 表存储时，只需为实际使用的容量付费。 这也说明了，表 API 在 99% 的时间里为何能够提供 10 毫秒的读取延迟和 15 毫秒的写入延迟 SLA，而 Azure 表存储提供 10 秒延迟 SLA。 因此，使用表 API 表（即使是不带任何请求的空表）时，要达到 Azure Cosmos DB 所提供的 SLA，必须支付费用来确保提供所需的容量来处理对这些表发出的所有请求。\n*   表 API 返回的查询结果未按分区键/行键顺序排序，因为它们在 Azure 表存储中。\n*   行键最多只能包含 255 个字节\n*   CreateIfNotExists 调用受管理限制的约束，该限制是固定的，不同于 RU 涵盖的其他表操作。 这意味着，发出大量 CreateIfNotExists 调用的对象会受到限制，无法执行相关的任何操作，因为限制不是来自其 RU。\n*   目前不支持 CORS\n*   Azure 表存储中的表名不区分大小写，但出现在 Azure Cosmos DB 表 API 中\n\n对于 REST API，有大量的终结点/查询选项不受 Azure Cosmos DB 表 API 的支持：\nREST 方法REST 终结点/查询选项文档 URL说明GET、PUT/?restype=service@comp=properties[设置表服务属性](https://docs.microsoft.com/rest/api/storageservices/set-table-service-properties)和[获取表服务属性](https://docs.microsoft.com/rest/api/storageservices/get-table-service-properties)此终结点用于设置 CORS 规则、存储分析配置和日志记录设置。 CORS 目前不受支持，Azure Cosmos DB 与 Azure 存储表中以不同的方式处理分析和日志记录OPTIONS/[预检 CORS 表请求](https://docs.microsoft.com/rest/api/storageservices/preflight-table-request)这是 Azure Cosmos DB 目前不支持的 CORS 部分。GET/?restype=service@comp=stats[获取表服务统计信息](https://docs.microsoft.com/rest/api/storageservices/get-table-service-stats)提供有关主节点与辅助节点之间的数据复制速度的信息。 由于复制是写入的一部分，因此在 Cosmos DB 中不需要此选项。GET、PUT/mytable?comp=acl[获取表 ACL](https://docs.microsoft.com/rest/api/storageservices/get-table-acl) 和[设置表 ACL](https://docs.microsoft.com/rest/api/storageservices/set-table-acl)获取和设置用于管理共享访问签名 (SAS) 的存储访问策略。 尽管支持 SAS，但其设置和管理方式不同。\n\n此外，Azure Cosmos DB 表 API 仅支持 JSON 格式，而不支持 ATOM。\n\n尽管 Azure Cosmos DB 支持共享访问签名 (SAS)，但它不支持某些策略，具体而言，是与管理操作相关的策略，例如创建新表的权限。\n\n对于特定的 .NET SDK，Azure Cosmos DB 目前不支持某些类和方法。\n类不支持的方法CloudTableClient*ServiceProperties**ServiceStats*CloudTableSetPermissions*GetPermissions*TableServiceContext*（实际上此类已弃用）TableServiceEntity"" ""TableServiceExtensions"" ""TableServiceQuery",表 API 与 Azure 表存储的行为有哪些不同之处？,cosmos db,https://docs.azure.cn/cosmos-db/faq
不是，现有的存储 SDK 仍然适用。 但是，我们建议始终使用最新的 SDK，以获得最佳支持，并在许多场合下获得优异的性能。 请参阅 [Azure Cosmos DB 表 API 简介](https://docs.azure.cn/cosmos-db/table-introduction)中的可用语言列表。,是否需要新的 SDK 才能使用表 API？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\n提供 Azure Cosmos DB 表 API。 首先必须注册 Azure 订阅。 注册以后，即可向 Azure 订阅添加 Azure Cosmos DB 表 API 帐户，然后向帐户添加表。 \n\n可以在 [Azure Cosmos DB 表 API 简介](https://docs.azure.cn/cosmos-db/table-introduction)中找到支持的语言和相关的快速入门。\n,如何使用表 API 产品/服务？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"\n\n除了常见的 MongoDB 错误代码，MongoDB API 还有其独特的错误代码：\n错误代码说明解决方案TooManyRequests16500使用的请求单位总数超过了集合的预配请求单位比率，已达到限制。请考虑从 Azure 门户缩放集合的吞吐量，或者重试。ExceededMemoryLimit16501作为一种多租户服务，操作已超出客户端的内存配额。通过限制性更强的查询条件缩小操作的作用域，或者通过 [Azure 门户](https://www.azure.cn/support/support-azure/)联系技术支持。 示例： db.getCollection('users').aggregate([ {$match: {name: ""Andy""}},  {$sort: {age: -1}} ]))\n\n## 使用表 API 进行开发\n\n",MongoDB 的 API 数据库是否有其他错误代码？,cosmos db,https://docs.azure.cn/cosmos-db/faq
\n\n可以使用 [Azure 存储资源管理器](https://docs.azure.cn/zh-cn/vs-azure-tools-storage-manage-with-storage-explorer)。\n\n灵活地采用之前指定格式的连接字符串的工具可以支持新的表 API。 [Azure 存储客户端工具](https://docs.azure.cn/storage/common/storage-explorers)页中提供了表工具列表。 \n,哪些工具适用于表 API？,cosmos db,https://docs.azure.cn/cosmos-db/faq
"\n\n若要连接到 Azure Cosmos DB API for MongoDB，最快捷的方式是使用 [Azure 门户](https://portal.azure.cn/)。 转到帐户，然后在左侧导航菜单上单击""快速启动""。 ""快速启动""是获取连接到数据库的代码片段的最佳方式。 \n\nAzure Cosmos DB 实施严格的安全要求和标准。 Azure Cosmos DB 帐户需要通过 SSL 进行身份验证和安全通信，因此务必使用 TLSv1.2。\n\n有关详细信息，请参阅[连接到 API for MongoDB 数据库](https://docs.azure.cn/cosmos-db/connect-mongodb-account)\n",如何连接到 API for MongoDB 数据库？,cosmos db,https://docs.azure.cn/cosmos-db/faq
Azure Cosmos DB API for MongoDB 是一个兼容层，允许应用程序使用现有的、社区支持的 Apache MongoDB API 和驱动程序轻松、透明地与本机 Azure Cosmos DB 数据库引擎通信。 开发人员现在可以使用现有的 MongoDB 工具链和技术，生成能够充分利用 Azure Cosmos DB 的应用程序。 开发人员可以使用 Azure Cosmos DB 的独特功能，其中包括自动索引、备份维护、获得财务支持的服务级别协议 (SLA) 等。,Azure Cosmos DB API for MongoDB 是什么？,cosmos db,https://docs.azure.cn/cosmos-db/faq
连接费用只在使用 AMQP 协议时适用。 使用 HTTP 发送事件没有连接费用，无论发送系统或设备的数量是多少。 如果计划使用 AMQP（例如，为了实现更高效的事件流式传输，或者为了对 IoT 命令和控制方案启用双向通信），请参阅[事件中心定价信息](https://www.azure.cn/pricing/details/event-hubs/)页，了解有关每个服务层中包括多少连接的详细信息。,中转连接费用是否适用于事件中心？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
命名空间中的任何事件中心启用了捕获选项时，即可启用捕获功能。 事件中心捕获按所购买的吞吐量单位以小时计费。 当吞吐量单位计数增加或减少时，事件中心捕获计费将在整个小时增量中反映这些变化。 有关事件中心捕获计费的详细信息，请参阅[事件中心定价信息](https://www.azure.cn/pricing/details/event-hubs/),事件中心捕获如何计费？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
\n\n捕获使用在事件中心启用捕获时提供的存储帐户。 由于这是你的存储帐户，对此配置进行任何更改都会在你的 Azure 订阅中计收费用。\n\n## 配额\n\n,是否要为事件中心捕获所选择的存储帐户付费？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
\n\n发送到事件中心的每个事件均计为一条可计费消息。 入口事件 定义为小于等于 64 KB 的数据单位。 任何小于等于 64 KB 的事件均被视为一个计费事件。 如果该事件大于 64 KB，则根据事件大小按 64 KB 的倍数来计算计费事件的数量。 例如，发送到事件中心的 8 KB 事件按一个事件计费，而发送到事件中心的 96 KB 的消息则按两个事件计费。\n\n从事件中心耗用的事件，以及管理操作和控制调用（例如检查点），不统计为计费入口事件，但会累计，上限为吞吐量单位限额。\n,事件中心入口事件是怎样计算的？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
有关可能的事件中心异常的列表，请参阅[异常概述](https://docs.azure.cn/event-hubs/event-hubs-messaging-exceptions),事件中心生成的异常有哪些，建议采取什么操作？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
\n\n事件中心的技术支持可通过 [社区论坛](https://social.msdn.microsoft.com/Forums/azure/home)获得。 计费和订阅管理支持免费提供。\n\n若要详细了解我们的 SLA，请参阅[服务级别协议](https://www.azure.cn/support/legal/sla/)页面。\n\n## 后续步骤\n\n访问以下链接可以了解有关事件中心的详细信息：\n\n*   [事件中心概述](https://docs.azure.cn/event-hubs/event-hubs-what-is-event-hubs)\n*   [创建事件中心](https://docs.azure.cn/event-hubs/event-hubs-create)\n*   [事件中心自动膨胀](https://docs.azure.cn/event-hubs/event-hubs-auto-inflate),支持和 SLA,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
\n\n如需所有事件中心配额的列表，请参阅[配额](https://docs.azure.cn/event-hubs/event-hubs-quotas)。\n\n## 故障排除\n\n,是否有与事件中心关联的配额？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
所有存储的事件的总大小（包括所有事件中心内事件标头或磁盘存储器结构上的所有内部开销）按整天计量。 在一天结束时，计算存储区大小峰值。 每天的存储限制根据在当天所选择的吞吐量单元的最小数量（每个吞吐量单元提供 84 GB 的限制）来计算。 如果总大小超过计算出的每日存储限额，超出的存储量会采用 Azure Blob 存储费率（按本地冗余存储费率）来计费。,怎样对事件中心存储区大小进行计算和收费？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
有关事件中心定价的完整信息，请参阅[事件中心定价详细信息](https://www.azure.cn/pricing/details/event-hubs/),我可以在哪里找到更多定价信息？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
事件中心标准层允许消息保留期长于 24 小时，最长以 7 天为限。 如果所存储事件总量的大小超过所选吞吐量单位数量的存储限制（每个吞吐量单位 84 GB），超出限制的部分会按公布的 Azure Blob 存储区费率收费。 每个吞吐量单元的存储限制包括 24 小时（默认值）的保留期期间的所有存储成本，即使吞吐量单元已经用到了最大入口限制。,保留事件中心事件超过 24 小时的话，要收取费用吗？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
\n\n通过 Azure 门户或事件中心 Resource Manager 模板明确选择事件中心吞吐量单位。 吞吐量单位适用于事件中心命名空间中的所有事件中心，每个吞吐量单位为命名空间赋予以下功能：\n\n*   入口事件（发送到事件中心的事件）最多达每秒 1 MB，但每秒不超过 1000 个入口事件、管理操作或控制 API 调用。\n*   出口事件（从事件中心耗用的事件）最多达每秒 2 MB。\n*   高达 84 GB 的事件存储空间（对于默认为 24 小时的保留期来说是很充足的）。\n\n事件中心吞吐量单元根据在指定的某个小时内选择的最大单元数量按小时计费。 可以随着使用量增加自动[增加吞吐量单位数](https://docs.azure.cn/event-hubs/event-hubs-auto-inflate)\n,什么是事件中心吞吐量单元？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
\n\n如果某个命名空间中所有事件中心间的总入口吞吐量或总入口事件率超过了聚合吞吐量单位限额，发送方会受到限制，并会收到指明已超出入口配额的错误信息。\n\n如果某个命名空间中所有事件中心间的总出口吞吐量或总出口事件率超过了聚合吞吐量单位限额，接收方会受到限制，并会收到指明已超出出口配额的错误信息。 入口和出口配额是分开强制实施的，因此，任何发送方都不会使事件耗用速度减慢，并且接收方也无法阻止事件发送到事件中心。\n,怎样强制实施事件中心吞吐量单元？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
\n\n默认配额为每个命名空间 20 个吞吐量单元。 可以通过填写支持票证来要求更大的吞吐量单元配额。 超出 20 个吞吐量单元这一限制时，以 20 个和 100 个吞吐量单元的形式提供捆绑包。 请注意，使用 20 个以上的吞吐量单元会失去在不填写支持票证的情况下更改吞吐量单元数的能力。\n\n使用[自动膨胀](https://docs.azure.cn/event-hubs/event-hubs-auto-inflate)功能，可以随着使用量增加自动增加吞吐量单位数。\n,可选择的吞吐量单元的数量有限制吗？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
\n\nAzure 事件中心标准层提供的功能超出了基本层中提供的功能。 以下功能是标准层附带的：\n\n*   更长的事件保留期\n*   其他中转连接，对于超出包含的数量的部分收取超额费用\n*   多于单个使用者组\n*   [捕获](https://docs.azure.cn/zh-cn/event-hubs/event-hubs-capture-overview)\n\n有关定价层的详细信息（包括专用事件中心），请参阅[事件中心定价详细信息](https://www.azure.cn/pricing/details/event-hubs/)\n,事件中心基本和标准这两种服务层有什么不同？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
事件中心标准目前支持的最长保留期为 7 天。 请注意，事件中心并不是永久性的数据存储区。 大于 24 小时的保留期适用于将事件流重播到相同系统中的情形；例如，为了基于现有数据来培训或验证新机器学习模型。 如果需要将消息保留 7 天以上，那么启用事件中心的[事件中心捕获](https://docs.azure.cn/zh-cn/event-hubs/event-hubs-capture-overview)功能，可将数据从事件中心拉取到选定的存储帐户。 启用捕获功能会基于购买的吞吐量单位进行计价。,事件的最长保留期有多久？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
\n\n在所有支持的 Azure 区域中都可使用 Azure 事件中心。 有关列表，请访问 [Azure 区域](https://www.azure.cn/support/service-dashboard/)页。 \n\n## 最佳实践\n\n,Azure 事件中心在哪些区域可用？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
\n\n请记住，事件中心的分区数在设置后无法修改。 鉴于这一点，请务必在开始之前考虑需要多少分区。 \n\n事件中心设计用于允许每个用户组使用单个分区读取器。 在大多数用例中，四个分区的默认设置就足够了。 如果希望扩展事件处理，则可以考虑添加其他分区。 对分区没有特定的吞吐量限制，但是命名空间中的聚合吞吐量受吞吐量单位数限制。 增加命名空间中吞吐量单位的数量时，可能需要添加额外分区来允许并发读取器实现其自身的最大吞吐量。\n\n但是，如果有一个模型，其中应用程序具有到特定分区的关联性，则增加分区数可能对你没有任何益处。 有关详细信息，请参阅[可用性和一致性](https://docs.azure.cn/event-hubs/event-hubs-availability-and-consistency)。\n\n## 定价\n\n,需要多少分区？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
可以，但前提是所有事件中心都在同一个命名空间中。,是否可以使用单个 AMQP 连接来与多个事件中心相互收发数据？,event hubs,https://docs.azure.cn/event-hubs/event-hubs-faq
是的。 如果尚未通过 BGP 会话公布默认路由 (0.0.0.0/0) 或 Internet 路由前缀，可以从连接到 ExpressRoute 线路的虚拟网络连接到 Internet。,能否从连接到 ExpressRoute 线路的虚拟网络访问 Internet？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
在公共对等 BGP 会话中，不接受私有前缀 (RFC1918)。,对可以通过 BGP 会话播发的 IP 地址范围是否有限制？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
\n\n是的。 可以播发默认路由 (0.0.0.0/0) 以阻止与虚拟网络内部署的虚拟机建立所有 Internet 连接，并通过 ExpressRoute 线路路由出所有流量。\n\n请注意，如果播发默认路由，我们会强制将传送到通过公共对等互连提供的服务（如 Azure 存储和 SQL DB）的流量传回本地。 必须将路由器配置为通过公共对等路径或通过 Internet 将流量传回 Azure。\n,能否阻止与连接到 ExpressRoute 线路的虚拟网络建立 Internet 连接？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
可以。 连接到同一 ExpressRoute 线路的虚拟网络中部署的虚拟机可以彼此通信。,连接到同一 ExpressRoute 线路的虚拟网络能否互相对话？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
可以。 ExpressRoute 可以与站点到站点 VPN 共存。,能否将站点到站点连接与 ExpressRoute 一起用于虚拟网络？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
可以。 必须在虚拟网络中创建 ExpressRoute 网关。 该过程会造成较短的停机时间。,能否将虚拟网络从站点到站点/点到站点配置转为使用 ExpressRoute？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
公共 IP 地址仅用于内部管理。 此公共 IP 地址不会在 Internet 上公开，因此不会给虚拟网络带来安全隐患。,为什么有一个公共 IP 地址与虚拟网络上的 ExpressRoute 网关相关联？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
必须建立 ExpressRoute 线路并为公共对等互连配置路由。,通过 ExpressRoute 连接到 Azure 存储需要执行哪些操作？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
"是的。 对于专用对等互连，最多接受 4000 个路由前缀；对于公共对等互连，各接受 200 个。 如果启用 ExpressRoute 高级功能，可以将专用对等互连的此限制提高为 10,000 个路由。",对可以播发的路由数是否有限制？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
会将 BGP 会话删除。 当前缀计数低于限制后，将重置这些会话。,如果超过 BGP 限制，会发生什么情况？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
\n\n可以使用 REST API 或 PowerShell cmdlet 更新 ExpressRoute 线路的带宽。\n\n## ExpressRoute 高级版\n\n,如何更改 ExpressRoute 线路的带宽？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
\n\n以下步骤帮助 Azure 识别激活请求：\n\n1.  为 ExpressRoute 线路建立公共对等互连。\n2.  执行 DNS 查找，找到 kms.core.chinacloudapi.cn 的 IP 地址\n3.  \n\n密钥管理服务必须识别来自 Azure 的激活请求并遵循该请求。 执行以下三个任务之一：\n\n    *   在本地网络上，通过公共对等互连将发往步骤 2 中获取的 IP 地址的流量路由回到 Azure。\n    *   让 NSP 提供商通过公共对等互连将流量路由回到 Azure。\n    *   创建用户定义的路由，该路由指明具有 Internet 的 IP 作为下一跃点，并将其应用于这些虚拟机所在的子网。,将默认路由 (0.0.0.0/0) 播发到虚拟网络后，我无法激活 Azure VM 上运行的 Windows。 我如何解决此问题？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
\n\n是的，可以尝试在 Azure 门户中或者使用 PowerShell.mpt 来增加 ExpressRoute 线路的带宽。 如果在创建线路的物理端口上有容量可用，则更改会成功。 \n\n如果更改失败，这意味着当前端口上没有剩余足够的容量，需要创建具有更高带宽的新 ExpressRoute 线路；或者意味着在该位置没有额外的容量，在这种情况下将无法增加带宽。 \n\n还必须跟进连接服务提供商，确保他们更新其网络中的限制以支持带宽增加。 不过，无法减小 ExpressRoute 线路的带宽。 必须创建具有更低带宽的新 ExpressRoute 线路并删除旧线路。\n,是否可以更改 ExpressRoute 线路的带宽？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
是的。 可将一个虚拟网络最多链接到四条 ExpressRoute 线路。 必须通过四个不同的 [ExpressRoute 位置](https://docs.azure.cn/expressroute/expressroute-locations)订购这些线路。,能否将一个虚拟网络连接到多条 ExpressRoute 线路？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
"\n\nExpressRoute 高级版是以下功能的集合：\n\n*   对于专用对等互连，将路由表限制从 4000 个路由提升为 10,000 个路由。\n*   增加了可连接到 ExpressRoute 线路的 VNet 数量（默认数量为 10 个）。 有关详细信息，请参阅 [ExpressRoute 限制](https://docs.azure.cn/expressroute/#limits)表。\n*   通过 Microsoft 核心网络建立全局连接。 现在，可将一个地缘政治区域中 VNet 链接到另一个区域中的 ExpressRoute 线路。",什么是 ExpressRoute 高级版？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
"\n\n下表显示了 ExpressRoute 限制和每条 ExpressRoute 线路的 VNet 数：\n\n#### ExpressRoute 限制\n\n下列限制适用于每个订阅的 ExpressRoute 资源。\n资源默认限制每个订阅的 ExpressRoute 线路数10ARM 的每个订阅每个区域的 ExpressRoute 线路数10具有 ExpressRoute Standard 的 Azure 私用对等互连的最大路由数4,000具有 ExpressRoute Premium 附加设备的 Azure 私用对等互连的最大路由数10,000具有 ExpressRoute Standard 的 Azure 公共对等互连的最大路由数200具有 ExpressRoute Premium 附加设备的 Azure 公共对等互连的最大路由数200每个 ExpressRoute 线路允许的虚拟网络链接数请参阅下表\n\n#### 每个 ExpressRoute 线路的虚拟网络数\n\n线路大小针对 Standard 的 VNet 链接数使用 Premium 附加设备时的 VNet 链接数50 Mbps1020100 Mbps1025200 Mbps1025500 Mbps10401 Gbps10502 Gbps10605 Gbps107510 Gbps10100",如果启用 ExpressRoute 高级版，可将多少个 VNet 链接到 ExpressRoute 线路？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
在启用相应的功能后，可启用 ExpressRoute 高级功能，并可通过更新线路状态关闭高级功能。 可以在创建线路时启用 ExpressRoute 高级版，或者调用 REST API/PowerShell cmdlet。,如何启用 ExpressRoute 高级版？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
可以通过调用 REST API 或 PowerShell cmdlet 来禁用 ExpressRoute 高级版。 必须确保已调整连接需求以满足默认限制，再禁用 ExpressRoute 高级版。 如果使用规模超出了默认限制，禁用 ExpressRoute 高级版的请求会失败。,如何禁用 ExpressRoute 高级版？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
不能。 无法选择功能。 如果启用 ExpressRoute 高级版，则会启用所有功能。,我是否可以从高级功能集选择所需的功能？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
有关费用，请参阅,ExpressRoute 高级版需要多少费用？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
是的。 ExpressRoute 高级版费用是在 ExpressRoute 线路费用和连接服务提供商所收费用的基础之上收取。,除了支付 ExpressRoute 高级版费用以外，是否还要支付标准版 ExpressRoute 的费用？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
保持时间为 180。 Keep-Alive（保持活动）消息每隔 60 秒发送一次。 这些是 Microsoft 端的固定设置，不能更改。 可以配置不同的计时器，BGP 会话参数会相应地协商。,ExpressRoute BGP 保持时间是多少？ 是否可以进行调整？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
\n\n是的。 ExpressRoute 授权可以跨订阅、租户和合约边界，不需要进行额外配置。 \n\n有关详细信息，请参阅[在多个订阅之间共享 ExpressRoute 线路](https://docs.azure.cn/expressroute/expressroute-howto-linkvnet-arm)\n,我有多个关联到不同 Azure Active Directory 租户或企业协议合约的 Azure 订阅。 是否可以将位于单独租户和合约中的虚拟网络连接到不在同一租户或合约中的单个 ExpressRoute 线路？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
是的。 [ExpressRoute 合作伙伴和位置](https://docs.azure.cn/expressroute/expressroute-locations)一文概述了 ExpressRoute 线路的连接界限。 一条 ExpressRoute 线路的连接范围限制为单个地缘政治区域。 可以通过启用 ExpressRoute 高级功能，将连接扩展为跨地缘政治区域。,ExpressRoute 线路是否存在连接界限？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
\n\n可以。 最多可以授权其他 10 个 Azure 订阅使用单个 ExpressRoute 线路。 可以通过启用 ExpressRoute 高级功能来提高此限制。\n\n有关详细信息，请参阅[在多个订阅之间共享 ExpressRoute 线路](https://docs.azure.cn/expressroute/expressroute-howto-linkvnet-arm)\n,我有多个包含虚拟网络的 Azure 订阅。 能否将不同订阅中的虚拟网络连接到单个 ExpressRoute 线路？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
ExpressRoute 连接不通过公共 Internet 。 与通过 Internet 的典型连接相比，ExpressRoute 连接提供更高的安全性、可靠性、速度和较低的一致延迟。 在某些情况下，使用 ExpressRoute 连接在本地设备和 Azure 之间传输数据可以产生显著的成本效益。,使用 ExpressRoute 和专用网络连接的好处是什么？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
参阅 [ExpressRoute 合作伙伴和位置](https://docs.azure.cn/expressroute/expressroute-locations)了解服务上市区域和可用性。,哪里提供该服务？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
可以将区域运营商和地区以太网连接选择为支持的 Exchange 提供商位置之一。 然后，可以在提供商位置与 Azure 实现对接。 请查看 [ExpressRoute 合作伙伴和位置](https://docs.azure.cn/expressroute/expressroute-locations)的最后一部分，以确定服务提供商是否在任何 Exchange 位置。 然后，可以通过服务提供商订购 ExpressRoute 线路以连接到 Azure。,如果未与 ExpressRoute 运营商合作伙伴之一建立合作伙伴关系，则如何使用 ExpressRoute 连接到 Azure,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
有关定价信息，请查看,ExpressRoute 需要多少费用？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
否。 可以从服务提供商购买任何速度的 VPN 连接。 但是，与 Azure 的连接速度限制为购买的 ExpressRoute 线路带宽。,如果购买具有给定带宽的 ExpressRoute 线路，是否必须从网络服务提供商购买具有相同速度的 VPN 连接？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
是的。 ExpressRoute 线路的配置允许免费将速度提升到所购带宽限制的两倍。 请咨询服务提供商，确定他们是否支持此功能。,如果我购买了具有给定带宽的 ExpressRoute 线路，是否可以根据需要提升到更高的速度？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
是的。 设置 ExpressRoute 线路后，可以同时访问虚拟网络中的服务和其他 Azure 服务。 可通过专用对等路径连接到虚拟网络，通过公用对等路径连接到其他服务。,能否同时与虚拟网络和其他 Azure 服务使用同一专用网络连接？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
\n\n有关信息，请参阅 [ExpressRoute SLA](https://www.azure.cn/support/legal/sla/) 页。\n\n## 支持的服务\n\nExpressRoute 支持 [两种路由域](https://docs.azure.cn/expressroute/expressroute-circuit-peerings) ，适用于各种类型的服务。\n,ExpressRoute 是否提供服务级别协议 (SLA)？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
我们不对数据传输量设置限制。 有关带宽价格的信息，请参阅,对于使用 ExpressRoute 可以传输的数据量是否有限制？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
否。 从路由角度看，连接到同一 ExpressRoute 线路的所有虚拟网络都属于同一路由域，不是相互隔离的。 如果需要路由隔离，则需要创建单独的 ExpressRoute 线路。,连接到同一线路的虚拟网络相互隔离吗？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
\n\n支持带宽提供：\n\n50 Mbps、100 Mbps、200 Mbps、500 Mbps、1 Gbps、2 Gbps、5 Gbps、10 Gbps\n,ExpressRoute 支持的连接速度是多少？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
有关要求，请参阅 [ExpressRoute 先决条件页](https://docs.azure.cn/expressroute/expressroute-prerequisites),将本地位置连接到 Azure 有哪些技术要求？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
可以。 每条 ExpressRoute 线路都配置一对冗余交叉连接，以提供高可用性。,与 ExpressRoute 的连接是冗余的吗？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
\n\n如果其中一个交叉连接出现故障，不会失去连接。 冗余连接可用于支持网络负载。 另外，还可以在不同对等位置创建多条线路以实现故障恢复。\n\n## 如何确保连接到 ExpressRoute 的虚拟网络上的高可用性？\n\n可以通过将不同的对等位置中的多条 ExpressRoute 线路连接到虚拟网络来实现高可用性。 例如，如果一个 ExpressRoute 站点出现故障，连接会故障转移到另一个 ExpressRoute 站点。 默认情况下，将基于等成本多路径路由 (ECMP) 对离开虚拟网络的流量进行路由。 可以使用连接权重来使一个连接优先于另一个连接。\n,如果某个 ExpressRoute 链路出现故障，会失去连接？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
如果服务提供商可以通过物理连接建立两条以太网虚拟线路，则只需要一个物理连接。 物理连接（例如光纤）的终点在第 1 层 (L1) 设备上（请参阅下图）。 两条以太网虚拟线路使用不同的 VLAN ID 进行标记，一个供主要线路使用，一个供辅助线路使用。 这些 VLAN ID 位于外部 802.1Q 以太网标头中。 内部 802.1Q 以太网标头（不显示）会映射到特定的 [ExpressRoute 路由域](https://docs.azure.cn/expressroute/expressroute-circuit-peerings),如果我不在云交换中共置，而我的服务提供商提供点到点连接，我需要在本地网络与 Microsoft 之间订购两个物理连接吗？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
否。 不支持将第 2 层连接扩展到 Azure。,能否使用 ExpressRoute 将我的一个 VLAN 扩展到 Azure？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
可以。 可以在订阅中有多条 ExpressRoute 线路。 默认限制设置为 10。 如果需要增大限制，请联系 Microsoft 支持部门。,是否可以在订阅中有多条 ExpressRoute 线路？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
可以。 可以使用多个服务提供商的 ExpressRoute 线路。 每条 ExpressRoute 线路只与一个服务提供商相关联。,能否使用不同服务提供商的 ExpressRoute 线路？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
是的。 在同一位置中可以有多条 ExpressRoute 线路，它们可以具有相同或不同的服务提供商。 不过，无法从同一位置将多条 ExpressRoute 线路链接到同一虚拟网络。,在同一位置中是否可以有多条 ExpressRoute 线路？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
\n\n基本步骤如下：\n\n*   建立一条 ExpressRoute 线路并让服务提供商启用它。\n*   客户或者提供商必须配置 BGP 对等互连。\n*   将虚拟网络连接到 ExpressRoute 线路。\n\n有关详细信息，请参阅 [ExpressRoute 线路预配工作流和线路状态](https://docs.azure.cn/expressroute/expressroute-workflows)\n,如何将我的虚拟网络连接到 ExpressRoute 线路,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
是的。 在标准 ExpressRoute 线路上最多可以有 10 个虚拟网络连接，在[高级 ExpressRoute 线路](https://docs.azure.cn/expressroute/#expressroute-premium)上最多可以有 100 个。,能否将多个虚拟网络链接到一条 ExpressRoute 线路？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
\n\n有关服务提供商和位置的列表，请参阅 [ExpressRoute 合作伙伴和位置](https://docs.azure.cn/expressroute/expressroute-locations)。\n\n## 技术详细信息\n\n,可以选择哪些服务提供商？,expressroute,https://docs.azure.cn/expressroute/expressroute-faqs
50 个。 可以创建 [Azure 支持票证](https://portal.azure.cn/#blade/Microsoft_Azure_Support/HelpAndSupportBlade)提高此限制，但默认情况下，只能对每个订阅预配 50 个 Cosmos DB 实例。,在订阅中可以预配多少个 Azure Cosmos DB 实例？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-faq
当前无法使用 Microsoft Azure for DreamSpark 帐户创建预配置解决方案。 但是，可以在几分钟内创建一个[Azure 试用帐户][lnk-30daytrial]，以便创建预配置的解决方案。,如果有 Microsoft Azure for DreamSpark，是否可以创建预配置解决方案？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-faq
默认情况下，可以[为每个订阅预配 10 个 IoT 中心](https://docs.azure.cn/azure-subscription-service-limits#iot-hub-limits)。 可以创建 [Azure 支持票证](https://portal.azure.cn/#blade/Microsoft_Azure_Support/HelpAndSupportBlade)以提高此限制。 由于每个预配置的解决方案将预配一个新的 IoT 中心，因此，在给定的订阅中，最多只能预配 10 个预配置的解决方案。,在一个订阅中可以设置多少个 IoT 中心实例？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-faq
请参阅 Eric Golpe 的博客文章 [删除 Azure AD 租户的演练](http://blogs.msdn.com/b/ericgolpe/archive/2015/04/30/walkthrough-of-deleting-an-azure-ad-tenant.aspx)。,如何删除 AAD 租户？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-faq
\n\n还可以浏览 IoT 套件预配置的解决方案的一些其他特性和功能：\n\n*   [预测性维护预配置解决方案概述](https://docs.azure.cn/iot-suite/iot-suite-predictive-overview)\n*   [从头开始保障 IoT 安全](https://docs.azure.cn/iot-suite/securing-iot-ground-up),后续步骤,iot suite,https://docs.azure.cn/iot-suite/iot-suite-faq
当前无法通过云解决方案提供商 (CSP) 订阅创建预配置的解决方案。 但是，可以在几分钟内创建一个 [Azure 试用帐户](https://www.azure.cn/pricing/1rmb-trial)，以便创建预配置的解决方案。,如果我有云解决方案提供商 (CSP) 订阅，是否可以创建预配置的解决方案？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-faq
*   如果在 [azureiotsuite.cn](https://www.azureiotsuite.cn/) 中删除预配置解决方案，则会删除在创建预配置解决方案时预配的所有资源。 如果向资源组添加了其他资源，则也会删除这些资源。 \n*   如果删除 [Azure 门户](https://portal.azure.cn/)中的资源组，则只会删除该资源组中的资源。 此外还需在 [Azure 经典门户](https://manage.windowsazure.cn/)中删除与预配置的解决方案关联的 Azure Active Directory 应用程序。,在 Azure 门户中删除资源组与在 azureiotsuite.cn 中对预配置解决方案单击删除之间的区别是什么？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-faq
过去两年以来，云体系结构已发生重大的演变。 微服务应运而生，是能够在不降低开发速度的情况下实现可伸缩性和灵活性的极佳模式。 此体系结构模式已在多种 Microsoft 服务内部使用，且获得了出色的可靠性和可伸缩性。 我们正在将这些知识付诸实践，使客户能够从中受益。,基于微服务的新开源体系结构在新的更新中提供哪些优势？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-faq
每个部署选项对应于不同的需求。 基本部署旨在满足入门需要以及开发 PoC 和小型试验。 它提供一个简化的体系结构，包含最少量的必要资源，并且费用较低。 标准部署旨在生成和自定义生产就绪的解决方案，为实现部署提供所需的元素。 在可靠性和缩放，微服务应用程序构建为 Docker 容器，并使用某个业务流程协调程序（默认为 Kubernetes）进行部署。 该业务流程协调程序负责部署、缩放和管理应用程序。 应根据当前需求选择其中一个选项。 可以根据项目所处的阶段，使用其中的一个选项或两者的组合。,基本和标准部署选项有什么差别？ 如何在这两个部署选项之间做出选择？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-faq
是的，新的远程监控解决方案可在同一地理区域中使用。,新的预配置解决方案是否在现有解决方案所在的同一地理区域中可用？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-faq
目前，只有远程监控解决方案使用微服务体系结构，因为它涵盖最广泛的方案。,新的微服务体系结构是否适用于所有三个预配置解决方案？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-faq
除了提供两种不同的部署以外，新的远程监控解决方案还提供一项设置来按需启用或禁用所有模拟设备。 禁用模拟可以减少解决方案中引入的数据，因此可以降低总体成本。,如何确保在开发解决方案的同时不断降低成本？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-faq
\n\n新的预配置解决方案提供两个部署选项：\n\n*   基本选项适用于寻求更低开发成本的开发人员，或想要生成演示或概念证明的客户。\n*   标准选项适用于想要部署生产就绪基础结构的企业。,预配新的远程监控解决方案的费用是多少？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-faq
\n\n源代码存储在以下 GitHub 存储库中：\n\n*   [远程监控预配置解决方案 (.NET)](https://github.com/Azure/azure-iot-pcs-remote-monitoring-dotnet)\n*   [远程监控预配置解决方案 (Java)](https://github.com/Azure/azure-iot-pcs-remote-monitoring-java)\n*   [预测性维护预配置解决方案](https://github.com/Azure/azure-iot-predictive-maintenance),在哪里可以找到预配置解决方案的源代码？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-faq
是的。 现存的任何解决方案可继续在 Azure 订阅中工作，GitHub 中仍会提供其源代码。,是否可以继续利用 Azure IoT 套件中的现有投资？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-faq
\n\n还可以浏览 IoT 套件预配置的解决方案的一些其他特性和功能：\n\n*   [预测性维护预配置解决方案概述](https://docs.azure.cn/iot-suite/iot-suite-predictive-overview)\n*   [从头开始保障 IoT 安全](https://docs.azure.cn/iot-suite/securing-iot-ground-up),后续步骤,iot suite,https://docs.azure.cn/iot-suite/iot-suite-v1-faq
请参阅 Eric Golpe 的博客文章 [删除 Azure AD 租户的演练](http://blogs.msdn.com/b/ericgolpe/archive/2015/04/30/walkthrough-of-deleting-an-azure-ad-tenant.aspx)。,如何删除 AAD 租户？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-v1-faq
当前无法通过云解决方案提供商 (CSP) 订阅创建预配置的解决方案。 但是，可以在几分钟内创建一个 [Azure 试用帐户](https://www.azure.cn/pricing/1rmb-trial/)，以便创建预配置的解决方案。,如果我有云解决方案提供商 (CSP) 订阅，是否可以创建预配置的解决方案？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-v1-faq
当前无法使用 Microsoft Azure for DreamSpark 帐户创建预配置解决方案。 但是，可以在几分钟内创建一个 [Azure 试用帐户](https://www.azure.cn/pricing/1rmb-trial/)，以便创建预配置的解决方案。,如果有 Microsoft Azure for DreamSpark，是否可以创建预配置解决方案？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-v1-faq
默认情况下，可以为每个订阅预配 10 个 IoT 中心。 可以创建 [Azure 支持票证](https://portal.azure.cn/#blade/Microsoft_Azure_Support/HelpAndSupportBlade)以提高此限制。 由于每个预配置的解决方案将预配一个新的 IoT 中心，因此，在给定的订阅中，最多只能预配 10 个预配置的解决方案。,在一个订阅中可以设置多少个 IoT 中心实例？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-v1-faq
50 个。 可以创建 [Azure 支持票证](https://portal.azure.cn/#blade/Microsoft_Azure_Support/HelpAndSupportBlade)以提高此限制，但在默认情况下，对每个订阅只能预配 50 个 Cosmos DB 实例。,在订阅中可以预配多少个 Azure Cosmos DB 实例？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-v1-faq
解决方案仪表板中的设备列表使用查询来返回设备列表。 目前，查询返回的设备数不能超过 10000。 可以尝试让查询的搜索条件更具限制性。,我的设备未显示在解决方案仪表板的设备列表中，这是什么原因？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-v1-faq
在远程监控预配置解决方案中，模拟设备代码仅使用所需的属性 Desired.Config.TemperatureMeanValue 和Desired.Config.TelemetryInterval 来更新报告的属性。 忽略所有其他的所需属性更改请求。,模拟设备忽略所需属性更改，这是什么原因？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-v1-faq
请参阅[自定义预配置解决方案](https://docs.azure.cn/iot-suite/iot-suite-v1-guidance-on-customizing-preconfigured-solutions)一文的[向模拟器添加新方法的支持](https://docs.azure.cn/iot-suite/iot-suite-v1-guidance-on-customizing-preconfigured-solutions#add-support-for-a-new-method-to-the-simulator)部分。,如何向远程监控预配置解决方案添加新设备方法的支持？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-v1-faq
*   如果从 [https://www.azureiotsuite.cn/](https://www.azureiotsuite.cn/) 站点部署预配置解决方案，则始终部署的是最新版解决方案的全新实例。\n*   如果使用命令行部署预配置解决方案，可以使用新代码更新现有部署。 请参阅 GitHub [存储库](https://github.com/Azure/azure-iot-remote-monitoring)中的[云部署](https://github.com/Azure/azure-iot-remote-monitoring/blob/master/Docs/cloud-deployment.md)。,如何更新到最新版的远程监控预配置解决方案，以便使用 IoT 中心设备管理功能？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-v1-faq
\n\n源代码存储在以下 GitHub 存储库中：\n\n*   [远程监控预配置解决方案](https://github.com/Azure/azure-iot-remote-monitoring)\n*   [预测性维护预配置解决方案](https://github.com/Azure/azure-iot-predictive-maintenance),在哪里可以找到预配置解决方案的源代码？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-v1-faq
*   如果在 [azureiotsuite.cn](https://www.azureiotsuite.cn/) 中删除预配置解决方案，则会删除在创建预配置解决方案时预配的所有资源。 如果向资源组添加了其他资源，则也会删除这些资源。 \n*   如果删除 [Azure 门户](https://portal.azure.cn/)中的资源组，则只会删除该资源组中的资源。 此外还需在 [Azure 门户](https://portal.azure.cn/)中删除与预配置解决方案关联的 Azure Active Directory 应用程序。,在 Azure 门户中删除资源组与在 azureiotsuite.cn 中对预配置解决方案单击删除之间的区别是什么？,iot suite,https://docs.azure.cn/iot-suite/iot-suite-v1-faq
是的。 可以使用现有的 Azure 订阅预配和使用 Power BI 工作区集合服务。,用户有一个 Azure 订阅。 是否可以通过现有的订阅使用 Power BI 工作区集合？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
\n\n[什么是 Power BI 工作区集合](https://docs.azure.cn/power-bi-workspace-collections/what-are-power-bi-workspace-collections)[Power BI 工作区集合入门](https://docs.azure.cn/power-bi-workspace-collections/get-started)[示例入门](https://docs.azure.cn/power-bi-workspace-collections/get-started-sample)[JavaScript 嵌入示例](https://microsoft.github.io/PowerBI-JavaScript/demo/)\n\n有更多问题？ [试用 Power BI 社区](http://community.powerbi.com/)\n,另请参阅,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
可以立即开始体验免费版！ 如果拥有 Azure 订阅，现在就可以直接从 Azure 门户预配 Power BI 工作区集合。 也可以创建自己的 [Azure 帐户](https://www.azure.cn/pricing/1rmb-trial/)。 一旦 Power BI 工作区集合服务预配完毕，就可以直接轻松使用 Power BI REST API，或使用 [GitHub](https://www.nuget.org/profiles/powerbi) 上提供的开发人员 SDK。 关于如何使用开发人员 SDK 提供的示例。,如何开始？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
可以访问 [Power BI 工作区集合文档页](https://docs.azure.cn/power-bi-workspace-collections/get-started)。 通过访问 [Power BI 博客](https://powerbi.microsoft.com/blog/)或通过访问 dev.powerbi.cn 上的 Power BI 开发人员中心，可以了解该服务的最新信息。 也可以在 [Stackoverflow](http://stackoverflow.com/questions/tagged/powerbi)上提问。,可以从何处了解详细信息？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
\n\n在 Power BI 工作区集合模型中，明确要求 Azure AD 租户中必须存在客户。 可以为客户选择是否需要 Azure AD。 这样，应用程序的体系结构和基础结构就可以用来确定 Power BI 工作区集合要求的租户模型。\n\n开发人员/员工操作或创建应用程序时会需要具有 AAD 用户帐户才能通过 Azure 门户管理 Azure 订阅和工作区集合。 开发人员可以使用编程 API 导入报表、修改连接字符串、获取嵌入式 URL、改用应用令牌进行身份验证，因此无需使用 AAD。\n,Power BI 工作区集合的租户模型如何工作？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
会支持通过直接查询对使用基本凭据的云数据源进行访问。 这意味着目前支持的源有 Azure SQL DB 和 Azure SQL DW 等。 在未来几个月中会添加对其他数据源和访问类型的支持。 有关详细信息，请参阅[连接到数据源](https://docs.azure.cn/power-bi-workspace-collections/connect-datasource),Power BI 工作区集合当前支持哪些数据源？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
不可以。 应用程序的最终用户无需单独购买 Power BI 订阅便可访问应用内数据可视化元素。 在 Power BI 工作区集合模型中，会通过 Azure 消耗计量器针对服务向应用程序提供商计费。 请参阅[定价和许可页](https://www.azure.cn/pricing/details/power-bi-embedded),应用程序的最终用户是否需要 Power BI 许可证？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
\n\n作为应用程序开发人员，创建希望在应用程序中使用的报表和可视化元素无需具有 Power BI 订阅。 但需要 Azure 订阅和免费的 Power BI Desktop 应用程序。\n\n有关如何使用 Power BI 工作区集合服务的详细信息，请参阅服务文档。\n,使用 Power BI 工作区集合开发应用程序是否需要 Power BI 订阅？ 如何开始？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
"\n\nPower BI 工作区集合服务使用""应用令牌""进行身份验证和授权，而不是使用显式的最终用户身份验证。 在应用令牌模型中，应用程序管理最终用户的身份验证和授权。 然后，若有必要，应用将创建\n\n并发送应用令牌，以指示服务来呈现所请求的报表。 此设计不要求应用使用 Azure AD 进行用户身份验证和授权，但仍然可以这样做。 可以[在此处](https://docs.azure.cn/power-bi-workspace-collections/app-token-flow)了解应用令牌的详细信息。 Power BI 工作区集合中还引入了行级安全性 (RLS) 功能以用于高级安全性筛选方案。\n",如何对 Power BI 工作区集合的用户进行身份验证？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
会话是指最终用户和 Power BI 工作区集合报表之间的一组交互活动。 每次向用户显示 Power BI 工作区集合报表时，就会启动一个会话，并向订阅持有者收取使用会话的费用。 会话按统一收费率计费，独立于报表中的视觉对象元素数量或报表内容的刷新频率。 当用户关闭报表时或者会话于一小时后超时时，会话结束。,什么是报表会话，它是如何计费的？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
具有 Azure 标准 SLA 的 Power BI 工作区集合。 有关详细信息，请参阅 [服务级别协议](https://www.azure.cn/support/legal/sla/),对于该服务，可用的 SLA 是什么？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
目前，大多数数据中心内都提供 Power BI 工作区集合服务。 始终可以 [在此处](https://azure.microsoft.com/status/)检查最新可用性。,此服务是否在全球提供？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
Power BI 工作区集合是一项 Azure 服务，应用程序开发人员可以通过该服务将令人惊叹的完整交互式报表和可视化元素嵌入到面向客户的应用中，使客户无需花费时间和费用从头开始生成其自己的控件。 现在，全球 9 个数据中心内都提供了包含 SLA 的 Power BI 工作区集合。 此服务中还提供了增强的功能，例如，支持通过 Power BI 工作区集合中的行级安全性 (RLS) 提供数据安全性以用于高级筛选。 Power BI 工作区集合定价模型也进行了简化和更新。,什么是 Power BI 工作区集合？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
不能，Power BI 工作区集合仅供外部用户使用，不应在内部业务应用程序中使用。 为了嵌入用于内部业务应用程序的 Power BI 内容，应该使用 Power BI 服务，并且所有使用该内容的用户必须拥有一个有效的 Power BI 免费版或 Power BI Pro 的用户订阅许可证。 有关如何将内部应用程序与 Power BI 服务进行集成的详细信息，请访问 [https://dev.powerbi.cn](https://dev.powerbi.cn/),Power BI 工作区集合可以用于创建内部应用程序吗？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
Power BI 工作区集合仅用于为供第三方使用而提供的应用程序。 如果想要使用 Power BI 工作区集合服务创建内部业务应用程序，则每个内部用户都需要具有一个 Power BI Pro USL，并且组织除需要支付 Power BI Pro USL 费用外，还需要支付使用 Power BI 工作区集合服务的费用。 为避免产生 Power BI Pro USL 费和 Power BI 工作区集合用于内部应用程序的消耗成本，Power BI 服务在 Power BI 工作区集合外提供了其自己的内容嵌入功能，而未额外增加 Power BI USL 持有者的成本 (dev.powerbi.cn)。,关于如何在应用中使用 Power BI 工作区集合是否存在任何规则或限制？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
当可以利用优秀的交互式数据可视化功能直接在应用程序中通知用户的决策时，应用程序的功能将更为强大。 Power BI 工作区集合可通过丰富的、始终保持最新的交互式数据可视化元素增强应用，以便提高应用的实用性、用户的满意度和忠诚度，并可在任何设备上轻松提供语境分析。,Power BI 工作区集合如何改进应用？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
Power BI 工作区集合和 Power BI 服务是单独的产品/服务。 Power BI 工作区集合采取基于消费的计费模式，通过 Azure 门户部署并且旨在使 ISV 能够将数据可视化元素嵌入到应用程序中，供其客户使用。 Power BI 服务通过 O365 门户进行计费和部署，是一个独立通用的 BI 产品/服务，主要供企业内部使用。 若要了解 Power BI 服务的详细信息，请参阅 [www.powerbi.com](https://powerbi.microsoft.com/),Power BI 工作区集合与 Power BI 服务有什么关系？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
Power BI 工作区集合适用于想要不必自己进行生成即可向其用户的所有设备提供令人惊叹的交互式数据可视化体验的应用程序开发人员。 通过 Power BI 工作区集合，开发人员可以利用直接查询提供始终保持最新的视图。 开发人员还可以使用 Azure 资源管理器 API 和 Power BI API 以编程方式部署、管理和自动化 Power BI。 与所有的 Power BI 服务一样，这种嵌入式服务也可以自动缩放以满足应用程序的使用情况和需求。 Power BI 工作区集合服务采取即用即付消费的定价模式。,谁想要使用 Power BI 工作区集合，为什么？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
Azure 门户会提供关于针对订阅已执行的呈现/报表会话数的帐单详细信息。,是否提供了任何工具或指南来帮助用户估计应预估的呈现/会话数？ 如何才能知道已完成了多少呈现？,power bi-workspace-collections,https://docs.azure.cn/power-bi-workspace-collections/faq
"\n\nRedis 服务器本身不支持 SSL，但 Azure Redis 缓存可以。 如果要连接到 Azure Redis 缓存并且客户端支持 SSL（如 StackExchange.Redis），则你应使用 SSL。\n\n\nNote\n\n默认情况下，为新的 Azure Redis 缓存实例禁用了非 SSL 端口。 如果客户端不支持 SSL，则必须根据[在 Azure Redis 缓存中配置缓存](https://docs.azure.cn/redis-cache/cache-configure)一文中的[访问端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)部分中的说明启用非 SSL 端口。\n\n\n`redis-cli` 等 Redis 工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 生产的一些最佳做法是什么？\n\n*   [StackExchange.Redis 最佳做法](https://docs.azure.cn/redis-cache/#stackexchangeredis-best-practices)\n*   [配置和概念](https://docs.azure.cn/redis-cache/#configuration-and-concepts)\n*   [性能测试](https://docs.azure.cn/redis-cache/#performance-testing)\n\n#### StackExchange.Redis 最佳做法\n\n*   将 `AbortConnect` 设置为 false，并使 ConnectionMultiplexer 自动重新连接。 [请参阅此处了解详细信息](https://gist.github.com/JonCole/36ba6f60c274e89014dd#file-se-redis-setabortconnecttofalse-md)。\n*   重复使用 ConnectionMultiplexer - 不要为每个请求创建一个新的 ConnectionMultiplexe。 建议使用[此处所示](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)的 `` 模式。\n*   具有较小值的 Redis 工作性能最佳，因此请考虑将较大数据分成多个密钥。 阅读[本文](https://gist.github.com/JonCole/db0e90bedeb3fc4823c2#large-requestresponse-size)了解较大值可能引起的问题示例。\n*   配置 [ThreadPool 设置](https://docs.azure.cn/redis-cache/#important-details-about-threadpool-growth) ，以免超时。\n*   将默认 connectTimeout 至少设置为 5 秒。 出现网络故障时，此时间间隔会给 StackExchange.Redis 足够的时间来重新建立连接。\n*   注意与正在运行的不同操作相关的性能成本。 例如，`KEYS` 命令是 O(n) 操作，应当避免。 [redis.io](http://redis.io/commands/) 站点具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n\n#### 配置和概念\n\n*   针对生产系统使用标准层或高级层。 基本层是没有数据复制和 SLA 的单节点系统。 此外，使用至少一个 C1 缓存。 C0 缓存通常用于简单的开发/测试方案。\n*   请记住，Redis 是 内存中 数据存储区。 阅读[本文](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md)，了解可能出现数据丢失的情况。\n*   开发系统以便处理[由于修补和故障转移](https://gist.github.com/JonCole/317fe03805d5802e31cfa37e646e419d#file-azureredis-patchingexplained-md)引起的连接故障。\n\n#### 性能测试\n\n*   使用 `redis-benchmark.exe` 启动以在编写性能测试前感受可能的吞吐量。 因为 `redis-benchmark` 不支持 SSL，因此，在运行测试之前必须[通过 Azure 门户启用非 SSL 端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)。 例如，请参阅 [如何制定基准和测试缓存的性能？](https://docs.azure.cn/redis-cache/#how-can-i-benchmark-and-test-the-performance-of-my-cache)\n*   用于测试的客户端 VM 应与 Redis 缓存实例位于同一区域。\n*   建议为客户端使用 Dv2 VM 系列，因为该系列具有更好的硬件，会提供最佳的结果。\n*   确保选择的客户端 VM 至少与正在测试的缓存拥有相同的计算和带宽容量。\n*   如果是在 Windows 设备上操作，请在客户端计算机上启用 VRSS。 [请参阅此处了解详细信息](https://technet.microsoft.com/library/dn383582.aspx)。\n*   高级层 Redis 实例具有更好的网络延迟和吞吐量，因为它们是在 CPU 和网络两方面都更好的硬件上运行的。\n\n### 使用常见 Redis 命令时要注意哪些问题？\n\n*   对于某些需要较长时间才能完成的 Redis 命令，在未了解这些命令造成的影响的情况下，不应运行这些命令。\n\n    *   例如，不要在生产环境中运行 [KEYS](http://redis.io/commands/keys) 命令，因为它可能需要很长时间才能返回，具体时间取决于键数。 Redis 是单线程服务器，每次只能处理一个命令。 如果在 KEYS 后面发出了其他命令，则这些命令只会在处理完 KEYS 命令后才会得到处理。 [redis.io 站点](http://redis.io/commands/) 具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n*   键大小 - 应使用小键/值还是大键/值？ 通常这取决于方案。 如果方案需要较大的键，则可调整 ConnectionTimeout 和重试值，并调整重试逻辑。 从 Redis 服务器的角度来看，值越小，性能就越好。\n*   这些考量并不意味着不能在 Redis 中存储较大值，只是要注意以下事项。 延迟会提高。 如果采用一个较大的数据集和一个较小的数据集，则可以使用多个 ConnectionMultiplexer 实例，并根据 [StackExchange.Redis 配置选项有什么作用](https://docs.azure.cn/redis-cache/#cache-configuration)部分中所述，为每个实例配置一组不同的超时和重试值。\n\n### 如何进行基准检验和测试缓存的性能？\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",何时应启用非 SSL 端口来连接 Redis？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\n*   [StackExchange.Redis 最佳做法](https://docs.azure.cn/redis-cache/#stackexchangeredis-best-practices)\n*   [配置和概念](https://docs.azure.cn/redis-cache/#configuration-and-concepts)\n*   [性能测试](https://docs.azure.cn/redis-cache/#performance-testing)\n\n#### StackExchange.Redis 最佳做法\n\n*   将 `AbortConnect` 设置为 false，并使 ConnectionMultiplexer 自动重新连接。 [请参阅此处了解详细信息](https://gist.github.com/JonCole/36ba6f60c274e89014dd#file-se-redis-setabortconnecttofalse-md)。\n*   重复使用 ConnectionMultiplexer - 不要为每个请求创建一个新的 ConnectionMultiplexe。 建议使用[此处所示](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)的 `` 模式。\n*   具有较小值的 Redis 工作性能最佳，因此请考虑将较大数据分成多个密钥。 阅读[本文](https://gist.github.com/JonCole/db0e90bedeb3fc4823c2#large-requestresponse-size)了解较大值可能引起的问题示例。\n*   配置 [ThreadPool 设置](https://docs.azure.cn/redis-cache/#important-details-about-threadpool-growth) ，以免超时。\n*   将默认 connectTimeout 至少设置为 5 秒。 出现网络故障时，此时间间隔会给 StackExchange.Redis 足够的时间来重新建立连接。\n*   注意与正在运行的不同操作相关的性能成本。 例如，`KEYS` 命令是 O(n) 操作，应当避免。 [redis.io](http://redis.io/commands/) 站点具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n\n#### 配置和概念\n\n*   针对生产系统使用标准层或高级层。 基本层是没有数据复制和 SLA 的单节点系统。 此外，使用至少一个 C1 缓存。 C0 缓存通常用于简单的开发/测试方案。\n*   请记住，Redis 是 内存中 数据存储区。 阅读[本文](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md)，了解可能出现数据丢失的情况。\n*   开发系统以便处理[由于修补和故障转移](https://gist.github.com/JonCole/317fe03805d5802e31cfa37e646e419d#file-azureredis-patchingexplained-md)引起的连接故障。\n\n#### 性能测试\n\n*   使用 `redis-benchmark.exe` 启动以在编写性能测试前感受可能的吞吐量。 因为 `redis-benchmark` 不支持 SSL，因此，在运行测试之前必须[通过 Azure 门户启用非 SSL 端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)。 例如，请参阅 [如何制定基准和测试缓存的性能？](https://docs.azure.cn/redis-cache/#how-can-i-benchmark-and-test-the-performance-of-my-cache)\n*   用于测试的客户端 VM 应与 Redis 缓存实例位于同一区域。\n*   建议为客户端使用 Dv2 VM 系列，因为该系列具有更好的硬件，会提供最佳的结果。\n*   确保选择的客户端 VM 至少与正在测试的缓存拥有相同的计算和带宽容量。\n*   如果是在 Windows 设备上操作，请在客户端计算机上启用 VRSS。 [请参阅此处了解详细信息](https://technet.microsoft.com/library/dn383582.aspx)。\n*   高级层 Redis 实例具有更好的网络延迟和吞吐量，因为它们是在 CPU 和网络两方面都更好的硬件上运行的。\n\n### 使用常见 Redis 命令时要注意哪些问题？\n\n*   对于某些需要较长时间才能完成的 Redis 命令，在未了解这些命令造成的影响的情况下，不应运行这些命令。\n\n    *   例如，不要在生产环境中运行 [KEYS](http://redis.io/commands/keys) 命令，因为它可能需要很长时间才能返回，具体时间取决于键数。 Redis 是单线程服务器，每次只能处理一个命令。 如果在 KEYS 后面发出了其他命令，则这些命令只会在处理完 KEYS 命令后才会得到处理。 [redis.io 站点](http://redis.io/commands/) 具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n*   键大小 - 应使用小键/值还是大键/值？ 通常这取决于方案。 如果方案需要较大的键，则可调整 ConnectionTimeout 和重试值，并调整重试逻辑。 从 Redis 服务器的角度来看，值越小，性能就越好。\n*   这些考量并不意味着不能在 Redis 中存储较大值，只是要注意以下事项。 延迟会提高。 如果采用一个较大的数据集和一个较小的数据集，则可以使用多个 ConnectionMultiplexer 实例，并根据 [StackExchange.Redis 配置选项有什么作用](https://docs.azure.cn/redis-cache/#cache-configuration)部分中所述，为每个实例配置一组不同的超时和重试值。\n\n### 如何进行基准检验和测试缓存的性能？\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",生产的一些最佳做法是什么？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\n*   对于某些需要较长时间才能完成的 Redis 命令，在未了解这些命令造成的影响的情况下，不应运行这些命令。\n\n    *   例如，不要在生产环境中运行 [KEYS](http://redis.io/commands/keys) 命令，因为它可能需要很长时间才能返回，具体时间取决于键数。 Redis 是单线程服务器，每次只能处理一个命令。 如果在 KEYS 后面发出了其他命令，则这些命令只会在处理完 KEYS 命令后才会得到处理。 [redis.io 站点](http://redis.io/commands/) 具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n*   键大小 - 应使用小键/值还是大键/值？ 通常这取决于方案。 如果方案需要较大的键，则可调整 ConnectionTimeout 和重试值，并调整重试逻辑。 从 Redis 服务器的角度来看，值越小，性能就越好。\n*   这些考量并不意味着不能在 Redis 中存储较大值，只是要注意以下事项。 延迟会提高。 如果采用一个较大的数据集和一个较小的数据集，则可以使用多个 ConnectionMultiplexer 实例，并根据 [StackExchange.Redis 配置选项有什么作用](https://docs.azure.cn/redis-cache/#cache-configuration)部分中所述，为每个实例配置一组不同的超时和重试值。\n\n### 如何进行基准检验和测试缓存的性能？\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",使用常见 Redis 命令时要注意哪些问题？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n,哪种 Azure 缓存产品适合我？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",如何监视缓存的运行状况和性能？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n,为何会出现超时？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n,客户端为何与缓存断开连接？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",如何进行基准检验和测试缓存的性能？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\nRedis 数据库就是同一 Redis 实例中的数据的逻辑隔离。 缓存内存在所有数据库之间共享，给定数据库的实际内存消耗取决于该数据库中存储的键/值。 例如，C6 缓存具有 53 GB 的内存。 可以选择将全部 53 GB 放置在一个数据库中，也可以将其分配到多个数据库中。 \n\n\nNote\n\n使用启用了群集功能的高级 Azure Redis 缓存时，仅数据库 0 可用。 此限制是固有的 Redis 限制，并不特定于 Azure Redis 缓存。 有关详细信息，请参阅[使用群集功能时，是否需要对客户端应用程序进行更改？](https://docs.azure.cn/redis-cache/cache-how-to-premium-clustering#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)\n\n\n### 何时应启用非 SSL 端口来连接 Redis？\n\nRedis 服务器本身不支持 SSL，但 Azure Redis 缓存可以。 如果要连接到 Azure Redis 缓存并且客户端支持 SSL（如 StackExchange.Redis），则你应使用 SSL。\n\n\nNote\n\n默认情况下，为新的 Azure Redis 缓存实例禁用了非 SSL 端口。 如果客户端不支持 SSL，则必须根据[在 Azure Redis 缓存中配置缓存](https://docs.azure.cn/redis-cache/cache-configure)一文中的[访问端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)部分中的说明启用非 SSL 端口。\n\n\n`redis-cli` 等 Redis 工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 生产的一些最佳做法是什么？\n\n*   [StackExchange.Redis 最佳做法](https://docs.azure.cn/redis-cache/#stackexchangeredis-best-practices)\n*   [配置和概念](https://docs.azure.cn/redis-cache/#configuration-and-concepts)\n*   [性能测试](https://docs.azure.cn/redis-cache/#performance-testing)\n\n#### StackExchange.Redis 最佳做法\n\n*   将 `AbortConnect` 设置为 false，并使 ConnectionMultiplexer 自动重新连接。 [请参阅此处了解详细信息](https://gist.github.com/JonCole/36ba6f60c274e89014dd#file-se-redis-setabortconnecttofalse-md)。\n*   重复使用 ConnectionMultiplexer - 不要为每个请求创建一个新的 ConnectionMultiplexe。 建议使用[此处所示](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)的 `` 模式。\n*   具有较小值的 Redis 工作性能最佳，因此请考虑将较大数据分成多个密钥。 阅读[本文](https://gist.github.com/JonCole/db0e90bedeb3fc4823c2#large-requestresponse-size)了解较大值可能引起的问题示例。\n*   配置 [ThreadPool 设置](https://docs.azure.cn/redis-cache/#important-details-about-threadpool-growth) ，以免超时。\n*   将默认 connectTimeout 至少设置为 5 秒。 出现网络故障时，此时间间隔会给 StackExchange.Redis 足够的时间来重新建立连接。\n*   注意与正在运行的不同操作相关的性能成本。 例如，`KEYS` 命令是 O(n) 操作，应当避免。 [redis.io](http://redis.io/commands/) 站点具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n\n#### 配置和概念\n\n*   针对生产系统使用标准层或高级层。 基本层是没有数据复制和 SLA 的单节点系统。 此外，使用至少一个 C1 缓存。 C0 缓存通常用于简单的开发/测试方案。\n*   请记住，Redis 是 内存中 数据存储区。 阅读[本文](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md)，了解可能出现数据丢失的情况。\n*   开发系统以便处理[由于修补和故障转移](https://gist.github.com/JonCole/317fe03805d5802e31cfa37e646e419d#file-azureredis-patchingexplained-md)引起的连接故障。\n\n#### 性能测试\n\n*   使用 `redis-benchmark.exe` 启动以在编写性能测试前感受可能的吞吐量。 因为 `redis-benchmark` 不支持 SSL，因此，在运行测试之前必须[通过 Azure 门户启用非 SSL 端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)。 例如，请参阅 [如何制定基准和测试缓存的性能？](https://docs.azure.cn/redis-cache/#how-can-i-benchmark-and-test-the-performance-of-my-cache)\n*   用于测试的客户端 VM 应与 Redis 缓存实例位于同一区域。\n*   建议为客户端使用 Dv2 VM 系列，因为该系列具有更好的硬件，会提供最佳的结果。\n*   确保选择的客户端 VM 至少与正在测试的缓存拥有相同的计算和带宽容量。\n*   如果是在 Windows 设备上操作，请在客户端计算机上启用 VRSS。 [请参阅此处了解详细信息](https://technet.microsoft.com/library/dn383582.aspx)。\n*   高级层 Redis 实例具有更好的网络延迟和吞吐量，因为它们是在 CPU 和网络两方面都更好的硬件上运行的。\n\n### 使用常见 Redis 命令时要注意哪些问题？\n\n*   对于某些需要较长时间才能完成的 Redis 命令，在未了解这些命令造成的影响的情况下，不应运行这些命令。\n\n    *   例如，不要在生产环境中运行 [KEYS](http://redis.io/commands/keys) 命令，因为它可能需要很长时间才能返回，具体时间取决于键数。 Redis 是单线程服务器，每次只能处理一个命令。 如果在 KEYS 后面发出了其他命令，则这些命令只会在处理完 KEYS 命令后才会得到处理。 [redis.io 站点](http://redis.io/commands/) 具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n*   键大小 - 应使用小键/值还是大键/值？ 通常这取决于方案。 如果方案需要较大的键，则可调整 ConnectionTimeout 和重试值，并调整重试逻辑。 从 Redis 服务器的角度来看，值越小，性能就越好。\n*   这些考量并不意味着不能在 Redis 中存储较大值，只是要注意以下事项。 延迟会提高。 如果采用一个较大的数据集和一个较小的数据集，则可以使用多个 ConnectionMultiplexer 实例，并根据 [StackExchange.Redis 配置选项有什么作用](https://docs.azure.cn/redis-cache/#cache-configuration)部分中所述，为每个实例配置一组不同的超时和重试值。\n\n### 如何进行基准检验和测试缓存的性能？\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",什么是 Redis 数据库？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\n可以使用 [Redis 命令](http://redis.io/commands#)中列出的任何命令，但 [Azure Redis 缓存中不支持的 Redis 命令](https://docs.azure.cn/redis-cache/cache-configure#redis-commands-not-supported-in-azure-redis-cache)所列的命令除外。 可以使用多个选项来运行 Redis 命令。\n\n*   如果采用标准或高级缓存，可以使用 [Redis 控制台](https://docs.azure.cn/redis-cache/cache-configure#redis-console)运行 Redis 命令。 Redis 控制台提供了一种在 Azure 门户中安全地运行 Redis 命令的方式。\n*   还可以使用 Redis 命令行工具。 若要使用这些工具，请执行以下步骤：\n*   下载 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/)。\n*   使用 `redis-cli.exe`连接到缓存。 使用 -h 开关传入缓存终结点，使用 -a 传入密钥，如以下示例中所示：\n*   ``\n\nNote\n\nRedis 命令行工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n\n### Azure Redis 缓存为何不像某些其他 Azure 服务一样提供 MSDN 类库参考？\n\nAzure Redis 缓存基于流行的开源 Redis 缓存，可以通过各种 [Redis 客户端](http://redis.io/clients) 进行访问，这些客户端适用于许多编程语言。 每个客户端有自身的 API，用于通过 [Redis 命令](http://redis.io/commands)调用 Redis 缓存实例。\n\n由于客户端各不相同，因此 MSDN 上未提供统一的类引用，每个客户端都有自己的参考文档。 除了参考文档以外，还可以参阅多个教程，这些教程介绍了如何通过不同的语言和缓存客户端来开始使用 Azure Redis 缓存。 要访问这些教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n### 是否可将 Azure Redis 缓存用作 PHP 会话缓存？\n\n可以。若要使用 Azure Redis 缓存作为 PHP 会话缓存，请在 `session.save_path` 中指定 Azure Redis 缓存实例的连接字符串。\n\n\nImportant\n\n使用 Azure Redis 缓存作为 PHP 会话缓存时，必须对用于连接到缓存的安全密钥进行 URL 编码，如以下示例所示：\n\n``\n\n如果未对密钥进行 URL 编码，可能会收到类似于以下消息的异常： `Failed to parse session.save_path`\n\n\n有关在 PhpRedis 客户端中使用 Redis 缓存作为 PHP 会话缓存的详细信息，请参阅 [PHP Session handler](https://github.com/phpredis/phpredis#php-session-handler)（PHP 会话处理程序）。\n\n### 什么是 Redis 数据库？\n\nRedis 数据库就是同一 Redis 实例中的数据的逻辑隔离。 缓存内存在所有数据库之间共享，给定数据库的实际内存消耗取决于该数据库中存储的键/值。 例如，C6 缓存具有 53 GB 的内存。 可以选择将全部 53 GB 放置在一个数据库中，也可以将其分配到多个数据库中。 \n\n\nNote\n\n使用启用了群集功能的高级 Azure Redis 缓存时，仅数据库 0 可用。 此限制是固有的 Redis 限制，并不特定于 Azure Redis 缓存。 有关详细信息，请参阅[使用群集功能时，是否需要对客户端应用程序进行更改？](https://docs.azure.cn/redis-cache/cache-how-to-premium-clustering#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)\n\n\n### 何时应启用非 SSL 端口来连接 Redis？\n\nRedis 服务器本身不支持 SSL，但 Azure Redis 缓存可以。 如果要连接到 Azure Redis 缓存并且客户端支持 SSL（如 StackExchange.Redis），则你应使用 SSL。\n\n\nNote\n\n默认情况下，为新的 Azure Redis 缓存实例禁用了非 SSL 端口。 如果客户端不支持 SSL，则必须根据[在 Azure Redis 缓存中配置缓存](https://docs.azure.cn/redis-cache/cache-configure)一文中的[访问端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)部分中的说明启用非 SSL 端口。\n\n\n`redis-cli` 等 Redis 工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 生产的一些最佳做法是什么？\n\n*   [StackExchange.Redis 最佳做法](https://docs.azure.cn/redis-cache/#stackexchangeredis-best-practices)\n*   [配置和概念](https://docs.azure.cn/redis-cache/#configuration-and-concepts)\n*   [性能测试](https://docs.azure.cn/redis-cache/#performance-testing)\n\n#### StackExchange.Redis 最佳做法\n\n*   将 `AbortConnect` 设置为 false，并使 ConnectionMultiplexer 自动重新连接。 [请参阅此处了解详细信息](https://gist.github.com/JonCole/36ba6f60c274e89014dd#file-se-redis-setabortconnecttofalse-md)。\n*   重复使用 ConnectionMultiplexer - 不要为每个请求创建一个新的 ConnectionMultiplexe。 建议使用[此处所示](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)的 `` 模式。\n*   具有较小值的 Redis 工作性能最佳，因此请考虑将较大数据分成多个密钥。 阅读[本文](https://gist.github.com/JonCole/db0e90bedeb3fc4823c2#large-requestresponse-size)了解较大值可能引起的问题示例。\n*   配置 [ThreadPool 设置](https://docs.azure.cn/redis-cache/#important-details-about-threadpool-growth) ，以免超时。\n*   将默认 connectTimeout 至少设置为 5 秒。 出现网络故障时，此时间间隔会给 StackExchange.Redis 足够的时间来重新建立连接。\n*   注意与正在运行的不同操作相关的性能成本。 例如，`KEYS` 命令是 O(n) 操作，应当避免。 [redis.io](http://redis.io/commands/) 站点具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n\n#### 配置和概念\n\n*   针对生产系统使用标准层或高级层。 基本层是没有数据复制和 SLA 的单节点系统。 此外，使用至少一个 C1 缓存。 C0 缓存通常用于简单的开发/测试方案。\n*   请记住，Redis 是 内存中 数据存储区。 阅读[本文](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md)，了解可能出现数据丢失的情况。\n*   开发系统以便处理[由于修补和故障转移](https://gist.github.com/JonCole/317fe03805d5802e31cfa37e646e419d#file-azureredis-patchingexplained-md)引起的连接故障。\n\n#### 性能测试\n\n*   使用 `redis-benchmark.exe` 启动以在编写性能测试前感受可能的吞吐量。 因为 `redis-benchmark` 不支持 SSL，因此，在运行测试之前必须[通过 Azure 门户启用非 SSL 端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)。 例如，请参阅 [如何制定基准和测试缓存的性能？](https://docs.azure.cn/redis-cache/#how-can-i-benchmark-and-test-the-performance-of-my-cache)\n*   用于测试的客户端 VM 应与 Redis 缓存实例位于同一区域。\n*   建议为客户端使用 Dv2 VM 系列，因为该系列具有更好的硬件，会提供最佳的结果。\n*   确保选择的客户端 VM 至少与正在测试的缓存拥有相同的计算和带宽容量。\n*   如果是在 Windows 设备上操作，请在客户端计算机上启用 VRSS。 [请参阅此处了解详细信息](https://technet.microsoft.com/library/dn383582.aspx)。\n*   高级层 Redis 实例具有更好的网络延迟和吞吐量，因为它们是在 CPU 和网络两方面都更好的硬件上运行的。\n\n### 使用常见 Redis 命令时要注意哪些问题？\n\n*   对于某些需要较长时间才能完成的 Redis 命令，在未了解这些命令造成的影响的情况下，不应运行这些命令。\n\n    *   例如，不要在生产环境中运行 [KEYS](http://redis.io/commands/keys) 命令，因为它可能需要很长时间才能返回，具体时间取决于键数。 Redis 是单线程服务器，每次只能处理一个命令。 如果在 KEYS 后面发出了其他命令，则这些命令只会在处理完 KEYS 命令后才会得到处理。 [redis.io 站点](http://redis.io/commands/) 具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n*   键大小 - 应使用小键/值还是大键/值？ 通常这取决于方案。 如果方案需要较大的键，则可调整 ConnectionTimeout 和重试值，并调整重试逻辑。 从 Redis 服务器的角度来看，值越小，性能就越好。\n*   这些考量并不意味着不能在 Redis 中存储较大值，只是要注意以下事项。 延迟会提高。 如果采用一个较大的数据集和一个较小的数据集，则可以使用多个 ConnectionMultiplexer 实例，并根据 [StackExchange.Redis 配置选项有什么作用](https://docs.azure.cn/redis-cache/#cache-configuration)部分中所述，为每个实例配置一组不同的超时和重试值。\n\n### 如何进行基准检验和测试缓存的性能？\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",如何运行 Redis 命令？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\nAzure Redis 缓存基于流行的开源 Redis 缓存，可以通过各种 [Redis 客户端](http://redis.io/clients) 进行访问，这些客户端适用于许多编程语言。 每个客户端有自身的 API，用于通过 [Redis 命令](http://redis.io/commands)调用 Redis 缓存实例。\n\n由于客户端各不相同，因此 MSDN 上未提供统一的类引用，每个客户端都有自己的参考文档。 除了参考文档以外，还可以参阅多个教程，这些教程介绍了如何通过不同的语言和缓存客户端来开始使用 Azure Redis 缓存。 要访问这些教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n### 是否可将 Azure Redis 缓存用作 PHP 会话缓存？\n\n可以。若要使用 Azure Redis 缓存作为 PHP 会话缓存，请在 `session.save_path` 中指定 Azure Redis 缓存实例的连接字符串。\n\n\nImportant\n\n使用 Azure Redis 缓存作为 PHP 会话缓存时，必须对用于连接到缓存的安全密钥进行 URL 编码，如以下示例所示：\n\n``\n\n如果未对密钥进行 URL 编码，可能会收到类似于以下消息的异常： `Failed to parse session.save_path`\n\n\n有关在 PhpRedis 客户端中使用 Redis 缓存作为 PHP 会话缓存的详细信息，请参阅 [PHP Session handler](https://github.com/phpredis/phpredis#php-session-handler)（PHP 会话处理程序）。\n\n### 什么是 Redis 数据库？\n\nRedis 数据库就是同一 Redis 实例中的数据的逻辑隔离。 缓存内存在所有数据库之间共享，给定数据库的实际内存消耗取决于该数据库中存储的键/值。 例如，C6 缓存具有 53 GB 的内存。 可以选择将全部 53 GB 放置在一个数据库中，也可以将其分配到多个数据库中。 \n\n\nNote\n\n使用启用了群集功能的高级 Azure Redis 缓存时，仅数据库 0 可用。 此限制是固有的 Redis 限制，并不特定于 Azure Redis 缓存。 有关详细信息，请参阅[使用群集功能时，是否需要对客户端应用程序进行更改？](https://docs.azure.cn/redis-cache/cache-how-to-premium-clustering#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)\n\n\n### 何时应启用非 SSL 端口来连接 Redis？\n\nRedis 服务器本身不支持 SSL，但 Azure Redis 缓存可以。 如果要连接到 Azure Redis 缓存并且客户端支持 SSL（如 StackExchange.Redis），则你应使用 SSL。\n\n\nNote\n\n默认情况下，为新的 Azure Redis 缓存实例禁用了非 SSL 端口。 如果客户端不支持 SSL，则必须根据[在 Azure Redis 缓存中配置缓存](https://docs.azure.cn/redis-cache/cache-configure)一文中的[访问端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)部分中的说明启用非 SSL 端口。\n\n\n`redis-cli` 等 Redis 工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 生产的一些最佳做法是什么？\n\n*   [StackExchange.Redis 最佳做法](https://docs.azure.cn/redis-cache/#stackexchangeredis-best-practices)\n*   [配置和概念](https://docs.azure.cn/redis-cache/#configuration-and-concepts)\n*   [性能测试](https://docs.azure.cn/redis-cache/#performance-testing)\n\n#### StackExchange.Redis 最佳做法\n\n*   将 `AbortConnect` 设置为 false，并使 ConnectionMultiplexer 自动重新连接。 [请参阅此处了解详细信息](https://gist.github.com/JonCole/36ba6f60c274e89014dd#file-se-redis-setabortconnecttofalse-md)。\n*   重复使用 ConnectionMultiplexer - 不要为每个请求创建一个新的 ConnectionMultiplexe。 建议使用[此处所示](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)的 `` 模式。\n*   具有较小值的 Redis 工作性能最佳，因此请考虑将较大数据分成多个密钥。 阅读[本文](https://gist.github.com/JonCole/db0e90bedeb3fc4823c2#large-requestresponse-size)了解较大值可能引起的问题示例。\n*   配置 [ThreadPool 设置](https://docs.azure.cn/redis-cache/#important-details-about-threadpool-growth) ，以免超时。\n*   将默认 connectTimeout 至少设置为 5 秒。 出现网络故障时，此时间间隔会给 StackExchange.Redis 足够的时间来重新建立连接。\n*   注意与正在运行的不同操作相关的性能成本。 例如，`KEYS` 命令是 O(n) 操作，应当避免。 [redis.io](http://redis.io/commands/) 站点具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n\n#### 配置和概念\n\n*   针对生产系统使用标准层或高级层。 基本层是没有数据复制和 SLA 的单节点系统。 此外，使用至少一个 C1 缓存。 C0 缓存通常用于简单的开发/测试方案。\n*   请记住，Redis 是 内存中 数据存储区。 阅读[本文](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md)，了解可能出现数据丢失的情况。\n*   开发系统以便处理[由于修补和故障转移](https://gist.github.com/JonCole/317fe03805d5802e31cfa37e646e419d#file-azureredis-patchingexplained-md)引起的连接故障。\n\n#### 性能测试\n\n*   使用 `redis-benchmark.exe` 启动以在编写性能测试前感受可能的吞吐量。 因为 `redis-benchmark` 不支持 SSL，因此，在运行测试之前必须[通过 Azure 门户启用非 SSL 端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)。 例如，请参阅 [如何制定基准和测试缓存的性能？](https://docs.azure.cn/redis-cache/#how-can-i-benchmark-and-test-the-performance-of-my-cache)\n*   用于测试的客户端 VM 应与 Redis 缓存实例位于同一区域。\n*   建议为客户端使用 Dv2 VM 系列，因为该系列具有更好的硬件，会提供最佳的结果。\n*   确保选择的客户端 VM 至少与正在测试的缓存拥有相同的计算和带宽容量。\n*   如果是在 Windows 设备上操作，请在客户端计算机上启用 VRSS。 [请参阅此处了解详细信息](https://technet.microsoft.com/library/dn383582.aspx)。\n*   高级层 Redis 实例具有更好的网络延迟和吞吐量，因为它们是在 CPU 和网络两方面都更好的硬件上运行的。\n\n### 使用常见 Redis 命令时要注意哪些问题？\n\n*   对于某些需要较长时间才能完成的 Redis 命令，在未了解这些命令造成的影响的情况下，不应运行这些命令。\n\n    *   例如，不要在生产环境中运行 [KEYS](http://redis.io/commands/keys) 命令，因为它可能需要很长时间才能返回，具体时间取决于键数。 Redis 是单线程服务器，每次只能处理一个命令。 如果在 KEYS 后面发出了其他命令，则这些命令只会在处理完 KEYS 命令后才会得到处理。 [redis.io 站点](http://redis.io/commands/) 具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n*   键大小 - 应使用小键/值还是大键/值？ 通常这取决于方案。 如果方案需要较大的键，则可调整 ConnectionTimeout 和重试值，并调整重试逻辑。 从 Redis 服务器的角度来看，值越小，性能就越好。\n*   这些考量并不意味着不能在 Redis 中存储较大值，只是要注意以下事项。 延迟会提高。 如果采用一个较大的数据集和一个较小的数据集，则可以使用多个 ConnectionMultiplexer 实例，并根据 [StackExchange.Redis 配置选项有什么作用](https://docs.azure.cn/redis-cache/#cache-configuration)部分中所述，为每个实例配置一组不同的超时和重试值。\n\n### 如何进行基准检验和测试缓存的性能？\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",Azure Redis 缓存为何不像某些其他 Azure 服务一样提供 MSDN 类库参考？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\nAzure Redis 缓存没有本地模拟器，但可以在本地计算机上从 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/) 运行 MSOpenTech 版本的 redis-server.exe 并连接到它，以获得与本地缓存模拟器相似的体验，如以下示例所示：\n\n``\n\n如果需要，可以选择配置 [redis.conf](http://redis.io/topics/config) 文件，以更好地匹配联机 Azure Redis 缓存的[默认缓存设置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何运行 Redis 命令？\n\n可以使用 [Redis 命令](http://redis.io/commands#)中列出的任何命令，但 [Azure Redis 缓存中不支持的 Redis 命令](https://docs.azure.cn/redis-cache/cache-configure#redis-commands-not-supported-in-azure-redis-cache)所列的命令除外。 可以使用多个选项来运行 Redis 命令。\n\n*   如果采用标准或高级缓存，可以使用 [Redis 控制台](https://docs.azure.cn/redis-cache/cache-configure#redis-console)运行 Redis 命令。 Redis 控制台提供了一种在 Azure 门户中安全地运行 Redis 命令的方式。\n*   还可以使用 Redis 命令行工具。 若要使用这些工具，请执行以下步骤：\n*   下载 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/)。\n*   使用 `redis-cli.exe`连接到缓存。 使用 -h 开关传入缓存终结点，使用 -a 传入密钥，如以下示例中所示：\n*   ``\n\nNote\n\nRedis 命令行工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n\n### Azure Redis 缓存为何不像某些其他 Azure 服务一样提供 MSDN 类库参考？\n\nAzure Redis 缓存基于流行的开源 Redis 缓存，可以通过各种 [Redis 客户端](http://redis.io/clients) 进行访问，这些客户端适用于许多编程语言。 每个客户端有自身的 API，用于通过 [Redis 命令](http://redis.io/commands)调用 Redis 缓存实例。\n\n由于客户端各不相同，因此 MSDN 上未提供统一的类引用，每个客户端都有自己的参考文档。 除了参考文档以外，还可以参阅多个教程，这些教程介绍了如何通过不同的语言和缓存客户端来开始使用 Azure Redis 缓存。 要访问这些教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n### 是否可将 Azure Redis 缓存用作 PHP 会话缓存？\n\n可以。若要使用 Azure Redis 缓存作为 PHP 会话缓存，请在 `session.save_path` 中指定 Azure Redis 缓存实例的连接字符串。\n\n\nImportant\n\n使用 Azure Redis 缓存作为 PHP 会话缓存时，必须对用于连接到缓存的安全密钥进行 URL 编码，如以下示例所示：\n\n``\n\n如果未对密钥进行 URL 编码，可能会收到类似于以下消息的异常： `Failed to parse session.save_path`\n\n\n有关在 PhpRedis 客户端中使用 Redis 缓存作为 PHP 会话缓存的详细信息，请参阅 [PHP Session handler](https://github.com/phpredis/phpredis#php-session-handler)（PHP 会话处理程序）。\n\n### 什么是 Redis 数据库？\n\nRedis 数据库就是同一 Redis 实例中的数据的逻辑隔离。 缓存内存在所有数据库之间共享，给定数据库的实际内存消耗取决于该数据库中存储的键/值。 例如，C6 缓存具有 53 GB 的内存。 可以选择将全部 53 GB 放置在一个数据库中，也可以将其分配到多个数据库中。 \n\n\nNote\n\n使用启用了群集功能的高级 Azure Redis 缓存时，仅数据库 0 可用。 此限制是固有的 Redis 限制，并不特定于 Azure Redis 缓存。 有关详细信息，请参阅[使用群集功能时，是否需要对客户端应用程序进行更改？](https://docs.azure.cn/redis-cache/cache-how-to-premium-clustering#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)\n\n\n### 何时应启用非 SSL 端口来连接 Redis？\n\nRedis 服务器本身不支持 SSL，但 Azure Redis 缓存可以。 如果要连接到 Azure Redis 缓存并且客户端支持 SSL（如 StackExchange.Redis），则你应使用 SSL。\n\n\nNote\n\n默认情况下，为新的 Azure Redis 缓存实例禁用了非 SSL 端口。 如果客户端不支持 SSL，则必须根据[在 Azure Redis 缓存中配置缓存](https://docs.azure.cn/redis-cache/cache-configure)一文中的[访问端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)部分中的说明启用非 SSL 端口。\n\n\n`redis-cli` 等 Redis 工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 生产的一些最佳做法是什么？\n\n*   [StackExchange.Redis 最佳做法](https://docs.azure.cn/redis-cache/#stackexchangeredis-best-practices)\n*   [配置和概念](https://docs.azure.cn/redis-cache/#configuration-and-concepts)\n*   [性能测试](https://docs.azure.cn/redis-cache/#performance-testing)\n\n#### StackExchange.Redis 最佳做法\n\n*   将 `AbortConnect` 设置为 false，并使 ConnectionMultiplexer 自动重新连接。 [请参阅此处了解详细信息](https://gist.github.com/JonCole/36ba6f60c274e89014dd#file-se-redis-setabortconnecttofalse-md)。\n*   重复使用 ConnectionMultiplexer - 不要为每个请求创建一个新的 ConnectionMultiplexe。 建议使用[此处所示](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)的 `` 模式。\n*   具有较小值的 Redis 工作性能最佳，因此请考虑将较大数据分成多个密钥。 阅读[本文](https://gist.github.com/JonCole/db0e90bedeb3fc4823c2#large-requestresponse-size)了解较大值可能引起的问题示例。\n*   配置 [ThreadPool 设置](https://docs.azure.cn/redis-cache/#important-details-about-threadpool-growth) ，以免超时。\n*   将默认 connectTimeout 至少设置为 5 秒。 出现网络故障时，此时间间隔会给 StackExchange.Redis 足够的时间来重新建立连接。\n*   注意与正在运行的不同操作相关的性能成本。 例如，`KEYS` 命令是 O(n) 操作，应当避免。 [redis.io](http://redis.io/commands/) 站点具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n\n#### 配置和概念\n\n*   针对生产系统使用标准层或高级层。 基本层是没有数据复制和 SLA 的单节点系统。 此外，使用至少一个 C1 缓存。 C0 缓存通常用于简单的开发/测试方案。\n*   请记住，Redis 是 内存中 数据存储区。 阅读[本文](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md)，了解可能出现数据丢失的情况。\n*   开发系统以便处理[由于修补和故障转移](https://gist.github.com/JonCole/317fe03805d5802e31cfa37e646e419d#file-azureredis-patchingexplained-md)引起的连接故障。\n\n#### 性能测试\n\n*   使用 `redis-benchmark.exe` 启动以在编写性能测试前感受可能的吞吐量。 因为 `redis-benchmark` 不支持 SSL，因此，在运行测试之前必须[通过 Azure 门户启用非 SSL 端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)。 例如，请参阅 [如何制定基准和测试缓存的性能？](https://docs.azure.cn/redis-cache/#how-can-i-benchmark-and-test-the-performance-of-my-cache)\n*   用于测试的客户端 VM 应与 Redis 缓存实例位于同一区域。\n*   建议为客户端使用 Dv2 VM 系列，因为该系列具有更好的硬件，会提供最佳的结果。\n*   确保选择的客户端 VM 至少与正在测试的缓存拥有相同的计算和带宽容量。\n*   如果是在 Windows 设备上操作，请在客户端计算机上启用 VRSS。 [请参阅此处了解详细信息](https://technet.microsoft.com/library/dn383582.aspx)。\n*   高级层 Redis 实例具有更好的网络延迟和吞吐量，因为它们是在 CPU 和网络两方面都更好的硬件上运行的。\n\n### 使用常见 Redis 命令时要注意哪些问题？\n\n*   对于某些需要较长时间才能完成的 Redis 命令，在未了解这些命令造成的影响的情况下，不应运行这些命令。\n\n    *   例如，不要在生产环境中运行 [KEYS](http://redis.io/commands/keys) 命令，因为它可能需要很长时间才能返回，具体时间取决于键数。 Redis 是单线程服务器，每次只能处理一个命令。 如果在 KEYS 后面发出了其他命令，则这些命令只会在处理完 KEYS 命令后才会得到处理。 [redis.io 站点](http://redis.io/commands/) 具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n*   键大小 - 应使用小键/值还是大键/值？ 通常这取决于方案。 如果方案需要较大的键，则可调整 ConnectionTimeout 和重试值，并调整重试逻辑。 从 Redis 服务器的角度来看，值越小，性能就越好。\n*   这些考量并不意味着不能在 Redis 中存储较大值，只是要注意以下事项。 延迟会提高。 如果采用一个较大的数据集和一个较小的数据集，则可以使用多个 ConnectionMultiplexer 实例，并根据 [StackExchange.Redis 配置选项有什么作用](https://docs.azure.cn/redis-cache/#cache-configuration)部分中所述，为每个实例配置一组不同的超时和重试值。\n\n### 如何进行基准检验和测试缓存的性能？\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",Azure Redis 缓存是否有本地模拟器？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\nRedis 的一大优势是有许多客户端，支持许多不同的开发语言。 如需最新的客户端列表，请参阅 [Redis 客户端](http://redis.io/clients)。 若需涵盖多种不同语言和客户端的教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n若要连接到某个 Azure Redis 缓存实例，缓存客户端需要该缓存的主机名、端口和密钥。 在某些客户端中，这些项的名称可能略有不同。 可以在 Azure 门户中检索该信息，也可以通过命令行工具（例如 Azure CLI）来检索。\n\n### 使用 Azure 门户检索主机名、端口和访问密钥\n\n若要使用 Azure 门户检索主机名、端口和访问密钥，请[浏览](https://docs.azure.cn/redis-cache/cache-configure#configure-redis-cache-settings)到 [Azure 门户](https://portal.azure.cn/)中的缓存，然后在""设置""中单击""访问密钥""和""属性""。 \n\n### 使用 Azure CLI 检索主机名、端口和访问密钥\n\n若要使用 Azure CLI 2.0 检索主机名和端口，可调用 [az redis show](https://docs.microsoft.com/cli/azure/redis#az_redis_show)；若要检索密钥，可调用 [az redis list-keys](https://docs.microsoft.com/cli/azure/redis#az_redis_list_keys)。 以下脚本调用这两个命令，并将主机名、端口和密钥回显到控制台。\n\n#/bin/bash # Retrieve the hostname, ports, and keys for contosoCache located in contosoGroup # Retrieve the hostname and ports for an Azure Redis Cache instance redis=($(az redis show --name contosoCache --resource-group contosoGroup --query [hostName,enableNonSslPort,port,sslPort] --output tsv)) # Retrieve the keys for an Azure Redis Cache instance keys=($(az redis list-keys --name contosoCache --resource-group contosoGroup --query [primaryKey,secondaryKey] --output tsv)) # Display the retrieved hostname, keys, and ports echo ""Hostname:"" ${redis[0]} echo ""Non SSL Port:"" ${redis[2]} echo ""Non SSL Port Enabled:"" ${redis[1]} echo ""SSL Port:"" ${redis[3]} echo ""Primary Key:"" ${keys[0]} echo ""Secondary Key:"" ${keys[1]} \n\n有关此脚本的详细信息，请参阅[获取 Azure Redis 缓存的主机名、端口和密钥](https://docs.azure.cn/redis-cache/scripts/cache-keys-ports)。 有关 Azure CLI 2.0 的详细信息，请参阅 [Install Azure CLI 2.0](https://docs.microsoft.com/cli/azure/install-azure-cli)（安装 Azure CLI 2.0）和 [Get started with Azure CLI 2.0](https://docs.microsoft.com/cli/azure/get-started-with-azure-cli)（Azure CLI 2.0 入门）。\n\n### Azure Redis 缓存是否有本地模拟器？\n\nAzure Redis 缓存没有本地模拟器，但可以在本地计算机上从 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/) 运行 MSOpenTech 版本的 redis-server.exe 并连接到它，以获得与本地缓存模拟器相似的体验，如以下示例所示：\n\n``\n\n如果需要，可以选择配置 [redis.conf](http://redis.io/topics/config) 文件，以更好地匹配联机 Azure Redis 缓存的[默认缓存设置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何运行 Redis 命令？\n\n可以使用 [Redis 命令](http://redis.io/commands#)中列出的任何命令，但 [Azure Redis 缓存中不支持的 Redis 命令](https://docs.azure.cn/redis-cache/cache-configure#redis-commands-not-supported-in-azure-redis-cache)所列的命令除外。 可以使用多个选项来运行 Redis 命令。\n\n*   如果采用标准或高级缓存，可以使用 [Redis 控制台](https://docs.azure.cn/redis-cache/cache-configure#redis-console)运行 Redis 命令。 Redis 控制台提供了一种在 Azure 门户中安全地运行 Redis 命令的方式。\n*   还可以使用 Redis 命令行工具。 若要使用这些工具，请执行以下步骤：\n*   下载 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/)。\n*   使用 `redis-cli.exe`连接到缓存。 使用 -h 开关传入缓存终结点，使用 -a 传入密钥，如以下示例中所示：\n*   ``\n\nNote\n\nRedis 命令行工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n\n### Azure Redis 缓存为何不像某些其他 Azure 服务一样提供 MSDN 类库参考？\n\nAzure Redis 缓存基于流行的开源 Redis 缓存，可以通过各种 [Redis 客户端](http://redis.io/clients) 进行访问，这些客户端适用于许多编程语言。 每个客户端有自身的 API，用于通过 [Redis 命令](http://redis.io/commands)调用 Redis 缓存实例。\n\n由于客户端各不相同，因此 MSDN 上未提供统一的类引用，每个客户端都有自己的参考文档。 除了参考文档以外，还可以参阅多个教程，这些教程介绍了如何通过不同的语言和缓存客户端来开始使用 Azure Redis 缓存。 要访问这些教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n### 是否可将 Azure Redis 缓存用作 PHP 会话缓存？\n\n可以。若要使用 Azure Redis 缓存作为 PHP 会话缓存，请在 `session.save_path` 中指定 Azure Redis 缓存实例的连接字符串。\n\n\nImportant\n\n使用 Azure Redis 缓存作为 PHP 会话缓存时，必须对用于连接到缓存的安全密钥进行 URL 编码，如以下示例所示：\n\n``\n\n如果未对密钥进行 URL 编码，可能会收到类似于以下消息的异常： `Failed to parse session.save_path`\n\n\n有关在 PhpRedis 客户端中使用 Redis 缓存作为 PHP 会话缓存的详细信息，请参阅 [PHP Session handler](https://github.com/phpredis/phpredis#php-session-handler)（PHP 会话处理程序）。\n\n### 什么是 Redis 数据库？\n\nRedis 数据库就是同一 Redis 实例中的数据的逻辑隔离。 缓存内存在所有数据库之间共享，给定数据库的实际内存消耗取决于该数据库中存储的键/值。 例如，C6 缓存具有 53 GB 的内存。 可以选择将全部 53 GB 放置在一个数据库中，也可以将其分配到多个数据库中。 \n\n\nNote\n\n使用启用了群集功能的高级 Azure Redis 缓存时，仅数据库 0 可用。 此限制是固有的 Redis 限制，并不特定于 Azure Redis 缓存。 有关详细信息，请参阅[使用群集功能时，是否需要对客户端应用程序进行更改？](https://docs.azure.cn/redis-cache/cache-how-to-premium-clustering#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)\n\n\n### 何时应启用非 SSL 端口来连接 Redis？\n\nRedis 服务器本身不支持 SSL，但 Azure Redis 缓存可以。 如果要连接到 Azure Redis 缓存并且客户端支持 SSL（如 StackExchange.Redis），则你应使用 SSL。\n\n\nNote\n\n默认情况下，为新的 Azure Redis 缓存实例禁用了非 SSL 端口。 如果客户端不支持 SSL，则必须根据[在 Azure Redis 缓存中配置缓存](https://docs.azure.cn/redis-cache/cache-configure)一文中的[访问端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)部分中的说明启用非 SSL 端口。\n\n\n`redis-cli` 等 Redis 工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 生产的一些最佳做法是什么？\n\n*   [StackExchange.Redis 最佳做法](https://docs.azure.cn/redis-cache/#stackexchangeredis-best-practices)\n*   [配置和概念](https://docs.azure.cn/redis-cache/#configuration-and-concepts)\n*   [性能测试](https://docs.azure.cn/redis-cache/#performance-testing)\n\n#### StackExchange.Redis 最佳做法\n\n*   将 `AbortConnect` 设置为 false，并使 ConnectionMultiplexer 自动重新连接。 [请参阅此处了解详细信息](https://gist.github.com/JonCole/36ba6f60c274e89014dd#file-se-redis-setabortconnecttofalse-md)。\n*   重复使用 ConnectionMultiplexer - 不要为每个请求创建一个新的 ConnectionMultiplexe。 建议使用[此处所示](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)的 `` 模式。\n*   具有较小值的 Redis 工作性能最佳，因此请考虑将较大数据分成多个密钥。 阅读[本文](https://gist.github.com/JonCole/db0e90bedeb3fc4823c2#large-requestresponse-size)了解较大值可能引起的问题示例。\n*   配置 [ThreadPool 设置](https://docs.azure.cn/redis-cache/#important-details-about-threadpool-growth) ，以免超时。\n*   将默认 connectTimeout 至少设置为 5 秒。 出现网络故障时，此时间间隔会给 StackExchange.Redis 足够的时间来重新建立连接。\n*   注意与正在运行的不同操作相关的性能成本。 例如，`KEYS` 命令是 O(n) 操作，应当避免。 [redis.io](http://redis.io/commands/) 站点具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n\n#### 配置和概念\n\n*   针对生产系统使用标准层或高级层。 基本层是没有数据复制和 SLA 的单节点系统。 此外，使用至少一个 C1 缓存。 C0 缓存通常用于简单的开发/测试方案。\n*   请记住，Redis 是 内存中 数据存储区。 阅读[本文](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md)，了解可能出现数据丢失的情况。\n*   开发系统以便处理[由于修补和故障转移](https://gist.github.com/JonCole/317fe03805d5802e31cfa37e646e419d#file-azureredis-patchingexplained-md)引起的连接故障。\n\n#### 性能测试\n\n*   使用 `redis-benchmark.exe` 启动以在编写性能测试前感受可能的吞吐量。 因为 `redis-benchmark` 不支持 SSL，因此，在运行测试之前必须[通过 Azure 门户启用非 SSL 端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)。 例如，请参阅 [如何制定基准和测试缓存的性能？](https://docs.azure.cn/redis-cache/#how-can-i-benchmark-and-test-the-performance-of-my-cache)\n*   用于测试的客户端 VM 应与 Redis 缓存实例位于同一区域。\n*   建议为客户端使用 Dv2 VM 系列，因为该系列具有更好的硬件，会提供最佳的结果。\n*   确保选择的客户端 VM 至少与正在测试的缓存拥有相同的计算和带宽容量。\n*   如果是在 Windows 设备上操作，请在客户端计算机上启用 VRSS。 [请参阅此处了解详细信息](https://technet.microsoft.com/library/dn383582.aspx)。\n*   高级层 Redis 实例具有更好的网络延迟和吞吐量，因为它们是在 CPU 和网络两方面都更好的硬件上运行的。\n\n### 使用常见 Redis 命令时要注意哪些问题？\n\n*   对于某些需要较长时间才能完成的 Redis 命令，在未了解这些命令造成的影响的情况下，不应运行这些命令。\n\n    *   例如，不要在生产环境中运行 [KEYS](http://redis.io/commands/keys) 命令，因为它可能需要很长时间才能返回，具体时间取决于键数。 Redis 是单线程服务器，每次只能处理一个命令。 如果在 KEYS 后面发出了其他命令，则这些命令只会在处理完 KEYS 命令后才会得到处理。 [redis.io 站点](http://redis.io/commands/) 具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n*   键大小 - 应使用小键/值还是大键/值？ 通常这取决于方案。 如果方案需要较大的键，则可调整 ConnectionTimeout 和重试值，并调整重试逻辑。 从 Redis 服务器的角度来看，值越小，性能就越好。\n*   这些考量并不意味着不能在 Redis 中存储较大值，只是要注意以下事项。 延迟会提高。 如果采用一个较大的数据集和一个较小的数据集，则可以使用多个 ConnectionMultiplexer 实例，并根据 [StackExchange.Redis 配置选项有什么作用](https://docs.azure.cn/redis-cache/#cache-configuration)部分中所述，为每个实例配置一组不同的超时和重试值。\n\n### 如何进行基准检验和测试缓存的性能？\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",可以使用哪些 Redis 缓存客户端？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\nStackExchange.Redis 有很多选项。 本部分介绍一些常用设置。 有关 StackExchange.Redis 选项的详细详细，请参阅 [StackExchange.Redis 配置](https://stackexchange.github.io/StackExchange.Redis/Configuration)。\n配置选项说明建议AbortOnConnectFail如果设置为 true，则发生网络故障后不会重新建立连接。设置为 false，让 StackExchange.Redis 自动重新连接。ConnectRetry初始连接期间重试连接的次数。请参阅下面的注释寻求指导。ConnectTimeout连接操作的超时，以毫秒为单位。请参阅下面的注释寻求指导。\n\n通常情况下，使用客户端的默认值便已足够。 可以根据工作负荷微调选项。\n\n*   重试\n\n    *   对于 ConnectRetry 和 ConnectTimeout，一般指导原则是快速失败并重试。 该指导原则取决于工作负荷，以及客户端发出 Redis 命令和接收响应平均花费的时间。\n    *   让 StackExchange.Redis 自动重新连接，而不是检查连接状态，然后由自己重新连接。 避免使用 ConnectionMultiplexer.IsConnected 属性。\n    *   雪球效应 - 有时可能会遇到这样的问题：不断地重试，但问题不断累积，导致永远无法恢复。 \n*   超时值\n\n    *   根据工作负荷相应地设置值。 如果要存储较大值，应将超时设置为较大值。\n    *   将 `AbortOnConnectFail` 设置为 false，让 StackExchange.Redis 重新连接。\n    *   使用应用程序的单个 ConnectionMultiplexer 实例。 可以使用 LazyConnection 创建 Connection 属性返回的单个实例，如[使用 ConnectionMultiplexer 类连接到缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)中所示。\n    *   将 `ConnectionMultiplexer.ClientName` 属性设置为应用程序实例的唯一名称以进行诊断。\n    *   对自定义工作负载使用多个 `ConnectionMultiplexer` 实例。\n\n    *   如果应用程序中的负载不同，可以遵循此模型。 例如：\n    *   可以使用一个多路复用器来处理大键。\n    *   可以使用一个多路复用器来处理小键。\n    *   可为连接超时设置不同的值，并为使用的每个 ConnectionMultiplexer 设置重试逻辑。\n    *   在每个多路复用器上设置 `ClientName` 属性以帮助进行诊断。\n    *   该指导原则可以更好地改进每个 `ConnectionMultiplexer`的延迟。\n\n### 可以使用哪些 Redis 缓存客户端？\n\nRedis 的一大优势是有许多客户端，支持许多不同的开发语言。 如需最新的客户端列表，请参阅 [Redis 客户端](http://redis.io/clients)。 若需涵盖多种不同语言和客户端的教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n若要连接到某个 Azure Redis 缓存实例，缓存客户端需要该缓存的主机名、端口和密钥。 在某些客户端中，这些项的名称可能略有不同。 可以在 Azure 门户中检索该信息，也可以通过命令行工具（例如 Azure CLI）来检索。\n\n### 使用 Azure 门户检索主机名、端口和访问密钥\n\n若要使用 Azure 门户检索主机名、端口和访问密钥，请[浏览](https://docs.azure.cn/redis-cache/cache-configure#configure-redis-cache-settings)到 [Azure 门户](https://portal.azure.cn/)中的缓存，然后在""设置""中单击""访问密钥""和""属性""。 \n\n### 使用 Azure CLI 检索主机名、端口和访问密钥\n\n若要使用 Azure CLI 2.0 检索主机名和端口，可调用 [az redis show](https://docs.microsoft.com/cli/azure/redis#az_redis_show)；若要检索密钥，可调用 [az redis list-keys](https://docs.microsoft.com/cli/azure/redis#az_redis_list_keys)。 以下脚本调用这两个命令，并将主机名、端口和密钥回显到控制台。\n\n#/bin/bash # Retrieve the hostname, ports, and keys for contosoCache located in contosoGroup # Retrieve the hostname and ports for an Azure Redis Cache instance redis=($(az redis show --name contosoCache --resource-group contosoGroup --query [hostName,enableNonSslPort,port,sslPort] --output tsv)) # Retrieve the keys for an Azure Redis Cache instance keys=($(az redis list-keys --name contosoCache --resource-group contosoGroup --query [primaryKey,secondaryKey] --output tsv)) # Display the retrieved hostname, keys, and ports echo ""Hostname:"" ${redis[0]} echo ""Non SSL Port:"" ${redis[2]} echo ""Non SSL Port Enabled:"" ${redis[1]} echo ""SSL Port:"" ${redis[3]} echo ""Primary Key:"" ${keys[0]} echo ""Secondary Key:"" ${keys[1]} \n\n有关此脚本的详细信息，请参阅[获取 Azure Redis 缓存的主机名、端口和密钥](https://docs.azure.cn/redis-cache/scripts/cache-keys-ports)。 有关 Azure CLI 2.0 的详细信息，请参阅 [Install Azure CLI 2.0](https://docs.microsoft.com/cli/azure/install-azure-cli)（安装 Azure CLI 2.0）和 [Get started with Azure CLI 2.0](https://docs.microsoft.com/cli/azure/get-started-with-azure-cli)（Azure CLI 2.0 入门）。\n\n### Azure Redis 缓存是否有本地模拟器？\n\nAzure Redis 缓存没有本地模拟器，但可以在本地计算机上从 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/) 运行 MSOpenTech 版本的 redis-server.exe 并连接到它，以获得与本地缓存模拟器相似的体验，如以下示例所示：\n\n``\n\n如果需要，可以选择配置 [redis.conf](http://redis.io/topics/config) 文件，以更好地匹配联机 Azure Redis 缓存的[默认缓存设置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何运行 Redis 命令？\n\n可以使用 [Redis 命令](http://redis.io/commands#)中列出的任何命令，但 [Azure Redis 缓存中不支持的 Redis 命令](https://docs.azure.cn/redis-cache/cache-configure#redis-commands-not-supported-in-azure-redis-cache)所列的命令除外。 可以使用多个选项来运行 Redis 命令。\n\n*   如果采用标准或高级缓存，可以使用 [Redis 控制台](https://docs.azure.cn/redis-cache/cache-configure#redis-console)运行 Redis 命令。 Redis 控制台提供了一种在 Azure 门户中安全地运行 Redis 命令的方式。\n*   还可以使用 Redis 命令行工具。 若要使用这些工具，请执行以下步骤：\n*   下载 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/)。\n*   使用 `redis-cli.exe`连接到缓存。 使用 -h 开关传入缓存终结点，使用 -a 传入密钥，如以下示例中所示：\n*   ``\n\nNote\n\nRedis 命令行工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n\n### Azure Redis 缓存为何不像某些其他 Azure 服务一样提供 MSDN 类库参考？\n\nAzure Redis 缓存基于流行的开源 Redis 缓存，可以通过各种 [Redis 客户端](http://redis.io/clients) 进行访问，这些客户端适用于许多编程语言。 每个客户端有自身的 API，用于通过 [Redis 命令](http://redis.io/commands)调用 Redis 缓存实例。\n\n由于客户端各不相同，因此 MSDN 上未提供统一的类引用，每个客户端都有自己的参考文档。 除了参考文档以外，还可以参阅多个教程，这些教程介绍了如何通过不同的语言和缓存客户端来开始使用 Azure Redis 缓存。 要访问这些教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n### 是否可将 Azure Redis 缓存用作 PHP 会话缓存？\n\n可以。若要使用 Azure Redis 缓存作为 PHP 会话缓存，请在 `session.save_path` 中指定 Azure Redis 缓存实例的连接字符串。\n\n\nImportant\n\n使用 Azure Redis 缓存作为 PHP 会话缓存时，必须对用于连接到缓存的安全密钥进行 URL 编码，如以下示例所示：\n\n``\n\n如果未对密钥进行 URL 编码，可能会收到类似于以下消息的异常： `Failed to parse session.save_path`\n\n\n有关在 PhpRedis 客户端中使用 Redis 缓存作为 PHP 会话缓存的详细信息，请参阅 [PHP Session handler](https://github.com/phpredis/phpredis#php-session-handler)（PHP 会话处理程序）。\n\n### 什么是 Redis 数据库？\n\nRedis 数据库就是同一 Redis 实例中的数据的逻辑隔离。 缓存内存在所有数据库之间共享，给定数据库的实际内存消耗取决于该数据库中存储的键/值。 例如，C6 缓存具有 53 GB 的内存。 可以选择将全部 53 GB 放置在一个数据库中，也可以将其分配到多个数据库中。 \n\n\nNote\n\n使用启用了群集功能的高级 Azure Redis 缓存时，仅数据库 0 可用。 此限制是固有的 Redis 限制，并不特定于 Azure Redis 缓存。 有关详细信息，请参阅[使用群集功能时，是否需要对客户端应用程序进行更改？](https://docs.azure.cn/redis-cache/cache-how-to-premium-clustering#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)\n\n\n### 何时应启用非 SSL 端口来连接 Redis？\n\nRedis 服务器本身不支持 SSL，但 Azure Redis 缓存可以。 如果要连接到 Azure Redis 缓存并且客户端支持 SSL（如 StackExchange.Redis），则你应使用 SSL。\n\n\nNote\n\n默认情况下，为新的 Azure Redis 缓存实例禁用了非 SSL 端口。 如果客户端不支持 SSL，则必须根据[在 Azure Redis 缓存中配置缓存](https://docs.azure.cn/redis-cache/cache-configure)一文中的[访问端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)部分中的说明启用非 SSL 端口。\n\n\n`redis-cli` 等 Redis 工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 生产的一些最佳做法是什么？\n\n*   [StackExchange.Redis 最佳做法](https://docs.azure.cn/redis-cache/#stackexchangeredis-best-practices)\n*   [配置和概念](https://docs.azure.cn/redis-cache/#configuration-and-concepts)\n*   [性能测试](https://docs.azure.cn/redis-cache/#performance-testing)\n\n#### StackExchange.Redis 最佳做法\n\n*   将 `AbortConnect` 设置为 false，并使 ConnectionMultiplexer 自动重新连接。 [请参阅此处了解详细信息](https://gist.github.com/JonCole/36ba6f60c274e89014dd#file-se-redis-setabortconnecttofalse-md)。\n*   重复使用 ConnectionMultiplexer - 不要为每个请求创建一个新的 ConnectionMultiplexe。 建议使用[此处所示](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)的 `` 模式。\n*   具有较小值的 Redis 工作性能最佳，因此请考虑将较大数据分成多个密钥。 阅读[本文](https://gist.github.com/JonCole/db0e90bedeb3fc4823c2#large-requestresponse-size)了解较大值可能引起的问题示例。\n*   配置 [ThreadPool 设置](https://docs.azure.cn/redis-cache/#important-details-about-threadpool-growth) ，以免超时。\n*   将默认 connectTimeout 至少设置为 5 秒。 出现网络故障时，此时间间隔会给 StackExchange.Redis 足够的时间来重新建立连接。\n*   注意与正在运行的不同操作相关的性能成本。 例如，`KEYS` 命令是 O(n) 操作，应当避免。 [redis.io](http://redis.io/commands/) 站点具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n\n#### 配置和概念\n\n*   针对生产系统使用标准层或高级层。 基本层是没有数据复制和 SLA 的单节点系统。 此外，使用至少一个 C1 缓存。 C0 缓存通常用于简单的开发/测试方案。\n*   请记住，Redis 是 内存中 数据存储区。 阅读[本文](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md)，了解可能出现数据丢失的情况。\n*   开发系统以便处理[由于修补和故障转移](https://gist.github.com/JonCole/317fe03805d5802e31cfa37e646e419d#file-azureredis-patchingexplained-md)引起的连接故障。\n\n#### 性能测试\n\n*   使用 `redis-benchmark.exe` 启动以在编写性能测试前感受可能的吞吐量。 因为 `redis-benchmark` 不支持 SSL，因此，在运行测试之前必须[通过 Azure 门户启用非 SSL 端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)。 例如，请参阅 [如何制定基准和测试缓存的性能？](https://docs.azure.cn/redis-cache/#how-can-i-benchmark-and-test-the-performance-of-my-cache)\n*   用于测试的客户端 VM 应与 Redis 缓存实例位于同一区域。\n*   建议为客户端使用 Dv2 VM 系列，因为该系列具有更好的硬件，会提供最佳的结果。\n*   确保选择的客户端 VM 至少与正在测试的缓存拥有相同的计算和带宽容量。\n*   如果是在 Windows 设备上操作，请在客户端计算机上启用 VRSS。 [请参阅此处了解详细信息](https://technet.microsoft.com/library/dn383582.aspx)。\n*   高级层 Redis 实例具有更好的网络延迟和吞吐量，因为它们是在 CPU 和网络两方面都更好的硬件上运行的。\n\n### 使用常见 Redis 命令时要注意哪些问题？\n\n*   对于某些需要较长时间才能完成的 Redis 命令，在未了解这些命令造成的影响的情况下，不应运行这些命令。\n\n    *   例如，不要在生产环境中运行 [KEYS](http://redis.io/commands/keys) 命令，因为它可能需要很长时间才能返回，具体时间取决于键数。 Redis 是单线程服务器，每次只能处理一个命令。 如果在 KEYS 后面发出了其他命令，则这些命令只会在处理完 KEYS 命令后才会得到处理。 [redis.io 站点](http://redis.io/commands/) 具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n*   键大小 - 应使用小键/值还是大键/值？ 通常这取决于方案。 如果方案需要较大的键，则可调整 ConnectionTimeout 和重试值，并调整重试逻辑。 从 Redis 服务器的角度来看，值越小，性能就越好。\n*   这些考量并不意味着不能在 Redis 中存储较大值，只是要注意以下事项。 延迟会提高。 如果采用一个较大的数据集和一个较小的数据集，则可以使用多个 ConnectionMultiplexer 实例，并根据 [StackExchange.Redis 配置选项有什么作用](https://docs.azure.cn/redis-cache/#cache-configuration)部分中所述，为每个实例配置一组不同的超时和重试值。\n\n### 如何进行基准检验和测试缓存的性能？\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",StackExchange.Redis 配置选项有什么作用？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\n[此处](https://www.azure.cn/pricing/details/redis-cache/)提供了 Azure Redis 缓存定价。 定价页列出了每小时费率。 缓存按分钟计费，从创建缓存时开始，到删除缓存时为止。 没有提供用于停止或暂停缓存的计费选项。\n\n### StackExchange.Redis 配置选项有什么作用？\n\nStackExchange.Redis 有很多选项。 本部分介绍一些常用设置。 有关 StackExchange.Redis 选项的详细详细，请参阅 [StackExchange.Redis 配置](https://stackexchange.github.io/StackExchange.Redis/Configuration)。\n配置选项说明建议AbortOnConnectFail如果设置为 true，则发生网络故障后不会重新建立连接。设置为 false，让 StackExchange.Redis 自动重新连接。ConnectRetry初始连接期间重试连接的次数。请参阅下面的注释寻求指导。ConnectTimeout连接操作的超时，以毫秒为单位。请参阅下面的注释寻求指导。\n\n通常情况下，使用客户端的默认值便已足够。 可以根据工作负荷微调选项。\n\n*   重试\n\n    *   对于 ConnectRetry 和 ConnectTimeout，一般指导原则是快速失败并重试。 该指导原则取决于工作负荷，以及客户端发出 Redis 命令和接收响应平均花费的时间。\n    *   让 StackExchange.Redis 自动重新连接，而不是检查连接状态，然后由自己重新连接。 避免使用 ConnectionMultiplexer.IsConnected 属性。\n    *   雪球效应 - 有时可能会遇到这样的问题：不断地重试，但问题不断累积，导致永远无法恢复。 \n*   超时值\n\n    *   根据工作负荷相应地设置值。 如果要存储较大值，应将超时设置为较大值。\n    *   将 `AbortOnConnectFail` 设置为 false，让 StackExchange.Redis 重新连接。\n    *   使用应用程序的单个 ConnectionMultiplexer 实例。 可以使用 LazyConnection 创建 Connection 属性返回的单个实例，如[使用 ConnectionMultiplexer 类连接到缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)中所示。\n    *   将 `ConnectionMultiplexer.ClientName` 属性设置为应用程序实例的唯一名称以进行诊断。\n    *   对自定义工作负载使用多个 `ConnectionMultiplexer` 实例。\n\n    *   如果应用程序中的负载不同，可以遵循此模型。 例如：\n    *   可以使用一个多路复用器来处理大键。\n    *   可以使用一个多路复用器来处理小键。\n    *   可为连接超时设置不同的值，并为使用的每个 ConnectionMultiplexer 设置重试逻辑。\n    *   在每个多路复用器上设置 `ClientName` 属性以帮助进行诊断。\n    *   该指导原则可以更好地改进每个 `ConnectionMultiplexer`的延迟。\n\n### 可以使用哪些 Redis 缓存客户端？\n\nRedis 的一大优势是有许多客户端，支持许多不同的开发语言。 如需最新的客户端列表，请参阅 [Redis 客户端](http://redis.io/clients)。 若需涵盖多种不同语言和客户端的教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n若要连接到某个 Azure Redis 缓存实例，缓存客户端需要该缓存的主机名、端口和密钥。 在某些客户端中，这些项的名称可能略有不同。 可以在 Azure 门户中检索该信息，也可以通过命令行工具（例如 Azure CLI）来检索。\n\n### 使用 Azure 门户检索主机名、端口和访问密钥\n\n若要使用 Azure 门户检索主机名、端口和访问密钥，请[浏览](https://docs.azure.cn/redis-cache/cache-configure#configure-redis-cache-settings)到 [Azure 门户](https://portal.azure.cn/)中的缓存，然后在""设置""中单击""访问密钥""和""属性""。 \n\n### 使用 Azure CLI 检索主机名、端口和访问密钥\n\n若要使用 Azure CLI 2.0 检索主机名和端口，可调用 [az redis show](https://docs.microsoft.com/cli/azure/redis#az_redis_show)；若要检索密钥，可调用 [az redis list-keys](https://docs.microsoft.com/cli/azure/redis#az_redis_list_keys)。 以下脚本调用这两个命令，并将主机名、端口和密钥回显到控制台。\n\n#/bin/bash # Retrieve the hostname, ports, and keys for contosoCache located in contosoGroup # Retrieve the hostname and ports for an Azure Redis Cache instance redis=($(az redis show --name contosoCache --resource-group contosoGroup --query [hostName,enableNonSslPort,port,sslPort] --output tsv)) # Retrieve the keys for an Azure Redis Cache instance keys=($(az redis list-keys --name contosoCache --resource-group contosoGroup --query [primaryKey,secondaryKey] --output tsv)) # Display the retrieved hostname, keys, and ports echo ""Hostname:"" ${redis[0]} echo ""Non SSL Port:"" ${redis[2]} echo ""Non SSL Port Enabled:"" ${redis[1]} echo ""SSL Port:"" ${redis[3]} echo ""Primary Key:"" ${keys[0]} echo ""Secondary Key:"" ${keys[1]} \n\n有关此脚本的详细信息，请参阅[获取 Azure Redis 缓存的主机名、端口和密钥](https://docs.azure.cn/redis-cache/scripts/cache-keys-ports)。 有关 Azure CLI 2.0 的详细信息，请参阅 [Install Azure CLI 2.0](https://docs.microsoft.com/cli/azure/install-azure-cli)（安装 Azure CLI 2.0）和 [Get started with Azure CLI 2.0](https://docs.microsoft.com/cli/azure/get-started-with-azure-cli)（Azure CLI 2.0 入门）。\n\n### Azure Redis 缓存是否有本地模拟器？\n\nAzure Redis 缓存没有本地模拟器，但可以在本地计算机上从 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/) 运行 MSOpenTech 版本的 redis-server.exe 并连接到它，以获得与本地缓存模拟器相似的体验，如以下示例所示：\n\n``\n\n如果需要，可以选择配置 [redis.conf](http://redis.io/topics/config) 文件，以更好地匹配联机 Azure Redis 缓存的[默认缓存设置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何运行 Redis 命令？\n\n可以使用 [Redis 命令](http://redis.io/commands#)中列出的任何命令，但 [Azure Redis 缓存中不支持的 Redis 命令](https://docs.azure.cn/redis-cache/cache-configure#redis-commands-not-supported-in-azure-redis-cache)所列的命令除外。 可以使用多个选项来运行 Redis 命令。\n\n*   如果采用标准或高级缓存，可以使用 [Redis 控制台](https://docs.azure.cn/redis-cache/cache-configure#redis-console)运行 Redis 命令。 Redis 控制台提供了一种在 Azure 门户中安全地运行 Redis 命令的方式。\n*   还可以使用 Redis 命令行工具。 若要使用这些工具，请执行以下步骤：\n*   下载 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/)。\n*   使用 `redis-cli.exe`连接到缓存。 使用 -h 开关传入缓存终结点，使用 -a 传入密钥，如以下示例中所示：\n*   ``\n\nNote\n\nRedis 命令行工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n\n### Azure Redis 缓存为何不像某些其他 Azure 服务一样提供 MSDN 类库参考？\n\nAzure Redis 缓存基于流行的开源 Redis 缓存，可以通过各种 [Redis 客户端](http://redis.io/clients) 进行访问，这些客户端适用于许多编程语言。 每个客户端有自身的 API，用于通过 [Redis 命令](http://redis.io/commands)调用 Redis 缓存实例。\n\n由于客户端各不相同，因此 MSDN 上未提供统一的类引用，每个客户端都有自己的参考文档。 除了参考文档以外，还可以参阅多个教程，这些教程介绍了如何通过不同的语言和缓存客户端来开始使用 Azure Redis 缓存。 要访问这些教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n### 是否可将 Azure Redis 缓存用作 PHP 会话缓存？\n\n可以。若要使用 Azure Redis 缓存作为 PHP 会话缓存，请在 `session.save_path` 中指定 Azure Redis 缓存实例的连接字符串。\n\n\nImportant\n\n使用 Azure Redis 缓存作为 PHP 会话缓存时，必须对用于连接到缓存的安全密钥进行 URL 编码，如以下示例所示：\n\n``\n\n如果未对密钥进行 URL 编码，可能会收到类似于以下消息的异常： `Failed to parse session.save_path`\n\n\n有关在 PhpRedis 客户端中使用 Redis 缓存作为 PHP 会话缓存的详细信息，请参阅 [PHP Session handler](https://github.com/phpredis/phpredis#php-session-handler)（PHP 会话处理程序）。\n\n### 什么是 Redis 数据库？\n\nRedis 数据库就是同一 Redis 实例中的数据的逻辑隔离。 缓存内存在所有数据库之间共享，给定数据库的实际内存消耗取决于该数据库中存储的键/值。 例如，C6 缓存具有 53 GB 的内存。 可以选择将全部 53 GB 放置在一个数据库中，也可以将其分配到多个数据库中。 \n\n\nNote\n\n使用启用了群集功能的高级 Azure Redis 缓存时，仅数据库 0 可用。 此限制是固有的 Redis 限制，并不特定于 Azure Redis 缓存。 有关详细信息，请参阅[使用群集功能时，是否需要对客户端应用程序进行更改？](https://docs.azure.cn/redis-cache/cache-how-to-premium-clustering#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)\n\n\n### 何时应启用非 SSL 端口来连接 Redis？\n\nRedis 服务器本身不支持 SSL，但 Azure Redis 缓存可以。 如果要连接到 Azure Redis 缓存并且客户端支持 SSL（如 StackExchange.Redis），则你应使用 SSL。\n\n\nNote\n\n默认情况下，为新的 Azure Redis 缓存实例禁用了非 SSL 端口。 如果客户端不支持 SSL，则必须根据[在 Azure Redis 缓存中配置缓存](https://docs.azure.cn/redis-cache/cache-configure)一文中的[访问端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)部分中的说明启用非 SSL 端口。\n\n\n`redis-cli` 等 Redis 工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 生产的一些最佳做法是什么？\n\n*   [StackExchange.Redis 最佳做法](https://docs.azure.cn/redis-cache/#stackexchangeredis-best-practices)\n*   [配置和概念](https://docs.azure.cn/redis-cache/#configuration-and-concepts)\n*   [性能测试](https://docs.azure.cn/redis-cache/#performance-testing)\n\n#### StackExchange.Redis 最佳做法\n\n*   将 `AbortConnect` 设置为 false，并使 ConnectionMultiplexer 自动重新连接。 [请参阅此处了解详细信息](https://gist.github.com/JonCole/36ba6f60c274e89014dd#file-se-redis-setabortconnecttofalse-md)。\n*   重复使用 ConnectionMultiplexer - 不要为每个请求创建一个新的 ConnectionMultiplexe。 建议使用[此处所示](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)的 `` 模式。\n*   具有较小值的 Redis 工作性能最佳，因此请考虑将较大数据分成多个密钥。 阅读[本文](https://gist.github.com/JonCole/db0e90bedeb3fc4823c2#large-requestresponse-size)了解较大值可能引起的问题示例。\n*   配置 [ThreadPool 设置](https://docs.azure.cn/redis-cache/#important-details-about-threadpool-growth) ，以免超时。\n*   将默认 connectTimeout 至少设置为 5 秒。 出现网络故障时，此时间间隔会给 StackExchange.Redis 足够的时间来重新建立连接。\n*   注意与正在运行的不同操作相关的性能成本。 例如，`KEYS` 命令是 O(n) 操作，应当避免。 [redis.io](http://redis.io/commands/) 站点具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n\n#### 配置和概念\n\n*   针对生产系统使用标准层或高级层。 基本层是没有数据复制和 SLA 的单节点系统。 此外，使用至少一个 C1 缓存。 C0 缓存通常用于简单的开发/测试方案。\n*   请记住，Redis 是 内存中 数据存储区。 阅读[本文](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md)，了解可能出现数据丢失的情况。\n*   开发系统以便处理[由于修补和故障转移](https://gist.github.com/JonCole/317fe03805d5802e31cfa37e646e419d#file-azureredis-patchingexplained-md)引起的连接故障。\n\n#### 性能测试\n\n*   使用 `redis-benchmark.exe` 启动以在编写性能测试前感受可能的吞吐量。 因为 `redis-benchmark` 不支持 SSL，因此，在运行测试之前必须[通过 Azure 门户启用非 SSL 端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)。 例如，请参阅 [如何制定基准和测试缓存的性能？](https://docs.azure.cn/redis-cache/#how-can-i-benchmark-and-test-the-performance-of-my-cache)\n*   用于测试的客户端 VM 应与 Redis 缓存实例位于同一区域。\n*   建议为客户端使用 Dv2 VM 系列，因为该系列具有更好的硬件，会提供最佳的结果。\n*   确保选择的客户端 VM 至少与正在测试的缓存拥有相同的计算和带宽容量。\n*   如果是在 Windows 设备上操作，请在客户端计算机上启用 VRSS。 [请参阅此处了解详细信息](https://technet.microsoft.com/library/dn383582.aspx)。\n*   高级层 Redis 实例具有更好的网络延迟和吞吐量，因为它们是在 CPU 和网络两方面都更好的硬件上运行的。\n\n### 使用常见 Redis 命令时要注意哪些问题？\n\n*   对于某些需要较长时间才能完成的 Redis 命令，在未了解这些命令造成的影响的情况下，不应运行这些命令。\n\n    *   例如，不要在生产环境中运行 [KEYS](http://redis.io/commands/keys) 命令，因为它可能需要很长时间才能返回，具体时间取决于键数。 Redis 是单线程服务器，每次只能处理一个命令。 如果在 KEYS 后面发出了其他命令，则这些命令只会在处理完 KEYS 命令后才会得到处理。 [redis.io 站点](http://redis.io/commands/) 具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n*   键大小 - 应使用小键/值还是大键/值？ 通常这取决于方案。 如果方案需要较大的键，则可调整 ConnectionTimeout 和重试值，并调整重试逻辑。 从 Redis 服务器的角度来看，值越小，性能就越好。\n*   这些考量并不意味着不能在 Redis 中存储较大值，只是要注意以下事项。 延迟会提高。 如果采用一个较大的数据集和一个较小的数据集，则可以使用多个 ConnectionMultiplexer 实例，并根据 [StackExchange.Redis 配置选项有什么作用](https://docs.azure.cn/redis-cache/#cache-configuration)部分中所述，为每个实例配置一组不同的超时和重试值。\n\n### 如何进行基准检验和测试缓存的性能？\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",Azure Redis 缓存如何计费？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\n为了获得最佳性能并最大程度地降低延迟，请在缓存客户端应用程序所在的区域放置 Azure Redis 缓存。\n\n### Azure Redis 缓存如何计费？\n\n[此处](https://www.azure.cn/pricing/details/redis-cache/)提供了 Azure Redis 缓存定价。 定价页列出了每小时费率。 缓存按分钟计费，从创建缓存时开始，到删除缓存时为止。 没有提供用于停止或暂停缓存的计费选项。\n\n### StackExchange.Redis 配置选项有什么作用？\n\nStackExchange.Redis 有很多选项。 本部分介绍一些常用设置。 有关 StackExchange.Redis 选项的详细详细，请参阅 [StackExchange.Redis 配置](https://stackexchange.github.io/StackExchange.Redis/Configuration)。\n配置选项说明建议AbortOnConnectFail如果设置为 true，则发生网络故障后不会重新建立连接。设置为 false，让 StackExchange.Redis 自动重新连接。ConnectRetry初始连接期间重试连接的次数。请参阅下面的注释寻求指导。ConnectTimeout连接操作的超时，以毫秒为单位。请参阅下面的注释寻求指导。\n\n通常情况下，使用客户端的默认值便已足够。 可以根据工作负荷微调选项。\n\n*   重试\n\n    *   对于 ConnectRetry 和 ConnectTimeout，一般指导原则是快速失败并重试。 该指导原则取决于工作负荷，以及客户端发出 Redis 命令和接收响应平均花费的时间。\n    *   让 StackExchange.Redis 自动重新连接，而不是检查连接状态，然后由自己重新连接。 避免使用 ConnectionMultiplexer.IsConnected 属性。\n    *   雪球效应 - 有时可能会遇到这样的问题：不断地重试，但问题不断累积，导致永远无法恢复。 \n*   超时值\n\n    *   根据工作负荷相应地设置值。 如果要存储较大值，应将超时设置为较大值。\n    *   将 `AbortOnConnectFail` 设置为 false，让 StackExchange.Redis 重新连接。\n    *   使用应用程序的单个 ConnectionMultiplexer 实例。 可以使用 LazyConnection 创建 Connection 属性返回的单个实例，如[使用 ConnectionMultiplexer 类连接到缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)中所示。\n    *   将 `ConnectionMultiplexer.ClientName` 属性设置为应用程序实例的唯一名称以进行诊断。\n    *   对自定义工作负载使用多个 `ConnectionMultiplexer` 实例。\n\n    *   如果应用程序中的负载不同，可以遵循此模型。 例如：\n    *   可以使用一个多路复用器来处理大键。\n    *   可以使用一个多路复用器来处理小键。\n    *   可为连接超时设置不同的值，并为使用的每个 ConnectionMultiplexer 设置重试逻辑。\n    *   在每个多路复用器上设置 `ClientName` 属性以帮助进行诊断。\n    *   该指导原则可以更好地改进每个 `ConnectionMultiplexer`的延迟。\n\n### 可以使用哪些 Redis 缓存客户端？\n\nRedis 的一大优势是有许多客户端，支持许多不同的开发语言。 如需最新的客户端列表，请参阅 [Redis 客户端](http://redis.io/clients)。 若需涵盖多种不同语言和客户端的教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n若要连接到某个 Azure Redis 缓存实例，缓存客户端需要该缓存的主机名、端口和密钥。 在某些客户端中，这些项的名称可能略有不同。 可以在 Azure 门户中检索该信息，也可以通过命令行工具（例如 Azure CLI）来检索。\n\n### 使用 Azure 门户检索主机名、端口和访问密钥\n\n若要使用 Azure 门户检索主机名、端口和访问密钥，请[浏览](https://docs.azure.cn/redis-cache/cache-configure#configure-redis-cache-settings)到 [Azure 门户](https://portal.azure.cn/)中的缓存，然后在""设置""中单击""访问密钥""和""属性""。 \n\n### 使用 Azure CLI 检索主机名、端口和访问密钥\n\n若要使用 Azure CLI 2.0 检索主机名和端口，可调用 [az redis show](https://docs.microsoft.com/cli/azure/redis#az_redis_show)；若要检索密钥，可调用 [az redis list-keys](https://docs.microsoft.com/cli/azure/redis#az_redis_list_keys)。 以下脚本调用这两个命令，并将主机名、端口和密钥回显到控制台。\n\n#/bin/bash # Retrieve the hostname, ports, and keys for contosoCache located in contosoGroup # Retrieve the hostname and ports for an Azure Redis Cache instance redis=($(az redis show --name contosoCache --resource-group contosoGroup --query [hostName,enableNonSslPort,port,sslPort] --output tsv)) # Retrieve the keys for an Azure Redis Cache instance keys=($(az redis list-keys --name contosoCache --resource-group contosoGroup --query [primaryKey,secondaryKey] --output tsv)) # Display the retrieved hostname, keys, and ports echo ""Hostname:"" ${redis[0]} echo ""Non SSL Port:"" ${redis[2]} echo ""Non SSL Port Enabled:"" ${redis[1]} echo ""SSL Port:"" ${redis[3]} echo ""Primary Key:"" ${keys[0]} echo ""Secondary Key:"" ${keys[1]} \n\n有关此脚本的详细信息，请参阅[获取 Azure Redis 缓存的主机名、端口和密钥](https://docs.azure.cn/redis-cache/scripts/cache-keys-ports)。 有关 Azure CLI 2.0 的详细信息，请参阅 [Install Azure CLI 2.0](https://docs.microsoft.com/cli/azure/install-azure-cli)（安装 Azure CLI 2.0）和 [Get started with Azure CLI 2.0](https://docs.microsoft.com/cli/azure/get-started-with-azure-cli)（Azure CLI 2.0 入门）。\n\n### Azure Redis 缓存是否有本地模拟器？\n\nAzure Redis 缓存没有本地模拟器，但可以在本地计算机上从 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/) 运行 MSOpenTech 版本的 redis-server.exe 并连接到它，以获得与本地缓存模拟器相似的体验，如以下示例所示：\n\n``\n\n如果需要，可以选择配置 [redis.conf](http://redis.io/topics/config) 文件，以更好地匹配联机 Azure Redis 缓存的[默认缓存设置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何运行 Redis 命令？\n\n可以使用 [Redis 命令](http://redis.io/commands#)中列出的任何命令，但 [Azure Redis 缓存中不支持的 Redis 命令](https://docs.azure.cn/redis-cache/cache-configure#redis-commands-not-supported-in-azure-redis-cache)所列的命令除外。 可以使用多个选项来运行 Redis 命令。\n\n*   如果采用标准或高级缓存，可以使用 [Redis 控制台](https://docs.azure.cn/redis-cache/cache-configure#redis-console)运行 Redis 命令。 Redis 控制台提供了一种在 Azure 门户中安全地运行 Redis 命令的方式。\n*   还可以使用 Redis 命令行工具。 若要使用这些工具，请执行以下步骤：\n*   下载 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/)。\n*   使用 `redis-cli.exe`连接到缓存。 使用 -h 开关传入缓存终结点，使用 -a 传入密钥，如以下示例中所示：\n*   ``\n\nNote\n\nRedis 命令行工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n\n### Azure Redis 缓存为何不像某些其他 Azure 服务一样提供 MSDN 类库参考？\n\nAzure Redis 缓存基于流行的开源 Redis 缓存，可以通过各种 [Redis 客户端](http://redis.io/clients) 进行访问，这些客户端适用于许多编程语言。 每个客户端有自身的 API，用于通过 [Redis 命令](http://redis.io/commands)调用 Redis 缓存实例。\n\n由于客户端各不相同，因此 MSDN 上未提供统一的类引用，每个客户端都有自己的参考文档。 除了参考文档以外，还可以参阅多个教程，这些教程介绍了如何通过不同的语言和缓存客户端来开始使用 Azure Redis 缓存。 要访问这些教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n### 是否可将 Azure Redis 缓存用作 PHP 会话缓存？\n\n可以。若要使用 Azure Redis 缓存作为 PHP 会话缓存，请在 `session.save_path` 中指定 Azure Redis 缓存实例的连接字符串。\n\n\nImportant\n\n使用 Azure Redis 缓存作为 PHP 会话缓存时，必须对用于连接到缓存的安全密钥进行 URL 编码，如以下示例所示：\n\n``\n\n如果未对密钥进行 URL 编码，可能会收到类似于以下消息的异常： `Failed to parse session.save_path`\n\n\n有关在 PhpRedis 客户端中使用 Redis 缓存作为 PHP 会话缓存的详细信息，请参阅 [PHP Session handler](https://github.com/phpredis/phpredis#php-session-handler)（PHP 会话处理程序）。\n\n### 什么是 Redis 数据库？\n\nRedis 数据库就是同一 Redis 实例中的数据的逻辑隔离。 缓存内存在所有数据库之间共享，给定数据库的实际内存消耗取决于该数据库中存储的键/值。 例如，C6 缓存具有 53 GB 的内存。 可以选择将全部 53 GB 放置在一个数据库中，也可以将其分配到多个数据库中。 \n\n\nNote\n\n使用启用了群集功能的高级 Azure Redis 缓存时，仅数据库 0 可用。 此限制是固有的 Redis 限制，并不特定于 Azure Redis 缓存。 有关详细信息，请参阅[使用群集功能时，是否需要对客户端应用程序进行更改？](https://docs.azure.cn/redis-cache/cache-how-to-premium-clustering#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)\n\n\n### 何时应启用非 SSL 端口来连接 Redis？\n\nRedis 服务器本身不支持 SSL，但 Azure Redis 缓存可以。 如果要连接到 Azure Redis 缓存并且客户端支持 SSL（如 StackExchange.Redis），则你应使用 SSL。\n\n\nNote\n\n默认情况下，为新的 Azure Redis 缓存实例禁用了非 SSL 端口。 如果客户端不支持 SSL，则必须根据[在 Azure Redis 缓存中配置缓存](https://docs.azure.cn/redis-cache/cache-configure)一文中的[访问端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)部分中的说明启用非 SSL 端口。\n\n\n`redis-cli` 等 Redis 工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 生产的一些最佳做法是什么？\n\n*   [StackExchange.Redis 最佳做法](https://docs.azure.cn/redis-cache/#stackexchangeredis-best-practices)\n*   [配置和概念](https://docs.azure.cn/redis-cache/#configuration-and-concepts)\n*   [性能测试](https://docs.azure.cn/redis-cache/#performance-testing)\n\n#### StackExchange.Redis 最佳做法\n\n*   将 `AbortConnect` 设置为 false，并使 ConnectionMultiplexer 自动重新连接。 [请参阅此处了解详细信息](https://gist.github.com/JonCole/36ba6f60c274e89014dd#file-se-redis-setabortconnecttofalse-md)。\n*   重复使用 ConnectionMultiplexer - 不要为每个请求创建一个新的 ConnectionMultiplexe。 建议使用[此处所示](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)的 `` 模式。\n*   具有较小值的 Redis 工作性能最佳，因此请考虑将较大数据分成多个密钥。 阅读[本文](https://gist.github.com/JonCole/db0e90bedeb3fc4823c2#large-requestresponse-size)了解较大值可能引起的问题示例。\n*   配置 [ThreadPool 设置](https://docs.azure.cn/redis-cache/#important-details-about-threadpool-growth) ，以免超时。\n*   将默认 connectTimeout 至少设置为 5 秒。 出现网络故障时，此时间间隔会给 StackExchange.Redis 足够的时间来重新建立连接。\n*   注意与正在运行的不同操作相关的性能成本。 例如，`KEYS` 命令是 O(n) 操作，应当避免。 [redis.io](http://redis.io/commands/) 站点具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n\n#### 配置和概念\n\n*   针对生产系统使用标准层或高级层。 基本层是没有数据复制和 SLA 的单节点系统。 此外，使用至少一个 C1 缓存。 C0 缓存通常用于简单的开发/测试方案。\n*   请记住，Redis 是 内存中 数据存储区。 阅读[本文](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md)，了解可能出现数据丢失的情况。\n*   开发系统以便处理[由于修补和故障转移](https://gist.github.com/JonCole/317fe03805d5802e31cfa37e646e419d#file-azureredis-patchingexplained-md)引起的连接故障。\n\n#### 性能测试\n\n*   使用 `redis-benchmark.exe` 启动以在编写性能测试前感受可能的吞吐量。 因为 `redis-benchmark` 不支持 SSL，因此，在运行测试之前必须[通过 Azure 门户启用非 SSL 端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)。 例如，请参阅 [如何制定基准和测试缓存的性能？](https://docs.azure.cn/redis-cache/#how-can-i-benchmark-and-test-the-performance-of-my-cache)\n*   用于测试的客户端 VM 应与 Redis 缓存实例位于同一区域。\n*   建议为客户端使用 Dv2 VM 系列，因为该系列具有更好的硬件，会提供最佳的结果。\n*   确保选择的客户端 VM 至少与正在测试的缓存拥有相同的计算和带宽容量。\n*   如果是在 Windows 设备上操作，请在客户端计算机上启用 VRSS。 [请参阅此处了解详细信息](https://technet.microsoft.com/library/dn383582.aspx)。\n*   高级层 Redis 实例具有更好的网络延迟和吞吐量，因为它们是在 CPU 和网络两方面都更好的硬件上运行的。\n\n### 使用常见 Redis 命令时要注意哪些问题？\n\n*   对于某些需要较长时间才能完成的 Redis 命令，在未了解这些命令造成的影响的情况下，不应运行这些命令。\n\n    *   例如，不要在生产环境中运行 [KEYS](http://redis.io/commands/keys) 命令，因为它可能需要很长时间才能返回，具体时间取决于键数。 Redis 是单线程服务器，每次只能处理一个命令。 如果在 KEYS 后面发出了其他命令，则这些命令只会在处理完 KEYS 命令后才会得到处理。 [redis.io 站点](http://redis.io/commands/) 具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n*   键大小 - 应使用小键/值还是大键/值？ 通常这取决于方案。 如果方案需要较大的键，则可调整 ConnectionTimeout 和重试值，并调整重试逻辑。 从 Redis 服务器的角度来看，值越小，性能就越好。\n*   这些考量并不意味着不能在 Redis 中存储较大值，只是要注意以下事项。 延迟会提高。 如果采用一个较大的数据集和一个较小的数据集，则可以使用多个 ConnectionMultiplexer 实例，并根据 [StackExchange.Redis 配置选项有什么作用](https://docs.azure.cn/redis-cache/#cache-configuration)部分中所述，为每个实例配置一组不同的超时和重试值。\n\n### 如何进行基准检验和测试缓存的性能？\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",应该将缓存放在哪个区域？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\n每个 Azure Redis 缓存产品/服务提供不同级别的大小、带宽、高可用性和 SLA 选项。\n\n以下是有关选择缓存产品的注意事项。\n\n*   内存：基本级别和标准级别提供 250 MB - 53 GB。 高级层最多提供 530 GB。 有关详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。\n*   网络性能：如果工作负荷需要较高的吞吐量，则可使用高级层，该层可提供比标准层或基本层更高的带宽。 另外，在每个层中，缓存大小越大，带宽越高，因为是由基础 VM 托管缓存。 有关详细信息，请参阅 [下表](https://docs.azure.cn/redis-cache/#cache-performance) 。\n*   吞吐量：高级级别提供的可用吞吐量最大。 如果缓存服务器或客户端达到带宽限制，客户端可能会出现超时。 有关详细信息，请参阅下表。\n*   高可用性/SLA：Azure Redis 缓存保证标准/高级缓存在至少 99.9% 的时间内都可用。 若要了解有关 SLA 的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/support/sla/redis-cache/)。 SLA 仅涉及与缓存终结点的连接。 SLA 不涉及对数据丢失的防护。 我们建议使用高级层中的 Redis 数据暂留功能来增加灵活性，防止数据丢失。\n*   Redis 数据持久性：高级级别允许将缓存数据暂留在 Azure 存储帐户中。 在基本/标准缓存中，所有数据只存储在内存中。 如果底层基础结构出现问题，可能会导致数据丢失。 我们建议使用高级层中的 Redis 数据暂留功能来增加灵活性，防止数据丢失。 Azure Redis 缓存提供可在 Redis 暂留中使用的 RDB 和 AOF（即将推出）选项。 有关详细信息，请参阅[如何为高级 Azure Redis 缓存配置持久性](https://docs.azure.cn/redis-cache/cache-how-to-premium-persistence)。\n*   Redis 缓存：要创建大于 53 GB 的缓存，或要将数据通过分片的方式分散到多个 Redis 节点中，可以使用在高级层中提供的 Redis 群集功能。 每个节点都包含一个主/副缓存对，目的是提高可用性。 有关详细信息，请参阅 [如何为高级 Azure Redis 缓存配置群集功能](https://docs.azure.cn/redis-cache/cache-how-to-premium-clustering)。\n*   增强的安全性和独立性：Azure 虚拟网络 (VNET) 部署为 Azure Redis 缓存提供增强的安全性和隔离性，并提供子网、访问控制策略和进一步限制访问的其他功能。 有关详细信息，请参阅 [如何为高级 Azure Redis 缓存配置虚拟网络支持](https://docs.azure.cn/redis-cache/cache-how-to-premium-vnet)。\n*   配置 Redis：在标准级别和高级级别，都可以针对 Keyspace 通知来配置 Redis。\n*   客户端连接的最大数量：高级级别提供的可以连接到 Redis 的客户端数量是最大的，缓存大小越大，连接数量越大。 有关详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。\n*   专用 Redis 服务器核心：高级层的所有缓存大小都有针对 Redis 的专用核心。 在基本层/标准层中，C1 以上（含）大小均有针对 Redis 服务器的专用核心。\n*   Redis 是单线程的 ，因此与仅使用两个内核相比，使用两个以上的内核并没有额外的优势，但大型 VM 通常提供比小型 VM 更高的带宽。 如果缓存服务器或客户端达到带宽限制，客户端会出现超时。\n*   性能改进：相较于基本层或标准层，高级层中的缓存部署在处理器速度更快且性能更高的硬件上。 高级层缓存的吞吐量更高，延迟更低。\n\n### Azure Redis 缓存性能\n\n下表显示了在 Iaas VM 中使用 `redis-benchmark.exe` 针对 Azure Redis 缓存终结点测试各种大小的标准缓存和高级缓存时，所观测到的最大带宽值。 \n\n\nNote\n\n这些值是没有保证的，并且我们不针对这些数字提供 SLA，但它们反映了典型的情况。 应该对自己的应用程序进行负载测试，以确定适合应用程序的缓存大小。\n\n\n我们可以从此表得出以下结论：\n\n*   在缓存大小相同的情况下，高级层中的缓存吞吐量要高于标准层中的缓存吞吐量。 例如，对于 6 GB 缓存，P1 的吞吐量为 180,000 RPS，而 C3 的吞吐量为 49,000。\n*   启用 Redis 群集功能时，增加群集中分片（节点）的数量会导致吞吐量线性提高。 例如，若创建一个包含 10 个分片的 P4 群集，则可用吞吐量为 400,000 *10 = 每秒 400 万个请求。\n*   如果增加密钥大小，则高级层的吞吐量要高于标准层。定价层大小CPU 核心数可用带宽1 KB 值大小标准缓存大小兆位/秒（Mb/秒）/兆字节/秒（MB/秒）请求数/秒 (RPS)C0250 MB共享5/0.625600C11 GB1100/12.512,200C22.5 GB2200/2524,000C36 GB4400/5049,000C413 GB2500/62.561,000C526 GB41,000 / 125115,000C653 GB82,000 / 250150,000高级缓存大小每个分片的 CPU 核心数兆位/秒（Mb/秒）/兆字节/秒（MB/秒）每分片每秒请求数 (RPS)P16 GB21,500 / 187.5180,000P213 GB43,000 / 375360,000P326 GB43,000 / 375360,000P453 GB86,000 / 750400,000\n\n有关下载 Redis 工具（例如 `redis-benchmark.exe`）的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 应该将缓存放在哪个区域？\n\n为了获得最佳性能并最大程度地降低延迟，请在缓存客户端应用程序所在的区域放置 Azure Redis 缓存。\n\n### Azure Redis 缓存如何计费？\n\n[此处](https://www.azure.cn/pricing/details/redis-cache/)提供了 Azure Redis 缓存定价。 定价页列出了每小时费率。 缓存按分钟计费，从创建缓存时开始，到删除缓存时为止。 没有提供用于停止或暂停缓存的计费选项。\n\n### StackExchange.Redis 配置选项有什么作用？\n\nStackExchange.Redis 有很多选项。 本部分介绍一些常用设置。 有关 StackExchange.Redis 选项的详细详细，请参阅 [StackExchange.Redis 配置](https://stackexchange.github.io/StackExchange.Redis/Configuration)。\n配置选项说明建议AbortOnConnectFail如果设置为 true，则发生网络故障后不会重新建立连接。设置为 false，让 StackExchange.Redis 自动重新连接。ConnectRetry初始连接期间重试连接的次数。请参阅下面的注释寻求指导。ConnectTimeout连接操作的超时，以毫秒为单位。请参阅下面的注释寻求指导。\n\n通常情况下，使用客户端的默认值便已足够。 可以根据工作负荷微调选项。\n\n*   重试\n\n    *   对于 ConnectRetry 和 ConnectTimeout，一般指导原则是快速失败并重试。 该指导原则取决于工作负荷，以及客户端发出 Redis 命令和接收响应平均花费的时间。\n    *   让 StackExchange.Redis 自动重新连接，而不是检查连接状态，然后由自己重新连接。 避免使用 ConnectionMultiplexer.IsConnected 属性。\n    *   雪球效应 - 有时可能会遇到这样的问题：不断地重试，但问题不断累积，导致永远无法恢复。 \n*   超时值\n\n    *   根据工作负荷相应地设置值。 如果要存储较大值，应将超时设置为较大值。\n    *   将 `AbortOnConnectFail` 设置为 false，让 StackExchange.Redis 重新连接。\n    *   使用应用程序的单个 ConnectionMultiplexer 实例。 可以使用 LazyConnection 创建 Connection 属性返回的单个实例，如[使用 ConnectionMultiplexer 类连接到缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)中所示。\n    *   将 `ConnectionMultiplexer.ClientName` 属性设置为应用程序实例的唯一名称以进行诊断。\n    *   对自定义工作负载使用多个 `ConnectionMultiplexer` 实例。\n\n    *   如果应用程序中的负载不同，可以遵循此模型。 例如：\n    *   可以使用一个多路复用器来处理大键。\n    *   可以使用一个多路复用器来处理小键。\n    *   可为连接超时设置不同的值，并为使用的每个 ConnectionMultiplexer 设置重试逻辑。\n    *   在每个多路复用器上设置 `ClientName` 属性以帮助进行诊断。\n    *   该指导原则可以更好地改进每个 `ConnectionMultiplexer`的延迟。\n\n### 可以使用哪些 Redis 缓存客户端？\n\nRedis 的一大优势是有许多客户端，支持许多不同的开发语言。 如需最新的客户端列表，请参阅 [Redis 客户端](http://redis.io/clients)。 若需涵盖多种不同语言和客户端的教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n若要连接到某个 Azure Redis 缓存实例，缓存客户端需要该缓存的主机名、端口和密钥。 在某些客户端中，这些项的名称可能略有不同。 可以在 Azure 门户中检索该信息，也可以通过命令行工具（例如 Azure CLI）来检索。\n\n### 使用 Azure 门户检索主机名、端口和访问密钥\n\n若要使用 Azure 门户检索主机名、端口和访问密钥，请[浏览](https://docs.azure.cn/redis-cache/cache-configure#configure-redis-cache-settings)到 [Azure 门户](https://portal.azure.cn/)中的缓存，然后在""设置""中单击""访问密钥""和""属性""。 \n\n### 使用 Azure CLI 检索主机名、端口和访问密钥\n\n若要使用 Azure CLI 2.0 检索主机名和端口，可调用 [az redis show](https://docs.microsoft.com/cli/azure/redis#az_redis_show)；若要检索密钥，可调用 [az redis list-keys](https://docs.microsoft.com/cli/azure/redis#az_redis_list_keys)。 以下脚本调用这两个命令，并将主机名、端口和密钥回显到控制台。\n\n#/bin/bash # Retrieve the hostname, ports, and keys for contosoCache located in contosoGroup # Retrieve the hostname and ports for an Azure Redis Cache instance redis=($(az redis show --name contosoCache --resource-group contosoGroup --query [hostName,enableNonSslPort,port,sslPort] --output tsv)) # Retrieve the keys for an Azure Redis Cache instance keys=($(az redis list-keys --name contosoCache --resource-group contosoGroup --query [primaryKey,secondaryKey] --output tsv)) # Display the retrieved hostname, keys, and ports echo ""Hostname:"" ${redis[0]} echo ""Non SSL Port:"" ${redis[2]} echo ""Non SSL Port Enabled:"" ${redis[1]} echo ""SSL Port:"" ${redis[3]} echo ""Primary Key:"" ${keys[0]} echo ""Secondary Key:"" ${keys[1]} \n\n有关此脚本的详细信息，请参阅[获取 Azure Redis 缓存的主机名、端口和密钥](https://docs.azure.cn/redis-cache/scripts/cache-keys-ports)。 有关 Azure CLI 2.0 的详细信息，请参阅 [Install Azure CLI 2.0](https://docs.microsoft.com/cli/azure/install-azure-cli)（安装 Azure CLI 2.0）和 [Get started with Azure CLI 2.0](https://docs.microsoft.com/cli/azure/get-started-with-azure-cli)（Azure CLI 2.0 入门）。\n\n### Azure Redis 缓存是否有本地模拟器？\n\nAzure Redis 缓存没有本地模拟器，但可以在本地计算机上从 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/) 运行 MSOpenTech 版本的 redis-server.exe 并连接到它，以获得与本地缓存模拟器相似的体验，如以下示例所示：\n\n``\n\n如果需要，可以选择配置 [redis.conf](http://redis.io/topics/config) 文件，以更好地匹配联机 Azure Redis 缓存的[默认缓存设置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何运行 Redis 命令？\n\n可以使用 [Redis 命令](http://redis.io/commands#)中列出的任何命令，但 [Azure Redis 缓存中不支持的 Redis 命令](https://docs.azure.cn/redis-cache/cache-configure#redis-commands-not-supported-in-azure-redis-cache)所列的命令除外。 可以使用多个选项来运行 Redis 命令。\n\n*   如果采用标准或高级缓存，可以使用 [Redis 控制台](https://docs.azure.cn/redis-cache/cache-configure#redis-console)运行 Redis 命令。 Redis 控制台提供了一种在 Azure 门户中安全地运行 Redis 命令的方式。\n*   还可以使用 Redis 命令行工具。 若要使用这些工具，请执行以下步骤：\n*   下载 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/)。\n*   使用 `redis-cli.exe`连接到缓存。 使用 -h 开关传入缓存终结点，使用 -a 传入密钥，如以下示例中所示：\n*   ``\n\nNote\n\nRedis 命令行工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n\n### Azure Redis 缓存为何不像某些其他 Azure 服务一样提供 MSDN 类库参考？\n\nAzure Redis 缓存基于流行的开源 Redis 缓存，可以通过各种 [Redis 客户端](http://redis.io/clients) 进行访问，这些客户端适用于许多编程语言。 每个客户端有自身的 API，用于通过 [Redis 命令](http://redis.io/commands)调用 Redis 缓存实例。\n\n由于客户端各不相同，因此 MSDN 上未提供统一的类引用，每个客户端都有自己的参考文档。 除了参考文档以外，还可以参阅多个教程，这些教程介绍了如何通过不同的语言和缓存客户端来开始使用 Azure Redis 缓存。 要访问这些教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n### 是否可将 Azure Redis 缓存用作 PHP 会话缓存？\n\n可以。若要使用 Azure Redis 缓存作为 PHP 会话缓存，请在 `session.save_path` 中指定 Azure Redis 缓存实例的连接字符串。\n\n\nImportant\n\n使用 Azure Redis 缓存作为 PHP 会话缓存时，必须对用于连接到缓存的安全密钥进行 URL 编码，如以下示例所示：\n\n``\n\n如果未对密钥进行 URL 编码，可能会收到类似于以下消息的异常： `Failed to parse session.save_path`\n\n\n有关在 PhpRedis 客户端中使用 Redis 缓存作为 PHP 会话缓存的详细信息，请参阅 [PHP Session handler](https://github.com/phpredis/phpredis#php-session-handler)（PHP 会话处理程序）。\n\n### 什么是 Redis 数据库？\n\nRedis 数据库就是同一 Redis 实例中的数据的逻辑隔离。 缓存内存在所有数据库之间共享，给定数据库的实际内存消耗取决于该数据库中存储的键/值。 例如，C6 缓存具有 53 GB 的内存。 可以选择将全部 53 GB 放置在一个数据库中，也可以将其分配到多个数据库中。 \n\n\nNote\n\n使用启用了群集功能的高级 Azure Redis 缓存时，仅数据库 0 可用。 此限制是固有的 Redis 限制，并不特定于 Azure Redis 缓存。 有关详细信息，请参阅[使用群集功能时，是否需要对客户端应用程序进行更改？](https://docs.azure.cn/redis-cache/cache-how-to-premium-clustering#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)\n\n\n### 何时应启用非 SSL 端口来连接 Redis？\n\nRedis 服务器本身不支持 SSL，但 Azure Redis 缓存可以。 如果要连接到 Azure Redis 缓存并且客户端支持 SSL（如 StackExchange.Redis），则你应使用 SSL。\n\n\nNote\n\n默认情况下，为新的 Azure Redis 缓存实例禁用了非 SSL 端口。 如果客户端不支持 SSL，则必须根据[在 Azure Redis 缓存中配置缓存](https://docs.azure.cn/redis-cache/cache-configure)一文中的[访问端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)部分中的说明启用非 SSL 端口。\n\n\n`redis-cli` 等 Redis 工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 生产的一些最佳做法是什么？\n\n*   [StackExchange.Redis 最佳做法](https://docs.azure.cn/redis-cache/#stackexchangeredis-best-practices)\n*   [配置和概念](https://docs.azure.cn/redis-cache/#configuration-and-concepts)\n*   [性能测试](https://docs.azure.cn/redis-cache/#performance-testing)\n\n#### StackExchange.Redis 最佳做法\n\n*   将 `AbortConnect` 设置为 false，并使 ConnectionMultiplexer 自动重新连接。 [请参阅此处了解详细信息](https://gist.github.com/JonCole/36ba6f60c274e89014dd#file-se-redis-setabortconnecttofalse-md)。\n*   重复使用 ConnectionMultiplexer - 不要为每个请求创建一个新的 ConnectionMultiplexe。 建议使用[此处所示](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)的 `` 模式。\n*   具有较小值的 Redis 工作性能最佳，因此请考虑将较大数据分成多个密钥。 阅读[本文](https://gist.github.com/JonCole/db0e90bedeb3fc4823c2#large-requestresponse-size)了解较大值可能引起的问题示例。\n*   配置 [ThreadPool 设置](https://docs.azure.cn/redis-cache/#important-details-about-threadpool-growth) ，以免超时。\n*   将默认 connectTimeout 至少设置为 5 秒。 出现网络故障时，此时间间隔会给 StackExchange.Redis 足够的时间来重新建立连接。\n*   注意与正在运行的不同操作相关的性能成本。 例如，`KEYS` 命令是 O(n) 操作，应当避免。 [redis.io](http://redis.io/commands/) 站点具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n\n#### 配置和概念\n\n*   针对生产系统使用标准层或高级层。 基本层是没有数据复制和 SLA 的单节点系统。 此外，使用至少一个 C1 缓存。 C0 缓存通常用于简单的开发/测试方案。\n*   请记住，Redis 是 内存中 数据存储区。 阅读[本文](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md)，了解可能出现数据丢失的情况。\n*   开发系统以便处理[由于修补和故障转移](https://gist.github.com/JonCole/317fe03805d5802e31cfa37e646e419d#file-azureredis-patchingexplained-md)引起的连接故障。\n\n#### 性能测试\n\n*   使用 `redis-benchmark.exe` 启动以在编写性能测试前感受可能的吞吐量。 因为 `redis-benchmark` 不支持 SSL，因此，在运行测试之前必须[通过 Azure 门户启用非 SSL 端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)。 例如，请参阅 [如何制定基准和测试缓存的性能？](https://docs.azure.cn/redis-cache/#how-can-i-benchmark-and-test-the-performance-of-my-cache)\n*   用于测试的客户端 VM 应与 Redis 缓存实例位于同一区域。\n*   建议为客户端使用 Dv2 VM 系列，因为该系列具有更好的硬件，会提供最佳的结果。\n*   确保选择的客户端 VM 至少与正在测试的缓存拥有相同的计算和带宽容量。\n*   如果是在 Windows 设备上操作，请在客户端计算机上启用 VRSS。 [请参阅此处了解详细信息](https://technet.microsoft.com/library/dn383582.aspx)。\n*   高级层 Redis 实例具有更好的网络延迟和吞吐量，因为它们是在 CPU 和网络两方面都更好的硬件上运行的。\n\n### 使用常见 Redis 命令时要注意哪些问题？\n\n*   对于某些需要较长时间才能完成的 Redis 命令，在未了解这些命令造成的影响的情况下，不应运行这些命令。\n\n    *   例如，不要在生产环境中运行 [KEYS](http://redis.io/commands/keys) 命令，因为它可能需要很长时间才能返回，具体时间取决于键数。 Redis 是单线程服务器，每次只能处理一个命令。 如果在 KEYS 后面发出了其他命令，则这些命令只会在处理完 KEYS 命令后才会得到处理。 [redis.io 站点](http://redis.io/commands/) 具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n*   键大小 - 应使用小键/值还是大键/值？ 通常这取决于方案。 如果方案需要较大的键，则可调整 ConnectionTimeout 和重试值，并调整重试逻辑。 从 Redis 服务器的角度来看，值越小，性能就越好。\n*   这些考量并不意味着不能在 Redis 中存储较大值，只是要注意以下事项。 延迟会提高。 如果采用一个较大的数据集和一个较小的数据集，则可以使用多个 ConnectionMultiplexer 实例，并根据 [StackExchange.Redis 配置选项有什么作用](https://docs.azure.cn/redis-cache/#cache-configuration)部分中所述，为每个实例配置一组不同的超时和重试值。\n\n### 如何进行基准检验和测试缓存的性能？\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",应使用哪种 Redis 缓存产品和大小？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\n可通过多种方法来开始使用 Azure Redis 缓存。\n\n*   用户可以查看适用于 [.NET](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)、[ASP.NET](https://docs.azure.cn/redis-cache/cache-web-app-howto)、[Java](https://docs.azure.cn/redis-cache/cache-java-get-started)、[Node.js](https://docs.azure.cn/redis-cache/cache-nodejs-get-started) 和 [Python](https://docs.azure.cn/redis-cache/cache-python-get-started) 的教程之一。\n*   可以查看与你项目的开发语言对应的面向客户的客户端文档，了解如何使用 Redis。 许多 Redis 客户端都可用于 Azure Redis 缓存。 有关 Redis 客户端的列表，请参阅 [http://redis.io/clients](http://redis.io/clients)。\n\n如果还没有 Azure 帐户，可以：\n\n*   [建立 Azure 试用帐户](https://www.azure.cn/pricing/1rmb-trial/?WT.mc_id=redis_cache_hero)。 \n\n### 应使用哪种 Redis 缓存产品和大小？\n\n每个 Azure Redis 缓存产品/服务提供不同级别的大小、带宽、高可用性和 SLA 选项。\n\n以下是有关选择缓存产品的注意事项。\n\n*   内存：基本级别和标准级别提供 250 MB - 53 GB。 高级层最多提供 530 GB。 有关详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。\n*   网络性能：如果工作负荷需要较高的吞吐量，则可使用高级层，该层可提供比标准层或基本层更高的带宽。 另外，在每个层中，缓存大小越大，带宽越高，因为是由基础 VM 托管缓存。 有关详细信息，请参阅 [下表](https://docs.azure.cn/redis-cache/#cache-performance) 。\n*   吞吐量：高级级别提供的可用吞吐量最大。 如果缓存服务器或客户端达到带宽限制，客户端可能会出现超时。 有关详细信息，请参阅下表。\n*   高可用性/SLA：Azure Redis 缓存保证标准/高级缓存在至少 99.9% 的时间内都可用。 若要了解有关 SLA 的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/support/sla/redis-cache/)。 SLA 仅涉及与缓存终结点的连接。 SLA 不涉及对数据丢失的防护。 我们建议使用高级层中的 Redis 数据暂留功能来增加灵活性，防止数据丢失。\n*   Redis 数据持久性：高级级别允许将缓存数据暂留在 Azure 存储帐户中。 在基本/标准缓存中，所有数据只存储在内存中。 如果底层基础结构出现问题，可能会导致数据丢失。 我们建议使用高级层中的 Redis 数据暂留功能来增加灵活性，防止数据丢失。 Azure Redis 缓存提供可在 Redis 暂留中使用的 RDB 和 AOF（即将推出）选项。 有关详细信息，请参阅[如何为高级 Azure Redis 缓存配置持久性](https://docs.azure.cn/redis-cache/cache-how-to-premium-persistence)。\n*   Redis 缓存：要创建大于 53 GB 的缓存，或要将数据通过分片的方式分散到多个 Redis 节点中，可以使用在高级层中提供的 Redis 群集功能。 每个节点都包含一个主/副缓存对，目的是提高可用性。 有关详细信息，请参阅 [如何为高级 Azure Redis 缓存配置群集功能](https://docs.azure.cn/redis-cache/cache-how-to-premium-clustering)。\n*   增强的安全性和独立性：Azure 虚拟网络 (VNET) 部署为 Azure Redis 缓存提供增强的安全性和隔离性，并提供子网、访问控制策略和进一步限制访问的其他功能。 有关详细信息，请参阅 [如何为高级 Azure Redis 缓存配置虚拟网络支持](https://docs.azure.cn/redis-cache/cache-how-to-premium-vnet)。\n*   配置 Redis：在标准级别和高级级别，都可以针对 Keyspace 通知来配置 Redis。\n*   客户端连接的最大数量：高级级别提供的可以连接到 Redis 的客户端数量是最大的，缓存大小越大，连接数量越大。 有关详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。\n*   专用 Redis 服务器核心：高级层的所有缓存大小都有针对 Redis 的专用核心。 在基本层/标准层中，C1 以上（含）大小均有针对 Redis 服务器的专用核心。\n*   Redis 是单线程的 ，因此与仅使用两个内核相比，使用两个以上的内核并没有额外的优势，但大型 VM 通常提供比小型 VM 更高的带宽。 如果缓存服务器或客户端达到带宽限制，客户端会出现超时。\n*   性能改进：相较于基本层或标准层，高级层中的缓存部署在处理器速度更快且性能更高的硬件上。 高级层缓存的吞吐量更高，延迟更低。\n\n### Azure Redis 缓存性能\n\n下表显示了在 Iaas VM 中使用 `redis-benchmark.exe` 针对 Azure Redis 缓存终结点测试各种大小的标准缓存和高级缓存时，所观测到的最大带宽值。 \n\n\nNote\n\n这些值是没有保证的，并且我们不针对这些数字提供 SLA，但它们反映了典型的情况。 应该对自己的应用程序进行负载测试，以确定适合应用程序的缓存大小。\n\n\n我们可以从此表得出以下结论：\n\n*   在缓存大小相同的情况下，高级层中的缓存吞吐量要高于标准层中的缓存吞吐量。 例如，对于 6 GB 缓存，P1 的吞吐量为 180,000 RPS，而 C3 的吞吐量为 49,000。\n*   启用 Redis 群集功能时，增加群集中分片（节点）的数量会导致吞吐量线性提高。 例如，若创建一个包含 10 个分片的 P4 群集，则可用吞吐量为 400,000 *10 = 每秒 400 万个请求。\n*   如果增加密钥大小，则高级层的吞吐量要高于标准层。定价层大小CPU 核心数可用带宽1 KB 值大小标准缓存大小兆位/秒（Mb/秒）/兆字节/秒（MB/秒）请求数/秒 (RPS)C0250 MB共享5/0.625600C11 GB1100/12.512,200C22.5 GB2200/2524,000C36 GB4400/5049,000C413 GB2500/62.561,000C526 GB41,000 / 125115,000C653 GB82,000 / 250150,000高级缓存大小每个分片的 CPU 核心数兆位/秒（Mb/秒）/兆字节/秒（MB/秒）每分片每秒请求数 (RPS)P16 GB21,500 / 187.5180,000P213 GB43,000 / 375360,000P326 GB43,000 / 375360,000P453 GB86,000 / 750400,000\n\n有关下载 Redis 工具（例如 `redis-benchmark.exe`）的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 应该将缓存放在哪个区域？\n\n为了获得最佳性能并最大程度地降低延迟，请在缓存客户端应用程序所在的区域放置 Azure Redis 缓存。\n\n### Azure Redis 缓存如何计费？\n\n[此处](https://www.azure.cn/pricing/details/redis-cache/)提供了 Azure Redis 缓存定价。 定价页列出了每小时费率。 缓存按分钟计费，从创建缓存时开始，到删除缓存时为止。 没有提供用于停止或暂停缓存的计费选项。\n\n### StackExchange.Redis 配置选项有什么作用？\n\nStackExchange.Redis 有很多选项。 本部分介绍一些常用设置。 有关 StackExchange.Redis 选项的详细详细，请参阅 [StackExchange.Redis 配置](https://stackexchange.github.io/StackExchange.Redis/Configuration)。\n配置选项说明建议AbortOnConnectFail如果设置为 true，则发生网络故障后不会重新建立连接。设置为 false，让 StackExchange.Redis 自动重新连接。ConnectRetry初始连接期间重试连接的次数。请参阅下面的注释寻求指导。ConnectTimeout连接操作的超时，以毫秒为单位。请参阅下面的注释寻求指导。\n\n通常情况下，使用客户端的默认值便已足够。 可以根据工作负荷微调选项。\n\n*   重试\n\n    *   对于 ConnectRetry 和 ConnectTimeout，一般指导原则是快速失败并重试。 该指导原则取决于工作负荷，以及客户端发出 Redis 命令和接收响应平均花费的时间。\n    *   让 StackExchange.Redis 自动重新连接，而不是检查连接状态，然后由自己重新连接。 避免使用 ConnectionMultiplexer.IsConnected 属性。\n    *   雪球效应 - 有时可能会遇到这样的问题：不断地重试，但问题不断累积，导致永远无法恢复。 \n*   超时值\n\n    *   根据工作负荷相应地设置值。 如果要存储较大值，应将超时设置为较大值。\n    *   将 `AbortOnConnectFail` 设置为 false，让 StackExchange.Redis 重新连接。\n    *   使用应用程序的单个 ConnectionMultiplexer 实例。 可以使用 LazyConnection 创建 Connection 属性返回的单个实例，如[使用 ConnectionMultiplexer 类连接到缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)中所示。\n    *   将 `ConnectionMultiplexer.ClientName` 属性设置为应用程序实例的唯一名称以进行诊断。\n    *   对自定义工作负载使用多个 `ConnectionMultiplexer` 实例。\n\n    *   如果应用程序中的负载不同，可以遵循此模型。 例如：\n    *   可以使用一个多路复用器来处理大键。\n    *   可以使用一个多路复用器来处理小键。\n    *   可为连接超时设置不同的值，并为使用的每个 ConnectionMultiplexer 设置重试逻辑。\n    *   在每个多路复用器上设置 `ClientName` 属性以帮助进行诊断。\n    *   该指导原则可以更好地改进每个 `ConnectionMultiplexer`的延迟。\n\n### 可以使用哪些 Redis 缓存客户端？\n\nRedis 的一大优势是有许多客户端，支持许多不同的开发语言。 如需最新的客户端列表，请参阅 [Redis 客户端](http://redis.io/clients)。 若需涵盖多种不同语言和客户端的教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n若要连接到某个 Azure Redis 缓存实例，缓存客户端需要该缓存的主机名、端口和密钥。 在某些客户端中，这些项的名称可能略有不同。 可以在 Azure 门户中检索该信息，也可以通过命令行工具（例如 Azure CLI）来检索。\n\n### 使用 Azure 门户检索主机名、端口和访问密钥\n\n若要使用 Azure 门户检索主机名、端口和访问密钥，请[浏览](https://docs.azure.cn/redis-cache/cache-configure#configure-redis-cache-settings)到 [Azure 门户](https://portal.azure.cn/)中的缓存，然后在""设置""中单击""访问密钥""和""属性""。 \n\n### 使用 Azure CLI 检索主机名、端口和访问密钥\n\n若要使用 Azure CLI 2.0 检索主机名和端口，可调用 [az redis show](https://docs.microsoft.com/cli/azure/redis#az_redis_show)；若要检索密钥，可调用 [az redis list-keys](https://docs.microsoft.com/cli/azure/redis#az_redis_list_keys)。 以下脚本调用这两个命令，并将主机名、端口和密钥回显到控制台。\n\n#/bin/bash # Retrieve the hostname, ports, and keys for contosoCache located in contosoGroup # Retrieve the hostname and ports for an Azure Redis Cache instance redis=($(az redis show --name contosoCache --resource-group contosoGroup --query [hostName,enableNonSslPort,port,sslPort] --output tsv)) # Retrieve the keys for an Azure Redis Cache instance keys=($(az redis list-keys --name contosoCache --resource-group contosoGroup --query [primaryKey,secondaryKey] --output tsv)) # Display the retrieved hostname, keys, and ports echo ""Hostname:"" ${redis[0]} echo ""Non SSL Port:"" ${redis[2]} echo ""Non SSL Port Enabled:"" ${redis[1]} echo ""SSL Port:"" ${redis[3]} echo ""Primary Key:"" ${keys[0]} echo ""Secondary Key:"" ${keys[1]} \n\n有关此脚本的详细信息，请参阅[获取 Azure Redis 缓存的主机名、端口和密钥](https://docs.azure.cn/redis-cache/scripts/cache-keys-ports)。 有关 Azure CLI 2.0 的详细信息，请参阅 [Install Azure CLI 2.0](https://docs.microsoft.com/cli/azure/install-azure-cli)（安装 Azure CLI 2.0）和 [Get started with Azure CLI 2.0](https://docs.microsoft.com/cli/azure/get-started-with-azure-cli)（Azure CLI 2.0 入门）。\n\n### Azure Redis 缓存是否有本地模拟器？\n\nAzure Redis 缓存没有本地模拟器，但可以在本地计算机上从 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/) 运行 MSOpenTech 版本的 redis-server.exe 并连接到它，以获得与本地缓存模拟器相似的体验，如以下示例所示：\n\n``\n\n如果需要，可以选择配置 [redis.conf](http://redis.io/topics/config) 文件，以更好地匹配联机 Azure Redis 缓存的[默认缓存设置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何运行 Redis 命令？\n\n可以使用 [Redis 命令](http://redis.io/commands#)中列出的任何命令，但 [Azure Redis 缓存中不支持的 Redis 命令](https://docs.azure.cn/redis-cache/cache-configure#redis-commands-not-supported-in-azure-redis-cache)所列的命令除外。 可以使用多个选项来运行 Redis 命令。\n\n*   如果采用标准或高级缓存，可以使用 [Redis 控制台](https://docs.azure.cn/redis-cache/cache-configure#redis-console)运行 Redis 命令。 Redis 控制台提供了一种在 Azure 门户中安全地运行 Redis 命令的方式。\n*   还可以使用 Redis 命令行工具。 若要使用这些工具，请执行以下步骤：\n*   下载 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/)。\n*   使用 `redis-cli.exe`连接到缓存。 使用 -h 开关传入缓存终结点，使用 -a 传入密钥，如以下示例中所示：\n*   ``\n\nNote\n\nRedis 命令行工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n\n### Azure Redis 缓存为何不像某些其他 Azure 服务一样提供 MSDN 类库参考？\n\nAzure Redis 缓存基于流行的开源 Redis 缓存，可以通过各种 [Redis 客户端](http://redis.io/clients) 进行访问，这些客户端适用于许多编程语言。 每个客户端有自身的 API，用于通过 [Redis 命令](http://redis.io/commands)调用 Redis 缓存实例。\n\n由于客户端各不相同，因此 MSDN 上未提供统一的类引用，每个客户端都有自己的参考文档。 除了参考文档以外，还可以参阅多个教程，这些教程介绍了如何通过不同的语言和缓存客户端来开始使用 Azure Redis 缓存。 要访问这些教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n### 是否可将 Azure Redis 缓存用作 PHP 会话缓存？\n\n可以。若要使用 Azure Redis 缓存作为 PHP 会话缓存，请在 `session.save_path` 中指定 Azure Redis 缓存实例的连接字符串。\n\n\nImportant\n\n使用 Azure Redis 缓存作为 PHP 会话缓存时，必须对用于连接到缓存的安全密钥进行 URL 编码，如以下示例所示：\n\n``\n\n如果未对密钥进行 URL 编码，可能会收到类似于以下消息的异常： `Failed to parse session.save_path`\n\n\n有关在 PhpRedis 客户端中使用 Redis 缓存作为 PHP 会话缓存的详细信息，请参阅 [PHP Session handler](https://github.com/phpredis/phpredis#php-session-handler)（PHP 会话处理程序）。\n\n### 什么是 Redis 数据库？\n\nRedis 数据库就是同一 Redis 实例中的数据的逻辑隔离。 缓存内存在所有数据库之间共享，给定数据库的实际内存消耗取决于该数据库中存储的键/值。 例如，C6 缓存具有 53 GB 的内存。 可以选择将全部 53 GB 放置在一个数据库中，也可以将其分配到多个数据库中。 \n\n\nNote\n\n使用启用了群集功能的高级 Azure Redis 缓存时，仅数据库 0 可用。 此限制是固有的 Redis 限制，并不特定于 Azure Redis 缓存。 有关详细信息，请参阅[使用群集功能时，是否需要对客户端应用程序进行更改？](https://docs.azure.cn/redis-cache/cache-how-to-premium-clustering#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)\n\n\n### 何时应启用非 SSL 端口来连接 Redis？\n\nRedis 服务器本身不支持 SSL，但 Azure Redis 缓存可以。 如果要连接到 Azure Redis 缓存并且客户端支持 SSL（如 StackExchange.Redis），则你应使用 SSL。\n\n\nNote\n\n默认情况下，为新的 Azure Redis 缓存实例禁用了非 SSL 端口。 如果客户端不支持 SSL，则必须根据[在 Azure Redis 缓存中配置缓存](https://docs.azure.cn/redis-cache/cache-configure)一文中的[访问端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)部分中的说明启用非 SSL 端口。\n\n\n`redis-cli` 等 Redis 工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 生产的一些最佳做法是什么？\n\n*   [StackExchange.Redis 最佳做法](https://docs.azure.cn/redis-cache/#stackexchangeredis-best-practices)\n*   [配置和概念](https://docs.azure.cn/redis-cache/#configuration-and-concepts)\n*   [性能测试](https://docs.azure.cn/redis-cache/#performance-testing)\n\n#### StackExchange.Redis 最佳做法\n\n*   将 `AbortConnect` 设置为 false，并使 ConnectionMultiplexer 自动重新连接。 [请参阅此处了解详细信息](https://gist.github.com/JonCole/36ba6f60c274e89014dd#file-se-redis-setabortconnecttofalse-md)。\n*   重复使用 ConnectionMultiplexer - 不要为每个请求创建一个新的 ConnectionMultiplexe。 建议使用[此处所示](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)的 `` 模式。\n*   具有较小值的 Redis 工作性能最佳，因此请考虑将较大数据分成多个密钥。 阅读[本文](https://gist.github.com/JonCole/db0e90bedeb3fc4823c2#large-requestresponse-size)了解较大值可能引起的问题示例。\n*   配置 [ThreadPool 设置](https://docs.azure.cn/redis-cache/#important-details-about-threadpool-growth) ，以免超时。\n*   将默认 connectTimeout 至少设置为 5 秒。 出现网络故障时，此时间间隔会给 StackExchange.Redis 足够的时间来重新建立连接。\n*   注意与正在运行的不同操作相关的性能成本。 例如，`KEYS` 命令是 O(n) 操作，应当避免。 [redis.io](http://redis.io/commands/) 站点具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n\n#### 配置和概念\n\n*   针对生产系统使用标准层或高级层。 基本层是没有数据复制和 SLA 的单节点系统。 此外，使用至少一个 C1 缓存。 C0 缓存通常用于简单的开发/测试方案。\n*   请记住，Redis 是 内存中 数据存储区。 阅读[本文](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md)，了解可能出现数据丢失的情况。\n*   开发系统以便处理[由于修补和故障转移](https://gist.github.com/JonCole/317fe03805d5802e31cfa37e646e419d#file-azureredis-patchingexplained-md)引起的连接故障。\n\n#### 性能测试\n\n*   使用 `redis-benchmark.exe` 启动以在编写性能测试前感受可能的吞吐量。 因为 `redis-benchmark` 不支持 SSL，因此，在运行测试之前必须[通过 Azure 门户启用非 SSL 端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)。 例如，请参阅 [如何制定基准和测试缓存的性能？](https://docs.azure.cn/redis-cache/#how-can-i-benchmark-and-test-the-performance-of-my-cache)\n*   用于测试的客户端 VM 应与 Redis 缓存实例位于同一区域。\n*   建议为客户端使用 Dv2 VM 系列，因为该系列具有更好的硬件，会提供最佳的结果。\n*   确保选择的客户端 VM 至少与正在测试的缓存拥有相同的计算和带宽容量。\n*   如果是在 Windows 设备上操作，请在客户端计算机上启用 VRSS。 [请参阅此处了解详细信息](https://technet.microsoft.com/library/dn383582.aspx)。\n*   高级层 Redis 实例具有更好的网络延迟和吞吐量，因为它们是在 CPU 和网络两方面都更好的硬件上运行的。\n\n### 使用常见 Redis 命令时要注意哪些问题？\n\n*   对于某些需要较长时间才能完成的 Redis 命令，在未了解这些命令造成的影响的情况下，不应运行这些命令。\n\n    *   例如，不要在生产环境中运行 [KEYS](http://redis.io/commands/keys) 命令，因为它可能需要很长时间才能返回，具体时间取决于键数。 Redis 是单线程服务器，每次只能处理一个命令。 如果在 KEYS 后面发出了其他命令，则这些命令只会在处理完 KEYS 命令后才会得到处理。 [redis.io 站点](http://redis.io/commands/) 具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n*   键大小 - 应使用小键/值还是大键/值？ 通常这取决于方案。 如果方案需要较大的键，则可调整 ConnectionTimeout 和重试值，并调整重试逻辑。 从 Redis 服务器的角度来看，值越小，性能就越好。\n*   这些考量并不意味着不能在 Redis 中存储较大值，只是要注意以下事项。 延迟会提高。 如果采用一个较大的数据集和一个较小的数据集，则可以使用多个 ConnectionMultiplexer 实例，并根据 [StackExchange.Redis 配置选项有什么作用](https://docs.azure.cn/redis-cache/#cache-configuration)部分中所述，为每个实例配置一组不同的超时和重试值。\n\n### 如何进行基准检验和测试缓存的性能？\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",使用 Azure Redis 缓存？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\nAzure Redis 缓存以常用的开放源 [Redis 缓存](http://redis.io/)为基础。 这样便可以访问安全、专用的 Redis 缓存，该缓存由 Azure.cn 管理并可从 Azure 内的任何应用程序进行访问。 有关更详细的概述，请参阅 Azure.com 上的 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)产品页。\n\n### 使用 Azure Redis 缓存？\n\n可通过多种方法来开始使用 Azure Redis 缓存。\n\n*   用户可以查看适用于 [.NET](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)、[ASP.NET](https://docs.azure.cn/redis-cache/cache-web-app-howto)、[Java](https://docs.azure.cn/redis-cache/cache-java-get-started)、[Node.js](https://docs.azure.cn/redis-cache/cache-nodejs-get-started) 和 [Python](https://docs.azure.cn/redis-cache/cache-python-get-started) 的教程之一。\n*   可以查看与你项目的开发语言对应的面向客户的客户端文档，了解如何使用 Redis。 许多 Redis 客户端都可用于 Azure Redis 缓存。 有关 Redis 客户端的列表，请参阅 [http://redis.io/clients](http://redis.io/clients)。\n\n如果还没有 Azure 帐户，可以：\n\n*   [建立 Azure 试用帐户](https://www.azure.cn/pricing/1rmb-trial/?WT.mc_id=redis_cache_hero)。 \n\n### 应使用哪种 Redis 缓存产品和大小？\n\n每个 Azure Redis 缓存产品/服务提供不同级别的大小、带宽、高可用性和 SLA 选项。\n\n以下是有关选择缓存产品的注意事项。\n\n*   内存：基本级别和标准级别提供 250 MB - 53 GB。 高级层最多提供 530 GB。 有关详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。\n*   网络性能：如果工作负荷需要较高的吞吐量，则可使用高级层，该层可提供比标准层或基本层更高的带宽。 另外，在每个层中，缓存大小越大，带宽越高，因为是由基础 VM 托管缓存。 有关详细信息，请参阅 [下表](https://docs.azure.cn/redis-cache/#cache-performance) 。\n*   吞吐量：高级级别提供的可用吞吐量最大。 如果缓存服务器或客户端达到带宽限制，客户端可能会出现超时。 有关详细信息，请参阅下表。\n*   高可用性/SLA：Azure Redis 缓存保证标准/高级缓存在至少 99.9% 的时间内都可用。 若要了解有关 SLA 的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/support/sla/redis-cache/)。 SLA 仅涉及与缓存终结点的连接。 SLA 不涉及对数据丢失的防护。 我们建议使用高级层中的 Redis 数据暂留功能来增加灵活性，防止数据丢失。\n*   Redis 数据持久性：高级级别允许将缓存数据暂留在 Azure 存储帐户中。 在基本/标准缓存中，所有数据只存储在内存中。 如果底层基础结构出现问题，可能会导致数据丢失。 我们建议使用高级层中的 Redis 数据暂留功能来增加灵活性，防止数据丢失。 Azure Redis 缓存提供可在 Redis 暂留中使用的 RDB 和 AOF（即将推出）选项。 有关详细信息，请参阅[如何为高级 Azure Redis 缓存配置持久性](https://docs.azure.cn/redis-cache/cache-how-to-premium-persistence)。\n*   Redis 缓存：要创建大于 53 GB 的缓存，或要将数据通过分片的方式分散到多个 Redis 节点中，可以使用在高级层中提供的 Redis 群集功能。 每个节点都包含一个主/副缓存对，目的是提高可用性。 有关详细信息，请参阅 [如何为高级 Azure Redis 缓存配置群集功能](https://docs.azure.cn/redis-cache/cache-how-to-premium-clustering)。\n*   增强的安全性和独立性：Azure 虚拟网络 (VNET) 部署为 Azure Redis 缓存提供增强的安全性和隔离性，并提供子网、访问控制策略和进一步限制访问的其他功能。 有关详细信息，请参阅 [如何为高级 Azure Redis 缓存配置虚拟网络支持](https://docs.azure.cn/redis-cache/cache-how-to-premium-vnet)。\n*   配置 Redis：在标准级别和高级级别，都可以针对 Keyspace 通知来配置 Redis。\n*   客户端连接的最大数量：高级级别提供的可以连接到 Redis 的客户端数量是最大的，缓存大小越大，连接数量越大。 有关详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。\n*   专用 Redis 服务器核心：高级层的所有缓存大小都有针对 Redis 的专用核心。 在基本层/标准层中，C1 以上（含）大小均有针对 Redis 服务器的专用核心。\n*   Redis 是单线程的 ，因此与仅使用两个内核相比，使用两个以上的内核并没有额外的优势，但大型 VM 通常提供比小型 VM 更高的带宽。 如果缓存服务器或客户端达到带宽限制，客户端会出现超时。\n*   性能改进：相较于基本层或标准层，高级层中的缓存部署在处理器速度更快且性能更高的硬件上。 高级层缓存的吞吐量更高，延迟更低。\n\n### Azure Redis 缓存性能\n\n下表显示了在 Iaas VM 中使用 `redis-benchmark.exe` 针对 Azure Redis 缓存终结点测试各种大小的标准缓存和高级缓存时，所观测到的最大带宽值。 \n\n\nNote\n\n这些值是没有保证的，并且我们不针对这些数字提供 SLA，但它们反映了典型的情况。 应该对自己的应用程序进行负载测试，以确定适合应用程序的缓存大小。\n\n\n我们可以从此表得出以下结论：\n\n*   在缓存大小相同的情况下，高级层中的缓存吞吐量要高于标准层中的缓存吞吐量。 例如，对于 6 GB 缓存，P1 的吞吐量为 180,000 RPS，而 C3 的吞吐量为 49,000。\n*   启用 Redis 群集功能时，增加群集中分片（节点）的数量会导致吞吐量线性提高。 例如，若创建一个包含 10 个分片的 P4 群集，则可用吞吐量为 400,000 *10 = 每秒 400 万个请求。\n*   如果增加密钥大小，则高级层的吞吐量要高于标准层。定价层大小CPU 核心数可用带宽1 KB 值大小标准缓存大小兆位/秒（Mb/秒）/兆字节/秒（MB/秒）请求数/秒 (RPS)C0250 MB共享5/0.625600C11 GB1100/12.512,200C22.5 GB2200/2524,000C36 GB4400/5049,000C413 GB2500/62.561,000C526 GB41,000 / 125115,000C653 GB82,000 / 250150,000高级缓存大小每个分片的 CPU 核心数兆位/秒（Mb/秒）/兆字节/秒（MB/秒）每分片每秒请求数 (RPS)P16 GB21,500 / 187.5180,000P213 GB43,000 / 375360,000P326 GB43,000 / 375360,000P453 GB86,000 / 750400,000\n\n有关下载 Redis 工具（例如 `redis-benchmark.exe`）的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 应该将缓存放在哪个区域？\n\n为了获得最佳性能并最大程度地降低延迟，请在缓存客户端应用程序所在的区域放置 Azure Redis 缓存。\n\n### Azure Redis 缓存如何计费？\n\n[此处](https://www.azure.cn/pricing/details/redis-cache/)提供了 Azure Redis 缓存定价。 定价页列出了每小时费率。 缓存按分钟计费，从创建缓存时开始，到删除缓存时为止。 没有提供用于停止或暂停缓存的计费选项。\n\n### StackExchange.Redis 配置选项有什么作用？\n\nStackExchange.Redis 有很多选项。 本部分介绍一些常用设置。 有关 StackExchange.Redis 选项的详细详细，请参阅 [StackExchange.Redis 配置](https://stackexchange.github.io/StackExchange.Redis/Configuration)。\n配置选项说明建议AbortOnConnectFail如果设置为 true，则发生网络故障后不会重新建立连接。设置为 false，让 StackExchange.Redis 自动重新连接。ConnectRetry初始连接期间重试连接的次数。请参阅下面的注释寻求指导。ConnectTimeout连接操作的超时，以毫秒为单位。请参阅下面的注释寻求指导。\n\n通常情况下，使用客户端的默认值便已足够。 可以根据工作负荷微调选项。\n\n*   重试\n\n    *   对于 ConnectRetry 和 ConnectTimeout，一般指导原则是快速失败并重试。 该指导原则取决于工作负荷，以及客户端发出 Redis 命令和接收响应平均花费的时间。\n    *   让 StackExchange.Redis 自动重新连接，而不是检查连接状态，然后由自己重新连接。 避免使用 ConnectionMultiplexer.IsConnected 属性。\n    *   雪球效应 - 有时可能会遇到这样的问题：不断地重试，但问题不断累积，导致永远无法恢复。 \n*   超时值\n\n    *   根据工作负荷相应地设置值。 如果要存储较大值，应将超时设置为较大值。\n    *   将 `AbortOnConnectFail` 设置为 false，让 StackExchange.Redis 重新连接。\n    *   使用应用程序的单个 ConnectionMultiplexer 实例。 可以使用 LazyConnection 创建 Connection 属性返回的单个实例，如[使用 ConnectionMultiplexer 类连接到缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)中所示。\n    *   将 `ConnectionMultiplexer.ClientName` 属性设置为应用程序实例的唯一名称以进行诊断。\n    *   对自定义工作负载使用多个 `ConnectionMultiplexer` 实例。\n\n    *   如果应用程序中的负载不同，可以遵循此模型。 例如：\n    *   可以使用一个多路复用器来处理大键。\n    *   可以使用一个多路复用器来处理小键。\n    *   可为连接超时设置不同的值，并为使用的每个 ConnectionMultiplexer 设置重试逻辑。\n    *   在每个多路复用器上设置 `ClientName` 属性以帮助进行诊断。\n    *   该指导原则可以更好地改进每个 `ConnectionMultiplexer`的延迟。\n\n### 可以使用哪些 Redis 缓存客户端？\n\nRedis 的一大优势是有许多客户端，支持许多不同的开发语言。 如需最新的客户端列表，请参阅 [Redis 客户端](http://redis.io/clients)。 若需涵盖多种不同语言和客户端的教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n若要连接到某个 Azure Redis 缓存实例，缓存客户端需要该缓存的主机名、端口和密钥。 在某些客户端中，这些项的名称可能略有不同。 可以在 Azure 门户中检索该信息，也可以通过命令行工具（例如 Azure CLI）来检索。\n\n### 使用 Azure 门户检索主机名、端口和访问密钥\n\n若要使用 Azure 门户检索主机名、端口和访问密钥，请[浏览](https://docs.azure.cn/redis-cache/cache-configure#configure-redis-cache-settings)到 [Azure 门户](https://portal.azure.cn/)中的缓存，然后在""设置""中单击""访问密钥""和""属性""。 \n\n### 使用 Azure CLI 检索主机名、端口和访问密钥\n\n若要使用 Azure CLI 2.0 检索主机名和端口，可调用 [az redis show](https://docs.microsoft.com/cli/azure/redis#az_redis_show)；若要检索密钥，可调用 [az redis list-keys](https://docs.microsoft.com/cli/azure/redis#az_redis_list_keys)。 以下脚本调用这两个命令，并将主机名、端口和密钥回显到控制台。\n\n#/bin/bash # Retrieve the hostname, ports, and keys for contosoCache located in contosoGroup # Retrieve the hostname and ports for an Azure Redis Cache instance redis=($(az redis show --name contosoCache --resource-group contosoGroup --query [hostName,enableNonSslPort,port,sslPort] --output tsv)) # Retrieve the keys for an Azure Redis Cache instance keys=($(az redis list-keys --name contosoCache --resource-group contosoGroup --query [primaryKey,secondaryKey] --output tsv)) # Display the retrieved hostname, keys, and ports echo ""Hostname:"" ${redis[0]} echo ""Non SSL Port:"" ${redis[2]} echo ""Non SSL Port Enabled:"" ${redis[1]} echo ""SSL Port:"" ${redis[3]} echo ""Primary Key:"" ${keys[0]} echo ""Secondary Key:"" ${keys[1]} \n\n有关此脚本的详细信息，请参阅[获取 Azure Redis 缓存的主机名、端口和密钥](https://docs.azure.cn/redis-cache/scripts/cache-keys-ports)。 有关 Azure CLI 2.0 的详细信息，请参阅 [Install Azure CLI 2.0](https://docs.microsoft.com/cli/azure/install-azure-cli)（安装 Azure CLI 2.0）和 [Get started with Azure CLI 2.0](https://docs.microsoft.com/cli/azure/get-started-with-azure-cli)（Azure CLI 2.0 入门）。\n\n### Azure Redis 缓存是否有本地模拟器？\n\nAzure Redis 缓存没有本地模拟器，但可以在本地计算机上从 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/) 运行 MSOpenTech 版本的 redis-server.exe 并连接到它，以获得与本地缓存模拟器相似的体验，如以下示例所示：\n\n``\n\n如果需要，可以选择配置 [redis.conf](http://redis.io/topics/config) 文件，以更好地匹配联机 Azure Redis 缓存的[默认缓存设置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何运行 Redis 命令？\n\n可以使用 [Redis 命令](http://redis.io/commands#)中列出的任何命令，但 [Azure Redis 缓存中不支持的 Redis 命令](https://docs.azure.cn/redis-cache/cache-configure#redis-commands-not-supported-in-azure-redis-cache)所列的命令除外。 可以使用多个选项来运行 Redis 命令。\n\n*   如果采用标准或高级缓存，可以使用 [Redis 控制台](https://docs.azure.cn/redis-cache/cache-configure#redis-console)运行 Redis 命令。 Redis 控制台提供了一种在 Azure 门户中安全地运行 Redis 命令的方式。\n*   还可以使用 Redis 命令行工具。 若要使用这些工具，请执行以下步骤：\n*   下载 [Redis 命令行工具](https://github.com/MSOpenTech/redis/releases/)。\n*   使用 `redis-cli.exe`连接到缓存。 使用 -h 开关传入缓存终结点，使用 -a 传入密钥，如以下示例中所示：\n*   ``\n\nNote\n\nRedis 命令行工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n\n### Azure Redis 缓存为何不像某些其他 Azure 服务一样提供 MSDN 类库参考？\n\nAzure Redis 缓存基于流行的开源 Redis 缓存，可以通过各种 [Redis 客户端](http://redis.io/clients) 进行访问，这些客户端适用于许多编程语言。 每个客户端有自身的 API，用于通过 [Redis 命令](http://redis.io/commands)调用 Redis 缓存实例。\n\n由于客户端各不相同，因此 MSDN 上未提供统一的类引用，每个客户端都有自己的参考文档。 除了参考文档以外，还可以参阅多个教程，这些教程介绍了如何通过不同的语言和缓存客户端来开始使用 Azure Redis 缓存。 要访问这些教程，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)，并单击文章顶部语言切换器中的所需语言。\n\n### 是否可将 Azure Redis 缓存用作 PHP 会话缓存？\n\n可以。若要使用 Azure Redis 缓存作为 PHP 会话缓存，请在 `session.save_path` 中指定 Azure Redis 缓存实例的连接字符串。\n\n\nImportant\n\n使用 Azure Redis 缓存作为 PHP 会话缓存时，必须对用于连接到缓存的安全密钥进行 URL 编码，如以下示例所示：\n\n``\n\n如果未对密钥进行 URL 编码，可能会收到类似于以下消息的异常： `Failed to parse session.save_path`\n\n\n有关在 PhpRedis 客户端中使用 Redis 缓存作为 PHP 会话缓存的详细信息，请参阅 [PHP Session handler](https://github.com/phpredis/phpredis#php-session-handler)（PHP 会话处理程序）。\n\n### 什么是 Redis 数据库？\n\nRedis 数据库就是同一 Redis 实例中的数据的逻辑隔离。 缓存内存在所有数据库之间共享，给定数据库的实际内存消耗取决于该数据库中存储的键/值。 例如，C6 缓存具有 53 GB 的内存。 可以选择将全部 53 GB 放置在一个数据库中，也可以将其分配到多个数据库中。 \n\n\nNote\n\n使用启用了群集功能的高级 Azure Redis 缓存时，仅数据库 0 可用。 此限制是固有的 Redis 限制，并不特定于 Azure Redis 缓存。 有关详细信息，请参阅[使用群集功能时，是否需要对客户端应用程序进行更改？](https://docs.azure.cn/redis-cache/cache-how-to-premium-clustering#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)\n\n\n### 何时应启用非 SSL 端口来连接 Redis？\n\nRedis 服务器本身不支持 SSL，但 Azure Redis 缓存可以。 如果要连接到 Azure Redis 缓存并且客户端支持 SSL（如 StackExchange.Redis），则你应使用 SSL。\n\n\nNote\n\n默认情况下，为新的 Azure Redis 缓存实例禁用了非 SSL 端口。 如果客户端不支持 SSL，则必须根据[在 Azure Redis 缓存中配置缓存](https://docs.azure.cn/redis-cache/cache-configure)一文中的[访问端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)部分中的说明启用非 SSL 端口。\n\n\n`redis-cli` 等 Redis 工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 生产的一些最佳做法是什么？\n\n*   [StackExchange.Redis 最佳做法](https://docs.azure.cn/redis-cache/#stackexchangeredis-best-practices)\n*   [配置和概念](https://docs.azure.cn/redis-cache/#configuration-and-concepts)\n*   [性能测试](https://docs.azure.cn/redis-cache/#performance-testing)\n\n#### StackExchange.Redis 最佳做法\n\n*   将 `AbortConnect` 设置为 false，并使 ConnectionMultiplexer 自动重新连接。 [请参阅此处了解详细信息](https://gist.github.com/JonCole/36ba6f60c274e89014dd#file-se-redis-setabortconnecttofalse-md)。\n*   重复使用 ConnectionMultiplexer - 不要为每个请求创建一个新的 ConnectionMultiplexe。 建议使用[此处所示](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)的 `` 模式。\n*   具有较小值的 Redis 工作性能最佳，因此请考虑将较大数据分成多个密钥。 阅读[本文](https://gist.github.com/JonCole/db0e90bedeb3fc4823c2#large-requestresponse-size)了解较大值可能引起的问题示例。\n*   配置 [ThreadPool 设置](https://docs.azure.cn/redis-cache/#important-details-about-threadpool-growth) ，以免超时。\n*   将默认 connectTimeout 至少设置为 5 秒。 出现网络故障时，此时间间隔会给 StackExchange.Redis 足够的时间来重新建立连接。\n*   注意与正在运行的不同操作相关的性能成本。 例如，`KEYS` 命令是 O(n) 操作，应当避免。 [redis.io](http://redis.io/commands/) 站点具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n\n#### 配置和概念\n\n*   针对生产系统使用标准层或高级层。 基本层是没有数据复制和 SLA 的单节点系统。 此外，使用至少一个 C1 缓存。 C0 缓存通常用于简单的开发/测试方案。\n*   请记住，Redis 是 内存中 数据存储区。 阅读[本文](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md)，了解可能出现数据丢失的情况。\n*   开发系统以便处理[由于修补和故障转移](https://gist.github.com/JonCole/317fe03805d5802e31cfa37e646e419d#file-azureredis-patchingexplained-md)引起的连接故障。\n\n#### 性能测试\n\n*   使用 `redis-benchmark.exe` 启动以在编写性能测试前感受可能的吞吐量。 因为 `redis-benchmark` 不支持 SSL，因此，在运行测试之前必须[通过 Azure 门户启用非 SSL 端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)。 例如，请参阅 [如何制定基准和测试缓存的性能？](https://docs.azure.cn/redis-cache/#how-can-i-benchmark-and-test-the-performance-of-my-cache)\n*   用于测试的客户端 VM 应与 Redis 缓存实例位于同一区域。\n*   建议为客户端使用 Dv2 VM 系列，因为该系列具有更好的硬件，会提供最佳的结果。\n*   确保选择的客户端 VM 至少与正在测试的缓存拥有相同的计算和带宽容量。\n*   如果是在 Windows 设备上操作，请在客户端计算机上启用 VRSS。 [请参阅此处了解详细信息](https://technet.microsoft.com/library/dn383582.aspx)。\n*   高级层 Redis 实例具有更好的网络延迟和吞吐量，因为它们是在 CPU 和网络两方面都更好的硬件上运行的。\n\n### 使用常见 Redis 命令时要注意哪些问题？\n\n*   对于某些需要较长时间才能完成的 Redis 命令，在未了解这些命令造成的影响的情况下，不应运行这些命令。\n\n    *   例如，不要在生产环境中运行 [KEYS](http://redis.io/commands/keys) 命令，因为它可能需要很长时间才能返回，具体时间取决于键数。 Redis 是单线程服务器，每次只能处理一个命令。 如果在 KEYS 后面发出了其他命令，则这些命令只会在处理完 KEYS 命令后才会得到处理。 [redis.io 站点](http://redis.io/commands/) 具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n*   键大小 - 应使用小键/值还是大键/值？ 通常这取决于方案。 如果方案需要较大的键，则可调整 ConnectionTimeout 和重试值，并调整重试逻辑。 从 Redis 服务器的角度来看，值越小，性能就越好。\n*   这些考量并不意味着不能在 Redis 中存储较大值，只是要注意以下事项。 延迟会提高。 如果采用一个较大的数据集和一个较小的数据集，则可以使用多个 ConnectionMultiplexer 实例，并根据 [StackExchange.Redis 配置选项有什么作用](https://docs.azure.cn/redis-cache/#cache-configuration)部分中所述，为每个实例配置一组不同的超时和重试值。\n\n### 如何进行基准检验和测试缓存的性能？\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",什么是 Azure Redis 缓存？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
"\n\n可以。若要使用 Azure Redis 缓存作为 PHP 会话缓存，请在 `session.save_path` 中指定 Azure Redis 缓存实例的连接字符串。\n\n\nImportant\n\n使用 Azure Redis 缓存作为 PHP 会话缓存时，必须对用于连接到缓存的安全密钥进行 URL 编码，如以下示例所示：\n\n``\n\n如果未对密钥进行 URL 编码，可能会收到类似于以下消息的异常： `Failed to parse session.save_path`\n\n\n有关在 PhpRedis 客户端中使用 Redis 缓存作为 PHP 会话缓存的详细信息，请参阅 [PHP Session handler](https://github.com/phpredis/phpredis#php-session-handler)（PHP 会话处理程序）。\n\n### 什么是 Redis 数据库？\n\nRedis 数据库就是同一 Redis 实例中的数据的逻辑隔离。 缓存内存在所有数据库之间共享，给定数据库的实际内存消耗取决于该数据库中存储的键/值。 例如，C6 缓存具有 53 GB 的内存。 可以选择将全部 53 GB 放置在一个数据库中，也可以将其分配到多个数据库中。 \n\n\nNote\n\n使用启用了群集功能的高级 Azure Redis 缓存时，仅数据库 0 可用。 此限制是固有的 Redis 限制，并不特定于 Azure Redis 缓存。 有关详细信息，请参阅[使用群集功能时，是否需要对客户端应用程序进行更改？](https://docs.azure.cn/redis-cache/cache-how-to-premium-clustering#do-i-need-to-make-any-changes-to-my-client-application-to-use-clustering)\n\n\n### 何时应启用非 SSL 端口来连接 Redis？\n\nRedis 服务器本身不支持 SSL，但 Azure Redis 缓存可以。 如果要连接到 Azure Redis 缓存并且客户端支持 SSL（如 StackExchange.Redis），则你应使用 SSL。\n\n\nNote\n\n默认情况下，为新的 Azure Redis 缓存实例禁用了非 SSL 端口。 如果客户端不支持 SSL，则必须根据[在 Azure Redis 缓存中配置缓存](https://docs.azure.cn/redis-cache/cache-configure)一文中的[访问端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)部分中的说明启用非 SSL 端口。\n\n\n`redis-cli` 等 Redis 工具对 SSL 端口不起作用，但是，可以[根据适用于 Redis 预览版的 ASP.NET 会话状态提供程序通告](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)中的说明，使用 `stunnel` 等实用程序安全地将这些工具连接到 SSL。\n\n有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n### 生产的一些最佳做法是什么？\n\n*   [StackExchange.Redis 最佳做法](https://docs.azure.cn/redis-cache/#stackexchangeredis-best-practices)\n*   [配置和概念](https://docs.azure.cn/redis-cache/#configuration-and-concepts)\n*   [性能测试](https://docs.azure.cn/redis-cache/#performance-testing)\n\n#### StackExchange.Redis 最佳做法\n\n*   将 `AbortConnect` 设置为 false，并使 ConnectionMultiplexer 自动重新连接。 [请参阅此处了解详细信息](https://gist.github.com/JonCole/36ba6f60c274e89014dd#file-se-redis-setabortconnecttofalse-md)。\n*   重复使用 ConnectionMultiplexer - 不要为每个请求创建一个新的 ConnectionMultiplexe。 建议使用[此处所示](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache#connect-to-the-cache)的 `` 模式。\n*   具有较小值的 Redis 工作性能最佳，因此请考虑将较大数据分成多个密钥。 阅读[本文](https://gist.github.com/JonCole/db0e90bedeb3fc4823c2#large-requestresponse-size)了解较大值可能引起的问题示例。\n*   配置 [ThreadPool 设置](https://docs.azure.cn/redis-cache/#important-details-about-threadpool-growth) ，以免超时。\n*   将默认 connectTimeout 至少设置为 5 秒。 出现网络故障时，此时间间隔会给 StackExchange.Redis 足够的时间来重新建立连接。\n*   注意与正在运行的不同操作相关的性能成本。 例如，`KEYS` 命令是 O(n) 操作，应当避免。 [redis.io](http://redis.io/commands/) 站点具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n\n#### 配置和概念\n\n*   针对生产系统使用标准层或高级层。 基本层是没有数据复制和 SLA 的单节点系统。 此外，使用至少一个 C1 缓存。 C0 缓存通常用于简单的开发/测试方案。\n*   请记住，Redis 是 内存中 数据存储区。 阅读[本文](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md)，了解可能出现数据丢失的情况。\n*   开发系统以便处理[由于修补和故障转移](https://gist.github.com/JonCole/317fe03805d5802e31cfa37e646e419d#file-azureredis-patchingexplained-md)引起的连接故障。\n\n#### 性能测试\n\n*   使用 `redis-benchmark.exe` 启动以在编写性能测试前感受可能的吞吐量。 因为 `redis-benchmark` 不支持 SSL，因此，在运行测试之前必须[通过 Azure 门户启用非 SSL 端口](https://docs.azure.cn/redis-cache/cache-configure#access-ports)。 例如，请参阅 [如何制定基准和测试缓存的性能？](https://docs.azure.cn/redis-cache/#how-can-i-benchmark-and-test-the-performance-of-my-cache)\n*   用于测试的客户端 VM 应与 Redis 缓存实例位于同一区域。\n*   建议为客户端使用 Dv2 VM 系列，因为该系列具有更好的硬件，会提供最佳的结果。\n*   确保选择的客户端 VM 至少与正在测试的缓存拥有相同的计算和带宽容量。\n*   如果是在 Windows 设备上操作，请在客户端计算机上启用 VRSS。 [请参阅此处了解详细信息](https://technet.microsoft.com/library/dn383582.aspx)。\n*   高级层 Redis 实例具有更好的网络延迟和吞吐量，因为它们是在 CPU 和网络两方面都更好的硬件上运行的。\n\n### 使用常见 Redis 命令时要注意哪些问题？\n\n*   对于某些需要较长时间才能完成的 Redis 命令，在未了解这些命令造成的影响的情况下，不应运行这些命令。\n\n    *   例如，不要在生产环境中运行 [KEYS](http://redis.io/commands/keys) 命令，因为它可能需要很长时间才能返回，具体时间取决于键数。 Redis 是单线程服务器，每次只能处理一个命令。 如果在 KEYS 后面发出了其他命令，则这些命令只会在处理完 KEYS 命令后才会得到处理。 [redis.io 站点](http://redis.io/commands/) 具有关于其支持的每个操作的时间复杂性的详细信息。 单击每个命令以查看每个操作的复杂程度。\n*   键大小 - 应使用小键/值还是大键/值？ 通常这取决于方案。 如果方案需要较大的键，则可调整 ConnectionTimeout 和重试值，并调整重试逻辑。 从 Redis 服务器的角度来看，值越小，性能就越好。\n*   这些考量并不意味着不能在 Redis 中存储较大值，只是要注意以下事项。 延迟会提高。 如果采用一个较大的数据集和一个较小的数据集，则可以使用多个 ConnectionMultiplexer 实例，并根据 [StackExchange.Redis 配置选项有什么作用](https://docs.azure.cn/redis-cache/#cache-configuration)部分中所述，为每个实例配置一组不同的超时和重试值。\n\n### 如何进行基准检验和测试缓存的性能？\n\n*   [启用缓存诊断](https://docs.azure.cn/redis-cache/cache-how-to-monitor#enable-cache-diagnostics)，以便可以[监视](https://docs.azure.cn/redis-cache/cache-how-to-monitor)缓存的运行状况。 可以在 Azure 门户中查看指标，也可以使用所选的工具[下载和查看](https://github.com/rustd/RedisSamples/tree/master/CustomMonitoring)这些指标。\n*   可以使用 redis-benchmark.exe 对 Redis 服务器进行负载测试。\n*   确保负载测试客户端和 Redis 缓存位于同一区域。\n*   使用 redis-cli.exe，并使用 INFO 命令监视缓存。\n*   如果负载导致出现大量内存碎片，则你应该扩展为更大的缓存大小。\n*   有关下载 Redis 工具的说明，请参阅[如何运行 Redis 命令？](https://docs.azure.cn/redis-cache/#cache-commands)部分。\n\n下面的命令提供了有关如何使用 redis-benchmark.exe 的示例。 为获得准确的结果，请从与缓存位于同一区域的 VM 运行这些命令。\n\n*   \n\n使用 1 k 有效负载测试管道 SET 请求\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t SET -n 1000000 -d 1024 -P 50`\n\n*   \n\n使用 1 k 有效负载测试管道 GET 请求。 注意：首先运行上面显示的 SET 测试以填充缓存\n\n`redis-benchmark.exe -h **yourcache**.redis.cache.chinacloudapi.cn -a **yourAccesskey** -t GET -n 1000000 -d 1024 -P 50`\n\n### 有关线程池增长的重要详细信息\n\nCLR 线程池具有两种类型的线程 -""辅助角色""和""I/O 完成端口""（又称为 IOCP）线程。\n\n*   对于诸如处理 `Task.Run(...)` 或 `ThreadPool.QueueUserWorkItem(...)` 方法这类事务，使用辅助角色线程。 需要在后台线程上进行工作时，CLR 中的各种组件也会使用这些线程。\n*   进行异步 IO（例如从网络进行读取）时，使用 IOCP 线程。\n\n线程池按需提供新的辅助角色线程或 I/O 完成线程（没有任何限制），直到它达到每种线程类型的""最小值""设置。 默认情况下，最小线程数设置为系统上的处理器数。\n\n一旦现有（忙碌）线程数达到""最小""线程数，线程池便会将插入新线程的速率限制为每 500 毫秒一个线程。 通常情况下，如果系统中出现需要 IOCP 线程的突发工作，则它会非常快速地处理该工作。 但是，如果突发工作多于配置的""最小值""设置，则在处理某些工作时会出现一定的延迟，因为 ThreadPool 会等待发生以下两种情况之一。\n\n1.  一个现有线程释放，以便处理工作。\n2.  在 500 毫秒内没有任何现有线程释放，因此会创建一个新线程。\n\n基本上，这意味着忙碌线程数大于最小线程数，在应用程序处理网络流量之前可能需要付出 500 毫秒延迟。 此外请务必注意，当现有线程保持空闲状态的时间超过 15 秒（基于我记得的内容）时，会清理它，并且这种增长和收缩的循环可能会重复。\n\n如果我们考虑一个来自 StackExchange.Redis（内部版本 1.0.450 或更高版本）的示例错误消息，会看到它现在会打印 ThreadPool 统计信息（请参阅下面的 IOCP 和辅助角色详细信息）。\n\n`System.TimeoutException: Timeout performing GET MyKey, inst: 2, mgr: Inactive, queue: 6, qu: 0, qs: 6, qc: 0, wr: 0, wq: 0, in: 0, ar: 0, IOCP: (Busy=6,Free=994,Min=4,Max=1000), WORKER: (Busy=3,Free=997,Min=4,Max=1000) `\n\n在上面的示例中，可以看到对于 IOCP 线程有 6 个忙碌线程，而系统配置为允许最少 4 个线程。 在这种情况下，客户端可能会遇到两个 500 毫秒延迟，因为 6 > 4。\n\n请注意，如果 IOCP 或辅助角色线程受到限制，则 StackExchange.Redis 可以会超时。\n\n### 建议\n\n考虑到此信息，我们强烈建议客户将 IOCP 和辅助角色线程的最小配置值设置为大于默认值。 我们无法提供有关此值应是多少的通用指导，因为一个应用程序的合适值对于另一个应用程序会太高/低。 此设置还可能会影响复杂应用程序其他部分的性能，因此每个客户需要按照其特定需求来微调此设置。 开始时设置为 200 或 300 会比较好，随后可进行测试并根据需要进行调整。\n\n如何配置此设置：\n\n*   \n\n在 ASP.NET 中，可在 web.config 中的 `` 配置元素下使用[""minIoThreads""配置设置](https://msdn.microsoft.com/library/vstudio/7w2sway1(v=vs.100).aspx)。如果在 Azure 网站内部运行，则此设置不会通过配置选项进行公开。 但是，应该仍然能够通过 global.asax.cs 中的 Application_Start 方法以编程方式配置此设置置（请参阅下文）。\n\n\nNote\n\n此配置元素中指定的值是按核心设置。 例如，如果使用 4 核计算机，并且希望 minIOThreads 设置在运行时为 200，则使用 ``。\n\n*   \n\n在 ASP.NET 外部，可使用 [ThreadPool.SetMinThreads(...)](https://msdn.microsoft.com/library/system.threading.threadpool.setminthreads.aspx) API。\n\n### 启用服务器 GC，以便在使用 StackExchange.Redis 时在客户端上获取更多吞吐量\n\n启用服务器 GC 可以在使用 StackExchange.Redis 时优化客户端并提供更好的性能和吞吐量。 有关服务器 GC 以及如何启用它的详细信息，请参阅以下文章：\n\n*   [若要启用服务器 GC](https://msdn.microsoft.com/library/ms229357.aspx)\n*   [垃圾回收基础](https://msdn.microsoft.com/library/ee787088.aspx)\n*   [垃圾回收和性能](https://msdn.microsoft.com/library/ee851764.aspx)\n\n### 围绕连接的性能注意事项\n\n每个定价层都有不同的客户端连接、内存和带宽的限制。 虽然每个缓存大小最多允许一定数量的连接，但与 Redis 的每个连接都具有其关联的开销。 此类开销的一个示例是，由于 TLS/SSL 加密而导致的 CPU 和内存使用。 给定缓存大小的最大连接限制假定轻负载缓存。 如果连接开销的负载和客户端操作的负载超出了系统容量，那么即使未超出当前缓存大小的连接限制，缓存也可能会遇到容量问题。\n\n有关每个层的不同连接限制的详细信息，请参阅 [Azure Redis 缓存定价](https://www.azure.cn/pricing/details/redis-cache/)。 有关连接和其他默认配置的详细信息，请参阅[默认 Redis 服务器配置](https://docs.azure.cn/redis-cache/cache-configure#default-redis-server-configuration)。\n\n### 如何监视缓存的运行状况和性能？\n\n可以在 [Azure 门户](https://portal.azure.cn/)中监视 Azure Redis 缓存实例。 可以查看度量值、将度量值图表固定到启动板、自定义监视图表的日期和时间范围、在图表中添加和删除度量值，以及设置符合特定条件时发出的警报。 有关详细信息，请参阅 [Monitor Azure Redis Cache](https://docs.azure.cn/redis-cache/cache-how-to-monitor)（监视 Azure Redis 缓存）。\n\n借助这些工具，可以监视 Azure Redis 缓存实例的运行状况，以及管理缓存应用程序。 有关详细信息，请参阅[如何配置 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-configure)的""支持和故障排除设置""部分。\n\n### 为何会出现超时？\n\n超时发生在用来与 Redis 通信的客户端中。 将某个命令发送到 Redis 服务器后，该命令会排队，Redis 服务器最终会提取该命令并执行它。 但是，客户端在此过程中可能会超时，在这种情况下，会在调用端引发异常。 有关排查超时问题的详细信息，请参阅[客户端故障排除](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#client-side-troubleshooting)和 [StackExchange.Redis 超时异常](https://docs.azure.cn/redis-cache/cache-how-to-troubleshoot#stackexchangeredis-timeout-exceptions)。\n\n### 客户端为何与缓存断开连接？\n\n下面是缓存断开连接的一些常见原因。\n\n*   客户端的原因\n\n    *   已重新部署客户端应用程序。\n    *   客户端应用程序执行了缩放操作。\n\n    *   对于云服务或 Web 应用，原因可能在于自动缩放。\n    *   客户端上的网络层已更改。\n    *   客户端中或客户端与服务器之间的网络节点中发生暂时性错误。\n    *   已达到带宽阈值限制。\n    *   占用大量 CPU 的操作花费了太长时间才完成。\n*   服务器端的原因\n\n    *   在标准缓存产品上，Azure Redis 缓存服务启动了从主节点到辅助节点的故障转移。\n    *   Azure 正在修补已部署缓存的实例\n\n    *   原因可能是 Redis 服务器更新或常规 VM 维护。\n\n### 哪种 Azure 缓存产品适合我？\n\n\n\nImportant\n\n按照去年的 [公告](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)，已于 2016 年 11 月 30 日 停用 Azure 托管缓存服务和 Azure 角色中缓存服务。 我们建议使用 [Azure Redis 缓存](https://docs.azure.cn/zh-cn/redis-cache/)。 有关迁移的信息，请参阅[从托管缓存服务迁移到 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-migrate-to-redis)。\n\n\n### Azure Redis 缓存\n\nAzure Redis 缓存已正式发布，最大大小为 53 GB，且其可用性 SLA 为 99.9%。 全新[高级级别](https://docs.azure.cn/redis-cache/cache-premium-tier-intro)提供的最大大小为 530 GB，且支持群集、VNET 和持久性，并附带 99.9% SLA。\n\nAzure Redis 缓存使客户能够使用 Azure.cn 管理的安全专用 Redis 缓存。 有了此产品，用户就可以利用 Redis 提供的丰富功能集和生态系统，并可以从 Azure.cn 获得可靠的托管和监控。\n\n与仅处理键/值对的传统缓存不同，Redis 因其高性能的数据类型而受欢迎。 Redis 还支持对这些类型运行原子操作，如在字符串后面追加内容；递增哈希中的值；推送到列表；计算交集、并集和差集，或者获取排序集中排名最高的成员。 其他功能包括支持事务、发布/订阅、Lua 脚本、具有有限生存时间的键和配置设置，使 Redis 在行为上更类似于传统缓存。\n\nRedis 取得成功的另一个重要方面是围绕它构建了健康而充满活力的开源生态系统。 这反映在可通过多种语言使用各种不同的 Redis 客户端。 此生态系统和广泛的客户端使得 Azure Redis 缓存几乎可供在 Azure 内生成的任何工作负荷使用。\n\n有关如何开始使用 Azure Redis 缓存的详细信息，请参阅[如何使用 Azure Redis 缓存](https://docs.azure.cn/redis-cache/cache-dotnet-how-to-use-azure-redis-cache)和 [Azure Redis 缓存文档](https://docs.azure.cn/redis-cache/index)。\n\n### 托管缓存服务\n\n[托管缓存服务已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的托管缓存服务文档](https://msdn.microsoft.com/library/azure/dn386094.aspx)。\n\n### 角色中缓存\n\n[角色中缓存已于 2016 年 11 月 30 日停用。](https://azure.microsoft.com/blog/azure-managed-cache-and-in-role-cache-services-to-be-retired-on-11-30-2016/)\n\n若要查看已存档的文档，请参阅[已存档的角色中缓存文档](https://msdn.microsoft.com/library/azure/dn386103.aspx)。\n",是否可将 Azure Redis 缓存用作 PHP 会话缓存？,redis cache,https://docs.azure.cn/redis-cache/cache-faq
\n\n可以使用 [Azure 门户](https://portal.azure.cn/)或 PowerShell 命令，将命名空间从一个 Azure 订阅移到另一个 Azure 订阅。 若要执行此操作，命名空间必须已处于活动状态。 执行这些命令的用户必须是源订阅和目标订阅的管理员。\n\n#### 门户\n\n若要使用 Azure 门户将服务总线命名空间迁移到其他订阅，可按照[此处](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources#use-portal)的说明操作。 \n\n#### PowerShell\n\n下面的 PowerShell 命令序列将命名空间从一个 Azure 订阅迁移到另一个 Azure 订阅。 若要执行此操作，命名空间必须已经处于活动状态，而且运行 PowerShell 命令的用户必须同时是源订阅和目标订阅的管理员。\n\n# Create a new resource group in target subscription Select-AzureRmSubscription -SubscriptionId 'ffffffff-ffff-ffff-ffff-ffffffffffff' New-AzureRmResourceGroup -Name 'targetRG' -Location 'China East' # Move namespace from source subscription to target subscription Select-AzureRmSubscription -SubscriptionId 'aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa' $res = Find-AzureRmResource -ResourceNameContains mynamespace -ResourceType 'Microsoft.ServiceBus/namespaces' Move-AzureRmResource -DestinationResourceGroupName 'targetRG' -DestinationSubscriptionId 'ffffffff-ffff-ffff-ffff-ffffffffffff' -ResourceId $res.ResourceId \n\n## 后续步骤\n\n若要了解有关服务总线的详细信息，请参阅以下文章：\n\n*   [服务总线概述](https://docs.azure.cn/service-bus-messaging/service-bus-messaging-overview)\n*   [Azure 服务总线体系结构概述](https://docs.azure.cn/service-bus-messaging/service-bus-fundamentals-hybrid-solutions)\n*   [服务总线队列入门](https://docs.azure.cn/service-bus-messaging/service-bus-dotnet-get-started-with-queues),如何将命名空间迁移到另一个 Azure 订阅中？,service bus-messaging,https://docs.azure.cn/service-bus-messaging/service-bus-faq
\n\n共享访问签名是基于 SHA-256 安全哈希或 URI 的身份验证机制。 有关如何在 Node、PHP、Java 和 C# 中生成自有签名的信息，请参阅[共享访问签名](https://docs.azure.cn/service-bus-messaging/service-bus-sas)一文。\n\n## 订阅和命名空间管理\n\n,什么是共享访问签名？哪些语言支持生成签名？,service bus-messaging,https://docs.azure.cn/service-bus-messaging/service-bus-faq
有关可能的服务总线异常的列表，请参阅[异常概述](https://docs.azure.cn/service-bus-messaging/service-bus-messaging-exceptions),Azure 服务总线 API 生成了哪些异常？建议采取什么操作？,service bus-messaging,https://docs.azure.cn/service-bus-messaging/service-bus-faq
\n\n否，服务总线不对存储收费。 但是，对每个队列/主题可以保留的数据最大量设有配额限制。 请参阅下一个常见问题。\n\n## 配额\n\n有关服务总线限制和配额的列表，请参阅[服务总线配额概述](https://docs.azure.cn/service-bus-messaging/service-bus-quotas)\n,服务总线是否对存储收费？,service bus-messaging,https://docs.azure.cn/service-bus-messaging/service-bus-faq
\n\n默认情况下，对于任何云服务，Azure 每月都会设置聚合的使用率配额，此配额基于客户的所有订阅进行计算。 如果需要这些限制之外的更多配额，可以随时联系客户服务，以便我们了解需求并相应地调整这些限制。 对于服务总线，总用量配额是每月 50 亿条消息。\n\n虽然我们保留禁用在给定月份超过使用配额的客户帐户的权利，但我们仍然会在采取任何措施前发送电子邮件通知，并多次尝试与客户联系。 超过这些配额的客户仍需负责超出配额的费用。\n\n至于 Azure 上的其他服务，服务总线会强制使用一组特定配额，以确保资源的公平使用。 可以在[服务总线配额概述](https://docs.azure.cn/service-bus-messaging/service-bus-quotas)中找到有关这些配额的更多详细信息。\n\n## 故障排除\n\n,服务总线是否有任何使用率配额？,service bus-messaging,https://docs.azure.cn/service-bus-messaging/service-bus-faq
在给定 Azure 区域内的任何数据传输和入站数据传输均不收费。,服务总线的哪些使用情况受数据传输限制？ 哪些不受其限制？,service bus-messaging,https://docs.azure.cn/service-bus-messaging/service-bus-faq
主题可被视为队列，使用多个订阅时，它成为更丰富的消息传送模型；实质上是一种一对多的通信工具。 此发布/订阅模型（或 pub/sub）启用了一个应用程序，该应用程序将消息发送到具有多个订阅的主题中，进而使多个应用程序接收到该消息。,什么是 Azure 服务总线主题和订阅？,service bus-messaging,https://docs.azure.cn/service-bus-messaging/service-bus-faq
\n\n队列和主题的以下属性是固定不变的。 预配实体时，请考虑此限制，因为必须创建新的替代实体才可修改这些属性。\n\n*   \n\n大小\n\n*   \n\n分区\n\n*   \n\n会话\n\n*   \n\n重复检测\n\n*   \n\n快速实体\n\n##  定价\n\n本部分回答了一些关于服务总线定价结构的常见问题。\n\n[服务总线定价和计费](https://docs.azure.cn/service-bus-messaging/service-bus-pricing-billing)一文介绍了服务总线中的计费计量。有关服务总线定价选项的具体信息，请参阅[服务总线定价详细信息](https://www.azure.cn/pricing/details/messaging/)\n,创建实体前的须知事项有哪些？,service bus-messaging,https://docs.azure.cn/service-bus-messaging/service-bus-faq
[Azure 服务总线](https://docs.azure.cn/service-bus-messaging/service-bus-messaging-overview)是一个异步消息传送云平台，可允许在分离的系统之间发送数据。 Microsoft 以服务的形式提供此功能，这表示不需要托管任何自有硬件就能使用它。,什么是 Azure 服务总线？,service bus-messaging,https://docs.azure.cn/service-bus-messaging/service-bus-faq
[命名空间](https://docs.azure.cn/service-bus-messaging/service-bus-create-namespace-portal)提供了用于对应用程序中的服务总线资源进行寻址的范围容器。 必须创建命名空间才能使用服务总线，而且这也是开始使用的第一步。,什么是服务总线命名空间？,service bus-messaging,https://docs.azure.cn/service-bus-messaging/service-bus-faq
有关服务总线定价的完整信息，请参阅[服务总线定价详细信息](http://www.azure.cn/pricing/details/messaging)。 除标示的价格外，还需为在其中部署应用程序的数据中心之外的相关数据输出支付费用。,服务总线如何收取费用？,service bus-messaging,https://docs.azure.cn/service-bus-messaging/service-bus-faq
\n\n传统的队列或主题由单个消息中转站进行处理并存储在一个消息存储中。 [分区队列或主题](https://docs.azure.cn/service-bus-messaging/service-bus-partitioning)由多个消息中转站处理，并存储在多个消息传送存储中。 这意味着分区的队列或主题的总吞吐量不再受到单个消息中转站或消息存储的性能所限制。 此外，消息传送存储的临时中断不会导致分区队列或主题不可用。\n\n请注意，使用分区实体时不保证排序。 如果某个分区不可用，仍可从其他分区发送和接收消息。\n\n## 最佳实践\n\n,什么是分区实体？,service bus-messaging,https://docs.azure.cn/service-bus-messaging/service-bus-faq
请参阅[使用服务总线改进性能的最佳做法](https://docs.azure.cn/service-bus-messaging/service-bus-performance-improvements) - 本文介绍了如何在交换消息时优化性能。,Azure 服务总线的最佳实践有哪些？,service bus-messaging,https://docs.azure.cn/service-bus-messaging/service-bus-faq
[服务总线队列](https://docs.azure.cn/service-bus-messaging/service-bus-queues-topics-subscriptions)是用于存储消息的实体。 有多个应用程序，或者有多个需要彼此通信的分布式应用程序部分时，队列特别有用。 队列和发行中心的相似之处在于，两者都会接收多个产品（消息），再从该处送出。,什么是 Azure 服务总线队列？,service bus-messaging,https://docs.azure.cn/service-bus-messaging/service-bus-faq
\n\n是的。 中继客户端使用完全限定的域名连接到 Azure 中继服务。 客户可以在支持 DNS 允许列表的防火墙上为 `*.servicebus.chinacloudapi.cn` 添加一个条目。\n\n## 后续步骤\n\n*   [创建命名空间](https://docs.azure.cn/service-bus-relay/relay-create-namespace-portal)\n*   [.NET 入门](https://docs.azure.cn/service-bus-relay/relay-hybrid-connections-dotnet-get-started)\n*   [节点入门](https://docs.azure.cn/service-bus-relay/relay-hybrid-connections-node-get-started),是否可以将中继终结点加入白名单？,service bus-relay,https://docs.azure.cn/service-bus-relay/relay-faq
共享访问签名是基于 SHA-256 安全哈希或 URI 的身份验证机制。 有关如何在 Node、PHP、Java、C 和 C# 中生成自有签名的信息，请参阅[使用共享访问签名进行服务总线身份验证](https://docs.azure.cn/service-bus-messaging/service-bus-sas),什么是共享访问签名？哪些语言可以用来生成签名？,service bus-relay,https://docs.azure.cn/service-bus-relay/relay-faq
有关常见异常以及可以采用的建议操作的说明，请参阅[中继异常](https://docs.azure.cn/service-bus-relay/relay-exceptions),Azure 中继 API 所生成的异常有哪些，可以采用哪些建议操作？,service bus-relay,https://docs.azure.cn/service-bus-relay/relay-faq
\n\n中继命名空间名称的长度必须介于 6 到 50 个字符之间。\n\n## 订阅和命名空间管理\n\n,命名限制,service bus-relay,https://docs.azure.cn/service-bus-relay/relay-faq
"\n\n（这仅适用于 WCF 中继。）\n\n一般情况下，会使用与上述相同的用于中转实体（队列、主题和订阅）的方法来计算中继的可计费消息。 但是，有一些明显的区别。\n\n将消息发送至服务总线中继的操作被视为""完全通过""式发送，其目标是接收消息的中继侦听器。 不会将其视为目标为服务总线中继的发送，这种情况下随后需交付至中继侦听器， 针对中继侦听器的请求-应答模式服务调用（最大 64 KB）将生成两条可计费消息：一条用于请求的可计费消息，一条用于应答（假设响应也是 64 KB 或更小）的可计费消息。 这不同于使用队列在客户端和服务之间进行协调。 如果使用队列在客户端和服务之间进行协调，则同一请求-答复模式要求先将请求发送到队列，然后再将其从队列交付到服务，或者取消其排队。 随后就是将响应发送至另一队列，再从该队列交付至客户端，或者取消排队。 如果始终使用同一大小作为假设（最高 64 KB），则此中介型队列模式会生成四条计费消息。 收费的消息数两倍于使用中继实现同一模式时的消息数。 当然，使用队列来实现此模式好处更多，例如持久性和负载分级。 这些好处可能产生额外费用。\n\n使用 netTCPRelay Windows Communication Foundation (WCF) 绑定打开的中继不将消息视为单条消息，而视为流经系统的数据流。 使用此绑定时，只有发送方和侦听器可以识别发送和接收的单条分帧消息。 对于使用 netTCPRelay 绑定的中继，所有数据都将被视为用于计算可计费消息的数据流。 在这种情况下，服务总线每隔 5 分钟计算一次通过单个中继发送或接收的数据总量。 然后会将该数据总量除以 64 KB，得出该中继在该时段的计费消息数。\n\n## 配额\n\n配额名称范围类型超出时的行为值中继上的并发侦听器数实体静态系统会拒绝后续的附加连接请求，且调用代码会收到异常。25并发中继侦听器数系统级静态系统会拒绝后续的附加连接请求，且调用代码会收到异常。2,000服务命名空间中所有中继终结点的并发中继连接数系统级静态-5,000每个服务命名空间的中继终结点数系统级静态-10,000[NetOnewayRelayBinding](https://msdn.microsoft.com/library/microsoft.servicebus.netonewayrelaybinding.aspx) 和 [NetEventRelayBinding](https://msdn.microsoft.com/library/microsoft.servicebus.neteventrelaybinding.aspx) 中继的消息大小系统级静态会拒绝超过这些配额的传入消息，且调用代码会收到异常。64 KB[HttpRelayTransportBindingElement](https://msdn.microsoft.com/library/microsoft.servicebus.httprelaytransportbindingelement.aspx) 和 [NetTcpRelayBinding](https://msdn.microsoft.com/library/microsoft.servicebus.nettcprelaybinding.aspx) 中继的消息大小系统级静态-不受限制",如何计算 WCF 中继的消息数？,service bus-relay,https://docs.azure.cn/service-bus-relay/relay-faq
\n\n可以使用 [Azure 门户](https://portal.azure.cn/)或 PowerShell 命令，将命名空间从一个 Azure 订阅移到另一个订阅。 若要将命名空间移到另一个订阅，该命名空间必须处于活动状态。 运行这些命令的用户必须是源订阅和目标订阅的管理员用户。\n\n#### Azure 门户\n\n若要使用 Azure 门户将 Azure 中继命名空间从一个订阅迁移到另一个订阅，请参阅[将资源移到新的资源组或订阅](https://docs.azure.cn/azure-resource-manager/resource-group-move-resources#use-portal)。 \n\n#### PowerShell\n\n若要使用 PowerShell 将命名空间从一个 Azure 订阅移到另一个订阅，请使用以下命令序列。 若要执行此操作，该命名空间必须已经处于活动状态，并且运行 PowerShell 命令的用户必须同时是源和目标订阅上的管理员用户。\n\n# Create a new resource group in the target subscription. Select-AzureRmSubscription -SubscriptionId 'ffffffff-ffff-ffff-ffff-ffffffffffff' New-AzureRmResourceGroup -Name 'targetRG' -Location 'China East' # Move the namespace from the source subscription to the target subscription. Select-AzureRmSubscription -SubscriptionId 'aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa' $res = Find-AzureRmResource -ResourceNameContains mynamespace -ResourceType 'Microsoft.ServiceBus/namespaces' Move-AzureRmResource -DestinationResourceGroupName 'targetRG' -DestinationSubscriptionId 'ffffffff-ffff-ffff-ffff-ffffffffffff' -ResourceId $res.ResourceId \n\n## 故障排除\n\n,如何将命名空间迁移到另一个 Azure 订阅？,service bus-relay,https://docs.azure.cn/service-bus-relay/relay-faq
WCF 中继仅适用于标准层命名空间。 其他中继的定价和[连接配额](https://docs.azure.cn/service-bus-messaging/service-bus-quotas)保持不变。 这意味着中继将继续根据消息数（而不是操作数）和中继小时数计费。 有关详细信息，请参阅定价详细信息页上的[混合连接和 WCF 中继](https://www.azure.cn/pricing/details/messaging/)表。,如何计算中继小时数？,service bus-relay,https://docs.azure.cn/service-bus-relay/relay-faq
有关中继定价的完整信息，请参阅[服务总线定价详细信息](https://www.azure.cn/pricing/details/messaging/)。 除该页上标示的价格外，还需为在其中部署应用程序的数据中心之外的相关数据输出支付费用。,WCF 中继如何收费？,service bus-relay,https://docs.azure.cn/service-bus-relay/relay-faq
\n\n以前命名的服务总线中继服务现在称为 WCF 中继。 你可以继续照常使用此服务。 混合连接功能是一种更新版的服务，从 Azure BizTalk 服务移植过来。 将继续支持 WCF 中继和混合连接。\n\n## 定价\n\n本部分回答了一些关于中继定价结构的常见问题。 若要了解一般的 Azure 定价信息，还可以参阅 [Azure 支持常见问题](http://go.microsoft.com/fwlink/?LinkID=185083)。 有关中继定价的完整信息，请参阅[服务总线定价详细信息](https://www.azure.cn/pricing/details/messaging/)。\n,服务总线中继服务发生了什么情况？,service bus-relay,https://docs.azure.cn/service-bus-relay/relay-faq
[命名空间](https://docs.azure.cn/service-bus-relay/relay-create-namespace-portal)是一个范围容器，可用于对应用程序中的中继资源进行寻址。 必须创建命名空间才能使用中继。 这是入门的开始步骤之一。,什么是中继命名空间？,service bus-relay,https://docs.azure.cn/service-bus-relay/relay-faq
[Azure 中继服务](https://docs.azure.cn/service-bus-relay/relay-what-is-it)可以帮助你以更安全的方式将企业网络中驻留的服务公开给公有云，从而改进混合应用程序的使用。 可以在不打开防火墙连接的情况下公开服务，不需对企业网络基础结构进行干预性更改。,什么是 Azure 中继？,service bus-relay,https://docs.azure.cn/service-bus-relay/relay-faq
"在某些情况下，单个中继可能会有多个连接的侦听器。 当至少有一个中继侦听器连接到中继时，该中继都就会被视为""打开""状态。 将侦听器添加到打开的中继时，会增加中继小时数。 连接到中继的中继发送方（调用消息或将消息发送至中继的客户端）数量不会对中继小时数的计算产生影响。",如果将多个侦听器连接到特定中继，会怎么样？,service bus-relay,https://docs.azure.cn/service-bus-relay/relay-faq
\n\n默认情况下，对于任何云服务，Microsoft 设置聚合的每月使用配额，通过对所有的客户订阅计算得到。 我们了解，有时候，你的需求可能会超过这些限制。 你可以随时联系客户服务人员，以便我们了解你的需求并相应地调整这些限制。 对于服务总线，聚合的使用率配额为如下所示：\n\n*   50 亿条消息\n*   200 万个中继小时\n\n虽然我们保留禁用超过单月使用率配额的客户帐户的权利，但我们仍然会在采取任何措施前发送电子邮件通知并会多次尝试与客户联系。 超过这些配额的客户仍需负责超出配额的费用。\n,中继是否具有任何使用率配额？,service bus-relay,https://docs.azure.cn/service-bus-relay/relay-faq
如需资源运行状况支持的运行状况检查和资源类型的列表，可单击[此处](https://docs.azure.cn/service-health/resource-health-checks-resource-types)。,资源运行状况是否适用于所有资源类型？,service health,https://docs.azure.cn/service-health/resource-health-faq
\n\n了解有关资源运行状况的详细信息：\n\n*   [Azure 资源运行状况概述](https://docs.azure.cn/service-health/resource-health-overview)\n*   [可通过 Azure 资源运行状况使用的资源类型和运行状况检查](https://docs.azure.cn/service-health/resource-health-checks-resource-types),后续步骤,service health,https://docs.azure.cn/service-health/resource-health-faq
资源运行状况会根据运行状态提供建议，目的是减少进行故障排除的时间。 这些建议针对可用资源，注重于如何解决客户遇到的最常见问题。 如果资源因 Azure 计划外事件而不可用，则会注重于提供恢复过程之中和之后的帮助。,资源运行状况提供的建议有哪些？,service health,https://docs.azure.cn/service-health/resource-health-faq
是的。 Azure 资源运行状况免费提供。,是否免费提供资源运行状况？,service health,https://docs.azure.cn/service-health/resource-health-faq
否。 Azure 资源运行状况可以在 Azure 门户中访问，没有任何设置要求。,是否需要为组织启用资源运行状况？,service health,https://docs.azure.cn/service-health/resource-health-faq
否。运行状况信息适用于可以通过资源运行状况获取的所有资源类型。,是否需要激活每个资源的资源运行状况？,service health,https://docs.azure.cn/service-health/resource-health-faq
\n\n资源运行状况提供的信息比 Azure 服务运行状况仪表板提供的更具体。\n\n[Azure 状态](https://www.azure.cn/support/service-dashboard/)和门户服务通知会告知影响大量客户（例如某个 Azure 区域的客户）的服务问题，而资源运行状况则会公开更细致的事件，这些事件仅与特定的资源相关。 例如，如果某个主机意外重启，资源运行状况仅提醒其虚拟机在该主机上运行的那些客户。\n\n必须注意的是，为了让你全面了解影响资源的事件，资源运行状况还会呈现在服务通知和服务运行状况仪表板中发布的事件。\n,资源运行状况与服务运行状况仪表板或 Azure 门户服务通知有何不同？,service health,https://docs.azure.cn/service-health/resource-health-faq
"检查资源的运行状况时，可直接在运行状态下单击""报告不正确的运行状态""。 在提交报告之前，可以选择提供更多详细信息，说明为什么你认为当前的运行状态不正确。",如果我的资源显示可用，但我认为它不可用，该怎么办？,service health,https://docs.azure.cn/service-health/resource-health-faq
"\n\n登录 Azure 门户以后，即可通过多种方式访问资源运行状况：\n\n*   导航到资源。 在左侧导航栏中，选择""资源运行状况""\n*   转到 Azure Monitor 边栏选项卡。 在左侧导航栏中，选择""资源运行状况""。\n*   通过选择门户右上角的问号，并选择""帮助 + 支持""，打开""帮助 + 支持""边栏选项卡。 该边栏选项卡打开后，选择""资源运行状况""\n\n也可使用资源运行状况 API，获取资源运行状况的相关信息。\n",在何处查找资源运行状况？,service health,https://docs.azure.cn/service-health/resource-health-faq
\n\n是的，当资源不可用时，资源运行状况会将根本原因归为以下类别之一： \n\n*   用户启动的操作\n*   计划内事件 \n*   计划外事件\n\n在门户中，用户启动的操作用蓝色通知图标显示，而计划内和计划外事件则用红色警告图标显示。 [资源运行状况概述](https://docs.azure.cn/service-health/resource-health-overview)中提供了更多详细信息。 \n,资源运行状况是否会对平台问题导致的不可用与我的操作导致的不可用进行区分？,service health,https://docs.azure.cn/service-health/resource-health-faq
可以从资源运行状况边栏选项卡提交支持请求。,如果资源不可用，如何获取帮助？,service health,https://docs.azure.cn/service-health/resource-health-faq
当资源运行状况停止接收特定资源的相关信息时，资源运行状态设置为未知。 虽然在出现问题的情况下，此状态并没有确切地指示资源的状态，但仍然表明可能存在 Azure 问题。,未知状态意味着什么？ 我的资源是否出了问题？,service health,https://docs.azure.cn/service-health/resource-health-faq
\n\n有三种不同的运行状态：\n\n*   可用：Azure 平台中没有任何已知能够影响该资源的问题\n*   不可用：资源运行状况检测到影响资源的问题\n*   未知：资源运行状况无法确定资源的运行状况，因为已停止接收有关该资源的信息。,每个运行状态意味着什么？,service health,https://docs.azure.cn/service-health/resource-health-faq
\n\n资源运行状况根据[资源类型](https://docs.azure.cn/service-health/resource-health-checks-resource-types)执行各种检查。 这些检查旨在针对三类问题： \n\n*   计划外事件，例如主机意外重新启动\n*   计划内事件，例如主机 OS 按计划更新\n*   用户操作触发的事件，例如用户重新启动虚拟机,资源运行状况执行何种运行状况检查？,service health,https://docs.azure.cn/service-health/resource-health-faq
检测到资源出现问题以后，即可通过资源运行状况诊断根本原因。 它有助于减轻问题，并可在需要 Azure 服务问题的更多帮助时提供技术支持。,资源运行状况的用途是什么？,service health,https://docs.azure.cn/service-health/resource-health-faq
资源运行状况在 Azure 问题影响资源时帮助你进行诊断并获得支持。 它通知你有关资源的当前和过去运行状况的信息，并帮助你缓解问题。 在需要有关 Azure 服务问题的帮助时，资源运行状况将提供技术支持。,什么是 Azure 资源运行状况？,service health,https://docs.azure.cn/service-health/resource-health-faq
资源运行状况是一项服务，旨在帮助你诊断和减轻影响资源的 Azure 服务问题。 虽然可以使用资源运行状况 API 来程序性地获取运行状态，但建议使用指标来监视资源。 一旦检测到问题，资源运行状况就可以帮助确定根本原因，指导完成解决问题所需的操作。 请访问 [Azure Monitor](https://docs.azure.cn/zh-cn/monitoring-and-diagnostics/)，详细了解如何使用指标来检查资源。,能否将资源运行状况与监视工具集成？,service health,https://docs.azure.cn/service-health/resource-health-faq
不支持此操作。,在首次复制到 Azure 时可以进行脱机复制吗？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
使用 Azure 门户将 [VMware VM 和 Hyper-V VM 复制](https://docs.azure.cn/site-recovery/site-recovery-exclude-disk)到 Azure 时支持此操作。,可以从复制中排除特定的磁盘吗？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
复制 Hyper-V 虚拟机时，支持使用动态磁盘。 将 VMware VM 和物理计算机复制到 Azure 时也支持使用动态磁盘。 操作系统磁盘必须是基本磁盘。,可以使用动态磁盘来复制虚拟机吗？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
"支持将新计算机添加到现有的复制组。 要进行此操作，请从""已复制项目""边栏选项卡中，选择复制组并右键单击/选择复制组中的上下文菜单，然后选择相应的选项。",我能否将新计算机添加到现有的复制组中？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
\n\n是的。 可以从以下部署文章中阅读更多有关限制带宽的信息：\n\n*   [复制 VMware VM 和物理服务器的容量规划](https://docs.azure.cn/site-recovery/site-recovery-plan-capacity-vmware)\n*   [将 Hyper-V VM 复制到 Azure 的容量规划](https://docs.azure.cn/site-recovery/site-recovery-capacity-planning-for-hyper-v-replication)\n\n## 故障转移\n\n,可以限制针对 Hyper-V 复制流量分配的带宽吗？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
可以通过安全的 Internet 连接或者站点到站点 VPN 或 Azure ExpressRoute 访问 Azure VM。 在连接之前需要做许多准备。,在故障转移到 Azure 之后，如何访问 Azure 虚拟机？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
Azure 具有复原能力。 Site Recovery 已经能够根据需要故障转移到符合 Azure SLA 的辅助 Azure 数据中心。 发生此情况时，我们确保元数据和保管库都保留在为保管库选择的相同地理区域。,如果故障转移到 Azure，Azure 如何确保我的数据可恢复？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
可以从辅助站点触发非计划的故障转移。 Site Recovery 不需要来自主站点的连接即可执行故障转移。,如果在两个数据中心之间进行复制，当我的主数据中心发生意外的服务中断时，会出现什么情况？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
不是。 租户标识是匿名的。 租户不需要访问 Site Recovery 门户。 只有服务提供商管理员才能与门户交互。,对于服务提供商而言，我的租户标识是否与 Site Recovery 服务共享？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
\n\n是，可以使用备用位置恢复从 Azure 故障回复到另一个主机。 通过用于 VMware 和 Hyper-v 虚拟机的以下链接详细了解选项。\n\n*   [对于 VMware 虚拟机](https://docs.azure.cn/site-recovery/site-recovery-how-to-failback-azure-to-vmware#fail-back-to-the-original-or-alternate-location)\n*   [对于 Hyper-v 虚拟机](https://docs.azure.cn/site-recovery/site-recovery-failback-from-azure-to-hyper-v#failback-to-an-alternate-location)\n\n## 服务提供商\n\n,如果我的本地主机未响应或崩溃，我是否可以故障转移回到另一个主机？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
是的，Site Recovery 同时支持专用与共享的基础结构模型。,我是服务提供商。 Site Recovery 是否适用于专用和共享的基础结构模型？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
\n\n在服务提供商拥有的站点之间进行复制时，永远不会将应用程序数据发送到 Azure。 数据进行传输中加密并直接在服务提供商站点之间复制。\n\n如果是复制到 Azure，应用程序数据将发送到 Azure 存储而不是站点恢复服务。 数据进行传输中加密并在 Azure 中保持加密状态。\n,租户应用程序数据是否会发往 Azure？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
不是。 Azure 直接与服务提供商保持计费关系。 服务提供商责任为其租户生成特定的帐单。,我的租户会收到来自 Azure 服务的帐单吗？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
不需要。会将数据复制到订阅中的 Azure 存储帐户。 执行测试故障转移（灾难恢复演练）或实际的故障转移时，站点恢复会在订阅中自动创建虚拟机。,如果我复制到 Azure，需要在 Azure 中随时运行虚拟机吗？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
我们支持 Azure Pack、云平台系统和基于 System Center 的（2012 和更高版本）的部署。 [了解更多](https://technet.microsoft.com/library/dn850370.aspx)有关 Azure Pack 和 Site Recovery 集成的信息。,目前支持哪些平台？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
\n\n是，可将 Hyper-V 虚拟机复制到 Azure，或者在服务提供商站点之间复制。 请注意，如果在服务提供商站点之间复制，将无法使用 Azure Runbook 集成。\n\n## 后续步骤\n\n*   阅读 [站点恢复概述](https://docs.azure.cn/site-recovery/site-recovery-overview)\n*   了解 [Site Recovery 体系结构](https://docs.azure.cn/site-recovery/site-recovery-components),是否支持单一 Azure Pack 和单一 VMM 服务器部署？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
不支持扩展扩展或链式复制。,我可以将复制从现有的恢复站点扩展到其他站点吗？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
\n\n故障转移不是自动的。 可以在门户中单击一下来启动故障转移，或者使用[站点恢复 PowerShell](https://docs.microsoft.com/powershell/module/azurerm.siterecovery) 来触发故障转移。 在 Site Recovery 门户中可以轻松进行故障回复。\n\n要自动化，可以使用本地 Orchestrator 或 Operations Manager 来检测虚拟机故障，并使用 SDK 来触发故障转移。\n\n*   [详细了解](https://docs.azure.cn/site-recovery/site-recovery-create-recovery-plans)恢复计划。\n*   [详细了解](https://docs.azure.cn/site-recovery/site-recovery-failover)故障转移。\n*   [详细了解](https://docs.azure.cn/site-recovery/site-recovery-failback-azure-to-vmware) VMware VM 和物理服务器故障回复的信息,故障转移是自动发生的吗？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
*   Hyper-V：可以每隔 30 秒（高级存储除外）、5 分钟或 15 分钟复制一次 Hyper-V VM。 如果已设置 SAN 复制，则复制将是同步的。\n*   VMware 和物理服务器： 复制频率无关紧要。 复制是连续的。,可以多久复制数据一次？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
是的。,复制到 Azure 时，是否向我确保提供租户级的隔离？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
\n\n是的。 可以使用 Rest API、PowerShell 或 Azure SDK 将站点恢复工作流自动化。 当前支持的使用 PowerShell 部署 Site Recovery 的方案：\n\n*   [将 VMM 云中的 Hyper-V VM 复制到 Azure PowerShell Resource Manager](https://docs.azure.cn/site-recovery/site-recovery-vmm-to-azure-powershell-resource-manager)\n*   [将 Hyper-V VM 复制（不使用 VMM）到 Azure PowerShell Resource Manager](https://docs.azure.cn/site-recovery/site-recovery-deploy-with-powershell-resource-manager),是否可以使用 SDK 自动执行 Site Recovery 方案？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
Site Recovery 可通过协调和自动运行区域之间的 Azure VM 复制、本地虚拟机与物理服务器到 Azure 的复制以及本地计算机到辅助数据中心的复制，来帮助实现业务连续性与灾难恢复 (BCDR) 策略。,Site Recovery 的功能是什么？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
*   Azure VM：Site Recovery 可复制任意在支持的 Azure VM 上运行的工作负荷\n*   Hyper-V 虚拟机：Site Recovery 可以保护 Hyper-V VM 上运行的任何工作负荷。\n*   物理服务器：Site Recovery 可以保护运行 Windows 或 Linux 的物理服务器。\n*   VMware 虚拟机：Site Recovery 可以保护 VMware VM 上运行的任何工作负荷。,Site Recovery 可以保护哪些计算机？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
可以，用户可在 Azure 区域间复制受支持的 Azure VM。,我能否复制 Azure VM？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
\n\n对于 Hyper-V 主机服务器，用户的所需取决于部署方案。 在以下内容中查看 Hyper-V 先决条件：\n\n*   [将 Hyper-V VM 复制（不使用 VMM）到 Azure](https://docs.azure.cn/site-recovery/site-recovery-hyper-v-site-to-azure)\n*   [将 Hyper-V VM 复制（使用 VMM）到 Azure](https://docs.azure.cn/site-recovery/site-recovery-vmm-to-azure)\n*   [将 Hyper-V VM 复制到辅助数据中心](https://docs.azure.cn/site-recovery/site-recovery-vmm-to-vmm)\n*   若要复制到辅助数据中心，请阅读 [Hyper-V 虚拟机的受支持的来宾操作系统](https://technet.microsoft.com/library/mt126277.aspx)。\n*   若要复制到 Azure，Site Recovery 支持 [Azure 支持的](https://technet.microsoft.com/library/cc794868(v=ws.10).aspx)所有来宾操作系统。,为什么需要在 Hyper-V 中使用站点恢复协调复制？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
不可以。VM 必须位于在受支持的 Windows 服务器计算机上运行的 Hyper-V 主机服务器上。 如果需要保护客户端计算机，可以将其作为物理计算机复制到 [Azure](https://docs.azure.cn/site-recovery/site-recovery-vmware-to-azure) 或[辅助数据中心](https://docs.azure.cn/site-recovery/site-recovery-vmware-to-vmware)。,当 Hyper-V 在客户端操作系统上运行时，我可以保护 VM 吗？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
可以使用 Site Recovery 来保护在支持的 VM 或物理服务器上运行的大多数工作负荷。 Site Recovery 为应用程序感知型复制提供支持，因此，应用可以恢复为智能状态。 它除了与 Microsoft 应用程序（例如 SharePoint、Exchange、Dynamics、SQL Server 及 Active Directory）集成之外，还能与行业领先的供应商（包括 Oracle、SAP、IBM 及 Red Hat）紧密配合。 [详细了解](https://docs.azure.cn/site-recovery/site-recovery-workload)工作负荷保护。,我可以使用站点恢复来保护哪些工作负荷？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
如果要复制到辅助数据中心，那么 Hyper-V VM 就必须位于 VMM 云中的 Hyper-V 主机服务器上。 如果想要复制到 Azure，那么可以复制 VM（无论是否使用 VMM 云）。 [详细了解](https://docs.azure.cn/site-recovery/tutorial-hyper-v-to-azure)从 Hyper-V 复制到 Azure。,Hyper-V 主机是否需要位于 VMM 云中？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
是的。 可以将 VMM 云中 Hyper-V 服务器上的 VM 复制到 Azure，或者在同一台服务器上的 VMM 云之间进行复制。 对于本地到本地复制，建议在主站点与辅助站点中都部署一个 VMM 服务器。,如果只有一个 VMM 服务器，可以部署带 VMM 的 Site Recovery 吗？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
\n\n可以将运行 Windows 或 Linux 的物理服务器复制到 Azure 或辅助站点。 [了解](https://docs.azure.cn/site-recovery/site-recovery-support-matrix-to-azure#failed-over-azure-vm-requirements)操作系统要求。 无论是将物理服务器复制到 Azure 还是辅助站点，都需要满足相同的要求。\n\n请注意，如果本地服务器关闭，物理服务器会在 Azure 中以 VM 的形式运行。 当前不支持故障回复到本地物理服务器。 对于作为物理机进行保护的计算机，只能故障回复到 VMware 虚拟机。\n,可以保护哪些物理服务器？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
需要 LRS 或 GRS 存储帐户。 建议使用 GRS，以便在发生区域性故障或无法恢复主要区域时，能够复原数据。 该帐户必须位于与恢复服务保管库相同的区域中。 在 Azure 门户中部署 Site Recovery 时，支持将高级存储用于 VMware VM、Hyper-V VM 和物理服务器复制。,如果要复制到 Azure，需要哪种存储帐户？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
"\n\n是的。 在使用 Site Recovery 来协调分支机构的复制与故障转移时，可在一个中心位置获得所有分支机构工作负荷的统一视图。 不需要前往分支机构，就可以从总部轻松对所有分支机构运行故障转移和管理灾难恢复。\n\n## 定价\n\n定价相关问题，请参阅 [Azure Site Recovery 定价](https://www.azure.cn/pricing/details/site-recovery/)中的常见问题解答。\n\n## ""安全""\n\n",可以使用 Site Recovery 来管理分支机构的灾难恢复吗？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
\n\n不会。站点恢复不拦截复制的数据，也不拥有虚拟机或物理服务器上运行哪些项目的任何相关信息。 复制数据在本地 Hyper-V 主机、VMware 虚拟机监控程序或物理服务器和 Azure 存储或辅助站点之间交换。 站点恢复并不具有拦截该数据的能力。 只有协调复制与故障转移所需的元数据会发送到站点恢复服务。 \n\nSite Recovery 已通过 ISO 27001:2013、27018、HIPAA、DPA 认证，目前正在接受 SOC2 和 FedRAMP JAB 评估。\n,复制数据是否会发送到 Site Recovery 服务？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
是的。 在某个区域中创建 Site Recovery 保管库时，我们确保启用和协调复制与故障转移时所需的一切元数据都保留在该区域的地理边界范围内。,为了遵从法规，即使是本地的元数据，也必须保留在同一个地理区域。 Site Recovery 可以帮助我们吗？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
\n\n在本地站点之间复制虚拟机和物理服务器时，支持传输中加密。 将虚拟机和物理服务器复制到 Azure 时，同时支持传输中加密和[静态加密（Azure 中）](https://docs.azure.cn/zh-cn/storage/storage-service-encryption)。\n\n## 复制\n\n,站点恢复是否将复制数据加密？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
Azure Site Recovery 通过公共终结点将数据复制到 Azure 存储帐户。 复制不是通过站点到站点 VPN 进行。 可以使用 Azure 虚拟网络创建站点到站点 VPN。 这不会干扰 Site Recovery 复制。,能否通过站点到站点 VPN 复制到 Azure？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
能，可以使用 ExpressRoute 将虚拟机复制到 Azure。 Azure Site Recovery 通过公共终结点将数据复制到 Azure 存储帐户。 需要设置[公共对等互连](https://docs.azure.cn/expressroute/expressroute-circuit-peerings#public-peering)将 ExpressRoute 用于 Site Recovery 复制。 将虚拟机故障转移到 Azure 虚拟网络以后，即可使用通过 Azure 虚拟网络设置的[专用对等互连](https://docs.azure.cn/expressroute/expressroute-circuit-peerings#private-peering)对其进行访问。,能否使用 ExpressRoute 将虚拟机复制到 Azure？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
\n\n要复制到 Azure 的虚拟机应符合 [Azure 要求](https://docs.azure.cn/site-recovery/site-recovery-support-matrix-to-azure#failed-over-azure-vm-requirements)。\n\nAzure 用户帐户需要具有某些[权限](https://docs.azure.cn/site-recovery/site-recovery-role-based-linked-access-control#permissions-required-to-enable-replication-for-new-virtual-machines)，才能启用新的虚拟机到 Azure 的复制。\n,将虚拟机复制到 Azure 需要满足任何先决条件吗？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
是的。 站点恢复在故障转移过程中将从第 2 代转换成第 1 代。 在故障回复时，计算机将转换回到第 2 代。,我可以将 Hyper-V 第 2 代虚拟机复制到 Azure 吗？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
若要保护 VMware VM，则需要 vSphere 虚拟机监控程序和运行 VMware 工具的虚拟机。 我们还建议使用 VMware vCenter 服务器托管虚拟机监控程序。 [了解](https://docs.azure.cn/site-recovery/site-recovery-support-matrix-to-azure#failed-over-azure-vm-requirements)有关复制 VMware 服务器和 VM 到 Azure 或辅助站点的精确要求。,可以保护哪些 VMware VM？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
在常规复制期间，数据将复制到异地冗余的 Azure 存储，不需要支付任何 Azure IaaS 虚拟机费用（提供一个明显的优势）。 当故障转移到 Azure 时，Site Recovery 自动创建 Azure IaaS 虚拟机，此后，需要为在 Azure 中使用的计算资源付费。,如果复制到 Azure，要支付哪些 Azure VM 费用？,site recovery,https://docs.azure.cn/site-recovery/site-recovery-faq
\n\n答： 能！ 尽管 PowerBI 支持使用 SQL DW 进行直接查询，但不适合大量用户或实时数据。 若要将 PowerBI 用于生产用途，建议基于 Azure Analysis Services 或 Analysis Service IaaS 使用 PowerBI。 \n\n问： SQL 数据仓库容量限制有哪些？\n\n答： 请参阅当前[容量限制](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-service-capacity-limits)页。 \n\n问： 为什么缩放/暂停/恢复会花费很长时间？\n\n答： 多种因素可能会影响计算管理操作的时间。 一个常见的长时运行操作的例子是事务回退。 缩放或暂停操作启动时，会阻止所有传入会话和查询。 为了使系统处于稳定状态，必须在操作开始前回退事务。 事务数量越多，其日志大小越大，使系统恢复到稳定状态的操作耗时越久。\n\n## 用户支持\n\n问： 该如何操作？\n\n答： 有关使用 SQL 数据仓库进行开发的帮助，可在 [Stack Overflow](http://stackoverflow.com/questions/tagged/azure-sqldw) 页提出问题。 \n\n## SQL 语言/功能支持\n\n问： SQL 数据仓库支持哪些数据类型？\n\n答： 请参阅 SQL 数据仓库[数据类型](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-tables-data-types)。\n\n问： 支持哪些表功能？\n\n答： 虽然 SQL 数据仓库支持许多功能，但不支持某些功能，这些功能记录在[不支持的表功能](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-tables-overview#unsupported-table-features)中。\n\n## 工具和管理\n\n问： Visual Studio 中是否支持数据库项目？\n\n答： 目前 Visual Studio 对于 SQL 数据仓库，不支持数据库项目。 如果想通过投票获取此功能，请访问 User Voice [数据库项目功能请求](https://feedback.azure.com/forums/307516-sql-data-warehouse/suggestions/13313247-database-project-from-visual-studio-to-support-azu)。\n\n问： SQL 数据仓库是否支持 REST API？\n\n答： 是的。 SQL 数据仓库还提供可与 SQL 数据库搭配使用的大多数 REST 功能。 可以在 REST 文档页或 [MSDN](https://msdn.microsoft.com/en-us/library/azure/mt163685.aspx) 中找到 API 信息。\n\n## 加载\n\n问： 支持哪些客户端驱动程序？\n\n答 可在[连接字符串](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-connection-strings)页找到 DW 驱动程序支持\n\n问：使用 SQL 数据仓库时，PolyBase 支持哪些文件格式？\n\n答：Orc、RC、Parquet 和平面分隔文本\n\n问：连接 Azure 存储 Blob 或 ADLS 时能否进行计算下推？ \n\n答：不能，SQL DW PolyBase 仅与存储组件交互。 \n\n问：能否连接到 HDI？\n\n答：HDI 可使用 ADLS 或 WASB 作为 HDFS 层。 如果将两者中任意一种作为 HDFS 层，可以将该数据加载到 SQL DW。 但是，无法生成 HDI 实例的下推计算。 \n\n## 后续步骤\n\n若要深入了解 SQL 数据仓库的概述信息，请参阅[概述](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq)页。\n,问： 是否可以连接 PowerBI？,sql data-warehouse,https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq
\n\n答： 请参阅当前[容量限制](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-service-capacity-limits)页。 \n\n问： 为什么缩放/暂停/恢复会花费很长时间？\n\n答： 多种因素可能会影响计算管理操作的时间。 一个常见的长时运行操作的例子是事务回退。 缩放或暂停操作启动时，会阻止所有传入会话和查询。 为了使系统处于稳定状态，必须在操作开始前回退事务。 事务数量越多，其日志大小越大，使系统恢复到稳定状态的操作耗时越久。\n\n## 用户支持\n\n问： 该如何操作？\n\n答： 有关使用 SQL 数据仓库进行开发的帮助，可在 [Stack Overflow](http://stackoverflow.com/questions/tagged/azure-sqldw) 页提出问题。 \n\n## SQL 语言/功能支持\n\n问： SQL 数据仓库支持哪些数据类型？\n\n答： 请参阅 SQL 数据仓库[数据类型](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-tables-data-types)。\n\n问： 支持哪些表功能？\n\n答： 虽然 SQL 数据仓库支持许多功能，但不支持某些功能，这些功能记录在[不支持的表功能](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-tables-overview#unsupported-table-features)中。\n\n## 工具和管理\n\n问： Visual Studio 中是否支持数据库项目？\n\n答： 目前 Visual Studio 对于 SQL 数据仓库，不支持数据库项目。 如果想通过投票获取此功能，请访问 User Voice [数据库项目功能请求](https://feedback.azure.com/forums/307516-sql-data-warehouse/suggestions/13313247-database-project-from-visual-studio-to-support-azu)。\n\n问： SQL 数据仓库是否支持 REST API？\n\n答： 是的。 SQL 数据仓库还提供可与 SQL 数据库搭配使用的大多数 REST 功能。 可以在 REST 文档页或 [MSDN](https://msdn.microsoft.com/en-us/library/azure/mt163685.aspx) 中找到 API 信息。\n\n## 加载\n\n问： 支持哪些客户端驱动程序？\n\n答 可在[连接字符串](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-connection-strings)页找到 DW 驱动程序支持\n\n问：使用 SQL 数据仓库时，PolyBase 支持哪些文件格式？\n\n答：Orc、RC、Parquet 和平面分隔文本\n\n问：连接 Azure 存储 Blob 或 ADLS 时能否进行计算下推？ \n\n答：不能，SQL DW PolyBase 仅与存储组件交互。 \n\n问：能否连接到 HDI？\n\n答：HDI 可使用 ADLS 或 WASB 作为 HDFS 层。 如果将两者中任意一种作为 HDFS 层，可以将该数据加载到 SQL DW。 但是，无法生成 HDI 实例的下推计算。 \n\n## 后续步骤\n\n若要深入了解 SQL 数据仓库的概述信息，请参阅[概述](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq)页。\n,问： SQL 数据仓库容量限制有哪些？,sql data-warehouse,https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq
\n\n答： 多种因素可能会影响计算管理操作的时间。 一个常见的长时运行操作的例子是事务回退。 缩放或暂停操作启动时，会阻止所有传入会话和查询。 为了使系统处于稳定状态，必须在操作开始前回退事务。 事务数量越多，其日志大小越大，使系统恢复到稳定状态的操作耗时越久。\n\n## 用户支持\n\n问： 该如何操作？\n\n答： 有关使用 SQL 数据仓库进行开发的帮助，可在 [Stack Overflow](http://stackoverflow.com/questions/tagged/azure-sqldw) 页提出问题。 \n\n## SQL 语言/功能支持\n\n问： SQL 数据仓库支持哪些数据类型？\n\n答： 请参阅 SQL 数据仓库[数据类型](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-tables-data-types)。\n\n问： 支持哪些表功能？\n\n答： 虽然 SQL 数据仓库支持许多功能，但不支持某些功能，这些功能记录在[不支持的表功能](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-tables-overview#unsupported-table-features)中。\n\n## 工具和管理\n\n问： Visual Studio 中是否支持数据库项目？\n\n答： 目前 Visual Studio 对于 SQL 数据仓库，不支持数据库项目。 如果想通过投票获取此功能，请访问 User Voice [数据库项目功能请求](https://feedback.azure.com/forums/307516-sql-data-warehouse/suggestions/13313247-database-project-from-visual-studio-to-support-azu)。\n\n问： SQL 数据仓库是否支持 REST API？\n\n答： 是的。 SQL 数据仓库还提供可与 SQL 数据库搭配使用的大多数 REST 功能。 可以在 REST 文档页或 [MSDN](https://msdn.microsoft.com/en-us/library/azure/mt163685.aspx) 中找到 API 信息。\n\n## 加载\n\n问： 支持哪些客户端驱动程序？\n\n答 可在[连接字符串](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-connection-strings)页找到 DW 驱动程序支持\n\n问：使用 SQL 数据仓库时，PolyBase 支持哪些文件格式？\n\n答：Orc、RC、Parquet 和平面分隔文本\n\n问：连接 Azure 存储 Blob 或 ADLS 时能否进行计算下推？ \n\n答：不能，SQL DW PolyBase 仅与存储组件交互。 \n\n问：能否连接到 HDI？\n\n答：HDI 可使用 ADLS 或 WASB 作为 HDFS 层。 如果将两者中任意一种作为 HDFS 层，可以将该数据加载到 SQL DW。 但是，无法生成 HDI 实例的下推计算。 \n\n## 后续步骤\n\n若要深入了解 SQL 数据仓库的概述信息，请参阅[概述](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq)页。\n,问： 为什么缩放/暂停/恢复会花费很长时间？,sql data-warehouse,https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq
\n\n答： 有关使用 SQL 数据仓库进行开发的帮助，可在 [Stack Overflow](http://stackoverflow.com/questions/tagged/azure-sqldw) 页提出问题。 \n\n## SQL 语言/功能支持\n\n问： SQL 数据仓库支持哪些数据类型？\n\n答： 请参阅 SQL 数据仓库[数据类型](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-tables-data-types)。\n\n问： 支持哪些表功能？\n\n答： 虽然 SQL 数据仓库支持许多功能，但不支持某些功能，这些功能记录在[不支持的表功能](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-tables-overview#unsupported-table-features)中。\n\n## 工具和管理\n\n问： Visual Studio 中是否支持数据库项目？\n\n答： 目前 Visual Studio 对于 SQL 数据仓库，不支持数据库项目。 如果想通过投票获取此功能，请访问 User Voice [数据库项目功能请求](https://feedback.azure.com/forums/307516-sql-data-warehouse/suggestions/13313247-database-project-from-visual-studio-to-support-azu)。\n\n问： SQL 数据仓库是否支持 REST API？\n\n答： 是的。 SQL 数据仓库还提供可与 SQL 数据库搭配使用的大多数 REST 功能。 可以在 REST 文档页或 [MSDN](https://msdn.microsoft.com/en-us/library/azure/mt163685.aspx) 中找到 API 信息。\n\n## 加载\n\n问： 支持哪些客户端驱动程序？\n\n答 可在[连接字符串](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-connection-strings)页找到 DW 驱动程序支持\n\n问：使用 SQL 数据仓库时，PolyBase 支持哪些文件格式？\n\n答：Orc、RC、Parquet 和平面分隔文本\n\n问：连接 Azure 存储 Blob 或 ADLS 时能否进行计算下推？ \n\n答：不能，SQL DW PolyBase 仅与存储组件交互。 \n\n问：能否连接到 HDI？\n\n答：HDI 可使用 ADLS 或 WASB 作为 HDFS 层。 如果将两者中任意一种作为 HDFS 层，可以将该数据加载到 SQL DW。 但是，无法生成 HDI 实例的下推计算。 \n\n## 后续步骤\n\n若要深入了解 SQL 数据仓库的概述信息，请参阅[概述](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq)页。\n,问： 该如何操作？,sql data-warehouse,https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq
\n\n答： 请参阅 SQL 数据仓库[数据类型](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-tables-data-types)。\n\n问： 支持哪些表功能？\n\n答： 虽然 SQL 数据仓库支持许多功能，但不支持某些功能，这些功能记录在[不支持的表功能](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-tables-overview#unsupported-table-features)中。\n\n## 工具和管理\n\n问： Visual Studio 中是否支持数据库项目？\n\n答： 目前 Visual Studio 对于 SQL 数据仓库，不支持数据库项目。 如果想通过投票获取此功能，请访问 User Voice [数据库项目功能请求](https://feedback.azure.com/forums/307516-sql-data-warehouse/suggestions/13313247-database-project-from-visual-studio-to-support-azu)。\n\n问： SQL 数据仓库是否支持 REST API？\n\n答： 是的。 SQL 数据仓库还提供可与 SQL 数据库搭配使用的大多数 REST 功能。 可以在 REST 文档页或 [MSDN](https://msdn.microsoft.com/en-us/library/azure/mt163685.aspx) 中找到 API 信息。\n\n## 加载\n\n问： 支持哪些客户端驱动程序？\n\n答 可在[连接字符串](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-connection-strings)页找到 DW 驱动程序支持\n\n问：使用 SQL 数据仓库时，PolyBase 支持哪些文件格式？\n\n答：Orc、RC、Parquet 和平面分隔文本\n\n问：连接 Azure 存储 Blob 或 ADLS 时能否进行计算下推？ \n\n答：不能，SQL DW PolyBase 仅与存储组件交互。 \n\n问：能否连接到 HDI？\n\n答：HDI 可使用 ADLS 或 WASB 作为 HDFS 层。 如果将两者中任意一种作为 HDFS 层，可以将该数据加载到 SQL DW。 但是，无法生成 HDI 实例的下推计算。 \n\n## 后续步骤\n\n若要深入了解 SQL 数据仓库的概述信息，请参阅[概述](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq)页。\n,问： SQL 数据仓库支持哪些数据类型？,sql data-warehouse,https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq
\n\n答： 虽然 SQL 数据仓库支持许多功能，但不支持某些功能，这些功能记录在[不支持的表功能](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-tables-overview#unsupported-table-features)中。\n\n## 工具和管理\n\n问： Visual Studio 中是否支持数据库项目？\n\n答： 目前 Visual Studio 对于 SQL 数据仓库，不支持数据库项目。 如果想通过投票获取此功能，请访问 User Voice [数据库项目功能请求](https://feedback.azure.com/forums/307516-sql-data-warehouse/suggestions/13313247-database-project-from-visual-studio-to-support-azu)。\n\n问： SQL 数据仓库是否支持 REST API？\n\n答： 是的。 SQL 数据仓库还提供可与 SQL 数据库搭配使用的大多数 REST 功能。 可以在 REST 文档页或 [MSDN](https://msdn.microsoft.com/en-us/library/azure/mt163685.aspx) 中找到 API 信息。\n\n## 加载\n\n问： 支持哪些客户端驱动程序？\n\n答 可在[连接字符串](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-connection-strings)页找到 DW 驱动程序支持\n\n问：使用 SQL 数据仓库时，PolyBase 支持哪些文件格式？\n\n答：Orc、RC、Parquet 和平面分隔文本\n\n问：连接 Azure 存储 Blob 或 ADLS 时能否进行计算下推？ \n\n答：不能，SQL DW PolyBase 仅与存储组件交互。 \n\n问：能否连接到 HDI？\n\n答：HDI 可使用 ADLS 或 WASB 作为 HDFS 层。 如果将两者中任意一种作为 HDFS 层，可以将该数据加载到 SQL DW。 但是，无法生成 HDI 实例的下推计算。 \n\n## 后续步骤\n\n若要深入了解 SQL 数据仓库的概述信息，请参阅[概述](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq)页。\n,问： 支持哪些表功能？,sql data-warehouse,https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq
\n\n答：Orc、RC、Parquet 和平面分隔文本\n\n问：连接 Azure 存储 Blob 或 ADLS 时能否进行计算下推？ \n\n答：不能，SQL DW PolyBase 仅与存储组件交互。 \n\n问：能否连接到 HDI？\n\n答：HDI 可使用 ADLS 或 WASB 作为 HDFS 层。 如果将两者中任意一种作为 HDFS 层，可以将该数据加载到 SQL DW。 但是，无法生成 HDI 实例的下推计算。 \n\n## 后续步骤\n\n若要深入了解 SQL 数据仓库的概述信息，请参阅[概述](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq)页。\n,问：使用 SQL 数据仓库时，PolyBase 支持哪些文件格式？,sql data-warehouse,https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq
\n\n答： 是的。 SQL 数据仓库还提供可与 SQL 数据库搭配使用的大多数 REST 功能。 可以在 REST 文档页或 [MSDN](https://msdn.microsoft.com/en-us/library/azure/mt163685.aspx) 中找到 API 信息。\n\n## 加载\n\n问： 支持哪些客户端驱动程序？\n\n答 可在[连接字符串](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-connection-strings)页找到 DW 驱动程序支持\n\n问：使用 SQL 数据仓库时，PolyBase 支持哪些文件格式？\n\n答：Orc、RC、Parquet 和平面分隔文本\n\n问：连接 Azure 存储 Blob 或 ADLS 时能否进行计算下推？ \n\n答：不能，SQL DW PolyBase 仅与存储组件交互。 \n\n问：能否连接到 HDI？\n\n答：HDI 可使用 ADLS 或 WASB 作为 HDFS 层。 如果将两者中任意一种作为 HDFS 层，可以将该数据加载到 SQL DW。 但是，无法生成 HDI 实例的下推计算。 \n\n## 后续步骤\n\n若要深入了解 SQL 数据仓库的概述信息，请参阅[概述](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq)页。\n,问： SQL 数据仓库是否支持 REST API？,sql data-warehouse,https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq
\n\n答 可在[连接字符串](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-connection-strings)页找到 DW 驱动程序支持\n\n问：使用 SQL 数据仓库时，PolyBase 支持哪些文件格式？\n\n答：Orc、RC、Parquet 和平面分隔文本\n\n问：连接 Azure 存储 Blob 或 ADLS 时能否进行计算下推？ \n\n答：不能，SQL DW PolyBase 仅与存储组件交互。 \n\n问：能否连接到 HDI？\n\n答：HDI 可使用 ADLS 或 WASB 作为 HDFS 层。 如果将两者中任意一种作为 HDFS 层，可以将该数据加载到 SQL DW。 但是，无法生成 HDI 实例的下推计算。 \n\n## 后续步骤\n\n若要深入了解 SQL 数据仓库的概述信息，请参阅[概述](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq)页。\n,问： 支持哪些客户端驱动程序？,sql data-warehouse,https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq
\n\n答：不能，SQL DW PolyBase 仅与存储组件交互。 \n\n问：能否连接到 HDI？\n\n答：HDI 可使用 ADLS 或 WASB 作为 HDFS 层。 如果将两者中任意一种作为 HDFS 层，可以将该数据加载到 SQL DW。 但是，无法生成 HDI 实例的下推计算。 \n\n## 后续步骤\n\n若要深入了解 SQL 数据仓库的概述信息，请参阅[概述](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq)页。\n,问：连接 Azure 存储 Blob 或 ADLS 时能否进行计算下推？,sql data-warehouse,https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq
\n\n答：HDI 可使用 ADLS 或 WASB 作为 HDFS 层。 如果将两者中任意一种作为 HDFS 层，可以将该数据加载到 SQL DW。 但是，无法生成 HDI 实例的下推计算。 \n\n## 后续步骤\n\n若要深入了解 SQL 数据仓库的概述信息，请参阅[概述](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq)页。\n,问：能否连接到 HDI？,sql data-warehouse,https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq
"\n\n答： 请访问 [Microsoft 符合性](https://www.microsoft.com/en-us/trustcenter/compliance/complianceofferings)页面，查明产品（如 SOC 和 ISO）的各种符合性规定。 首先选择""符合性""标题，然后在页面右侧的""Microsoft 范围内云服务""部分展开 Azure，查看哪些服务是 Azure 符合性服务。\n\n问： 是否可以连接 PowerBI？\n\n答： 能！ 尽管 PowerBI 支持使用 SQL DW 进行直接查询，但不适合大量用户或实时数据。 若要将 PowerBI 用于生产用途，建议基于 Azure Analysis Services 或 Analysis Service IaaS 使用 PowerBI。 \n\n问： SQL 数据仓库容量限制有哪些？\n\n答： 请参阅当前[容量限制](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-service-capacity-limits)页。 \n\n问： 为什么缩放/暂停/恢复会花费很长时间？\n\n答： 多种因素可能会影响计算管理操作的时间。 一个常见的长时运行操作的例子是事务回退。 缩放或暂停操作启动时，会阻止所有传入会话和查询。 为了使系统处于稳定状态，必须在操作开始前回退事务。 事务数量越多，其日志大小越大，使系统恢复到稳定状态的操作耗时越久。\n\n## 用户支持\n\n问： 该如何操作？\n\n答： 有关使用 SQL 数据仓库进行开发的帮助，可在 [Stack Overflow](http://stackoverflow.com/questions/tagged/azure-sqldw) 页提出问题。 \n\n## SQL 语言/功能支持\n\n问： SQL 数据仓库支持哪些数据类型？\n\n答： 请参阅 SQL 数据仓库[数据类型](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-tables-data-types)。\n\n问： 支持哪些表功能？\n\n答： 虽然 SQL 数据仓库支持许多功能，但不支持某些功能，这些功能记录在[不支持的表功能](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-tables-overview#unsupported-table-features)中。\n\n## 工具和管理\n\n问： Visual Studio 中是否支持数据库项目？\n\n答： 目前 Visual Studio 对于 SQL 数据仓库，不支持数据库项目。 如果想通过投票获取此功能，请访问 User Voice [数据库项目功能请求](https://feedback.azure.com/forums/307516-sql-data-warehouse/suggestions/13313247-database-project-from-visual-studio-to-support-azu)。\n\n问： SQL 数据仓库是否支持 REST API？\n\n答： 是的。 SQL 数据仓库还提供可与 SQL 数据库搭配使用的大多数 REST 功能。 可以在 REST 文档页或 [MSDN](https://msdn.microsoft.com/en-us/library/azure/mt163685.aspx) 中找到 API 信息。\n\n## 加载\n\n问： 支持哪些客户端驱动程序？\n\n答 可在[连接字符串](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-connection-strings)页找到 DW 驱动程序支持\n\n问：使用 SQL 数据仓库时，PolyBase 支持哪些文件格式？\n\n答：Orc、RC、Parquet 和平面分隔文本\n\n问：连接 Azure 存储 Blob 或 ADLS 时能否进行计算下推？ \n\n答：不能，SQL DW PolyBase 仅与存储组件交互。 \n\n问：能否连接到 HDI？\n\n答：HDI 可使用 ADLS 或 WASB 作为 HDFS 层。 如果将两者中任意一种作为 HDFS 层，可以将该数据加载到 SQL DW。 但是，无法生成 HDI 实例的下推计算。 \n\n## 后续步骤\n\n若要深入了解 SQL 数据仓库的概述信息，请参阅[概述](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq)页。\n",问： 从何处可以查明 SQL DW 符合哪些法律或业务标准？,sql data-warehouse,https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq
\n\n答： 目前 Visual Studio 对于 SQL 数据仓库，不支持数据库项目。 如果想通过投票获取此功能，请访问 User Voice [数据库项目功能请求](https://feedback.azure.com/forums/307516-sql-data-warehouse/suggestions/13313247-database-project-from-visual-studio-to-support-azu)。\n\n问： SQL 数据仓库是否支持 REST API？\n\n答： 是的。 SQL 数据仓库还提供可与 SQL 数据库搭配使用的大多数 REST 功能。 可以在 REST 文档页或 [MSDN](https://msdn.microsoft.com/en-us/library/azure/mt163685.aspx) 中找到 API 信息。\n\n## 加载\n\n问： 支持哪些客户端驱动程序？\n\n答 可在[连接字符串](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-connection-strings)页找到 DW 驱动程序支持\n\n问：使用 SQL 数据仓库时，PolyBase 支持哪些文件格式？\n\n答：Orc、RC、Parquet 和平面分隔文本\n\n问：连接 Azure 存储 Blob 或 ADLS 时能否进行计算下推？ \n\n答：不能，SQL DW PolyBase 仅与存储组件交互。 \n\n问：能否连接到 HDI？\n\n答：HDI 可使用 ADLS 或 WASB 作为 HDFS 层。 如果将两者中任意一种作为 HDFS 层，可以将该数据加载到 SQL DW。 但是，无法生成 HDI 实例的下推计算。 \n\n## 后续步骤\n\n若要深入了解 SQL 数据仓库的概述信息，请参阅[概述](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq)页。\n,问： Visual Studio 中是否支持数据库项目？,sql data-warehouse,https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq
"\n\n答： SQL DW 提供若干解决方案，用于保护数据（如 TDE）和审核。 有关详细信息，请参阅[安全性](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-manage-security)。\n\n问： 从何处可以查明 SQL DW 符合哪些法律或业务标准？\n\n答： 请访问 [Microsoft 符合性](https://www.microsoft.com/en-us/trustcenter/compliance/complianceofferings)页面，查明产品（如 SOC 和 ISO）的各种符合性规定。 首先选择""符合性""标题，然后在页面右侧的""Microsoft 范围内云服务""部分展开 Azure，查看哪些服务是 Azure 符合性服务。\n\n问： 是否可以连接 PowerBI？\n\n答： 能！ 尽管 PowerBI 支持使用 SQL DW 进行直接查询，但不适合大量用户或实时数据。 若要将 PowerBI 用于生产用途，建议基于 Azure Analysis Services 或 Analysis Service IaaS 使用 PowerBI。 \n\n问： SQL 数据仓库容量限制有哪些？\n\n答： 请参阅当前[容量限制](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-service-capacity-limits)页。 \n\n问： 为什么缩放/暂停/恢复会花费很长时间？\n\n答： 多种因素可能会影响计算管理操作的时间。 一个常见的长时运行操作的例子是事务回退。 缩放或暂停操作启动时，会阻止所有传入会话和查询。 为了使系统处于稳定状态，必须在操作开始前回退事务。 事务数量越多，其日志大小越大，使系统恢复到稳定状态的操作耗时越久。\n\n## 用户支持\n\n问： 该如何操作？\n\n答： 有关使用 SQL 数据仓库进行开发的帮助，可在 [Stack Overflow](http://stackoverflow.com/questions/tagged/azure-sqldw) 页提出问题。 \n\n## SQL 语言/功能支持\n\n问： SQL 数据仓库支持哪些数据类型？\n\n答： 请参阅 SQL 数据仓库[数据类型](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-tables-data-types)。\n\n问： 支持哪些表功能？\n\n答： 虽然 SQL 数据仓库支持许多功能，但不支持某些功能，这些功能记录在[不支持的表功能](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-tables-overview#unsupported-table-features)中。\n\n## 工具和管理\n\n问： Visual Studio 中是否支持数据库项目？\n\n答： 目前 Visual Studio 对于 SQL 数据仓库，不支持数据库项目。 如果想通过投票获取此功能，请访问 User Voice [数据库项目功能请求](https://feedback.azure.com/forums/307516-sql-data-warehouse/suggestions/13313247-database-project-from-visual-studio-to-support-azu)。\n\n问： SQL 数据仓库是否支持 REST API？\n\n答： 是的。 SQL 数据仓库还提供可与 SQL 数据库搭配使用的大多数 REST 功能。 可以在 REST 文档页或 [MSDN](https://msdn.microsoft.com/en-us/library/azure/mt163685.aspx) 中找到 API 信息。\n\n## 加载\n\n问： 支持哪些客户端驱动程序？\n\n答 可在[连接字符串](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-connection-strings)页找到 DW 驱动程序支持\n\n问：使用 SQL 数据仓库时，PolyBase 支持哪些文件格式？\n\n答：Orc、RC、Parquet 和平面分隔文本\n\n问：连接 Azure 存储 Blob 或 ADLS 时能否进行计算下推？ \n\n答：不能，SQL DW PolyBase 仅与存储组件交互。 \n\n问：能否连接到 HDI？\n\n答：HDI 可使用 ADLS 或 WASB 作为 HDFS 层。 如果将两者中任意一种作为 HDFS 层，可以将该数据加载到 SQL DW。 但是，无法生成 HDI 实例的下推计算。 \n\n## 后续步骤\n\n若要深入了解 SQL 数据仓库的概述信息，请参阅[概述](https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq)页。\n",问： SQL DW 为数据安全提供哪些功能？,sql data-warehouse,https://docs.azure.cn/sql-data-warehouse/sql-data-warehouse-overview-faq
"请勿使用""用户 ID=username@servername""形式的凭据，而只需使用""用户 ID = username""。 此外，请确保""用户名""登录名对分片具有权限。",为什么从另一台服务器添加分片时，凭据不起作用？,sql database,https://docs.azure.cn/sql-database/sql-database-elastic-scale-faq
"使用弹性数据库客户端库不会产生任何费用。 只有为分片使用的 Azure SQL 数据库和分片映射管理器，以及为""拆分/合并""工具预配的 Web/辅助角色才会产生费用。",弹性数据库工具的费用如何？,sql database,https://docs.azure.cn/sql-database/sql-database-elastic-scale-faq
"架构信息对象仅用于""拆分/合并""方案。 如果某个应用程序本质上是单租户，那么它则不需要""拆分/合并""工具，因此无需填充架构信息对象。",如果每个分片只有单个租户且没有分片键，该如何为架构信息填充分片键？,sql database,https://docs.azure.cn/sql-database/sql-database-elastic-scale-faq
请参阅[使用弹性数据库客户端库将分片添加到应用程序](https://docs.azure.cn/sql-database/sql-database-elastic-scale-add-a-shard)。,在已预配了一个数据库，并且已安装了分片映射管理器的情况下，应如何将此新数据库注册为分片？,sql database,https://docs.azure.cn/sql-database/sql-database-elastic-scale-faq
不是 - 分片映射管理器（例如，[ShardMapManagerFactory.CreateSqlShardMapManager](http://msdn.microsoft.com/library/azure/microsoft.azure.sqldatabase.elasticscale.shardmanagement.shardmapmanagerfactory.createsqlshardmapmanager.aspx)）只需创建一次。 在启动应用程序时，应用程序应使用调用 [ShardMapManagerFactory.TryGetSqlShardMapManager()](http://msdn.microsoft.com/library/azure/microsoft.azure.sqldatabase.elasticscale.shardmanagement.shardmapmanagerfactory.trygetsqlshardmapmanager.aspx)。 每个应用程序域应该只有一个此类调用。,每次启动应用程序时，是否都需要创建分片映射管理器并填充分片？,sql database,https://docs.azure.cn/sql-database/sql-database-elastic-scale-faq
请在 [Azure SQL 数据库论坛](https://social.msdn.microsoft.com/Forums/zh-cn/home?forum=ssdsgetstarted)上联系我们。,如果在使用弹性数据库工具方面存在疑问，如何才能获得解答？,sql database,https://docs.azure.cn/sql-database/sql-database-elastic-scale-faq
弹性缩放 API 使用户能够连接到分片键的正确数据库，但不提供分片键筛选。 如果需要，请在查询中添加 WHERE 子句，以将范围限制到提供的分片键。,当使用分片键建立数据库连接的同时，仍然可以对同一分片上的其他分片键查询数据。 这是设计使然吗？,sql database,https://docs.azure.cn/sql-database/sql-database-elastic-scale-faq
是的，每个分片是单独的数据库，因此，一个分片可以是高级版，而另一个可以是标准版。 此外，在分片的生命周期内，该分片的版本可以进行多次上调或下调。,是否可为分片集中的每个分片使用不同的 Azure 数据库版本？,sql database,https://docs.azure.cn/sql-database/sql-database-elastic-scale-faq
不可以。 对于 拆分 操作，必须存在目标数据库和相应的架构，并且必须注册到分片映射管理器。 对于 合并 操作，必须从分片映射管理器中删除分片，然后删除数据库。,"在拆分或合并操作期间，""拆分/合并""工具是否会设置（或删除）数据库？",sql database,https://docs.azure.cn/sql-database/sql-database-elastic-scale-faq
尚未使用弹性数据库工具？ 请查看[入门指南](https://docs.azure.cn/sql-database/sql-database-elastic-scale-get-started)和[文档结构图](https://docs.azure.cn/zh-cn/documentation/articles/sql-database-elastic-scale-documentation-map/)。 有关问题，请在 [SQL 数据库论坛](https://social.msdn.microsoft.com/Forums/zh-cn/home?forum=windowsazurezhchs)上联系我们和发出功能请求。,了解详细信息,sql database,https://docs.azure.cn/sql-database/sql-database-elastic-scale-faq
SQL 数据库以可预测的每小时费率收费，同时根据服务层 + 单一数据库的性能级别或每一弹性池的 eDTU 数计费。 实际使用量是每小时按比例计算的，因此帐单可能会显示小时的小数部分。 例如，如果某个数据库在一个月内存在了 12 小时，则帐单将显示 0.5 天的使用量。 服务层 + 性能级别和每个池的 eDTU 数在帐单中进行了划分，以便查看单个月份中使用数据库的天数。,SQL 数据库的使用情况如何体现在我的帐单上？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
SQL 数据库的最新版本为 V12。 版本 V11 已停用。,SQL 数据库的最新版本是什么？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
"我们保证至少在 99.99% 的时间内客户将能够在其单个或弹性""基本""、""标准""或""高级""版 Azure SQL 数据库与我们的 Internet 网关之间保持连接。 有关详细信息，请参阅 [SLA](https://www.azure.cn/support/legal/sla/)",SQL 数据库的 SLA 是什么？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
"在 [Azure 门户](https://portal.azure.cn/)中，单击""SQL Server""，从列表中选择服务器，然后单击""重置密码""。",如何重置服务器管理员的密码？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
请参阅[管理数据库和登录名](https://docs.azure.cn/sql-database/sql-database-manage-logins),如何管理数据库和登录名？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
请参阅[如何：在 SQL 数据库上配置防火墙设置](https://docs.azure.cn/sql-database/sql-database-configure-firewall-settings),如何确保只允许经过授权的 IP 地址访问服务器？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
我们通过 DMV 显示主数据库与地域辅助数据库之间的实时复制延迟。 有关详细信息，请参阅 [sys.dm_geo_replication_link_status](https://msdn.microsoft.com/library/mt575504.aspx),哪些工具可用于监视主数据库与地域辅助数据库之间的复制延迟？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
"\n\n需要支付使用最高服务层数据库存在的时数 + 在该小时适用的性能级别，无论使用方式或数据库的活动状态是否少于一小时。 例如，如果创建了单一数据库，并在五分钟后将其删除，则将按该数据库存在一小时收费。 \n\n示例\n\n*   如果你创建了一个基本数据库并立即将其升级为标准版 S1，则第一小时将按标准版 S1 费率收费。\n*   如果从晚上 10:00 开始将数据库从""基本""升级到""高级""， 并且在第二天凌晨 1:35 完成升级， 那么将会从凌晨 1:00 开始按高级版费率收费。 \n*   如果在上午 11:00 将数据库从""高级""降级到""基本""级别， 并且在下午 2:15 完成降级，则会针对数据库以高级版费率收取到下午 3:00，之后将以基本版费率收费。",如果单一数据库活动的时间少于一小时，或使用更高服务层的时间少于一小时，会如何计费？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
如果连接断开，我们会每 10 秒钟重试一次以重新建立连接。,如果两个区域之间存在网络故障，那么在设置了异地复制的情况下，重试逻辑是如何运作的？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
\n\n在帐单上，弹性池收费显示为弹性 DTU (eDTU)，并在[定价页](https://www.azure.cn/pricing/details/sql-database/)上以每一池 eDTU 递增显示。 弹性池没有按照数据库收取的费用。 对于池存在的每个小时，都需要支付最高的 eDTU，无论使用量是多少，也不管池处于活动状态的时间是否少于一小时。 \n\n示例\n\n*   如果在上午 11:18 以 200 eDTU 创建标准弹性池，同时将五个数据库添加到池，则从上午 11:00 开始以 200 eDTU 收取整小时的费用。 到当天剩余的时间。\n*   在第 2 天上午 5:05，数据库 1 开始使用 50 eDTU 并稳定持有一天。 数据库 2-5 在 0 和 80 eDTU 之间波动。 在当天，添加全天使用不同 eDTU 的其他五个数据库。 第 2 天将全天以 200 eDTU 计费。 \n*   在第 3 天的上午 5:00， 你添加了另外 15 个数据库。 数据库使用量全天增加，到下午 8:05 确定将池的 eDTU 从 200 增加为 400。 下午 8 点以前继续按 200 eDTU 收费，当天的其余 4 小时则按 400 eDTU 计费。,弹性池的使用情况如何体现在我的帐单上，另外，更改每个池的 eDTU 会发生什么情况？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
地域辅助数据库是非同步副本，我们不尝试将其与主数据库保持完全同步。 不过，我们提供一种强制同步的方法，确保复制关键更改（例如密码更新）。 强制同步会阻止调用线程，直到所有提交的事务得到复制，因此会影响性能。 有关详细信息，请参阅 [sp_wait_for_database_copy_sync](https://msdn.microsoft.com/library/dn467644.aspx),为了保证复制主数据库上的关键更改，我该做什么？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
\n\n弹性池按以下特征计费：\n\n*   弹性池一创建即计费，即使池中没有数据库。\n*   弹性池按小时计费。 该计量频率与单一数据库性能级别的计量频率相同。\n*   如果将弹性池的大小调整为新的 eDTU 数，在调整操作完成之前，不会按新的 eDTU 数计费。 这种计费所遵循的模式与更改单一数据库的性能级别所遵循的模式相同。\n*   弹性池的价格取决于池的 eDTU 数量。 弹性池的价格与池内弹性数据库的数目和使用率无关。\n*   价格的计算公式为：（池 eDTU 的数量）x（每 eDTU 的单位价格）。\n\n弹性池的 eDTU 单价高于同一服务层中单一数据库的 DTU 单价。 有关详细信息，请参阅 [SQL 数据库定价](https://www.azure.cn/pricing/details/sql-database/)。 \n\n若要了解 eDTU 和服务层，请参阅 [SQL 数据库选项和性能](https://docs.azure.cn/sql-database/sql-database-service-tiers)\n,弹性池计费和定价信息,sql database,https://docs.azure.cn/sql-database/sql-database-faq
审核功能是 SQL 数据库服务的内置功能，无需另行付费，基本数据库、标准数据库、高级数据库和高级 RS 数据库均提供此功能。 但是，为了存储审核日志，审核功能将使用 Azure 存储帐户，而 Azure 存储中表和队列的费率根据审核日志的大小来应用。,使用审核功能会对帐单产生什么影响？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
\n\n有几种工具可供使用。 \n\n*   对于本地数据库，请使用 [DTU 选型顾问](http://dtucalculator.azurewebsites.net/) ，它会建议所需的数据库和 DTU，并为弹性池评估多个数据库。\n*   如果单一数据库可因池受益，并且 Azure 的智能引擎发现担保数据库的历史使用模式时，建议使用弹性池。 请参阅[使用 Azure 门户监视和管理弹性池](https://docs.azure.cn/sql-database/sql-database-elastic-pool-manage-portal)。 有关如何自行进行数学计算的详细信息，请参阅[弹性池的价格和性能注意事项](https://docs.azure.cn/sql-database/sql-database-elastic-pool)\n*   若要确定是否需要向上或向下调整单一数据库，请参阅[单一数据库的性能指南](https://docs.azure.cn/sql-database/sql-database-performance-guidance)。,如何找到单一数据库和弹性池的合适服务层和性能级别？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
可以（在基本、标准、高级和高级 RS 之间）更改服务层或服务层内的性能级别（例如 S1 到 S2），次数随意。 对于早期版本的数据库，可以在 24 小时内更改服务层或性能级别四次。,可以按何种频率更改单一数据库的服务层或性能级别？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
与单一数据库不同的是，对弹性数据库使用[活动异地复制](https://docs.azure.cn/sql-database/sql-database-geo-replication-overview)对计费没有直接的影响。 你只需支付对每个池（主池和辅助池）预配的 eDTU 费用,帐单上如何体现弹性池中活动异地复制的使用？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
更改数据库的服务层和移入和移出池需要在平台上以后台操作的形式复制数据库。 更改服务层可能需要几分钟至几小时的时间，具体取决于数据库的大小。 这两种情况下，数据库在移动期间保持联机和可用。 有关更改单一数据库的详细信息，请参阅[更改数据库的服务层](https://docs.azure.cn/sql-database/sql-database-service-tiers),更改单一数据库的服务层次或性能级别，或将数据库移入和移出弹性池需要多长时间？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
一般而言，弹性池针对典型的[软件即服务 (SaaS) 应用程序模式](https://docs.azure.cn/sql-database/sql-database-design-patterns-multi-tenancy-saas-applications)而设计，该模式中每个客户或租户有一个数据库。 购买单独的数据库并超量设置以满足每个数据库的可变和峰值需求通常不够经济高效。 使用池可以管理池的整体性能，数据库将自动扩展和收缩。 如果 Azure 的智能引擎发现了担保数据库的使用模式，则建议使用池。 有关详细信息，请参阅[弹性池指南](https://docs.azure.cn/sql-database/sql-database-elastic-pool)。,何时应该使用单一数据库或弹性数据库？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
"备份存储是与用于[时间点还原](https://docs.azure.cn/sql-database/sql-database-recovery-using-backups#point-in-time-restore)和[异地还原](https://docs.azure.cn/sql-database/sql-database-recovery-using-backups#geo-restore)的自动数据库备份关联的存储。 Azure SQL 数据库提供了高达备份存储的最大已预配数据库存储两倍的容量，不需要支付额外的成本。 例如，如果拥有一个标准 DB 实例并且预配的 DB 大小为 250 GB，则会提供 500 GB 的备份存储并且不额外收费。 如果数据库超过提供的备份存储，则可以选择与 Azure 支持联系来缩短保留期，或针对按标准读取访问地域冗余存储 (RA-GRS) 费率计费的额外备份存储支付费用。 有关 RA-GRS 计费的更多信息，请参阅""存储定价详细信息""。",具有高达备份存储的最大已设置数据库存储两倍的容量是什么意思？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
根据经验数据，使用 Azure 建议的配对区域时，内部区域和区域之间的复制延迟没有太多差别。,在主数据库所在的同一区域中创建地域辅助数据库时，哪些是预期的复制滞后？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
Azure SQL Web 和企业数据库现已停用。 基本、标准、高级、高级 RS 和弹性层将取代即将停用的 Web 和企业数据库。,我正在从 Web/企业版迁移到新服务层，我需要了解哪些信息？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
次数随意。,可以按何种频率调整每个池的 eDTU？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
目前支持 5 秒的 RPO，并且只要地域辅助数据库承载于 Azure 建议的配对区域并且属于相同的服务层，复制延迟就会少于该时间。,在相同的 Azure 地理位置内的两个区域之间进行异地复制数据库时，哪些是预期的复制延迟？,sql database,https://docs.azure.cn/sql-database/sql-database-faq
\n\n如果从 Key Vault 中删除机密，然后对所有 VM 运行 `stop deallocate`，则再次启动这些 VM 时，会发生失败。 失败发生的原因是 CRP 需要从密钥保管库检索机密，但它无法进行检索。 在这种情况下，可以从虚拟机规模集模型中删除证书。 \n\nCRP 组件不会持久保留客户机密。 如果对虚拟机规模集中的所有虚拟机运行 `stop deallocate`，会删除缓存。 在这种情况下，将从密钥保管库中检索机密。\n\n扩大时不会遇到此问题，因为（单 Fabric 租户模型中的）Azure Service Fabric 中存在机密的缓存副本。\n,从 Key Vault 中删除证书会发生什么情况？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\nKey Vault 要求指定证书版本的目的是为了使用户清楚地了解哪些证书部署在其 VM 上。\n\n如果创建了 VM，并更新了密钥保管库中的机密，则新证书不会下载到 VM。 但是，VM 看上去像是引用了该证书，并且新 VM 将获取新机密。 要避免此问题，需要引用机密的版本。\n,使用 Key Vault 时，为什么需要指定证书版本？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n要将 .cer 公钥部署到虚拟机规模集，可以生成仅包含 .cer 文件的 .pfx 文件。 为此，请使用 `X509ContentType = Pfx`。 例如，将 .cer 文件作为 x509Certificate2 对象加载到 C# 或 PowerShell 中，然后调用该方法。 \n\n有关详细信息，请参阅 [X509Certificate.Export 方法 (X509ContentType, String)](https://msdn.microsoft.com/library/24ww6yzk(v=vs.110.aspx))\n",本团队正在开发几个证书，到时将以 .cer 公钥的形式分发给大家使用。 将这些证书部署到虚拟机规模集的建议方法有哪些？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n若要删除虚拟机规模集扩展，请使用以下 PowerShell 示例：\n\n$vmss = Get-AzureRmVmss -ResourceGroupName ""resource_group_name"" -VMScaleSetName ""vmssName"" $vmss=Remove-AzureRmVmssExtension -VirtualMachineScaleSet $vmss -Name ""extensionName"" Update-AzureRmVmss -ResourceGroupName ""resource_group_name"" -VMScaleSetName ""vmssName"" -VirtualMacineScaleSet $vmss \n\n可以在 `$vmss` 中找到 extensionName 值。\n",如何删除虚拟机规模集扩展？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\n在虚拟机规模集和 VM 中，必须在 JSON 对象中包装证书。 \n\n我们还支持 application/x-pkcs12 内容类型。 有关使用 application/x-pkcs12 的说明，请参阅 [Azure Key Vault 中的 PFX 证书](http://www.rahulpnath.com/blog/pfx-certificate-in-azure-key-vault/)。\n\n我们目前不支持 .cer 文件。 要使用.cer 文件，请将其导出到.pfx 容器中。\n\n## 符合性和安全性\n\n,是否需要在密钥保管库中将证书包装在 JSON 对象中？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
有关与 Operations Management Suite 集成的虚拟机规模集模板示例，请参阅[部署 Azure Service Fabric 群集，并通过使用 Log Analytics 来启用监视](https://github.com/krnese/AzureDeploy/tree/master/OMS/MSOMS/ServiceFabric)中的第二个示例。,与 Operations Management Suite 集成的虚拟机规模集模板是否有任何示例可供参考？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
若要了解虚拟机规模集中的扩展序列，请参阅 [Extension sequencing in Azure virtual machine scale sets](https://msftstack.wordpress.com/2016/05/12/extension-sequencing-in-azure-vm-scale-sets/)（Azure 虚拟机规模集中的扩展序列）。,扩展似乎在虚拟机规模集上并行运行。 这导致我的自定义脚本扩展失败。 如何进行修复？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
如果重置 VM 的映像，则会删除证书。 重置映像会删除整个 OS 磁盘。,如果重置 VM 的映像，证书会发生什么情况？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n若要对虚拟机规模集中的 VM 重置密码，请使用 VM 访问扩展。 \n\n使用以下 PowerShell 示例：\n\n$vmssName = ""myvmss"" $vmssResourceGroup = ""myvmssrg"" $publicConfig = @{""UserName"" = ""newuser""} $privateConfig = @{""Password"" = ""********""} $extName = ""VMAccessAgent"" $publisher = ""Microsoft.Compute"" $vmss = Get-AzureRmVmss -ResourceGroupName $vmssResourceGroup -VMScaleSetName $vmssName $vmss = Add-AzureRmVmssExtension -VirtualMachineScaleSet $vmss -Name $extName -Publisher $publisher -Setting $publicConfig -ProtectedSetting $privateConfig -Type $extName -TypeHandlerVersion ""2.0"" -AutoUpgradeMinorVersion $true Update-AzureRmVmss -ResourceGroupName $vmssResourceGroup -Name $vmssName -VirtualMachineScaleSet $vmss \n",如何对虚拟机规模集中的 VM 重置密码？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n若要模拟以 base64 字符串形式传入证书，可以在 Resource Manager 模板中提取最新版本的 URL。 在 Resource Manager 模板中包含以下 JSON 属性：\n\n""certificateUrl"": ""[reference(resourceId(parameters('vaultResourceGroup'), 'Microsoft.KeyVault/vaults/secrets', parameters('vaultName'), parameters('secretName')), '2015-06-01').secretUriWithVersion]"" \n",我没有看到可让用户以 base64 字符串形式传入证书的选项。 其他大多数资源提供程序提供此选项。,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\n要将保管库证书添加到现有机密，请参阅下面的 PowerShell 示例。 仅使用一个机密对象。\n\n$newVaultCertificate = New-AzureRmVmssVaultCertificateConfig -CertificateStore MY -CertificateUrl https://sansunallapps1.vault.azure.cn:443/secrets/dg-private-enc/55fa0332edc44a84ad655298905f1809 $vmss.VirtualMachineProfile.OsProfile.Secrets[0].VaultCertificates.Add($newVaultCertificate) Update-AzureRmVmss -VirtualMachineScaleSet $vmss -ResourceGroup $rg -Name $vmssName \n,如何将新的保管库证书添加到新的证书对象？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n是的。 用于 osProfile 的 REST API 类似于标准 VM REST API。 \n\n在模板中包括 osProfile：\n\n""osProfile"": { ""computerName"": ""[variables('vmName')]"", ""adminUsername"": ""[parameters('adminUserName')]"", ""linuxConfiguration"": { ""disablePasswordAuthentication"": ""true"", ""ssh"": { ""publicKeys"": [ { ""path"": ""[variables('sshKeyPath')]"", ""keyData"": ""[parameters('sshKeyData')]"" } ] } } } \n\n[101-vm-sshkey GitHub 快速入门模板](https://github.com/Azure/azure-quickstart-templates/blob/master/101-vm-sshkey/azuredeploy.json) 中使用了此 JSON 块。\n\n[grelayhost.json GitHub 快速启动模板](https://github.com/ExchMaster/gadgetron/blob/master/Gadgetron/Templates/grelayhost.json)中也使用了此 OS 配置文件。\n\n有关详细信息，请参阅[创建或更新虚拟机规模集](https://msdn.microsoft.com/library/azure/mt589035.aspx#linuxconfiguration)\n",是否可以通过 Resource Manager 模板指定一个 SSH 密钥对，用于对 Linux 虚拟机规模集进行 SSH 身份验证？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"证书将添加到所有 VM，包括现有的 VM。 如果虚拟机规模集的 upgradePolicy 属性设置为""手动""，对 VM 执行手动更新时，证书会添加到该 VM。",如果将机密添加到现有虚拟机规模集，机密会注入到现有 VM 中，还是仅注入到新 VM 中？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\nWindows 远程管理 (WinRM) 证书引用必须在 OS 配置文件的 Secrets 属性中存在。 \n\n指示源保管库的目的在于强制实施访问控制列表 (ACL) 策略，该策略存在于用户的 Azure 云服务模型中。 如果源保管库未指定，无权在密钥保管库中部署或访问机密的用户可以通过计算资源提供程序 (CRP) 实现此目的。 即使是不存在的资源，它们也有 ACL。\n\n如果提供错误的源保管库 ID 但提供有效的保管库 URL，轮询操作时系统会报告错误。\n,虚拟机规模集的 virtualMachineProfile.osProfile 的 Secrets 属性的工作原理是什么？ 使用 certificateUrl 属性指定证书的绝对 URI 时，为什么需要 sourceVault 值？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
不需要对脚本中的密码进行硬编码。 可以使用运行部署脚本的权限来动态检索密码。 如果某个脚本可移动机密存储密钥保管库的证书，机密存储 `get certificate` 命令也会输出 pfx 文件的密码。,如果证书位于机密存储中，是否可以在不提供密码的情况下将证书推送到虚拟机规模集？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n如果仅向 VM 提供 SSH 公钥，则不需要将公钥放在 Key Vault 中。 公钥不是机密。\n\n可以在创建 Linux VM 时以明文形式提供 SSH 公钥：\n\n""linuxConfiguration"": { ""ssh"": { ""publicKeys"": [ { ""path"": ""path"", ""keyData"": ""publickey"" } ] } \nlinuxConfiguration 元素名称必选类型说明ssh否集合指定 Linux OS 的 SSH 密钥配置path是String指定 SSH 密钥或证书应放置到的 Linux 文件路径keyData是String指定 base64 编码的 SSH 公钥\n\n有关示例，请参阅 [101-vm-sshkey GitHub 快速入门模板](https://github.com/Azure/azure-quickstart-templates/blob/master/101-vm-sshkey/azuredeploy.json)\n",如何在预配期间将现有的 SSH 公钥注入到虚拟机规模集 SSH 层？ 我想要将 SSH 公钥值存储在 Azure Key Vault 中，并在 Resource Manager 模板中使用这些值。,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\n若要删除已弃用的证书，请从保管库证书列表中删除旧证书。 在列表中留下想要在计算机上保留的所有证书。 这不会删除所有虚拟机中的证书。 也不会向虚拟机规模集中创建的新 VM 添加证书。 \n\n若要从现有 VM 中删除证书，需要编写一个自定义脚本扩展，从证书存储中手动删除证书。\n,如何删除已弃用的证书？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n为了将证书安全地传送到 VM，可以将客户证书从客户的密钥保管库直接安装到 Windows 证书存储中。\n\n使用以下值 JSON：\n\n""secrets"": [ { ""sourceVault"": { ""id"": ""/subscriptions/{subscriptionid}/resourceGroups/myrg1/providers/Microsoft.KeyVault/vaults/mykeyvault1"" }, ""vaultCertificates"": [ { ""certificateUrl"": ""https://mykeyvault1.vault.azure.cn/secrets/{secretname}/{secret-version}"", ""certificateStore"": ""certificateStoreName"" } ] } ] \n\n该代码支持 Windows 和 Linux。\n\n有关详细信息，请参阅[创建或更新虚拟机规模集](https://msdn.microsoft.com/library/mt589035.aspx)\n",如何安全地将证书传送到 VM？ 如何预配虚拟机规模集来运行网站，并且可以通过证书配置安全传送该网站的 SSL？ （常见的证书轮转操作几乎与配置更新操作相同。）是否有示例说明如何执行此操作？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\n若要使用 PowerShell 对虚拟机规模集设置自动缩放，请参阅博客文章 [How to add autoscale to an Azure virtual machine scale set](https://msftstack.wordpress.com/2017/03/05/how-to-add-autoscale-to-an-azure-vm-scale-set/)（如何向 Azure 虚拟机规模集添加自动缩放）。\n\n## 证书\n\n,如何使用 PowerShell 对虚拟机规模集设置自动缩放？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\n通过 PowerShell 或 Azure CLI，可以为虚拟机规模集创建指标警报。 有关详细信息，请参阅 [Azure Monitor PowerShell 快速入门示例](https://docs.azure.cn/zh-cn/monitoring-and-diagnostics/insights-powershell-samples/#create-alert-rules)和 [Azure Monitor 跨平台 CLI 快速入门示例](https://docs.azure.cn/zh-cn/monitoring-and-diagnostics/insights-cli-samples/#work-with-alerts)。\n\n虚拟机规模集的 TargetResourceId 如下所示： \n\n/subscriptions/yoursubscriptionid/resourceGroups/yourresourcegroup/providers/Microsoft.Compute/virtualMachineScaleSets/yourvmssname\n\n可以选择任何 VM 性能计数器作为要对其设置警报的指标。 有关详细信息，请参阅 [Azure Monitor 自动缩放常用指标](https://docs.azure.cn/zh-cn/monitoring-and-diagnostics/insights-autoscale-common-metrics/)中的[基于 Resource Manager 的 Windows VM 的来宾 OS 指标](https://docs.azure.cn/zh-cn/monitoring-and-diagnostics/insights-autoscale-common-metrics/#guest-os-metrics-resource-manager-based-windows-vms)和 [Linux VM 的来宾 OS 指标](https://docs.azure.cn/zh-cn/monitoring-and-diagnostics/insights-autoscale-common-metrics/#guest-os-metrics-linux-vms)。\n,如何对虚拟机规模集设置警报规则？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\n可以在 VM 上创建自动缩放设置，以使用主机级指标或基于来宾 OS 的指标。\n\n关于受支持的指标列表，请参阅 [Azure Monitor 自动缩放常用指标](https://docs.azure.cn/zh-cn/monitoring-and-diagnostics/insights-autoscale-common-metrics)。 \n\n此示例使用主机级 CPU 指标和消息计数指标。\n,应该使用基于主机的指标还是使用诊断扩展来执行自动缩放？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n是的。 有关基于 Azure 服务总线主题和队列长度的自动缩放示例，请参阅 [Azure Monitor 自动缩放常用指标](https://docs.azure.cn/zh-cn/monitoring-and-diagnostics/insights-autoscale-common-metrics/)。\n\n对于服务总线队列，请使用以下 JSON：\n\n""metricName"": ""MessageCount"", ""metricNamespace"": """", ""metricResourceUri"": ""/subscriptions/s1/resourceGroups/rg1/providers/Microsoft.ServiceBus/namespaces/mySB/queues/myqueue"" \n\n对于存储队列，请使用以下 JSON：\n\n""metricName"": ""ApproximateMessageCount"", ""metricNamespace"": """", ""metricResourceUri"": ""/subscriptions/s1/resourceGroups/rg1/providers/Microsoft.ClassicStorage/storageAccounts/mystorage/services/queue/queues/mystoragequeue"" \n\n将示例值替换为资源的统一资源标识符 (URI)。\n",基于 Azure 服务总线主题和队列长度的自动缩放是否有任何示例可供参考？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n如果更新策略设置为自动，使用新扩展属性重新部署模板可更新所有 VM。\n\n如果更新策略设置为""手动""，先更新扩展，并手动更新 VM 中的所有实例。\n",如何将扩展添加到虚拟机规模集中的所有 VM？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
若要了解如何部署 Linux VM 的证书，请参阅[将证书从客户管理的 Key Vault 部署到 VM](https://blogs.technet.microsoft.com/kv/2015/07/14/deploy-certificates-to-vms-from-customer-managed-key-vault/),在 Linux VM 上，证书放在哪个位置？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n如果更新虚拟机规模集模型中的扩展定义，且将 upgradePolicy 属性设置为""自动""，则会更新 VM。 如果 upgradePolicy 属性设置为""手动""，扩展会标记为不匹配模型。 \n\n如果对现有 VM 执行服务修复，这种行为类似于重新启动，因此不会重新运行扩展。 如果重置映像，则类似于将 OS 驱动器替换为源映像。 在这种情况下，将运行最新模型中的任何专用设置（如扩展）。\n",如果更新与现有虚拟机规模集关联的扩展，是否会影响现有的 VM？ （即，VM 是否会不匹配虚拟机规模集模型？）或者，是否会忽略 VM？ 如果对现有计算机执行服务修复或重置映像操作，是否会执行当前在虚拟机规模集上配置的脚本，或者，是否会使用最初创建 VM 时配置的脚本？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n可以在一定程度上灵活处理指定阈值的警报。 例如，可以定义自定义的 webhook。 以下 webhook 示例取自 Resource Manager 模板：\n\n{ ""type"": ""Microsoft.Insights/autoscaleSettings"", ""apiVersion"": ""[variables('insightsApi')]"", ""name"": ""autoscale"", ""location"": ""[parameters('resourceLocation')]"", ""dependsOn"": [ ""[concat('Microsoft.Compute/virtualMachineScaleSets/', parameters('vmSSName'))]"" ], ""properties"": { ""name"": ""autoscale"", ""targetResourceUri"": ""[concat('/subscriptions/',subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Compute/virtualMachineScaleSets/', parameters('vmSSName'))]"", ""enabled"": true, ""notifications"": [ { ""operation"": ""Scale"", ""email"": { ""sendToSubscriptionAdministrator"": true, ""sendToSubscriptionCoAdministrators"": true, ""customEmails"": [ ""youremail@address.com"" ] }, ""webhooks"": [ { ""serviceUri"": ""https://events.pagerduty.com/integration/0b75b57246814149b4d87fa6e1273687/enqueue"", ""properties"": { ""key1"": ""custommetric"", ""key2"": ""scalevmss"" } } ] } ], \n\n在此示例中，达到阈值时，警报将转到 Pagerduty.com。\n\n## 修补和操作\n\n",如何定义达到特定阈值时触发的自定义警报？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
如果虚拟机规模集扩展尝试安装需要重新启动的内容，可以使用 Azure 自动化所需状态配置 (Automation DSC) 扩展。 如果操作系统为 Windows Server 2012 R2，Azure 将拉入 Windows Management Framework (WMF) 5.0 安装程序，重新启动，然后继续使用该配置。,"虚拟机规模集扩展尝试安装需要重新启动的内容。 例如，""commandToExecute"": ""powershell.exe -ExecutionPolicy Unrestricted Install-WindowsFeature -Name FS-Resource-Manager -IncludeManagementTools""",virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\n删除虚拟机规模集中的 VM 与解除分配 VM 的主要区别在于 `deallocate` 不会删除虚拟硬盘 (VHD)。 运行 `stop deallocate` 会产生存储费用。 采用其中一种做法可能是由于以下原因之一：\n\n*   不再想要支付计算费用，但要保留 VM 的磁盘状态。\n*   想要更快速地启动一组 VM，而不是扩大虚拟机规模集。\n\n    *   出于这种方案，可能创建了自己的自动缩放引擎，并希望以更快的速度完成端到端缩放。\n*   虚拟机规模集未均匀分布在容错域或更新域。 这可能是由于有选择地删除了 VM，或者因为过度预配后，VM 被删除。 在虚拟机规模集上先运行 `stop deallocate`，并运行 `start`，可将 VM 均匀地分布到容错域或更新域。,删除虚拟机规模集中的 VM 与解除分配 VM 有什么区别？ 如何在这两种做法之间做出选择？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\n虚拟机规模集 VM 计算机名和 VM ID 不连续是因为虚拟机规模集的 overprovision 属性设置为默认值 true。 如果 overprovision 设置为 true，创建的 VM 数量将超过请求数量。 然后，将删除多余的 VM。 在这种情况下，虽然部署可靠性得到提高，但代价是无法遵守连续命名和连续网络地址转换 (NAT) 规则。 \n\n可以将此属性设置为 false。 对于小型虚拟机规模集，不会显著影响部署可靠性。\n,虚拟机规模集 VM 计算机名和 VM ID 为什么不是连续的？ 例如：0，1，3...,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
不可以将不同的扩展参数传递给虚拟机规模集中的不同 VM。 但是，扩展可以根据它们运行所在的 VM 的唯一属性（例如计算机名）运行。 扩展还可以在 [http://169.254.169.254](http://169.254.169.254/) 上查询实例元数据来获取更多关于 VM 的信息。,是否可将不同的扩展参数传递给虚拟机规模集中的不同 VM？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\n若要在不发出多个调用的情况下获取每个 VM 的属性信息，通过在以下资源 URI 上执行 REST API `GET`调用 `ListVMInstanceViews`：\n\n/subscriptions//resourceGroups//providers/Microsoft.Compute/virtualMachineScaleSets//virtualMachines?$expand=instanceView&$select=instanceView\n\n,如何在不发出多个调用的情况下获取每个 VM 的属性信息？ 例如，对于虚拟机规模集中的 100 个 VM，如何获取每个 VM 的的容错域？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n若要启用启动诊断，首先，创建存储帐户。 然后，将此 JSON 块放在虚拟机规模集 virtualMachineProfile 中，并更新虚拟机规模集：\n\n""diagnosticsProfile"": { ""bootDiagnostics"": { ""enabled"": true, ""storageUri"": ""http://yourstorageaccount.blob.core.chinacloudapi.cn"" } } \n\n创建新 VM 时，VM 的 InstanceView 属性显示屏幕截图的详细信息等等。 下面是一个示例：\n\n""bootDiagnostics"": { ""consoleScreenshotBlobUri"": ""https://o0sz3nhtbmkg6geswarm5.blob.core.chinacloudapi.cn/bootdiagnostics-swarmagen-4157d838-8335-4f78-bf0e-b616a99bc8bd/swarm-agent-9574AE92vmss-0_2.4157d838-8335-4f78-bf0e-b616a99bc8bd.screenshot.bmp"", ""serialConsoleLogBlobUri"": ""https://o0sz3nhtbmkg6geswarm5.blob.core.chinacloudapi.cn/bootdiagnostics-swarmagen-4157d838-8335-4f78-bf0e-b616a99bc8bd/swarm-agent-9574AE92vmss-0_2.4157d838-8335-4f78-bf0e-b616a99bc8bd.serialconsole.log"" } \n\n## 虚拟机属性\n\n",如何启用启动诊断？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n可以，可在规模集 VM 上安装 OMS 扩展。 Azure CLI 示例如下：\n\n``\n\n可在 OMS 门户中查找所需的 workspaceId 和 workspaceKey。 在""概述""页面上，单击""设置""磁贴。 单击顶部的""相连的源""选项卡。\n\n注意：如果规模集""upgradePolicy""设置为""手动""，则需要通过对 VM 调用升级将扩展应用到集中的所有 VM。 在 CLI 中，这将为""az vmss update-instances""。\n\n## 故障排除\n\n",是否可以将规模集与 Azure OMS (Operations Management Suite) 集成？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\n可以在不更改映像的情况下，使用重置映像操作来重置 VM。 但是，如果虚拟机规模集使用 `version = latest` 引用了平台映像，则调用 `reimage` 时，VM 可以更新为更高版本的 OS 映像。\n\n有关详细信息，请参阅[管理虚拟机规模集中的所有 VM](https://docs.microsoft.com/rest/api/virtualmachinescalesets/manage-all-vms-in-a-set)\n,是否可以在不更改映像的情况下，使用重置映像操作来重置 VM？ （也就是说，将 VM 重置为出厂设置而不是重置为新映像）,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
若要将虚拟机规模集更新为新映像，或管理修补，请参阅[升级虚拟机规模集](https://docs.azure.cn/zh-cn/virtual-machine-scale-sets/virtual-machine-scale-sets-upgrade-scale-set),如何将虚拟机规模集更新为新映像？ 如何管理修补？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
可以，可以将规模集资源移至新的订阅或资源组。,可以将规模集移至另一个资源组吗？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
尚不能通过 Azure 门户在现有资源组中创建规模集，但从 Azure Resource Manager 模板部署规模集时，可以指定现有资源组。 使用 Azure PowerShell 或 CLI 创建规模集时，也可指定现有的资源组。,如何在现有资源组中创建规模集？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
有关使用基于主机的指标执行自动缩放时的相关指标名称，请参阅 [Azure Monitor 支持的指标](https://docs.azure.cn/zh-cn/monitoring-and-diagnostics/monitoring-supported-metrics/),在哪里可以找到使用基于主机的指标执行自动缩放时的相关指标名称？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
若要更改虚拟机规模集中的 VM 数量，请参阅[更改虚拟机规模集的实例计数](https://msftstack.wordpress.com/2016/05/13/change-the-instance-count-of-an-azure-vm-scale-set/),如何更改虚拟机规模集中的 VM 数目？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n创建包含少于两个 VM 的虚拟机规模集的原因之一为需要使用虚拟机规模集的弹性属性。 例如，可以部署不包含任何 VM 的虚拟机规模集来定义基础结构，这样就无需支付 VM 运行费。 然后，在准备好部署 VM 后，将虚拟机规模集的""容量""提高到生产实例计数。\n\n可能创建包含少于两个 VM 的虚拟机规模集的另一个原因为，相比于使用离散 VM 的可用性集，不必担心可用性的问题。 此外，可以借助虚拟机规模集来使用可替代的无差别计算单元。 这种一致性是虚拟机规模集相比可用性集存在的一项重要优势。 许多无状态工作负载不跟踪单个单元。 如果工作负载下降，可以减少到一个计算单元，如果工作负载上升，可以增加到多个计算单元。\n",在哪些情况下我会创建包含少于两个 VM 的虚拟机规模集？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\n是的。 可以将多个应用程序网关后端地址池的资源 ID 添加到规模集网络配置文件的 ipConfigurations 部分的 applicationGatewayBackendAddressPools 列表中。\n\n## 缩放\n\n,能否配置与多个应用程序网关配合使用的规模集？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n若要创建具有自定义 DNS 配置的 VM 规模集，请将 dnsSettings JSON 数据包添加到规模集的 networkInterfaceConfigurations 节。 示例：\n\n ""dnsSettings"":{ ""dnsServers"":[""10.0.0.6"", ""10.0.0.5""] } \n",如何才能配置规模集使用的 DNS 服务器？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n是的。 若要使用加速网络，请在规模集的 networkInterfaceConfigurations 设置中将 enableAcceleratedNetworking 设置为 true。 例如\n\n""networkProfile"": { ""networkInterfaceConfigurations"": [ { ""name"": ""niconfig1"", ""properties"": { ""primary"": true, ""enableAcceleratedNetworking"" : true, ""ipConfigurations"": [ ] } } ] } } ] } \n",能否将规模集与加速网络结合使用？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
若要将虚拟机规模集中第一个 VM 的 IP 地址添加到模板的输出中，请参阅 [ARM：获取 VMSS 的专用 IP](http://stackoverflow.com/questions/42790392/arm-get-vmsss-private-ips),如何将虚拟机规模集中第一个 VM 的 IP 地址添加到模板的输出中？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
若要将虚拟机规模集部署到现有的 Azure 虚拟网络，请参阅[将虚拟机规模集部署到现有的 Azure 虚拟网络](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-existing-vnet),如何将虚拟机规模集部署到现有的 Azure 虚拟网络？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\nIP 地址是从指定的子网中选择的。 \n\n虚拟机规模集 IP 地址的分配方法始终为""动态""，但这并不意味着可以更改这些 IP 地址。 在这种情况下，""动态""仅意味不在 PUT 请求中指定 IP 地址。 通过使用子网设置静态集。 \n",如何为静态专用 IP 地址分配指定专用 IP 地址范围？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
如果有两个包含 Azure 负载均衡器前端的虚拟机规模集，并且它们位于同一订阅和区域中，可以解除分配它们的公共 IP 地址，并将公共 IP 地址分配给其他资源。 有关示例，请参阅 [VIP 交换：Azure Resource Manager 中的蓝绿部署](https://msftstack.wordpress.com/2017/02/24/vip-swap-blue-green-deployment-in-azure-resource-manager/)。 但这确实意味着延迟，因为要在网络一级解除分配/分配资源。 更快的做法是将 Azure 应用程序网关与两个后端池和路由规则结合使用。 也可以使用支持快速切换暂存槽和生产槽的 [Azure 应用服务](https://docs.azure.cn/zh-cn/app-service/)托管应用程序。,如何针对同一订阅和同一区域中的虚拟机规模集执行 VIP 交换？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n是的。 网络安全组可以直接应用于规模集，方法是在网络配置文件的 networkInterfaceConfigurations 部分引用该组。 示例：\n\n""networkProfile"": { ""networkInterfaceConfigurations"": [ { ""name"": ""nic1"", ""properties"": { ""primary"": ""true"", ""ipConfigurations"": [ { ""name"": ""ip1"", ""properties"": { ""subnet"": { ""id"": ""[concat('/subscriptions/', subscription().subscriptionId,'/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/virtualNetworks/', variables('vnetName'), '/subnets/subnet1')]"" } ""loadBalancerInboundNatPools"": [ { ""id"": ""[concat('/subscriptions/', subscription().subscriptionId,'/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/loadBalancers/', variables('lbName'), '/inboundNatPools/natPool1')]"" } ], ""loadBalancerBackendAddressPools"": [ { ""id"": ""[concat('/subscriptions/', subscription().subscriptionId,'/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/loadBalancers/', variables('lbName'), '/backendAddressPools/addressPool1')]"" } ] } } ], ""networkSecurityGroup"": { ""id"": ""[concat('/subscriptions/', subscription().subscriptionId,'/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Network/networkSecurityGroups/', variables('nsgName'))]"" } } } ] } \n",是否可以将网络安全组 (NSG) 分配给规模集，以便将其应用于集中的所有 VM NIC？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\n若要执行在私有存储帐户中托管的自定义脚本，请通过存储帐户密钥和名称来设置受保护的设置。 有关详细信息，请参阅[适用于 Windows 的自定义脚本扩展](https://docs.azure.cn/zh-cn/virtual-machines/virtual-machines-windows-extensions-customscript/#template-example-for-a-windows-vm-with-protected-settings)。\n\n## 联网\n\n,"我需要执行一个在专用存储帐户中托管的自定义脚本。 存储为公共存储时脚本成功运行，但尝试使用共享访问签名 (SAS) 时，脚本运行失败。 显示此消息：""缺少有效共享访问签名的强制参数""。 通过本地浏览器可以正常使用""链接+SAS""。",virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n若要在虚拟机规模集中启用反恶意软件，请使用以下 PowerShell 示例：\n\n$rgname = 'autolap' $vmssname = 'autolapbr' $location = 'chinanorth' # Retrieve the most recent version number of the extension. $allVersions= (Get-AzureRmVMExtensionImage -Location $location -PublisherName ""Microsoft.Azure.Security"" -Type ""IaaSAntimalware"").Version $versionString = $allVersions[($allVersions.count)-1].Split(""."")[0] + ""."" + $allVersions[($allVersions.count)-1].Split(""."")[1] $VMSS = Get-AzureRmVmss -ResourceGroupName $rgname -VMScaleSetName $vmssname echo $VMSS Add-AzureRmVmssExtension -VirtualMachineScaleSet $VMSS -Name ""IaaSAntimalware"" -Publisher ""Microsoft.Azure.Security"" -Type ""IaaSAntimalware"" -TypeHandlerVersion $versionString Update-AzureRmVmss -ResourceGroupName $rgname -Name $vmssname -VirtualMachineScaleSet $VMSS \n",如何在虚拟机规模集中启用反恶意软件？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n要将虚拟机规模集加入到 Azure Active Directory (Azure AD) 域，可以定义一个扩展。 \n\n若要定义扩展，请使用 JsonADDomainExtension 属性：\n\n""extensionProfile"": { ""extensions"": [ { ""name"": ""joindomain"", ""properties"": { ""publisher"": ""Microsoft.Compute"", ""type"": ""JsonADDomainExtension"", ""typeHandlerVersion"": ""1.3"", ""settings"": { ""Name"": ""[parameters('domainName')]"", ""OUPath"": ""[variables('ouPath')]"", ""User"": ""[variables('domainAndUsername')]"", ""Restart"": ""true"", ""Options"": ""[variables('domainJoinOptions')]"" }, ""protectedsettings"": { ""Password"": ""[parameters('domainJoinPassword')]"" } } } ] } \n",如何将虚拟机规模集加入到 Azure AD 域？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
有关自动缩放的最佳做法，请参阅[自动缩放虚拟机的最佳做法](https://docs.azure.cn/zh-cn/monitoring-and-diagnostics/insights-autoscale-best-practices),Azure 自动缩放的最佳做法是什么？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
"\n\n若要创建向每个 VM 分配公共 IP 地址的 VM 规模集，请确保 Microsoft.Compute/virtualMAchineScaleSets 资源的 API 版本为 2017-03-30，并将 publicipaddressconfiguration JSON 数据包添加到规模集的 ipConfigurations 节。 示例：\n\n ""publicipaddressconfiguration"": { ""name"": ""pub1"", ""properties"": { ""idleTimeoutInMinutes"": 15 } } \n",如何将规模集配置为向每个 VM 分配公共 IP 地址？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\n虚拟机规模集是 CRP 之上的一个精简 API 层。 这两个组件是 Azure 服务树中的计算平台的一部分。\n\n从合规性角度看，虚拟机规模集是 Azure 计算平台的基础部分。 它们与 CRP 共享团队、工具、进程、部署方法、安全控制、实时 (JIT) 编译、监视、警报等。 虚拟机规模集符合支付卡行业 (PCI) 规范，因为 CRP 属于当前 PCI 数据安全标准 (DSS) 证明的一部分。\n\n有关详细信息，请参阅 [Microsoft 信任中心](https://www.trustcenter.cn/)。\n\n## 扩展\n\n,虚拟机规模集是否符合 PCI 规范？,virtual machine-scale-sets,https://docs.azure.cn/virtual-machine-scale-sets/virtual-machine-scale-sets-faq
\n\n[关于 Azure 虚拟机](https://docs.azure.cn/virtual-machines/virtual-machines-linux-about)\n\n[创建 Linux 虚拟机的不同方式](https://docs.azure.cn/virtual-machines/linux/creation-choices?toc=/virtual-machines/linux/toc.json)\n\n[创建 Windows 虚拟机的不同方式](https://docs.azure.cn/virtual-machines/windows/creation-choices?toc=/virtual-machines/windows/toc.json)\n,其他资源,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
\n\n在进行 Azure 数据中心定期计划内维护更新时，Azure 有时会重新启动 VM。\n\n当 Azure 检测到影响 VM 的严重硬件问题时，可能会发生计划外维护事件。 对于计划外事件，Azure 自动将 VM 迁移到正常运行的主机，并重新启动 VM。\n\n对于任何独立的 VM（表示该 VM 不属于可用性集），Azure 在进行计划内维护前提前至少 1 周向订阅服务管理员发送电子邮件通知，因为在更新期间各个 VM 可能会重新启动。 在 VM 上运行的应用程序可能会遭遇停机。\n\n因计划内维护而重新启动时，你还可以使用 Azure 经典管理门户或 Azure PowerShell 查看重新启动日志。 有关详细信息，请参阅 [Viewing VM Reboot Logs](https://azure.microsoft.com/blog/2015/04/01/viewing-vm-reboot-logs/)（查看 VM 重新启动日志）。\n\n若要提供冗余，可将两个或多个采用类似配置的 VM 放到同一个可用性集中。 这可以确保在计划内或计划外维护期间至少有一个 VM 可用。 对于此配置，Azure 可以保证某些级别的 VM 可用性。 有关详细信息，请参阅[管理虚拟机的可用性](https://docs.azure.cn/virtual-machines/windows/manage-availability?toc=/virtual-machines/windows/toc.json)\n,Azure 是否会重新启动 VM 进行维护？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
"\n\nAzure 根据 VM 的大小和操作系统按小时进行收费。 对于不足一小时的部分，Azure 将仅根据使用的分钟数计费。 如果使用包含特定预安装软件的 VM 映像创建 VM，则还会按小时收取额外软件费用。 对于 VM 的操作系统和数据磁盘，Azure 单独收取存储费用。 临时磁盘存储免费。\n\n当 VM 状态为""正在运行""或""已停止""时计费，但是当 VM 状态为""已停止""（""已释放""）时不计费。 若要将 VM 置于""已停止""（""已释放""）状态，请执行以下操作之一：\n\n*   从 Azure 经典管理门户关闭或删除该 VM。\n*   使用 Azure PowerShell 模块中提供的 Stop-AzureVM cmdlet。\n*   使用服务管理 REST API 中的关闭角色操作，并为 PostShutdownAction 元素指定 StoppedDeallocated。\n\n有关更多详细信息，请参阅[虚拟机定价](https://www.azure.cn/pricing/details/virtual-machines/)\n",Azure 如何为 VM 收费？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
\n\n在某些区域，可将 Azure 备份用作预览。 有关详细信息，请参阅[备份 Azure 虚拟机](https://docs.azure.cn/backup/backup-azure-vms)。 认证合作伙伴提供了其他解决方案。 若要了解当前提供的内容，请搜索 Azure 应用商店。\n\n另一个选项是使用 blob 存储的快照功能。 为此，需要在进行任何依赖 blob 快照的操作前关闭 VM。 这会保存挂起的数据写入，并将文件系统保持为一致状态。\n,哪些选项可用于备份和恢复？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
\n\nAzure 针对防病毒解决方案提供多种选项，但需要用户自行管理。 例如，可能需要另外订阅反恶意软件的软件，并需要自行决定运行扫描和安装更新的时间。 你可以在创建 Windows 虚拟机时通过适用于 Microsoft 反恶意软件或 TrendMicro Deep Security Agent 的 VM 扩展来添加防病毒支持，也可以稍后进行。 有关详细信息，请参阅：\n\n*   [如何在 Azure VM 上安装和配置 Trend Micro Deep Security 即服务](https://docs.azure.cn/zh-cn/virtual-machines/windows/classic/install-trend)\n*   [在 Azure 虚拟机上部署反恶意软件解决方案](https://azure.microsoft.com/blog/2014/05/13/deploying-antimalware-solutions-on-azure-virtual-machines/),Azure 能否在虚拟机上运行防病毒软件？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
"\n\nAzure 提供的映像没有预先配置的用户名和密码。 使用其中一个映像创建虚拟机时，需提供用于登录到虚拟机的用户名和密码。\n\n如果忘记用户名或密码且已安装 VM 代理，可以安装并使用 [VMAccess](https://docs.azure.cn/virtual-machines/windows/extensions-features?toc=/virtual-machines/windows/toc.json) 扩展解决该问题。\n\n其他详细信息：\n\n*   对于 Linux 映像，如果你使用 Azure 经典管理门户，系统会提供""azureuser""作为默认用户名，但你可以更改该用户名，只需使用""从库中""而非""快速创建""作为创建虚拟机的方法即可。 使用""从库中""，你可以决定在登录时是使用密码、SSH 密钥还是二者都使用。 用户帐户是非特权用户，但具有运行特权命令所需的""sudo""访问权限。 ""root""帐户已禁用。\n*   对于 Windows 映像，需要在创建 VM 时提供用户名和密码。 该帐户将添加到管理员组。",虚拟机的默认用户名和密码是什么？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
"\n\n术语""升级""通常是指迁移到更新的操作系统版本，同时保留原有硬件。 对于 Azure VM，迁移到更新的 Linux 版本和 Windows 版本是不同过程：\n\n*   对于 Linux VM，可使用适用于发行版的包管理工具和过程。\n*   对于 Windows 虚拟机，需要使用类似 Windows Server 迁移工具的工具迁移服务器。 请勿尝试升级来宾 OS（如果驻留在 Azure 上）。 由于存在失去虚拟机访问权限的风险，因此不支持该功能。 如果在升级过程中出现问题，可能无法启动远程桌面会话，并且无法解决这些问题。\n\n有关 Windows Server 迁移工具和过程的一般详细信息，请参阅[将角色和功能迁移到 Windows Server](https://technet.microsoft.com/library/jj134039.aspx)\n",如何升级来宾操作系统？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
不得使用临时磁盘（Windows 默认的 D: 盘或 Linux 的 /dev/sdb1）存储数据。 这些磁盘只是临时存储空间，因此存在丢失数据且无法恢复数据的风险。 将虚拟机迁移到其他主机时，可能会发生这种情况。 调整虚拟机大小，更新主机和主机硬件故障都是需要迁移动虚拟机的原因。,是否可以使用临时磁盘（Windows 的 D: 盘或 Linux 的 /dev/sdb1）存储数据？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
在 Windows 虚拟机中，可以通过移动页面文件和重新分配驱动器号更改驱动器号，但需要确保按特定顺序执行这些步骤。 有关说明，请参阅[更改 Windows 临时磁盘的驱动器号](https://docs.azure.cn/virtual-machines/windows/change-drive-letter?toc=/virtual-machines/windows/classic/toc.json),如何更改临时磁盘的驱动器号？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
\n\n对于通过经典部署模型创建的虚拟机，可以使用 Azure 虚拟网络扩展现有的基础结构。 该方法类似于设立分支机构。 可以预配和管理 Azure 中的虚拟专用网 (VPN)，并将其安全连接到本地 IT 基础结构。 有关详细信息，请参阅[虚拟网络概述](https://docs.azure.cn/virtual-network/virtual-networks-overview)。\n\n创建虚拟机时，需要指定虚拟机所属的网络。 不能将现有虚拟机加入虚拟网络。 不过，将虚拟硬盘 (VHD) 与现有虚拟机分离即可解决此问题，然后可以用于创建具有所需网络配置的新虚拟机。\n,这些虚拟机可否使用现有的本地网络基础结构？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
"\n\n在许多方面，它们与""第 1 代""Hyper-V VM 类似，但并非完全相同。 两种类型的虚拟机都提供虚拟化硬件，并且兼容 VHD 格式虚拟硬盘。 这意味着可以在 Hyper-V 与 Azure 之间交换使用它们。 同时存在以下三大区别，有时也会使 Hyper-V 用户感到惊讶：\n\n*   Azure 不提供对虚拟机的控制台访问。 在 VM 完成启动前，无法对其进行访问。\n*   大多数[大小](https://docs.azure.cn/virtual-machines/linux/sizes?toc=/virtual-machines/linux/toc.json)的 Azure VM 只有 1 个虚拟网络适配器，这意味着它们也只能具有 1 个外部 IP 地址。 （A8 和 A9 大小的 VM 可使用第二个网络适配器在实例之间进行应用程序通信，但仅限特定方案。）\n*   Azure VM 不支持第 2 代 Hyper-V VM 功能。 有关这些功能的详细信息，请参阅 [Hyper-V 虚拟机规范](http://technet.microsoft.com/library/dn592184.aspx)和[第 2 代虚拟机概述](https://technet.microsoft.com/library/dn282285.aspx)。",这些虚拟机是否与 Hyper-V 虚拟机相同？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
"\n\nAzure 只支持固定的 VHD 格式的虚拟硬盘。 若要在 Azure 中使用 VHDX，需先使用 Hyper-V 管理器或 [convert-VHD](https://technet.microsoft.com/itpro/powershell/windows/hyper-v/convert-vhd) cmdlet 对其进行转换。 然后，使用 [Add-AzureVHD](https://msdn.microsoft.com/library/azure/dn495173.aspx) cmdlet（在""服务管理""模式下）将 VHD 上传到 Azure 的存储帐户，用于虚拟机。\n\n*   有关 Linux 说明，请参阅[创建并上传包含 Linux 操作系统的虚拟硬盘](https://docs.azure.cn/virtual-machines/linux/classic/create-upload-vhd?toc=/virtual-machines/linux/classic/toc.json)。\n*   有关 Windows 说明，请参阅[创建 Windows Server VHD 并将其上传到 Azure](https://docs.azure.cn/virtual-machines/windows/classic/createupload-vhd?toc=/virtual-machines/windows/classic/toc.json)。",可以使用哪些虚拟硬盘类型？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
\n\n每个数据磁盘的容量高达 1 TB。 可以使用的数据磁盘数取决于虚拟机大小。 有关详细信息，请参阅[虚拟机大小](https://docs.azure.cn/virtual-machines/linux/sizes?toc=/virtual-machines/linux/toc.json)。\n\nAzure 存储帐户可为操作系统磁盘和任何数据磁盘提供存储空间。 每个磁盘都是一个 .vhd 文件，以页 blob 形式存储。 有关定价详细信息，请参阅 [Storage Pricing Details](https://www.azure.cn/pricing/details/storage/blob/)（存储定价详细信息）。\n,使用虚拟机时，我可以使用多少存储？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
\n\n地缘组是一个旧概念，指的是在 Azure 中客户的云服务部署和存储帐户的地理分组。 在早期的 Azure 网络设计中，它们最初用于改进 VM 到 VM 的网络性能。 它们还支持仅限于使用一个区域中的一小部分硬件的虚拟网络 (VNet) 的初始版本。\n\n当前一个区域内的 Azure 网络已被设计为不再需要地缘组。 虚拟网络也在区域范围内，因此使用虚拟网络时不再需要地缘组。 由于这些改进，我们不再建议客户使用地缘组，因为在某些情况下它们可能存在一些限制。 使用地缘组将不必要地将 VM 和特定的硬件相关联，这样限制了可供你选择的 VM 大小。 当与地缘组相关联的特定硬件接近容量上限时，如果尝试添加新的 VM，还可能导致与容量相关的错误。\n\nAzure Resource Manager 部署模型和 Azure 门户已弃用地缘组功能。 对于 Azure 经典管理门户，我们将禁止支持创建地缘组以及创建固定到地缘组的存储资源。 你无需修改现有的使用地缘组的云服务。 但是，你不能在新的云服务中使用地缘组，除非 Azure 支持专业人员建议使用它们。\n,为什么要弃用地缘组？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
\n\n所有订户都可以在 Azure 虚拟机上运行服务器软件。 可以运行最新版本的 Windows Server 和各种 Linux 发行版。 有关支持详细信息，请参阅：\n\n• 对于Windows VM - [Microsoft 服务器软件对 Azure 虚拟机的支持](https://support.microsoft.com/help/2721672/microsoft-server-software-support-for-microsoft-azure-virtual-machines)\n\n• 对于 Linux VM - [Azure 认可的分发中的 Linux](https://docs.azure.cn/zh-cn/virtual-machines/linux/endorsed-distros)\n,我可以在 Azure VM 上运行什么程序？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
\n\n是的。 有关迁移方法的说明，请参阅：\n\n*   [使用 Azure PowerShell 从经典部署迁移到 Azure Resource Manager 部署](https://docs.azure.cn/virtual-machines/windows/migration-classic-resource-manager-ps)。\n*   [使用 Azure CLI 从经典部署迁移到 Azure Resource Manager 部署](https://docs.azure.cn/virtual-machines/virtual-machines-linux-cli-migration-classic-resource-manager)。,是否可以将经典部署模型中创建的 VM 迁移到新的 Resource Manager 模型？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
"\n\n需要通过适用于 Windows VM 的远程桌面连接或适用于 Linux VM 的安全外壳 (SSH) 建立登录虚拟机所需的远程连接。 有关说明，请参阅：\n\n*   [如何登录到运行 Windows Server 的虚拟机](https://docs.azure.cn/virtual-machines/windows/classic/connect-logon?toc=/virtual-machines/windows/classic/toc.json)。 除非将服务器配置为远程桌面服务会话主机，否则最多支持 2 个并发连接。 \n*   [如何登录到运行 Linux 的虚拟机](https://docs.azure.cn/virtual-machines/linux/mac-create-ssh-keys?toc=/virtual-machines/linux/toc.json)。 默认情况下，SSH 最多允许 10 个并发连接。 通过编辑配置文件，可以增加此数量。\n\n如果在使用远程桌面或 SSH 时遇到问题，请安装并使用 [VMAccess](https://docs.azure.cn/virtual-machines/windows/extensions-features?toc=/virtual-machines/windows/toc.json) 扩展帮助解决问题。\n\nWindows VM 的其他选项包括：\n\n*   在 Azure 经典管理门户中找到 VM，然后单击命令栏中的""重置远程访问""。\n*   查看[对基于 Windows 的 Azure 虚拟机的远程桌面连接进行故障排除](https://docs.azure.cn/virtual-machines/windows/troubleshoot-rdp-connection?toc=/virtual-machines/windows/toc.json)。\n*   使用 Windows PowerShell 远程连接到 VM，或创建其他终结点以方便其他资源连接到 VM。 有关详细信息，请参阅[如何设置虚拟机的终结点](https://docs.azure.cn/virtual-machines/windows/classic/setup-endpoints?toc=/virtual-machines/windows/classic/toc.json)。\n\n如果熟悉 Hyper-V，可以查找与 VMConnect 类似的工具。 Azure 不提供类似工具，因为不支持通过控制台访问虚拟机。\n",如何访问虚拟机？,classic,https://docs.azure.cn/virtual-machines/linux/classic/faq
能，目前可行。 首先需停止解除分配 VM。 然后便可添加或删除 NIC（除非它是 VM 上的最后一个 NIC）。,创建 VM 后能否向 VM 添加 NIC？,linux,https://docs.azure.cn/virtual-machines/linux/faq
\n\n密码的长度必须为 6 到 72 个字符，并满足以下 4 个复杂性要求中的 3 个要求：\n\n*   具有小写字符\n*   具有大写字符\n*   具有数字\n*   具有特殊字符（正则表达式匹配 [\W_]）\n\n不允许使用以下密码：\n\nabc@123P@$$w0rdP@ssw0rdP@ssword123Pa$$wordpass@word1Password!Password1Password22iloveyou!\n,创建 VM 时，密码有什么要求？,linux,https://docs.azure.cn/virtual-machines/linux/faq
是的。 资源组名称的最大长度为 90 个字符。 有关资源组的详细信息，请参阅[命名约定规则和限制](https://docs.microsoft.com/azure/architecture/best-practices/naming-conventions#naming-rules-and-restrictions?toc=/virtual-machines/linux/toc.json),是否存在资源组名称要求？,linux,https://docs.azure.cn/virtual-machines/linux/faq
是的。 计算机名称的最大长度为 64 个字符。 有关命名资源的详细信息，请参阅[命名约定规则和限制](https://docs.microsoft.com/azure/architecture/best-practices/naming-conventions#naming-rules-and-restrictions?toc=/virtual-machines/linux/toc.json),是否有任何计算机名称要求？,linux,https://docs.azure.cn/virtual-machines/linux/faq
是的。 有关说明，请参阅[如何在 Resource Manager 部署模型中创建 Linux 虚拟机的副本](https://docs.azure.cn/virtual-machines/linux/copy-vm?toc=/virtual-machines/linux/toc.json),我是否可以复制或克隆现有的 Azure VM？,linux,https://docs.azure.cn/virtual-machines/linux/faq
\n\n用户名的长度必须为 1 到 64 个字符。\n\n不允许使用以下用户名：\nadministrator  admin  user  user1test  user2  test1  user3admin1  1  123  aactuser  adm  admin2  aspnetbackup  console  david  guestjohn  owner  root  serversql  support  support_388945a0  systest2  test3  user4  user5,创建 VM 时，用户名有什么要求？,linux,https://docs.azure.cn/virtual-machines/linux/faq
\n\n使用安全外壳 (SSH) 建立远程连接，登录到虚拟机。 请参阅如何[从 Windows](https://docs.azure.cn/virtual-machines/linux/ssh-from-windows?toc=/virtual-machines/linux/toc.json) 或[从 Linux 和 Mac](https://docs.azure.cn/virtual-machines/linux/mac-create-ssh-keys?toc=/virtual-machines/linux/toc.json) 进行连接的相关说明。 默认情况下，SSH 允许的并发连接最多为 10 个。 通过编辑配置文件，可以增加此数量。\n\n如果遇到问题，请查阅[排查安全外壳 (SSH) 连接问题](https://docs.azure.cn/virtual-machines/linux/troubleshoot-ssh-connection?toc=/virtual-machines/linux/toc.json)\n,如何访问我的虚拟机？,linux,https://docs.azure.cn/virtual-machines/linux/faq
"\n\n每个数据磁盘的容量高达 4 TB (4,095 GB)。 可以使用的数据磁盘的数目取决于虚拟机的大小。 有关详细信息，请参阅[虚拟机大小](https://docs.azure.cn/virtual-machines/linux/sizes?toc=/virtual-machines/linux/toc.json)。\n\nAzure 托管磁盘是推荐用于 Azure 虚拟机的磁盘存储产品，方便永久存储数据。 可对每个虚拟机使用多个托管磁盘。 托管磁盘提供两种类型的持久存储选项：高级托管磁盘和标准托管磁盘。 有关定价信息，请参阅[托管磁盘定价](https://www.azure.cn/pricing/details/managed-disks/)。\n\nAzure 存储帐户还可为操作系统磁盘和任何数据磁盘提供存储空间。 每个磁盘都是一个 .vhd 文件，以页 blob 形式存储。 有关定价详细信息，请参阅 [Storage Pricing Details](https://www.azure.cn/pricing/details/storage/)（存储定价详细信息）。\n",使用虚拟机时，我可以使用多少存储？,linux,https://docs.azure.cn/virtual-machines/linux/faq
所有订户都可以在 Azure 虚拟机上运行服务器软件。 有关详细信息，请参阅 [Azure 认可的分发版本中的 Linux](https://docs.azure.cn/virtual-machines/linux/endorsed-distros?toc=/virtual-machines/linux/toc.json),我可以在 Azure VM 上运行什么程序？,linux,https://docs.azure.cn/virtual-machines/linux/faq
不要使用临时磁盘 (/dev/sdb1) 存储数据。 它只是用于临时存储。 有丢失无法恢复的数据的风险。,我是否可以使用临时磁盘 (/dev/sdb1) 存储数据？,linux,https://docs.azure.cn/virtual-machines/linux/faq
"\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以收缩或缩小托管磁盘？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否仍支持非托管磁盘？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以创建托管磁盘副本？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可将托管磁盘复制或导出到专用存储帐户？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",托管磁盘支持哪类基于角色的访问控制？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",如何设置用于诊断的标准存储帐户？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",什么是使用托管磁盘的可用性集的支持容错域计数？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以创建一个空托管磁盘？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",托管磁盘是否是 Azure 门户中的默认选项？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以创建托管磁盘的增量快照？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",客户使用托管磁盘是否存在任何规模限制？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n是的。 可使用 Azure 门户、PowerShell 或 Azure CLI 导出托管磁盘。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？\n\n不可以。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可将托管磁盘复制或导出到专用存储帐户？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n是的。 可以使用 Azure 门户、PowerShell 或 Azure CLI 更改托管磁盘的存储帐户类型。\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n是的。 可使用 Azure 门户、PowerShell 或 Azure CLI 导出托管磁盘。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？\n\n不可以。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以更改托管磁盘的存储帐户类型（标准或高级）？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n高级托管磁盘的定价与高级非托管磁盘的定价相同。\n\n是否可以更改托管磁盘的存储帐户类型（标准或高级）？\n\n是的。 可以使用 Azure 门户、PowerShell 或 Azure CLI 更改托管磁盘的存储帐户类型。\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n是的。 可使用 Azure 门户、PowerShell 或 Azure CLI 导出托管磁盘。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？\n\n不可以。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",高级托管磁盘与非托管磁盘的定价有何不同？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n我们根据磁盘的预配容量收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n高级托管磁盘与非托管磁盘的定价有何不同？\n\n高级托管磁盘的定价与高级非托管磁盘的定价相同。\n\n是否可以更改托管磁盘的存储帐户类型（标准或高级）？\n\n是的。 可以使用 Azure 门户、PowerShell 或 Azure CLI 更改托管磁盘的存储帐户类型。\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n是的。 可使用 Azure 门户、PowerShell 或 Azure CLI 导出托管磁盘。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？\n\n不可以。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",对于标准托管磁盘，是对磁盘上的数据实际大小收费还是对磁盘的预配容量收费？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n是的。 我们针对每个事务进行收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n对于标准托管磁盘，是对磁盘上的数据实际大小收费还是对磁盘的预配容量收费？\n\n我们根据磁盘的预配容量收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n高级托管磁盘与非托管磁盘的定价有何不同？\n\n高级托管磁盘的定价与高级非托管磁盘的定价相同。\n\n是否可以更改托管磁盘的存储帐户类型（标准或高级）？\n\n是的。 可以使用 Azure 门户、PowerShell 或 Azure CLI 更改托管磁盘的存储帐户类型。\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n是的。 可使用 Azure 门户、PowerShell 或 Azure CLI 导出托管磁盘。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？\n\n不可以。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",标准托管磁盘是否产生任何事务成本？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n从 80 GB VHD 创建的标准托管磁盘被视为下一个可用的标准磁盘大小（S10 磁盘）。 我们按 S10 磁盘定价收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n标准托管磁盘是否产生任何事务成本？\n\n是的。 我们针对每个事务进行收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n对于标准托管磁盘，是对磁盘上的数据实际大小收费还是对磁盘的预配容量收费？\n\n我们根据磁盘的预配容量收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n高级托管磁盘与非托管磁盘的定价有何不同？\n\n高级托管磁盘的定价与高级非托管磁盘的定价相同。\n\n是否可以更改托管磁盘的存储帐户类型（标准或高级）？\n\n是的。 可以使用 Azure 门户、PowerShell 或 Azure CLI 更改托管磁盘的存储帐户类型。\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n是的。 可使用 Azure 门户、PowerShell 或 Azure CLI 导出托管磁盘。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？\n\n不可以。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",如果从现有的 VHD（80 GB）创建标准托管磁盘，需要多少费用？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n托管磁盘是一种通过处理存储帐户管理来简化 Azure IaaS VM 的磁盘管理的功能。 有关详细信息，请参阅[托管磁盘概述](https://docs.azure.cn/virtual-machines/windows/managed-disks-overview)。\n\n如果从现有的 VHD（80 GB）创建标准托管磁盘，需要多少费用？\n\n从 80 GB VHD 创建的标准托管磁盘被视为下一个可用的标准磁盘大小（S10 磁盘）。 我们按 S10 磁盘定价收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n标准托管磁盘是否产生任何事务成本？\n\n是的。 我们针对每个事务进行收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n对于标准托管磁盘，是对磁盘上的数据实际大小收费还是对磁盘的预配容量收费？\n\n我们根据磁盘的预配容量收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n高级托管磁盘与非托管磁盘的定价有何不同？\n\n高级托管磁盘的定价与高级非托管磁盘的定价相同。\n\n是否可以更改托管磁盘的存储帐户类型（标准或高级）？\n\n是的。 可以使用 Azure 门户、PowerShell 或 Azure CLI 更改托管磁盘的存储帐户类型。\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n是的。 可使用 Azure 门户、PowerShell 或 Azure CLI 导出托管磁盘。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？\n\n不可以。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",什么是 Azure 托管磁盘？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",可用性集中的 VM 是否可以同时包含托管和非托管磁盘？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n,是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。,如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n,如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n,非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",支持的最大页 blob 大小是多少？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",操作系统和数据磁盘支持的最大磁盘大小是多少？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",在高级磁盘上使用 TRIM 是否有任何影响？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",托管磁盘 VM 是否支持本地 SSD？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否会同时加密从托管磁盘或快照导出的 VHD？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",使用高级存储时是否存在事务成本？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",托管快照和映像是否加密？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",创建托管磁盘时，是否会默认启用 Azure 存储服务加密？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以为托管磁盘禁用存储服务加密？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",存储服务加密是否仅适用于特定区域？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",如何确定托管磁盘是否已加密？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
"\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",加密密钥由谁管理？,linux,https://docs.azure.cn/virtual-machines/linux/faq-for-disks
\n\n[关于 Azure 虚拟机](https://docs.azure.cn/virtual-machines/virtual-machines-linux-about)\n\n[创建 Linux 虚拟机的不同方式](https://docs.azure.cn/virtual-machines/linux/creation-choices?toc=/virtual-machines/linux/toc.json)\n\n[创建 Windows 虚拟机的不同方式](https://docs.azure.cn/virtual-machines/windows/creation-choices?toc=/virtual-machines/windows/toc.json)\n,其他资源,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
在 Windows 虚拟机中，可以通过移动页面文件和重新分配驱动器号更改驱动器号，但需要确保按特定顺序执行这些步骤。 有关说明，请参阅[更改 Windows 临时磁盘的驱动器号](https://docs.azure.cn/virtual-machines/windows/change-drive-letter?toc=/virtual-machines/windows/classic/toc.json),如何更改临时磁盘的驱动器号？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
\n\n在进行 Azure 数据中心定期计划内维护更新时，Azure 有时会重新启动 VM。\n\n当 Azure 检测到影响 VM 的严重硬件问题时，可能会发生计划外维护事件。 对于计划外事件，Azure 自动将 VM 迁移到正常运行的主机，并重新启动 VM。\n\n对于任何独立的 VM（表示该 VM 不属于可用性集），Azure 在进行计划内维护前提前至少 1 周向订阅服务管理员发送电子邮件通知，因为在更新期间各个 VM 可能会重新启动。 在 VM 上运行的应用程序可能会遭遇停机。\n\n因计划内维护而重新启动时，你还可以使用 Azure 经典管理门户或 Azure PowerShell 查看重新启动日志。 有关详细信息，请参阅 [Viewing VM Reboot Logs](https://azure.microsoft.com/blog/2015/04/01/viewing-vm-reboot-logs/)（查看 VM 重新启动日志）。\n\n若要提供冗余，可将两个或多个采用类似配置的 VM 放到同一个可用性集中。 这可以确保在计划内或计划外维护期间至少有一个 VM 可用。 对于此配置，Azure 可以保证某些级别的 VM 可用性。 有关详细信息，请参阅[管理虚拟机的可用性](https://docs.azure.cn/virtual-machines/windows/manage-availability?toc=/virtual-machines/windows/toc.json)\n,Azure 是否会重新启动 VM 进行维护？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
"\n\nAzure 根据 VM 的大小和操作系统按小时进行收费。 对于不足一小时的部分，Azure 将仅根据使用的分钟数计费。 如果使用包含特定预安装软件的 VM 映像创建 VM，则还会按小时收取额外软件费用。 对于 VM 的操作系统和数据磁盘，Azure 单独收取存储费用。 临时磁盘存储免费。\n\n当 VM 状态为""正在运行""或""已停止""时计费，但是当 VM 状态为""已停止""（""已释放""）时不计费。 若要将 VM 置于""已停止""（""已释放""）状态，请执行以下操作之一：\n\n*   从 Azure 经典管理门户关闭或删除该 VM。\n*   使用 Azure PowerShell 模块中提供的 Stop-AzureVM cmdlet。\n*   使用服务管理 REST API 中的关闭角色操作，并为 PostShutdownAction 元素指定 StoppedDeallocated。\n\n有关更多详细信息，请参阅[虚拟机定价](https://www.azure.cn/pricing/details/virtual-machines/)\n",Azure 如何为 VM 收费？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
\n\n在某些区域，可将 Azure 备份用作预览。 有关详细信息，请参阅[备份 Azure 虚拟机](https://docs.azure.cn/backup/backup-azure-vms)。 认证合作伙伴提供了其他解决方案。 若要了解当前提供的内容，请搜索 Azure 应用商店。\n\n另一个选项是使用 blob 存储的快照功能。 为此，需要在进行任何依赖 blob 快照的操作前关闭 VM。 这会保存挂起的数据写入，并将文件系统保持为一致状态。\n,哪些选项可用于备份和恢复？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
\n\nAzure 针对防病毒解决方案提供多种选项，但需要用户自行管理。 例如，可能需要另外订阅反恶意软件的软件，并需要自行决定运行扫描和安装更新的时间。 你可以在创建 Windows 虚拟机时通过适用于 Microsoft 反恶意软件或 TrendMicro Deep Security Agent 的 VM 扩展来添加防病毒支持，也可以稍后进行。 有关详细信息，请参阅：\n\n*   [如何在 Azure VM 上安装和配置 Trend Micro Deep Security 即服务](https://docs.azure.cn/zh-cn/virtual-machines/windows/classic/install-trend)\n*   [在 Azure 虚拟机上部署反恶意软件解决方案](https://azure.microsoft.com/blog/2014/05/13/deploying-antimalware-solutions-on-azure-virtual-machines/),Azure 能否在虚拟机上运行防病毒软件？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
"\n\nAzure 提供的映像没有预先配置的用户名和密码。 使用其中一个映像创建虚拟机时，需提供用于登录到虚拟机的用户名和密码。\n\n如果忘记用户名或密码且已安装 VM 代理，可以安装并使用 [VMAccess](https://docs.azure.cn/virtual-machines/windows/extensions-features?toc=/virtual-machines/windows/toc.json) 扩展解决该问题。\n\n其他详细信息：\n\n*   对于 Linux 映像，如果你使用 Azure 经典管理门户，系统会提供""azureuser""作为默认用户名，但你可以更改该用户名，只需使用""从库中""而非""快速创建""作为创建虚拟机的方法即可。 使用""从库中""，你可以决定在登录时是使用密码、SSH 密钥还是二者都使用。 用户帐户是非特权用户，但具有运行特权命令所需的""sudo""访问权限。 ""root""帐户已禁用。\n*   对于 Windows 映像，需要在创建 VM 时提供用户名和密码。 该帐户将添加到管理员组。",虚拟机的默认用户名和密码是什么？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
"\n\n术语""升级""通常是指迁移到更新的操作系统版本，同时保留原有硬件。 对于 Azure VM，迁移到更新的 Linux 版本和 Windows 版本是不同过程：\n\n*   对于 Linux VM，可使用适用于发行版的包管理工具和过程。\n*   对于 Windows 虚拟机，需要使用类似 Windows Server 迁移工具的工具迁移服务器。 请勿尝试升级来宾 OS（如果驻留在 Azure 上）。 由于存在失去虚拟机访问权限的风险，因此不支持该功能。 如果在升级过程中出现问题，可能无法启动远程桌面会话，并且无法解决这些问题。\n\n有关 Windows Server 迁移工具和过程的一般详细信息，请参阅[将角色和功能迁移到 Windows Server](https://technet.microsoft.com/library/jj134039.aspx)\n",如何升级来宾操作系统？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
不得使用临时磁盘（Windows 默认的 D: 盘或 Linux 的 /dev/sdb1）存储数据。 这些磁盘只是临时存储空间，因此存在丢失数据且无法恢复数据的风险。 将虚拟机迁移到其他主机时，可能会发生这种情况。 调整虚拟机大小，更新主机和主机硬件故障都是需要迁移动虚拟机的原因。,是否可以使用临时磁盘（Windows 的 D: 盘或 Linux 的 /dev/sdb1）存储数据？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
\n\n是的。 有关迁移方法的说明，请参阅：\n\n*   [使用 Azure PowerShell 从经典部署迁移到 Azure Resource Manager 部署](https://docs.azure.cn/virtual-machines/windows/migration-classic-resource-manager-ps)。\n*   [使用 Azure CLI 从经典部署迁移到 Azure Resource Manager 部署](https://docs.azure.cn/virtual-machines/virtual-machines-linux-cli-migration-classic-resource-manager)。,是否可以将经典部署模型中创建的 VM 迁移到新的 Resource Manager 模型？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
\n\n对于通过经典部署模型创建的虚拟机，可以使用 Azure 虚拟网络扩展现有的基础结构。 该方法类似于设立分支机构。 可以预配和管理 Azure 中的虚拟专用网 (VPN)，并将其安全连接到本地 IT 基础结构。 有关详细信息，请参阅[虚拟网络概述](https://docs.azure.cn/virtual-network/virtual-networks-overview)。\n\n创建虚拟机时，需要指定虚拟机所属的网络。 不能将现有虚拟机加入虚拟网络。 不过，将虚拟硬盘 (VHD) 与现有虚拟机分离即可解决此问题，然后可以用于创建具有所需网络配置的新虚拟机。\n,这些虚拟机可否使用现有的本地网络基础结构？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
"\n\n在许多方面，它们与""第 1 代""Hyper-V VM 类似，但并非完全相同。 两种类型的虚拟机都提供虚拟化硬件，并且兼容 VHD 格式虚拟硬盘。 这意味着可以在 Hyper-V 与 Azure 之间交换使用它们。 同时存在以下三大区别，有时也会使 Hyper-V 用户感到惊讶：\n\n*   Azure 不提供对虚拟机的控制台访问。 在 VM 完成启动前，无法对其进行访问。\n*   大多数[大小](https://docs.azure.cn/virtual-machines/linux/sizes?toc=/virtual-machines/linux/toc.json)的 Azure VM 只有 1 个虚拟网络适配器，这意味着它们也只能具有 1 个外部 IP 地址。 （A8 和 A9 大小的 VM 可使用第二个网络适配器在实例之间进行应用程序通信，但仅限特定方案。）\n*   Azure VM 不支持第 2 代 Hyper-V VM 功能。 有关这些功能的详细信息，请参阅 [Hyper-V 虚拟机规范](http://technet.microsoft.com/library/dn592184.aspx)和[第 2 代虚拟机概述](https://technet.microsoft.com/library/dn282285.aspx)。",这些虚拟机是否与 Hyper-V 虚拟机相同？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
"\n\nAzure 只支持固定的 VHD 格式的虚拟硬盘。 若要在 Azure 中使用 VHDX，需先使用 Hyper-V 管理器或 [convert-VHD](https://technet.microsoft.com/itpro/powershell/windows/hyper-v/convert-vhd) cmdlet 对其进行转换。 然后，使用 [Add-AzureVHD](https://msdn.microsoft.com/library/azure/dn495173.aspx) cmdlet（在""服务管理""模式下）将 VHD 上传到 Azure 的存储帐户，用于虚拟机。\n\n*   有关 Linux 说明，请参阅[创建并上传包含 Linux 操作系统的虚拟硬盘](https://docs.azure.cn/virtual-machines/linux/classic/create-upload-vhd?toc=/virtual-machines/linux/classic/toc.json)。\n*   有关 Windows 说明，请参阅[创建 Windows Server VHD 并将其上传到 Azure](https://docs.azure.cn/virtual-machines/windows/classic/createupload-vhd?toc=/virtual-machines/windows/classic/toc.json)。",可以使用哪些虚拟硬盘类型？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
\n\n每个数据磁盘的容量高达 1 TB。 可以使用的数据磁盘数取决于虚拟机大小。 有关详细信息，请参阅[虚拟机大小](https://docs.azure.cn/virtual-machines/linux/sizes?toc=/virtual-machines/linux/toc.json)。\n\nAzure 存储帐户可为操作系统磁盘和任何数据磁盘提供存储空间。 每个磁盘都是一个 .vhd 文件，以页 blob 形式存储。 有关定价详细信息，请参阅 [Storage Pricing Details](https://www.azure.cn/pricing/details/storage/blob/)（存储定价详细信息）。\n,使用虚拟机时，我可以使用多少存储？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
\n\n地缘组是一个旧概念，指的是在 Azure 中客户的云服务部署和存储帐户的地理分组。 在早期的 Azure 网络设计中，它们最初用于改进 VM 到 VM 的网络性能。 它们还支持仅限于使用一个区域中的一小部分硬件的虚拟网络 (VNet) 的初始版本。\n\n当前一个区域内的 Azure 网络已被设计为不再需要地缘组。 虚拟网络也在区域范围内，因此使用虚拟网络时不再需要地缘组。 由于这些改进，我们不再建议客户使用地缘组，因为在某些情况下它们可能存在一些限制。 使用地缘组将不必要地将 VM 和特定的硬件相关联，这样限制了可供你选择的 VM 大小。 当与地缘组相关联的特定硬件接近容量上限时，如果尝试添加新的 VM，还可能导致与容量相关的错误。\n\nAzure Resource Manager 部署模型和 Azure 门户已弃用地缘组功能。 对于 Azure 经典管理门户，我们将禁止支持创建地缘组以及创建固定到地缘组的存储资源。 你无需修改现有的使用地缘组的云服务。 但是，你不能在新的云服务中使用地缘组，除非 Azure 支持专业人员建议使用它们。\n,为什么要弃用地缘组？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
\n\n所有订户都可以在 Azure 虚拟机上运行服务器软件。 可以运行最新版本的 Windows Server 和各种 Linux 发行版。 有关支持详细信息，请参阅：\n\n• 对于Windows VM - [Microsoft 服务器软件对 Azure 虚拟机的支持](https://support.microsoft.com/help/2721672/microsoft-server-software-support-for-microsoft-azure-virtual-machines)\n\n• 对于 Linux VM - [Azure 认可的分发中的 Linux](https://docs.azure.cn/zh-cn/virtual-machines/linux/endorsed-distros)\n,我可以在 Azure VM 上运行什么程序？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
"\n\n需要通过适用于 Windows VM 的远程桌面连接或适用于 Linux VM 的安全外壳 (SSH) 建立登录虚拟机所需的远程连接。 有关说明，请参阅：\n\n*   [如何登录到运行 Windows Server 的虚拟机](https://docs.azure.cn/virtual-machines/windows/classic/connect-logon?toc=/virtual-machines/windows/classic/toc.json)。 除非将服务器配置为远程桌面服务会话主机，否则最多支持 2 个并发连接。 \n*   [如何登录到运行 Linux 的虚拟机](https://docs.azure.cn/virtual-machines/linux/mac-create-ssh-keys?toc=/virtual-machines/linux/toc.json)。 默认情况下，SSH 最多允许 10 个并发连接。 通过编辑配置文件，可以增加此数量。\n\n如果在使用远程桌面或 SSH 时遇到问题，请安装并使用 [VMAccess](https://docs.azure.cn/virtual-machines/windows/extensions-features?toc=/virtual-machines/windows/toc.json) 扩展帮助解决问题。\n\nWindows VM 的其他选项包括：\n\n*   在 Azure 经典管理门户中找到 VM，然后单击命令栏中的""重置远程访问""。\n*   查看[对基于 Windows 的 Azure 虚拟机的远程桌面连接进行故障排除](https://docs.azure.cn/virtual-machines/windows/troubleshoot-rdp-connection?toc=/virtual-machines/windows/toc.json)。\n*   使用 Windows PowerShell 远程连接到 VM，或创建其他终结点以方便其他资源连接到 VM。 有关详细信息，请参阅[如何设置虚拟机的终结点](https://docs.azure.cn/virtual-machines/windows/classic/setup-endpoints?toc=/virtual-machines/windows/classic/toc.json)。\n\n如果熟悉 Hyper-V，可以查找与 VMConnect 类似的工具。 Azure 不提供类似工具，因为不支持通过控制台访问虚拟机。\n",如何访问虚拟机？,classic,https://docs.azure.cn/virtual-machines/windows/classic/faq
可以。 有关说明，请参阅 [How to expand the OS drive of a Virtual Machine in an Azure Resource Group](https://docs.azure.cn/virtual-machines/windows/expand-os-disk?toc=/virtual-machines/windows/toc.json)（如何扩展 Azure 资源组中虚拟机的 OS 驱动器）。,可否调整 OS 磁盘的大小？,windows,https://docs.azure.cn/virtual-machines/windows/faq
是的。 借助托管映像，可创建虚拟机的映像，然后使用该映像生成多个新的 VM。 有关说明，请参阅[创建 VM 的自定义映像](https://docs.azure.cn/virtual-machines/windows/tutorial-custom-images),可否复制或克隆现有的 Azure VM？,windows,https://docs.azure.cn/virtual-machines/windows/faq
不可以。如果希望 VM 成为可用性集的一部分，需要在该集内创建 VM。 目前不支持在创建 VM 之后再将其添加到可用性集。,我是否可以将现有 VM 添加到可用性集？,windows,https://docs.azure.cn/virtual-machines/windows/faq
是的。 有关说明，请参阅[将本地 VM 迁移到 Azure](https://docs.azure.cn/virtual-machines/windows/on-prem-to-azure),我是否可以将虚拟机上传到 Azure？,windows,https://docs.azure.cn/virtual-machines/windows/faq
可以通过移动页面文件和重新分配驱动器号来更改驱动器号，但需确保按特定顺序执行这些步骤。 有关说明，请参阅[更改 Windows 临时磁盘的驱动器号](https://docs.azure.cn/virtual-machines/windows/change-drive-letter?toc=/virtual-machines/windows/classic/toc.json),如何更改临时磁盘的驱动器号？,windows,https://docs.azure.cn/virtual-machines/windows/faq
可以。 计算机名称的最大长度为 15 个字符。 有关命名资源的详细信息，请参阅[命名约定规则和限制](https://docs.microsoft.com/azure/architecture/best-practices/naming-conventions#naming-rules-and-restrictions?toc=/virtual-machines/windows/toc.json),是否有任何计算机名称要求？,windows,https://docs.azure.cn/virtual-machines/windows/faq
\n\n使用适用于 Windows VM 的远程桌面连接 (RDP) 建立远程连接。 有关说明，请参阅[如何连接并登录到运行 Windows 的 Azure 虚拟机](https://docs.azure.cn/virtual-machines/windows/connect-logon?toc=/virtual-machines/windows/toc.json)。 除非将服务器配置为远程桌面服务会话主机，否则最多支持两个并发连接。 \n\n如果在使用远程桌面时遇到问题，请参阅[排查连接到基于 Windows 的 Azure 虚拟机时的远程桌面连接问题](https://docs.azure.cn/virtual-machines/windows/troubleshoot-rdp-connection?toc=/virtual-machines/windows/toc.json)。 \n\n如果熟悉 Hyper-V，可以查找与 VMConnect 类似的工具。 Azure 不提供类似工具，因为不支持通过控制台访问虚拟机。\n,如何访问我的虚拟机？,windows,https://docs.azure.cn/virtual-machines/windows/faq
"\n\n每个数据磁盘的容量高达 4 TB (4,095 GB)。 可以使用的数据磁盘的数目取决于虚拟机的大小。 有关详细信息，请参阅[虚拟机大小](https://docs.azure.cn/virtual-machines/windows/sizes?toc=/virtual-machines/windows/toc.json)。\n\nAzure 托管磁盘是推荐用于 Azure 虚拟机的磁盘存储产品，方便永久存储数据。 可对每个虚拟机使用多个托管磁盘。 托管磁盘提供两种类型的持久存储选项：高级托管磁盘和标准托管磁盘。\n\nAzure 存储帐户还可为操作系统磁盘和任何数据磁盘提供存储空间。 每个磁盘都是一个 .vhd 文件，以页 blob 形式存储。 有关定价详细信息，请参阅 [Storage Pricing Details](https://www.azure.cn/pricing/details/storage/)（存储定价详细信息）。\n",使用虚拟机时，我可以使用多少存储？,windows,https://docs.azure.cn/virtual-machines/windows/faq
能，目前可行。 首先需停止解除分配 VM。 然后便可添加或删除 NIC（除非它是 VM 上的最后一个 NIC）。,创建 VM 后能否向 VM 添加 NIC？,windows,https://docs.azure.cn/virtual-machines/windows/faq
针对现有 Azure 订阅创建的虚拟机不会自动注册到加拿大中部和加拿大东部这两个新区域。 通过 Azure 门户使用 Azure Resource Manager 将虚拟机部署到其他任何区域时，将自动完成此注册。 将虚拟机部署到其他任何 Azure 区域后，新区域可供后续虚拟机使用。,为什么在 Azure Resource Manager 中看不到加拿大中部和加拿大东部区域？,windows,https://docs.azure.cn/virtual-machines/windows/faq
\n\n不要使用临时磁盘来存储数据。 它只是临时存储空间，因此存在丢失数据且数据不能恢复的风险。 将虚拟机移到另一主机时，可能会发生数据丢失的情况。 调整虚拟机大小、更新主机、主机硬件故障等都是需要移动虚拟机的原因。\n\n如果有应用程序需要使用 D: 驱动器号，可以重新分配驱动器号以便临时磁盘使用除 D: 以外的位置。 有关说明，请参阅[更改 Windows 临时磁盘的驱动器号](https://docs.azure.cn/virtual-machines/windows/change-drive-letter?toc=/virtual-machines/windows/classic/toc.json)\n,我是否可以使用临时磁盘（默认为 D: 驱动器）存储数据？,windows,https://docs.azure.cn/virtual-machines/windows/faq
可以。 若要快速创建 Linux VM 进行试用，请参阅[使用门户在 Azure 上创建 Linux VM](https://docs.azure.cn/virtual-machines/linux/quick-create-portal),Azure 可否支持 Linux VM？,windows,https://docs.azure.cn/virtual-machines/windows/faq
所有订户都可以在 Azure 虚拟机上运行服务器软件。 有关在 Azure 中运行 Microsoft 服务器软件的支持策略的信息，请参阅 [Microsoft server software support for Azure Virtual Machines](https://support.microsoft.com/kb/2721672)（对 Azure 虚拟机中的 Microsoft 服务器软件的支持）,可以在 Azure VM 上运行哪些程序？,windows,https://docs.azure.cn/virtual-machines/windows/faq
是的。 资源组名称的最大长度为 90 个字符。 有关资源组的详细信息，请参阅[命名约定规则和限制](https://docs.microsoft.com/azure/architecture/best-practices/naming-conventions#naming-rules-and-restrictions?toc=/virtual-machines/windows/toc.json),是否存在资源组名称要求？,windows,https://docs.azure.cn/virtual-machines/windows/faq
"\n\n用户名最长为 20 个字符，不能以句点（"".""）结尾。 \n\n不允许使用以下用户名： administrator  admin  user  user1test  user2  test1  user3admin1  1  123  aactuser  adm  admin2  aspnetbackup  console  david  guestjohn  owner  root  serversql  support  support_388945a0  systest2  test3  user4  user5\n",创建 VM 时，用户名有什么要求？,windows,https://docs.azure.cn/virtual-machines/windows/faq
\n\n密码的长度必须为 12 到 123 个字符，并满足以下 4 个复杂性要求中的 3 个要求：\n\n*   具有小写字符\n*   具有大写字符\n*   具有数字\n*   具有特殊字符（正则表达式匹配 [\W_]）\n\n不允许使用以下密码：\n\nabc@123 P@$$w0rd P@ssw0rd P@ssword123 Pa$$word pass@word1 Password! Password1 Password22 iloveyou! \n,创建 VM 时，密码有什么要求？,windows,https://docs.azure.cn/virtual-machines/windows/faq
\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n,如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以收缩或缩小托管磁盘？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否仍支持非托管磁盘？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以创建托管磁盘副本？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可将托管磁盘复制或导出到专用存储帐户？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",托管磁盘支持哪类基于角色的访问控制？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",如何设置用于诊断的标准存储帐户？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",什么是使用托管磁盘的可用性集的支持容错域计数？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n,非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",托管磁盘是否是 Azure 门户中的默认选项？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以创建托管磁盘的增量快照？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",客户使用托管磁盘是否存在任何规模限制？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n是的。 可使用 Azure 门户、PowerShell 或 Azure CLI 导出托管磁盘。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？\n\n不可以。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可将托管磁盘复制或导出到专用存储帐户？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n是的。 可以使用 Azure 门户、PowerShell 或 Azure CLI 更改托管磁盘的存储帐户类型。\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n是的。 可使用 Azure 门户、PowerShell 或 Azure CLI 导出托管磁盘。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？\n\n不可以。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以更改托管磁盘的存储帐户类型（标准或高级）？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n高级托管磁盘的定价与高级非托管磁盘的定价相同。\n\n是否可以更改托管磁盘的存储帐户类型（标准或高级）？\n\n是的。 可以使用 Azure 门户、PowerShell 或 Azure CLI 更改托管磁盘的存储帐户类型。\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n是的。 可使用 Azure 门户、PowerShell 或 Azure CLI 导出托管磁盘。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？\n\n不可以。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",高级托管磁盘与非托管磁盘的定价有何不同？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n我们根据磁盘的预配容量收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n高级托管磁盘与非托管磁盘的定价有何不同？\n\n高级托管磁盘的定价与高级非托管磁盘的定价相同。\n\n是否可以更改托管磁盘的存储帐户类型（标准或高级）？\n\n是的。 可以使用 Azure 门户、PowerShell 或 Azure CLI 更改托管磁盘的存储帐户类型。\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n是的。 可使用 Azure 门户、PowerShell 或 Azure CLI 导出托管磁盘。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？\n\n不可以。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",对于标准托管磁盘，是对磁盘上的数据实际大小收费还是对磁盘的预配容量收费？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n是的。 我们针对每个事务进行收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n对于标准托管磁盘，是对磁盘上的数据实际大小收费还是对磁盘的预配容量收费？\n\n我们根据磁盘的预配容量收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n高级托管磁盘与非托管磁盘的定价有何不同？\n\n高级托管磁盘的定价与高级非托管磁盘的定价相同。\n\n是否可以更改托管磁盘的存储帐户类型（标准或高级）？\n\n是的。 可以使用 Azure 门户、PowerShell 或 Azure CLI 更改托管磁盘的存储帐户类型。\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n是的。 可使用 Azure 门户、PowerShell 或 Azure CLI 导出托管磁盘。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？\n\n不可以。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",标准托管磁盘是否产生任何事务成本？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n从 80 GB VHD 创建的标准托管磁盘被视为下一个可用的标准磁盘大小（S10 磁盘）。 我们按 S10 磁盘定价收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n标准托管磁盘是否产生任何事务成本？\n\n是的。 我们针对每个事务进行收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n对于标准托管磁盘，是对磁盘上的数据实际大小收费还是对磁盘的预配容量收费？\n\n我们根据磁盘的预配容量收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n高级托管磁盘与非托管磁盘的定价有何不同？\n\n高级托管磁盘的定价与高级非托管磁盘的定价相同。\n\n是否可以更改托管磁盘的存储帐户类型（标准或高级）？\n\n是的。 可以使用 Azure 门户、PowerShell 或 Azure CLI 更改托管磁盘的存储帐户类型。\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n是的。 可使用 Azure 门户、PowerShell 或 Azure CLI 导出托管磁盘。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？\n\n不可以。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",如果从现有的 VHD（80 GB）创建标准托管磁盘，需要多少费用？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n托管磁盘是一种通过处理存储帐户管理来简化 Azure IaaS VM 的磁盘管理的功能。 有关详细信息，请参阅[托管磁盘概述](https://docs.azure.cn/virtual-machines/windows/managed-disks-overview)。\n\n如果从现有的 VHD（80 GB）创建标准托管磁盘，需要多少费用？\n\n从 80 GB VHD 创建的标准托管磁盘被视为下一个可用的标准磁盘大小（S10 磁盘）。 我们按 S10 磁盘定价收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n标准托管磁盘是否产生任何事务成本？\n\n是的。 我们针对每个事务进行收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n对于标准托管磁盘，是对磁盘上的数据实际大小收费还是对磁盘的预配容量收费？\n\n我们根据磁盘的预配容量收费。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n高级托管磁盘与非托管磁盘的定价有何不同？\n\n高级托管磁盘的定价与高级非托管磁盘的定价相同。\n\n是否可以更改托管磁盘的存储帐户类型（标准或高级）？\n\n是的。 可以使用 Azure 门户、PowerShell 或 Azure CLI 更改托管磁盘的存储帐户类型。\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n是的。 可使用 Azure 门户、PowerShell 或 Azure CLI 导出托管磁盘。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件以不同的订阅创建托管磁盘？\n\n不可以。\n\n是否可以使用 Azure 存储帐户中的 VHD 文件在不同的区域中创建托管磁盘？\n\n不可以。\n\n客户使用托管磁盘是否存在任何规模限制？\n\n托管磁盘取消了与存储帐户相关的限制。 但是，每个订阅的托管磁盘数默认限制为 2,000 个。 可以致电支持人员增加此限制数。\n\n是否可以创建托管磁盘的增量快照？\n\n不可以。 当前的快照功能可提供托管磁盘的完整副本。 但我们计划在将来支持增量快照。\n\n可用性集中的 VM 是否可以同时包含托管和非托管磁盘？\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",什么是 Azure 托管磁盘？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n不可以。 可用性集中的 VM 必须全部使用托管磁盘或全部使用非托管磁盘。 创建可用性集时，可以选择要使用的磁盘类型。\n\n托管磁盘是否是 Azure 门户中的默认选项？\n\n目前不是，但将来会成为默认选项。\n\n是否可以创建一个空托管磁盘？\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",可用性集中的 VM 是否可以同时包含托管和非托管磁盘？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n是的。 可创建空磁盘。 可独立于 VM 创建托管磁盘，例如，不需要将磁盘附加到 VM。\n\n什么是使用托管磁盘的可用性集的支持容错域计数？\n\n使用托管磁盘的可用性集的支持容错域计数为 2 或 3，具体取决于它所在的区域。\n\n如何设置用于诊断的标准存储帐户？\n\n设置 VM 诊断的专用存储帐户。 我们计划将来也将诊断切换到托管磁盘。\n\n托管磁盘支持哪类基于角色的访问控制？\n\n托管磁盘支持三个密钥默认角色：\n\n*   所有者：可管理所有内容，包括访问权限\n*   参与者：可管理除访问权限以外的所有内容\n*   读者：可查看所有内容，但不能进行更改\n\n是否可将托管磁盘复制或导出到专用存储帐户？\n\n可以为托管磁盘获取只读共享访问签名 URI，使用它将内容复制到专用存储帐户或本地存储。\n\n是否可以创建托管磁盘副本？\n\n客户可以生成托管磁盘的快照，并使用快照创建另一个托管磁盘。\n\n是否仍支持非托管磁盘？\n\n是的。 我们支持非托管磁盘和托管磁盘。 建议对新的工作负荷使用托管磁盘，并将当前的工作负荷迁移到托管磁盘。\n\n如果创建 128 GB 磁盘，然后将大小增加到 130 GB，是否会针对下一磁盘大小 (512 GB) 进行收费？\n\n是的。\n\n是否可以创建本地冗余存储、异地冗余存储和区域冗余存储托管磁盘？\n\nAzure 托管磁盘当前仅支持本地冗余存储托管磁盘。\n\n是否可以收缩或缩小托管磁盘？\n\n不可以。 目前，不支持此功能。 \n\n当使用专用（未使用系统准备工具创建或未通用化）操作系统磁盘预配 VM 时，是否可以更改计算机名称属性？\n\n不可以。 无法更新计算机名称属性。 新 VM 从创建操作系统磁盘时所用的父 VM 继承该属性。 \n\n## 迁移到托管磁盘\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 备份服务配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以创建一个空托管磁盘？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。,如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n是的，备份可以顺利工作。\n\n迁移到托管磁盘之前/之后，需要在现有的 Azure 磁盘加密配置中进行哪些更改？\n\n不需要进行任何更改。 \n\n是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",在迁移之前通过 Azure 备份服务创建的 VM 备份是否可继续工作？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",支持的最大页 blob 大小是多少？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",操作系统和数据磁盘支持的最大磁盘大小是多少？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",在高级磁盘上使用 TRIM 是否有任何影响？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",托管磁盘 VM 是否支持本地 SSD？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",使用高级存储时是否存在事务成本？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否会同时加密从托管磁盘或快照导出的 VHD？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n,是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",托管快照和映像是否加密？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n不能。 可以使用包含非托管磁盘的旧 VMSS 中的映像创建包含托管磁盘的新 VMSS。 \n\n是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否支持将现有 VM 规模集 (VMSS) 从非托管磁盘自动迁移到托管磁盘？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",创建托管磁盘时，是否会默认启用 Azure 存储服务加密？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n不能。 可将页 Blob 快照导出为页 Blob，然后从导出的页 Blob 创建托管磁盘。 \n\n是否可将 Azure Site Recovery 保护的本地计算机故障转移到包含托管磁盘的 VM？\n\n是的，可以选择故障转移到包含托管磁盘的 VM。\n\n迁移是否影响 Azure Site Recovery (ASR) 通过 Azure 到 Azure 复制保护的 Azure VM？\n\n是的。 包含托管磁盘的 VM 不支持 ASR Azure 到 Azure 保护。 2018 日历年末将会支持这种保护。 \n\n是否可以迁移位于存储帐户中现在或以前已加密的 VM 的非托管磁盘迁移到托管磁盘？\n\n是的。\n\n## 托管磁盘和存储服务加密\n\n创建托管磁盘时，是否会默认启用 Azure 存储服务加密？\n\n是的。\n\n加密密钥由谁管理？\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以通过迁移到托管磁盘之前创建的页 Blob 快照创建托管磁盘？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",是否可以为托管磁盘禁用存储服务加密？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",存储服务加密是否仅适用于特定区域？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",如何确定托管磁盘是否已加密？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
"\n\n21 Vianet 管理加密密钥。\n\n是否可以为托管磁盘禁用存储服务加密？\n\n不可以。\n\n存储服务加密是否仅适用于特定区域？\n\n不可以。 它适用于托管磁盘可用的所有区域。 托管磁盘适用于所有公共区域和德国。\n\n如何确定托管磁盘是否已加密？\n\n可以从 Azure 门户、Azure CLI 和 PowerShell 确定托管磁盘的创建时间。 如果时间是在 2017 年 6 月 9 日之后，则磁盘已加密。 \n\n如何对 2017 年 6 月 10 日之前创建的现有磁盘加密？\n\n自 2017 年 6 月 10 日起，写入到现有托管磁盘的新数据会自动加密。 我们还打算对现有数据进行加密，且在后台以异步方式加密。 如果必须立即对现有数据进行加密，请创建磁盘的副本。 将对新磁盘进行加密。\n\n*   [使用 Azure CLI 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-linux-cli-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n*   [使用 PowerShell 复制托管磁盘](https://docs.azure.cn/virtual-machines/scripts/virtual-machines-windows-powershell-sample-copy-managed-disks-to-same-or-different-subscription?toc=/cli/module/toc.json)\n\n托管快照和映像是否加密？\n\n是的。 2017 年 6 月 9 日之后创建的所有托管快照和映像均会自动加密。 \n\n是否可以将 VM 的位于存储帐户且现在或以前已加密的非托管磁盘转换为托管磁盘？\n\n是\n\n是否会同时加密从托管磁盘或快照导出的 VHD？\n\n不可以。 但如果将 VHD 从加密托管磁盘或快照导出到加密存储帐户，则会对其进行加密。 \n\n## 高级磁盘：托管和非托管\n\n如果 VM 使用支持高级存储的大小系列（比如 DSv2），是否可以同时附加高级和标准数据磁盘？ \n\n是的。\n\n是否可以同时将高级和标准数据磁盘附加到不支持高级存储的大小系列，例如 D、Dv2 或 F 系列？\n\n不可以。 只可以将标准数据磁盘附加到不使用支持高级存储的大小系列的 VM。\n\n如果从现有的 VHD (80 GB) 创建高级数据磁盘，需要多少费用？\n\n从 80 GB VHD 创建的高级数据磁盘被视为下一个可用的高级磁盘大小（P10 磁盘）。 我们按 P10 磁盘定价收费。\n\n使用高级存储时是否存在事务成本？\n\n每个磁盘大小都有固定成本，其根据 IOPS 和吞吐量的特定限制进行预配。 其他成本包括出站带宽和快照容量（如果适用）。 有关详细信息，请参阅[定价页](https://www.azure.cn/pricing/details/storage)。\n\n可从磁盘缓存获取的 IOPS 和吞吐量限制是多少？\n\nDS 系列的缓存和本地 SSD 合并限制是每个核心 4,000 IOPS，以及每个核心每秒 33 MB。 \n\n托管磁盘 VM 是否支持本地 SSD？\n\n本地 SSD 是托管磁盘 VM 随附的临时存储。 临时存储不需要额外的成本。 建议不要使用此本地 SSD 来存储应用程序数据，因为这些数据不会永久保存在 Azure Blob 存储中。\n\n在高级磁盘上使用 TRIM 是否有任何影响？\n\n在高级或标准磁盘的 Azure 磁盘上使用 TRIM 没有负面影响。\n\n## 新磁盘大小：托管和非托管\n\n操作系统和数据磁盘支持的最大磁盘大小是多少？\n\nAzure 支持的操作系统磁盘的分区类型是主启动记录 (MBR)。 MBR 格式支持的磁盘最大大小为 2 TB。 Azure 支持的操作系统磁盘的最大大小为 2 TB。 Azure 支持的数据磁盘最大大小为 4 TB。 \n\n支持的最大页 blob 大小是多少？\n\nAzure 支持的最大页 blob 大小是 8 TB (8,191 GB)。 我们不支持将大于 4 TB (4,095 GB) 的页 blob 作为数据或操作系统磁盘附加到 VM。\n\n是否需要使用新版本的 Azure 工具来创建、附加、上传大于 1 TB 的磁盘并重设其大小？\n\n无需升级现有 Azure 工具即可创建、附加大于 1 TB 的磁盘或重设其大小。 若要直接从本地将 VHD 文件作为页 blob 或非托管磁盘上传到到 Azure，需要使用最新工具集：\nAzure 工具支持的版本Azure PowerShell版本号 4.1.0：2017 年 6 月版或更高版本Azure CLI v1版本号 0.10.13：2017 年 5 月版或更高版本AzCopy版本号 6.1.0：2017 年 6 月版或更高版本\n\n即将提供 Azure CLI v2 和 Azure 存储资源管理器支持。 \n\n非托管磁盘或页 blob 是否支持 P4 和 P6 磁盘大小？\n\n不可以。 仅托管磁盘支持 P4 (32 GB) 和 P6 (64 GB) 磁盘大小。 即将提供非托管磁盘和页 blob 支持。\n\n如果在支持较小磁盘（约 2017 年 6 月 15 日）之前创建了小于 64 GB 的高级托管磁盘，将如何计费？\n\n根据 P10 定价层继续对小于 64 GB 的现有高级小磁盘计费。 \n\n如何将小于 64 GB 的高级小磁盘的磁盘层级从 P10 切换到 P4 或 P6？\n\n可以拍摄小磁盘的快照，然后创建磁盘以自动根据预配大小将定价层切换到 P4 或 P6。 \n",加密密钥由谁管理？,windows,https://docs.azure.cn/virtual-machines/windows/faq-for-disks
可以。 可在[如何将 VM 或角色实例移到其他子网](https://docs.azure.cn/virtual-network/virtual-networks-move-vm-role-to-subnet)一文中找到详细信息。,在无需重新部署的情况下，是否可以将 VM 从一个子网移动到 VNet 中的另一个子网？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
\n\n否。 不能为 VNet 指定自定义的 DNS 后缀。\n\n## 连接虚拟机\n\n,是否可以引入我自己的 DNS 后缀？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
是的。 附加到通过 Resource Manager 部署模型部署的 VM 的所有网络接口 (NIC) 必须连接到 VNet。 可以选择性地将通过经典部署模型部署的 VM 连接到 VNet。,是否可以将 VM 部署到 VNet？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
*   专用： 分配到每个 VM 中的每个 NIC。 使用静态或动态方法分配地址。 应该分配 VNet 子网设置中指定的范围内的专用 IP 地址。 将为通过经典部署模型部署的资源分配专用 IP 地址，即使它们未连接到 VNet。 使用动态方法分配的专用 IP 地址将仍分配给某个资源，直到该资源被删除（VM 或云服务部署槽）。 如果 VM 在处于停止（解除分配）状态后重新启动，使用动态方法分配的的专用 IP 地址可能会更改。 使用静态方法分配的专用 IP 地址将仍分配给某个资源，直到该资源被删除。 如果需要确保在删除资源之前，该资源的专用 IP 地址永远不会更改，请使用静态方法分配专用 IP 地址。\n*   公共： 选择性地分配给附加到通过 Azure Resource Manager 部署模型部署的 VM 的 NIC。 可以使用静态或动态分配方法分配地址。 通过经典部署模型部署的所有 VM 和云服务角色实例位于分配有动态公共虚拟 IP (VIP) 地址的云服务中。 可以选择性地将某个公共静态 IP 地址（称为[保留 IP 地址](https://docs.azure.cn/virtual-network/virtual-networks-reserved-public-ip)）分配为 VIP。 可将公共 IP 地址分配给通过经典部署模型部署的单个 VM 或云服务角色实例。 这些地址称为[实例级公共 IP (ILPIP](https://docs.azure.cn/virtual-network/virtual-networks-instance-level-public-ip) 地址，可动态分配。,可向 VM 分配哪些不同类型的 IP 地址？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
不可以。 无法保留专用 IP 地址。 如果某个专用 IP 地址可用，它将由 DHCP 服务器分配给 VM 或角色实例。 该 VM 可能是要将专用 IP 地址分配到的 VM，也可能不是。 但是，可将已创建的 VM 的专用 IP 地址更改为任何可用的专用 IP 地址。,是否可为以后创建的 VM 保留专用 IP 地址？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
视情况而定。 在停止（解除分配）或删除 VM 之前，该 VM 将保留使用动态专用 IP 地址。 只有在删除 VM 之后，才会从中释放静态专用 IP 地址。,VNet 中 VM 的专用 IP 地址是否会变化？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
\n\nAzure 提供的 DNS 是由 Microsoft 提供的多租户 DNS 服务。 Azure 在此服务中注册所有 VM 和云服务角色实例。 此服务通过主机名为相同云服务内包含的 VM 和角色实例提供名称解析，并通过 FQDN 为相同 VNet 中的 VM 和角色实例提供名称解析。 请参阅 [VM 和角色实例的名称解析](https://docs.azure.cn/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances)一文，了解有关 DNS 的详细信息。\n\n\nNote\n\n目前，使用 Azure 提供的 DNS 进行跨租户名称解析时，VNet 中的前 100 个云服务存在限制。 如果使用自己的 DNS 服务器，此限制则不适用。\n,什么是 Azure 提供的 DNS？它是否适用于 VNet？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
可以，但不建议这样做。 如果分配给 Azure VM 中的 NIC 的 IP 地址会发生变化，在 VM 的操作系统中手动更改 NIC 的 IP 地址可能会导致与 VM 断开连接。,是否可以在 VM 操作系统中手动将 IP 地址分配到 NIC？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
"无变化。 IP 地址（公共 VIP、公共和专用）将保留分配给该云服务部署槽或 VM。 仅当停止（解除分配）或删除 VM，或者删除云服务部署槽时，才会释放动态地址。 在 Azure 门户中单击 VM 对应的""停止""按钮会将其状态设置为""已停止(已解除分配)""。 在这种情况下，VM 将会丢失其 IP 地址。",如果在操作系统中停止云服务部署槽或关闭 VM，IP 地址会发生什么情况？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
否。 MAC 地址不能以静态方式配置。,是否可以为我的 VM 配置静态 MAC 地址？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
"\n\n否。 不能将服务移入和移出 VNet。 必须删除并重新部署该服务，以将其移动到另一个 VNet 中。\n\n## ""安全""\n\n",是否可以将服务移入和移出 VNet？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
\n\n可以。 VNet 中部署的所有 VM 和云服务角色实例都可连接到 Internet。\n\n## 连接到 VNet 的 Azure 服务\n\n,是否可以通过 VNet 中的 VM 连接到 Internet？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
\n\n是的。 可以使用 ASE（应用服务环境）在 VNet 中部署 Web 应用。 如果为 VNet 配置了点到站点连接，Web 应用可以安全地连接和访问 Azure VNet 中的资源。 有关详细信息，请参阅以下文章：\n\n*   [将应用与 Azure 虚拟网络进行集成](https://docs.azure.cn/app-service-web/web-sites-integrate-with-vnet)\n*   [将 VNet 集成和混合连接用于 Web 应用](https://docs.azure.cn/app-service-web/web-sites-integrate-with-vnet),是否可以在 VNet 中使用 Azure 应用服务 Web 应用？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
是的。 （可选）可在 VNet 中部署云服务角色实例。 为此，请在服务配置的网络配置部分中指定 VNet 名称和角色/子网映射。 不需要更新任何二进制文件。,是否可以在 VNet 中部署云服务与 Web 和辅助角色 (PaaS)？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
是的。 必须将 VMSS 连接到 VNet。,是否可将虚拟机规模集 (VMSS) 连接到 VNet？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
VNet 相互之间以及与 Azure 基础结构中托管的其他服务之间完全孤立。 VNet 是一条信任边界。,VNet 的安全模型是什么？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
可以。 可向 VNet 中的单个子网和/或附加到 VNet 的 NIC 应用[网络安全组](https://docs.azure.cn/virtual-network/virtual-networks-nsg),是否可以限制入站或出站流量流向与 VNet 连接的资源？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
可以。 可以通过 Azure 应用商店部署许多供应商提供 [防火墙网络虚拟设备](https://azure.microsoft.com/marketplace/?term=firewall),是否可在与 VNet 连接的资源之间实施防火墙？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
\n\n可以。 有关详细信息，请参阅 [Azure 网络安全概述](https://docs.azure.cn/security/security-network-overview)一文。\n\n## API、架构和工具\n\n,是否有介绍如何保护 VNet 的信息？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
是的。 可以在 [Azure Resource Manager](https://msdn.microsoft.com/library/mt163658.aspx) 和[经典（服务管理）](http://go.microsoft.com/fwlink/?LinkId=296833)部署模型中使用适用于 VNet 的 REST API。,是否可以通过代码管理 VNet？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
\n\n可以。 详细了解以下操作：\n\n*   使用 Azure 门户通过 [Azure Resource Manager](https://docs.azure.cn/virtual-network/virtual-networks-create-vnet-arm-pportal) 和[经典](https://docs.azure.cn/virtual-network/virtual-networks-create-vnet-classic-pportal)部署模型部署 VNet。\n*   使用 PowerShell 来管理通过 [Resource Manager](https://docs.microsoft.com/powershell/resourcemanager/azurerm.network/v3.1.0/azurerm.network.md) 和[经典](https://docs.microsoft.com/powershell/module/azure/?view=azuresmps-3.7.0)部署模型部署的 VNet。\n*   使用 [Azure 命令行接口 (CLI)](https://docs.azure.cn/virtual-machines/azure-cli-arm-commands#azure-network-commands-to-manage-network-resources) 来管理通过这两种部署模型部署的 VNet。,是否有 VNet 的工具支持？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
是的。 可以随时更改 VNet 的 DNS 服务器列表。 如果更改 DNS 服务器列表，则需要重新启动 VNet 中的每个 VM，以使其拾取新的 DNS 服务器。,创建网络后是否可以修改 DNS 服务器？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
是的，通过资源管理器和经典部署模型部署的 VM 在被删除之前，其 MAC 地址将保持不变。 以前，如果停止（解除分配）VM，将会释放 MAC 地址，但现在，即使 VM 处于解除分配状态，也会保留其 MAC 地址。,创建 MAC 后，其地址是否在 VM 中保持不变？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
是的。 可以在 VNet 设置中指定 DNS 服务器 IP 地址。 这将作为 VNet 中所有 VM 的默认 DNS 服务器进行应用。,是否可以为 VNet 指定 DNS 服务器？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
是的。 可以基于每个云服务设置 DNS 服务器，以重写默认网络设置。 但是，我们建议使用尽可能多的整个网络的 DNS。,是否可以基于每个 VM/服务重写 DNS 设置？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
\n\n可以。 可使用以下方式将一个 VNet 连接到另一个 VNet：\n\n*   Azure VPN 网关。 有关详细信息，请参阅[配置 VNet 到 VNet 连接](https://docs.azure.cn/vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal)一文。 \n*   VNet 对等互连。 有关详细信息，请参阅 [VNet 对等互连概述](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)一文。\n\n## 名称解析 (DNS)\n\n,是否可以将 VNet 连接到 Azure 中的另一个 VNet？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
使用 [VM 和角色实例的名称解析](https://docs.azure.cn/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances)页上的决策表，可引导用户浏览可用的所有 DNS 选项。,VNet 的 DNS 选项有哪些？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
\n\nAzure 虚拟网络 (VNet) 是你自己的网络在云中的表示形式。 它是对专用于订阅的 Azure 云进行的逻辑隔离。 你可以使用 VNet 设置和管理 Azure 中的虚拟专用网络 (VPN)，或者链接 VNet 与 Azure 中的其他 VNet，或链接你的本地 IT 基础结构，以创建混合或跨界解决方案。 创建的每个 VNet 具有其自身的 CIDR 块，只要 CIDR 块不重叠，即可链接到其他 VNet 和本地网络。 还可以控制 VNet 的 DNS 服务器设置并将 VNet 分离到子网中。\n\n使用 VNet：\n\n*   创建私有云专用的 VNet：有时，不需要对解决方案使用跨界配置。 创建 VNet 时，VNet 中的服务和 VM 可以在云中安全地互相直接通信。 这可以在 VNet 内安全地保存流量，但仍允许为需要 Internet 通信的 VM 和服务配置终结点连接，作为解决方案的一部分。\n*   安全地扩展数据中心：借助 VNet，可以构建传统的站点到站点 (S2S) VPN，以便安全缩放数据中心的容量。 S2S VPN 使用 IPSEC 提供企业 VPN 网关和 Azure 之间的安全连接。\n*   实现混合云方案：利用 VNet 可以灵活支持一系列混合云方案。 可以安全地将基于云的应用程序连接到任何类型的本地系统，例如大型机和 Unix 系统。,Azure 虚拟网络 (VNet) 是什么？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
[虚拟网络概述](https://docs.azure.cn/virtual-network/virtual-networks-overview)一文提供了一份决策表，可帮助你确定最佳的网络设计选项。,如何知道是否需要 VNet？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
请访问[虚拟网络文档](https://docs.azure.cn/zh-cn/virtual-network/)帮助自己入门。 这些内容提供了所有 VNet 功能的概述和部署信息。,如何开始？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
可以。 可以在不使用混合连接的情况下使用 VNet。 如果想要在 Azure 中运行 Microsoft Windows Server Active Directory 域控制器和 SharePoint 场，此功能特别有用。,没有跨界连接的情况下是否可以使用 VNet？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
\n\n可以。 可以通过 Azure 应用商店部署许多供应商提供 [WAN 优化网络虚拟设备](https://azure.microsoft.com/marketplace/?term=wan optimization) 。\n\n## 配置\n\n,是否可以在 VNet 之间或者 VNet 与本地数据中心之间执行 WAN 优化？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
\n\n可以使用以下工具创建或配置 VNet：\n\n*   Azure 门户（用于经典 VNet 和 Resource Manager VNet）。\n*   网络配置文件（netcfg - 仅用于经典 VNet）。 请参阅[使用网络配置文件配置 VNet](https://docs.azure.cn/virtual-network/virtual-networks-using-network-configuration-file) 一文。\n*   PowerShell（用于经典 VNet 和 Resource Manager VNet）。\n*   Azure CLI（用于经典 VNet 和 Resource Manager VNet）。,要使用哪些工具创建 VNet？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
可以。 有关公共 IP 地址范围的详细信息，请参阅[虚拟网络中的公共 IP 地址空间](https://docs.azure.cn/virtual-network/virtual-networks-public-ip-within-vnet)一文。 无法从 Internet 直接访问公共 IP 地址。,我的 VNet 中是否可以有公共 IP 地址？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
有。 子网地址空间不能相互重叠。,VNet 中的子网数量是否有限制？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
可以。 Azure 会保留每个子网中的某些 IP 地址。 子网的第一个和最后一个 IP 地址仅为协议一致性而保留，其他 3 个地址用于 Azure 服务。,使用这些子网中的 IP 地址是否有任何限制？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
支持的最小子网为 /29，最大为 /8（使用 CIDR 子网定义）。,VNet 和子网的最小和最大容量是多少？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
[RFC 1918](http://tools.ietf.org/html/rfc1918)中定义的任何 IP 地址范围。 例如 10.0.0.0/16。,在我的 VNet 中可以使用哪些地址范围？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
是的。 可以使用用户定义路由 (UDR)。 有关 UDR 的详细信息，请访问[用户定义的路由和 IP 转发](https://docs.azure.cn/virtual-network/virtual-networks-udr-overview),是否可以在 VNet 和子网上指定自定义路由策略？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
否。 我们不支持多播或广播。,VNet 是否支持多播或广播？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
可以在 VNet 中使用 TCP、UDP 和 ICMP TCP/IP 协议。 VNet 中会阻止多播、广播、在 IP 里面封装 IP 的数据包以及通用路由封装 (GRE) 数据包。,在 VNet 中可以使用哪些协议？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
否。,是否可以在 VNet 中 ping 默认路由器？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
否。,是否可以使用 tracert 诊断连接？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
是的。 只要子网地址不属于 VNet 中另一个子网的一部分，就能随时将子网添加到 VNet 中。,创建 VNet 后是否可以添加子网？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
可以。 如果子网中未部署任何 VM 或服务，可以添加、删除、扩展或收缩该子网。,创建后是否可以修改子网的大小？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
是的。 可以添加、删除和修改 VNet 使用的 CIDR 块。,创建子网后是否可以对其进行修改？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
是的。 VNet 中部署的所有服务都可以连接到 Internet。 Azure 中部署的每个云服务都具有分配到它的可公开寻址的 VIP。 必须定义 PaaS 角色的输入终结点和虚拟机的终结点，以使这些服务可以接受 Internet 的连接。,如果我在 VNet 中运行服务，是否可以连接到 Internet？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
否。 无法共同使用 IPv6 和 VNet。,VNet 是否支持 IPv6？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
否。 VNet 是第 3 层重叠。 Azure 不支持任何第 2 层语义。,是否可以使用 VNet 将 VLAN 引入 Azure 中？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
否。 一个 VNet 限制为单个区域。,VNet 是否可以跨区域？,virtual network,https://docs.azure.cn/virtual-network/virtual-networks-faq
是，但必须在两个通向同一位置的隧道上配置 BGP。,是否可以使用多站点 VPN 在我的虚拟网络和本地站点之间配置多个隧道？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
能，可以将点到站点 (P2S) VPN 用于连接到多个本地站点的 VPN 网关和其他虚拟网络。,能否将点到站点 VPN 用于具有多个 VPN 隧道的虚拟网络？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n是，系统支持该操作。 有关详细信息，请参阅 [配置可共存的 ExpressRoute 连接和站点到站点 VPN 连接](https://docs.azure.cn/expressroute/expressroute-howto-coexist-classic)。\n\n## IPsec/IKE 策略\n\n,能否将使用 IPsec VPN 的虚拟网络连接到我的 ExpressRoute 线路？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
自定义 IPsec/IKE 策略在 Azure VpnGw1、VpnGw2、VpnGw3、标准 VPN 网关和高性能 VPN 网关上受支持。 不支持基本 SKU。,是否所有 Azure VPN 网关 SKU 都支持自定义 IPsec/IKE 策略？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是的。一旦在连接上指定自定义策略，Azure VPN 网关就会只使用该连接的策略，既充当 IKE 发起方，又充当 IKE 响应方。,自定义策略是否会替换 Azure VPN 网关的默认 IPsec/IKE 策略集？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
"\n\n下表列出了支持的加密算法和密钥强度，客户可自行配置。 必须为每个字段选择一个选项。\nIPsec/IKEv2选项IKEv2 加密AES256、AES192、AES128、DES3、DESIKEv2 完整性SHA384、SHA256、SHA1、MD5DH 组DHGroup24、ECP384、ECP256、DHGroup14 (DHGroup2048)、DHGroup2、DHGroup1、无IPsec 加密GCMAES256、GCMAES192、GCMAES128、AES256、AES192、AES128、DES3、DES、无IPsec 完整性GCMAES256、GCMAES192、GCMAES128、SHA256、SHA1、MD5PFS 组PFS24、ECP384、ECP256、PFS2048、PFS2、PFS1、无QM SA 生存期秒（整数；至少为 300 秒/默认为 27000 秒）KB（整数；至少为 1024 KB/默认为 102400000 KB）流量选择器UsePolicyBasedTrafficSelectors ($True/$False; default $False)\n\nImportant\n\n1.  在 IKE 和 IPsec PFS 中，DHGroup2048 和 PFS2048 与 Diffie-Hellman 组 14 相同。 如需完整的映射，请参阅 [Diffie-Hellman 组](https://docs.azure.cn/vpn-gateway/#DH)。\n2.  对于 GCMAES 算法，必须为 IPsec 加密和完整性指定相同的 GCMAES 算法和密钥长度。\n3.  在 Azure VPN 网关上，IKEv2 主模式 SA 生存期固定为 28,800 秒\n4.  QM SA 生存期是可选参数。 如果未指定，则使用默认值 27,000 秒（7.5 小时）和 102400000 KB (102GB)。\n5.  UsePolicyBasedTrafficSelector 是连接的可选参数。 请参阅下一针对""UsePolicyBasedTrafficSelectors""的常见问题解答项",自定义策略中支持的算法和密钥强度有哪些？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n本地 VPN 设备配置必须匹配，或者必须包含可在 Azure IPsec/IKE 策略中指定的以下算法和参数：\n\n*   IKE 加密算法\n*   IKE 完整性算法\n*   DH 组\n*   IPsec 加密算法\n*   IPsec 完整性算法\n*   PFS 组\n*   流量选择器 (*)\n\nSA 生存期是本地规范，不需匹配。\n\n如果启用 UsePolicyBasedTrafficSelectors，则需确保对于本地网络（本地网关）前缀与 Azure 虚拟网络前缀的所有组合，VPN 设备都定义了与之匹配的流量选择器（而不是任意到任意）。 例如，如果本地网络前缀为 10.1.0.0/16 和 10.2.0.0/16，虚拟网络前缀为 192.168.0.0/16 和 172.16.0.0/16，则需指定以下流量选择器：\n\n*   10.1.0.0/16  192.168.0.0/16\n*   10.1.0.0/16  172.16.0.0/16\n*   10.2.0.0/16  192.168.0.0/16\n*   10.2.0.0/16  172.16.0.0/16\n\n有关详细信息，请参阅[连接多个基于策略的本地 VPN 设备](https://docs.azure.cn/vpn-gateway/vpn-gateway-connect-multiple-policybased-rm-ps)。\n,Azure VPN 网关策略与本地 VPN 设备配置是否需完全匹配？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n下表列出了支持的 Diffie-Hellman 组，分别针对 IKE (DHGroup) 和 IPsec (PFSGroup)：\nDiffie-Hellman 组DHGroupPFSGroup密钥长度1DHGroup1PFS1768 位 MODP2DHGroup2PFS21024 位 MODP14DHGroup14DHGroup2048PFS20482048 位 MODP19ECP256ECP256256 位 ECP20ECP384ECP284384 位 ECP24DHGroup24PFS242048 位 MODP\n\n有关详细信息，请参阅 [RFC3526](https://tools.ietf.org/html/rfc3526) 和 [RFC5114](https://tools.ietf.org/html/rfc5114)。\n,支持哪些 Diffie-Hellman 组？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否，所有 VPN 隧道（包括点到站点 VPN）共享同一 Azure VPN 网关和可用带宽。,使用更多站点到站点 VPN 是否会比为单个虚拟网络获取更多带宽？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
一个给定的连接只能指定一个策略组合。,在一个连接上可以指定多少个策略？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否，默认情况下，Azure 会为不同 VPN 连接生成不同的预共享密钥。 但是，可以使用设置 VPN 网关密钥 REST API 或 PowerShell cmdlet 设置你想要的密钥值。 该密钥必须是长度介于 1 到 128 个字符之间的字母数字字符串。,Azure 会为同一虚拟网络的所有 VPN 连接生成同一 IPsec/IKE 预共享密钥吗？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
不可以。 VNet 到 VNet 通信支持在同一 Azure 实例中连接虚拟网络。 例如，不能在公共 Azure 和中国/德国/美国政府 Azure 实例之间创建连接。 对于上述情形，可考虑使用站点到站点 VPN 连接。,能否在单独的 Azure 实例中使用 VNet 到 VNet 通信来连接虚拟网络？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否。 不能有重叠的 IP 地址范围。,连接的虚拟网络与内部本地站点之间是否可以有重叠的地址空间？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否。 不能有重叠的 IP 地址范围。,VNet 到 VNet 配置是否可以有重叠的地址空间？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
将一个虚拟网络网关配置为主动-主动模式时，支持在一对虚拟网络之间设置冗余隧道。,是否支持冗余隧道？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是的。 虚拟网络的所有 VPN 隧道共享 Azure VPN 网关上的可用带宽，以及 Azure 中的相同 VPN 网关运行时间 SLA。,VPN 隧道是否共享带宽？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否，两台虚拟网络都必须使用基于路由（以前称为动态路由）的 VPN。,是否可以将 RouteBased VPN 类型的 VNet 连接到另一个 PolicyBased VPN 类型的 VNet？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否。 VNet 到 VNet 连接和多站点连接需要 RouteBased（以前称为动态路由）VPN 类型的 Azure VPN 网关。,是否可以为 VNet 到 VNet 或多站点连接使用 PolicyBased VPN 类型？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否。 云服务或负载均衡终结点不能跨虚拟网络，即使它们连接在一起，也是如此。,云服务或负载均衡终结点可否跨 VNet？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否。 VNet 到 VNet 支持连接虚拟网络。 它不支持连接不在虚拟网络中的虚拟机或云服务。,是否可以使用 VNet 到 VNet 连接 VNet 外的 VM 或云服务？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
请参阅[网关要求](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpn-gateway-settings#requirements)表。,一个虚拟网络可以连接到多少个本地站点和虚拟网络？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是的。 虚拟网络连接可与多站点 VPN 同时使用。,能否将 VNet 到 VNet 连接与多站点连接一起使用？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否。连接仍受 IPsec/IKE 保护。 从连接中删除自定义策略以后，Azure VPN 网关会还原为[默认的 IPsec/IKE 提议列表](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpn-devices)，并再次重启与本地 VPN 设备的 IKE 握手。,如果删除自定义 IPsec/IKE 策略，连接是否会变得不受保护？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\nResource Manager 部署模型 是。 有关详细信息，请参阅 [BGP](https://docs.azure.cn/vpn-gateway/#bgp) 部分。\n\n经典部署模型 使用经典部署模型通过 Azure VPN 网关传输流量是可行的，但依赖于网络配置文件中静态定义的地址空间。 使用经典部署模型的 Azure 虚拟网络和 VPN 网关尚不支持 BGP。 没有 BGP，手动定义传输地址空间很容易出错，不建议这样做。\n,能否使用 Azure VPN 网关在我的本地站点之间传输流量或将流量传输到其他虚拟网络？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是的。那样会导致短时中断（数秒），因为 Azure VPN 网关会断开现有连接并重启 IKE 握手，以便使用新的加密算法和参数重建 IPsec 隧道。 请确保也使用匹配的算法和密钥强度对本地 VPN 设备进行配置，尽量减少中断。,添加或更新 IPsec/IKE 策略是否会中断 VPN 连接？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n是的。\n\n请注意，这样会强制所有的 VNet 出口流量流向本地站点，并且会阻止 VNet VM 接受直接来自 Internet 的公共通信，例如从 Internet 发往 VM 的 RDP 或 SSH。\n,能否将默认路由 (0.0.0.0/0) 播发给 Azure VPN 网关？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是的。可以在 IPsec 跨界连接或 VNet 到 VNet 连接上应用自定义策略。,是否也可在 VNet 到 VNet 连接上使用自定义策略？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
"\n\n如果无法通过 VPN 连接连接到虚拟机，请查看以下项目：\n\n*   验证 VPN 连接是否成功。\n*   验证是否已连接到 VM 的专用 IP 地址。\n*   如果可以使用专用 IP 地址连接到 VM，但不能使用计算机名称进行连接，则请验证是否已正确配置 DNS。 若要详细了解如何对 VM 进行名称解析，请参阅[针对 VM 的名称解析](https://docs.azure.cn/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances)。\n\n通过点到站点进行连接时，请检查下述其他项：\n\n*   使用""ipconfig""检查分配给以太网适配器的 IPv4 地址，该适配器所在的计算机正是要从其进行连接的计算机。 如果该 IP 地址位于你要连接到的 VNet 的地址范围内，或者位于 VPNClientAddressPool 的地址范围内，则称为地址空间重叠。 当地址空间以这种方式重叠时，网络流量不会抵达 Azure，而是呆在本地网络中。\n*   验证是否在为 VNet 指定 DNS 服务器 IP 地址之后，才生成 VPN 客户端配置包。 如果更新了 DNS 服务器 IP 地址，请生成并安装新的 VPN 客户端配置包。\n\n若要详细了解如何排查 RDP 连接问题，请参阅[排查到 VM 的远程桌面连接问题](https://docs.azure.cn/virtual-machines/windows/troubleshoot-rdp-connection)。\n\n## 虚拟网络常见问题解答\n\n请在 [虚拟网络常见问题](https://docs.azure.cn/virtual-network/virtual-networks-faq)中查看更多虚拟网络信息。\n\n## 后续步骤\n\n*   有关 VPN 网关的详细信息，请参阅[关于 VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n*   有关 VPN 网关配置设置的详细信息，请参阅[关于 VPN 网关配置设置](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpn-gateway-settings)。",如何排查到 VM 的 RDP 连接的问题,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否。 只有其目标 IP 包含在指定虚拟网络本地网络 IP 地址范围内的流量才会通过虚拟网络网关。 流量有一个目标 IP 位于虚拟网络中，并将保留在虚拟网络中。 其他流量通过负载均衡器发送到公共网络，或者在使用强制隧道的情况下通过 Azure VPN 网关发送。,如果我的虚拟机位于使用跨界连接的虚拟网络中，从我的 VM 流出的所有流量是否都会经过该连接？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n有几个选择。 如果为 VM 启用了 RDP，则可使用专用 IP 地址连接到虚拟机。 在这种情况下，需要指定要连接到的专用 IP 地址和端口（通常为 3389）。 需要配置用于流量的虚拟机端口。\n\n也可以使用位于同一虚拟网络中的另一个虚拟机的专用 IP 地址连接到虚拟机。 如果要从虚拟网络外部的位置进行连接，则无法使用专用 IP 地址 RDP 到虚拟机。 例如，如果配置了点到站点虚拟网络，并且未从计算机建立连接，则无法通过专用 IP 地址连接到虚拟机。\n,如果虚拟机位于虚拟网络中，而连接是跨界连接，应如何连接到该 VM？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
"\n\n应在指向 IPsec S2S VPN 隧道的 VPN 设备上添加 Azure BGP 对等节点 IP 地址的主机路由。 例如，如果 Azure VPN 对等节点 IP 为""10.12.255.30""，则应在 VPN 设备上添加""10.12.255.30""的主机路由（包含匹配的 IPsec 隧道接口的下一跃点接口）。\n\n## 跨界连接和 VM\n\n",应为 BGP 对等会话添加到本地 VPN 设备什么内容？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
"Azure 本地网关为本地网络指定初始地址前缀。 使用 BGP 时，必须分配 BGP 对等节点 IP 地址的主机前缀（/32 前缀）作为本地网络的地址空间。 如果 BGP 对等节点 IP 为 10.52.255.254，则应指定""10.52.255.254/32""作为表示此本地网络的本地网关的 localNetworkAddressSpace。 这是为了确保 Azure VPN 网关通过 S2S VPN 隧道建立 BGP 会话。",使用 BGP 时应将什么指定为本地网关的地址前缀？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
本地 BGP 对等节点地址 不能 与 VPN 设备的公共 IP 地址相同。 在 VPN 设备上对 BGP 对等节点 IP 使用不同的 IP 地址。 它可以是分配给该设备上环回接口的地址。 在表示该位置的相应本地网关中指定此地址。,VPN 设备上的 BGP 对等节点 IP 地址的要求是什么？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
Azure VPN 网关将从为虚拟网络定义的 GatewaySubnet 范围内分配单个 IP 地址。 默认情况下，它是该范围的倒数第二个地址。 例如，如果 GatewaySubnet 是 10.12.255.0/27（范围从 10.12.255.0 到 10.12.255.31），则 Azure VPN 网关上的 BGP 对等 IP 地址是 10.12.255.30。 当列出 Azure VPN 网关信息时，可以找到此信息。,Azure VPN 网关将哪个地址用于 BGP 对等节点 IP？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是的。,能否在 ExpressRoute/S2S VPN 共存配置中对 S2S VPN 使用 BGP？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是，但其中至少一个虚拟网络网关必须采用主动-主动配置。,在两个使用 BGP 的 Azure VNet 之间能否有多个隧道？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n能，可以在 Azure VPN 网关和本地网络之间建立多个 S2S VPN 隧道。 请注意，所有这些隧道都会计入 Azure VPN 网关的隧道总数，而且必须在两个隧道上启用 BGP。\n\n例如，如果在 Azure VPN 网关与一个本地网络之间有两个冗余隧道，它们会占用 Azure VPN 网关的总配额（标准为 10 个，高性能为 30 个）中的 2 个隧道。\n,在 Azure VPN 网关和我的本地网络之间能否有多个隧道？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是，支持 BGP 传输路由，但例外是 Azure VPN 网关 不 会将默认路由播发到其他 BGP 对等节点。 若要启用跨多个 Azure VPN 网关的传输路由，必须在所有中间 VNet 到 VNet 连接上启用 BGP。,Azure VPN 网关是否支持 BGP 传输路由？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是的。 自定义策略是在单个连接的基础上应用的。 可以在不同的连接上创建并应用不同的 IPsec/IKE 策略。 也可选择在连接子集上应用自定义策略。 剩余连接使用 Azure 默认 IPsec/IKE 策略集。,是否可以在不同的连接上使用不同的策略？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
能，可以将 BGP 连接和非 BGP 连接混合用于同一 Azure VPN 网关。,能否将 BGP 连接与非 BGP 连接混合用于 Azure VPN 网关？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n不能，Azure 平台会阻止播发与任一虚拟网络地址前缀相同的前缀或对其进行筛选。 但是，可播发属于虚拟网络内所拥有内容超集的前缀。 \n\n例如，如果虚拟网络可使用地址空间 10.0.0.0/16，则可以播发 10.0.0.0/8， 但不能播发 10.0.0.0/16 或 10.0.0.0/24。\n,能否播发与虚拟网络前缀完全相同的前缀？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
不可以。,如果 VNet 不在同一订阅中，订阅是否需要与相同的 AD 租户相关联？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\nAzure VPN 网关会将以下路由播发到本地 BGP 设备：\n\n*   VNet 地址前缀\n*   已连接到 Azure VPN 网关的每个本地网关的地址前缀\n*   从连接到 Azure VPN 网关的其他 BGP 对等会话获知的路由， 默认路由或与任何 VNet 前缀重叠的路由除外。,Azure VPN 网关会播发给我哪些地址前缀？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否，必须在本地网络和 Azure VNet 之间分配不同 ASN（如果要使用 BGP 将它们连接在一起）。 无论是否为跨界连接启用了 BGP，都会为 Azure VPN 网关分配默认 ASN（即 65515）。 可以通过在创建 VPN 网关时分配不同 ASN，或者在创建网关后更改 ASN 来覆盖此默认值。 需要将本地 ASN 分配给相应的 Azure 本地网关。,能否将同一个 ASN 同时用于本地 VPN 网络和 Azure VNet？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n是的。以下 ASN 是 [IANA 保留](http://www.iana.org/assignments/iana-as-numbers-special-registry/iana-as-numbers-special-registry.xhtml)的，不能在 Azure VPN 网关上配置：\n\n23456、64496-64511、65535-65551 和 429496729\n,是否有任何其他我不能使用的 ASN？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n是，Azure 保留了以下 ASN 用于内部和外部的对等互连：\n\n*   公用 ASN：8075、8076、12076\n*   专用 ASN：65515、65517、65518、65519、65520\n\n连接到 Azure VPN 网关时，不能为本地 VPN 设备指定这些 ASN。\n,是否存在由 Azure 保留的 ASN？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
能，可以将自己的公共 ASN 或专用 ASN 同时用于本地网络和 Azure 虚拟网络。,能否使用专用 ASN（自治系统编号）？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否，只有基于路由的 VPN 网关支持 BGP。,能否将 BGP 用于 Azure 基于策略的 VPN 网关？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否，BGP 在 Azure VpnGw1、VpnGw2、VpnGw3、标准 VPN 网关和高性能 VPN 网关上受支持。 基本 SKU。,BGP 是否在所有 Azure VPN 网关 SKU 上受支持？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n不可以。 只能通过 Azure VPN 网关在 S2S VPN 和 VNet 到 VNet 连接上使用 IPsec/IKE 策略。\n\n## BGP\n\n,能否在 ExpressRoute 连接上使用自定义 IPsec/IKE 策略？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是的。 VNet 到 VNet 隧道包含 Azure 中的两个连接资源，一个方向一个资源。 请确保两个连接资源的策略相同，否则无法建立 VNet 到 VNet 连接。,是否需在两个 VNet 到 VNet 连接资源上指定同一策略？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
能，可以将 BGP 同时用于跨界连接和 VNet 到 VNet 连接。,能否将 BGP 用于 VNet 到 VNet 连接？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否。 虚拟网络可以在相同或不同的 Azure 区域（位置）中。,VNet 是否需要处于同一区域？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否，必须指定 IKE（主模式）和 IPsec（快速模式）的所有算法和参数。 不允许指定部分策略。,能否在一个连接上指定部分策略？ （例如，仅指定 IKE 算法，不指定 IPsec）,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是，它通过 IPsec/IKE 加密进行保护。,VNet 到 VNet 流量是否安全？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
若要了解如何编辑设备配置示例，请参阅[编辑示例](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpn-devices#editing)。,如何编辑 VPN 设备配置示例？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n请参阅以下链接，了解配置信息：\n\n*   \n\n有关兼容 VPN 设备的信息，请参阅 [VPN 设备](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpn-devices)。\n\n*   \n\n在配置 VPN 设备之前，对于要使用的 VPN 设备，请查看是否存在任何[已知的设备兼容性问题](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpn-devices#known)。\n\n*   \n\n有关设备配置设置的链接，请参阅[已验证的 VPN 设备](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpn-devices#devicetable)。 我们会尽力提供各种设备配置链接。 如需最新的配置信息，最好是咨询设备制造商。 我们提供的列表会显示已测试的版本。 如果你的 OS 不在该列表中，则仍有可能版本是兼容的。 请与设备制造商联系以验证 VPN 设备的 OS 版本是否兼容。\n\n*   \n\n有关 VPN 设备配置的概述，请参阅[第三方 VPN 设备配置概述](https://docs.azure.cn/vpn-gateway/vpn-gateway-3rdparty-device-config-overview)。\n\n*   \n\n若要了解如何编辑设备配置示例，请参阅[编辑示例](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpn-devices#editing)。\n\n*   \n\n有关加密要求的信息，请参阅[关于加密要求和 Azure VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-compliance-crypto)。\n\n*   \n\n有关 IPsec/IKE 参数的信息，请参阅[关于用于站点到站点 VPN 网关连接的 VPN 设备和 IPsec/IKE 参数](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpn-devices#ipsec)。 除了完成配置所需的其他参数信息外，此链接还显示有关 IKE 版本、Diffie-Hellman 组、身份验证方法、加密和哈希算法、SA 生存期、PFS 和 DPD 的信息。\n\n*   \n\n有关 IPsec/IKE 策略的配置步骤，请参阅[配置用于 S2S VPN 或 VNet 到 VNet 连接的 IPsec/IKE 策略](https://docs.azure.cn/vpn-gateway/vpn-gateway-ipsecikepolicy-rm-powershell)。\n\n*   \n\n若要连接多个基于策略的 VPN 设备，请参阅[使用 PowerShell 将 Azure VPN 网关连接到多个基于策略的本地 VPN 设备](https://docs.azure.cn/vpn-gateway/vpn-gateway-connect-multiple-policybased-rm-ps)。\n,在哪里可以找到 VPN 设备配置设置？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
我们在与设备供应商合作的过程中验证了一系列的标准站点到站点 VPN 设备。 可在[关于 VPN 设备](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpn-devices)一文中找到已知兼容的 VPN 设备及其相应的配置说明/示例和设备规范的列表。 设备系列中列为已知兼容设备的所有设备都应适用于虚拟网络。 若要获取配置 VPN 设备的帮助，请参考对应于相应设备系列的设备配置示例或链接。,选择 VPN 设备时应考虑什么？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n[关于 VPN 网关配置设置](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpn-gateway-settings)。\n\n## 站点到站点连接和 VPN 设备\n\n,有关网关类型、要求和吞吐量的详细信息,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n这些端口是进行 Azure 基础结构通信所必需的。 它们受 Azure 证书的保护（处于锁定状态）。 如果没有适当的证书，外部实体（包括这些网关的客户）将无法对这些终结点施加任何影响。\n\nVPN 网关基本上是一个多宿主设备，其中一个 NIC 进入客户专用网络，另一个 NIC 面向公共网络。 因合规性原因，Azure 基础结构实体无法进入客户专用网络，因此需利用公共终结点进行基础结构通信。 Azure 安全审核会定期扫描公共终结点。\n,我的 VPN 网关上的某些端口为何处于打开状态？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是。可以在 Azure 中部署自己的 VPN 网关或服务器，可以从 Azure 应用商店部署，也可以通过创建自己的 VPN 路由器部署。 需要在虚拟网络中配置用户定义的路由，确保流量在本地网络和虚拟网络子网之间正确路由。,是否可以在 Azure 中设置自己的 VPN 服务器，并使用它连接到本地网络？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是的。 请参阅[配置强制隧道](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-forced-tunneling)。,是否可以配置强制隧道？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
"\n\n#### Resource Manager 部署模型\n\n*   PowerShell：使用""AddressPrefix""指定本地网络网关的流量。\n*   Azure 门户：导航到""本地网关"">""配置"">""地址空间""。\n\n#### 经典部署模型\n\n*   Azure 门户：导航到""经典虚拟网络"">""VPN 连接"">""站点到站点 VPN 连接"">""本地站点名称"">""本地站点"">""客户端地址空间""。",如何指定通过 VPN 网关的流量？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
我们只能使用预共享密钥 (PSK) 进行身份验证。,是否可以使用其他身份验证选项？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
"是，""设置预共享密钥 API""和 PowerShell cmdlet 可用于配置 Azure 基于策略的（静态）VPN 和基于路由的（动态）路由 VPN。","是否可以使用""设置预共享密钥 API""配置基于策略的（静态路由）网关 VPN？",vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
Azure VPN 使用 PSK（预共享密钥）身份验证。 我们在创建 VPN 隧道时生成一个预共享密钥 (PSK)。 可以使用设置预共享密钥 PowerShell cmdlet 或 REST API 会自动生成的 PSK 更改成自己的 PSK。,VPN 隧道如何进行身份验证？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
对于 IPsec/IKE 参数，请参阅[参数](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpn-devices#ipsec)。,在何处查找 IPsec 和 IKE 参数？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否。 仅支持动态 IP 地址分配。 但这并不意味着 IP 地址在分配到 VPN 网关后会更改。 VPN 网关 IP 地址只在删除或重新创建网关时更改。 VPN 网关公共 IP 地址不会因为重新调整大小、重置或其他 VPN 网关内部维护/升级而更改。,能否为 VPN 网关请求静态公共 IP 地址？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否。,是否可以将虚拟机或角色实例部署到网关子网？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
"\n\n是。 网关子网包含虚拟网络网关服务使用的 IP 地址。 若要配置虚拟网关，需要先为 VNet 创建网关子网。 所有网关子网都必须命名为""GatewaySubnet""才能正常工作。 不要对网关子网使用其他名称。 此外，不要在网关子网中部署 VM 或其他组件。\n\n创建网关子网时，需指定子网包含的 IP 地址数。 网关子网中的 IP 地址分配到网关服务。 某些配置相对于其他配置需要将更多 IP 地址分配到网关服务。 需确保网关子网包含足够的 IP 地址，以适应未来的增长和可能的其他新连接配置。 因此，尽管网关子网最小可创建为 /29，但建议创建 /27 或更大（/27、/26 和 /25 等）的网关子网。 查看要创建的配置的要求，并验证所拥有的网关子网是否可满足这些要求。\n","是否需要""GatewaySubnet""？",vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n不可以。 Azure Vnet 网关类型不能从基于策略更改为基于路由，反之亦然。 必须先删除该网关，然后再重新创建，此过程需时约 60 分钟。 不会保留网关的 IP 地址，也不会保留预共享密钥 (PSK)。\n\n1.  删除与要删除的网关相关联的任何连接。\n2.  删除网关：\n\n    *   [Azure 门户](https://docs.azure.cn/vpn-gateway/vpn-gateway-delete-vnet-gateway-portal)\n    *   [Azure PowerShell](https://docs.azure.cn/vpn-gateway/vpn-gateway-delete-vnet-gateway-powershell)\n    *   [Azure Powershell - 经典](https://docs.azure.cn/vpn-gateway/vpn-gateway-delete-vnet-gateway-classic-powershell)\n3.  [创建所需类型的新网关并完成 VPN 设置](https://docs.azure.cn/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal#VNetGateway),能否将基于策略的 VPN 网关更新为基于路由的？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
"基于路由的网关可实施基于路由的 VPN。 基于路由的 VPN 使用 IP 转发或路由表中的""路由""将数据包引导到相应的隧道接口中。 然后，隧道接口会加密或解密出入隧道的数据包。 基于路由的 VPN 的策略或流量选择器配置为任意到任意（或通配符）。",什么是基于路由的（动态路由）网关？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
"VPN 网关是一种虚拟网络网关。 VPN 网关通过公共连接在虚拟网络和本地位置之间发送加密流量。 还可使用 VPN 网关在虚拟网络之间发送流量。 创建 VPN 网关时，指定""GatewayType""的值为""Vpn""。 有关详细信息，请参阅[关于 VPN 网关配置设置](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpn-gateway-settings)。",VPN 网关是否为虚拟网关？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n站点到站点（IPsec/IKE VPN 隧道）配置是指本地位置与 Azure 之间的配置。 这意味着，可以将任何本地计算机连接到虚拟网络中的任何虚拟机或角色实例，具体取决于如何选择路由和权限的配置。 它对于需要始终可用的跨界连接来说是一个极佳的选项，很适合混合配置。 此类连接依赖于 IPsec VPN 设备（硬件设备或软件设备），该设备必须部署在网络边缘。 若要创建此类连接，必须具有面向外部且不在 NAT 之后的 IPv4 地址。\n\n点到站点（基于 SSTP 的 VPN）配置允许从任何位置的单台计算机连接到虚拟网络中的任何内容。 它使用 Windows 内置的 VPN 客户端。 在进行点到站点配置时，需要安装证书和 VPN 客户端配置包，其中包含的设置允许计算机连接到虚拟网络中的任何虚拟机或角色实例。 此连接适用于需要连接到虚拟网络但该虚拟网络不在本地的情况。 无法访问 VPN 硬件或面向外部的 IPv4 地址（二者是进行站点到站点连接所必需的）时，它也是一个很好的选项。\n\n可以将虚拟网络配置为同时使用站点到站点连接和点到站点连接，前提是使用基于路由的 VPN 类型为网关创建站点到站点连接。 在经典部署模型中，基于路由的 VPN 类型称为动态网关。\n\n## 虚拟网关\n\n,站点到站点连接和点到站点连接的区别是什么？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n支持以下跨界连接：\n\n*   站点到站点 - 基于 IPsec（IKE v1 和 IKE v2）的 VPN 连接。 此类型的连接需要 VPN 设备或 RRAS。 有关详细信息，请参阅[站点到站点](https://docs.azure.cn/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal)。\n*   点到站点 - 基于 SSTP（安全套接字隧道协议）的 VPN 连接。 此连接不需要 VPN 设备。 有关详细信息，请参阅[点到站点](https://docs.azure.cn/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal)。\n*   VNet 到 VNet - 这种连接类型与站点到站点配置相同。 VNet 到 VNet 是一种基于 IPsec（IKE v1 和 IKE v2）的 VPN 连接。 它不需要 VPN 设备。 有关详细信息，请参阅 [VNet 到 VNet](https://docs.azure.cn/vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal)。\n*   多站点 - 这是站点到站点配置的变体，可将多个本地站点连接到虚拟网络。 有关详细信息，请参阅[多站点](https://docs.azure.cn/vpn-gateway/vpn-gateway-howto-multi-site-to-site-resource-manager-portal)。\n*   ExpressRoute - ExpressRoute 是从 WAN 到 Azure 的直接连接，不是经公共 Internet 的 VPN 连接。 有关详细信息，请参阅 [ExpressRoute 技术概述](https://docs.azure.cn/expressroute/expressroute-introduction)和 [ExpressRoute 常见问题](https://docs.azure.cn/expressroute/expressroute-faqs)。\n\n有关 VPN 网关连接的详细信息，请参阅[关于 VPN 网关](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways)。\n,我的跨界连接选项有哪些？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
"可以使用 Windows PowerShell 和 Azure REST API 连接到多个站点。 请参阅 [多站点与 VNet 到 VNet 连接](https://docs.azure.cn/vpn-gateway/#V2VMulti) 的""常见问题""部分。",是否可以从一个虚拟网络连接到多个站点？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是。,是否可以连接不同订阅中的虚拟网络？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是。 事实上，没有任何区域约束。 一个虚拟网络可以连接到同一区域中的其他虚拟网络，也可以连接到其他 Azure 区域中的其他虚拟网络。,是否可以连接不同 Azure 区域中的虚拟网络？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否。 将多个 Azure 虚拟网络连接在一起不需要 VPN 设备，除非需要跨界连接。,是否需要使用 VPN 设备将 VNet 连接在一起？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否。 必须先创建网关，才能获得 IP 地址。 如果删除再重新创建 VPN 网关，IP 地址将更改。,能否先获得 VPN 网关 IP 地址，再创建网关？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
对于基于策略（也称为静态路由）的 VPN 网关来说，这是预期的行为。 当经过隧道的流量处于空闲状态 5 分钟以上时，将销毁该隧道。 当流量朝任一方向开始流动时，该隧道将立刻重新建立。,在流量处于空闲状态时，为何我的基于策略的 VPN 隧道会关闭？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
基于策略的网关实施基于策略的 VPN。 基于策略的 VPN 会根据本地网络和 Azure VNet 之间的地址前缀的各种组合，加密数据包并引导其通过 IPsec 隧道。 通常会在 VPN 配置中将策略（或流量选择器）定义为访问列表。,什么是基于策略的（静态路由）网关？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n支持以下客户端操作系统：\n\n*   Windows 7（32 位和 64 位）\n*   Windows Server 2008 R2（仅 64 位）\n*   Windows 8（32 位和 64 位）\n*   Windows 8.1（32 位和 64 位）\n*   Windows Server 2012（仅 64 位）\n*   Windows Server 2012 R2（仅 64 位）\n*   Windows Server 2016（仅 64 位）\n*   Windows 10\n*   适用于 Mac 的 OSX 版本 10.11 (El Capitan)\n*   适用于 Mac 的 macOS 版本 10.12 (Sierra),点到站点连接可以用于哪些客户端操作系统？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
当使用 VPN 网关连接时，同一区域中的 VNet 到 VNet 流量双向均免费。 跨区域 VNet 到 VNet 出口流量根据源区域的出站 VNet 间数据传输费率收费。 有关详细信息，请参阅 [VPN 网关定价页](https://www.azure.cn/pricing/details/vpn-gateway/)。 如果使用 VNet 对等互连而非 VPN 网关连接 VNet，请参阅[虚拟网络定价页](https://www.azure.cn/pricing/details/virtual-network/)。,Azure 会对 VNet 之间的流量收费吗？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n是的，IKEv2 和 SSTP VPN 都支持 RADIUS 身份验证。 \n\n## VNet 到 VNet 和多站点连接\n\nVNet 到 VNet 连接常见问题解答适用于 VPN 网关连接。 若要了解 VNet 对等互连，请参阅[虚拟网络对等互连](https://docs.azure.cn/virtual-network/virtual-network-peering-overview)\n,RADIUS 身份验证是否同时适用于 IKEv2 和 SSTP VPN？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n在 RADIUS 证书身份验证中，身份验证请求被转发到处理实际证书验证的 RADIUS 服务器。 如果希望通过 RADIUS 与已有的证书身份验证基础结构进行集成，则此选项非常有用。\n\n使用 Azure 进行证书身份验证时，由 Azure VPN 网关执行证书验证。 需要将证书公钥上传到网关。 还可以指定不允许进行连接的已吊销证书的列表。\n,使用 RADIUS 服务器执行证书身份验证与使用 Azure 本机证书身份验证执行身份验证（通过将受信任的证书上传到 Azure）之间有何区别？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
RADIUS 身份验证在网关上支持的最大 SSTP 连接数没有变化。 它保持为 128。 不管网关是针对 SSTP、IKEv2 还是针对两者配置的，支持的最大连接数都是 128。,RADIUS 身份验证支持的 SSTP 连接数是否有变化？ 支持的最大 SSTP 和 IKEv2 连接数是多少？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
不可以。 它只能通过站点到站点连接进行传送。,是否可以通过 ExpressRoute 连接来传送（从 Azure VPN 网关）流向本地 RADIUS 服务器的流量？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
需要具有到本地站点的 VPN 站点到站点连接，并且需要配置正确的路由。,若要确保 Azure 网关能够访问本地 RADIUS 服务器，对连接有何要求？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n我们支持将 Windows Server 2012 路由和远程访问 (RRAS) 服务器用于站点到站点跨界配置。\n\n其他软件 VPN 解决方案只要遵循行业标准 IPsec 实现，就会与我们的网关兼容。 有关配置和支持说明，请与该软件的供应商联系。\n\n## 点到站点 - 本机 Azure 证书身份验证\n\n本部分适用于资源管理器部署模型。\n,我可以使用软件 VPN 连接到 Azure 吗？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是的，支持第三方 RADIUS 服务器。,是否支持第三方 RADIUS 服务器？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
不可以。 经典部署模型不支持 RADIUS 身份验证。,经典部署模型是否支持 RADIUS 身份验证？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
VpnGw1、VpnGw2 和 VpnGw3 SKU 支持 RADIUS 身份验证。 如果使用的是旧版 SKU，则标准和高性能 SKU 支持 RADIUS 身份验证。 基本网关 SKU 不支持该身份验证。,是否所有 Azure VPN 网关 SKU 都支持 RADIUS 身份验证？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n*   \n\n内部 PKI/企业 PKI 解决方案：请参阅[生成证书](https://docs.azure.cn/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal#generatecert)的步骤。\n\n*   \n\nAzure PowerShell：请参阅 [Azure PowerShell](https://docs.azure.cn/vpn-gateway/vpn-gateway-certificates-point-to-site) 一文了解相关步骤。\n\n*   \n\nMakeCert：请参阅 [MakeCert](https://docs.azure.cn/vpn-gateway/vpn-gateway-certificates-point-to-site-makecert) 一文了解相关步骤。\n\n*   \n\nOpenSSL： \n\n    *   \n\n导出证书时，请务必将根证书转换为 Base64。\n\n    *   \n\n对于客户端证书：\n\n    *   创建私钥时，请将长度指定为 4096。\n    *   创建证书时，对于 -extensions 参数，指定 usr_cert。\n\n## 点到站点 - RADIUS 身份验证\n\n本部分适用于资源管理器部署模型。\n,是否有证书设置和参数的说明？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
否。 VNet 到 VNet 流量会流经 Azure 主干，而非 Internet。,VNet 到 VNet 流量是否会通过 Internet？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
可以使用企业 PKI 解决方案（内部 PKI）、Azure PowerShell、MakeCert 和 OpenSSL。,可以使用哪些工具来创建证书？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是的，可以通过 Powershell 和 Azure 门户，在已部署的网关启用这些新功能。,我已部署 Azure VPN 网关。 是否可在该网关上启用 RADIUS 和/或 IKEv2 VPN？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
Azure 仅支持在 Windows 和 Mac 上使用 P2S VPN。,除了 Windows 和 Mac 以外，Azure 还支持在其他哪些平台上使用 P2S VPN？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\n用户可以使用支持 IKEv2 的内置 Windows VPN 客户端连接到 Azure。 但是，在以下情况下，从 Windows 设备建立的 IKEv2 连接不起作用：\n\n 如果用户的设备包含大量的受信任根证书，在 IKE 交换期间，消息有效负载会很大，导致 IP 层碎片化。 碎片会在 Azure 端被拒绝，导致连接失败。 导致此问题的确切证书数目很难估算。 因此，无法保证从 Windows 设备建立的 IKEv2 连接可行。 在混合环境（包括 Windows 和 Mac 设备）中配置 SSTP 和 IKEv2 时，Windows VPN 配置文件始终会先尝试 IKEv2 隧道。 如果由于此处所述的问题而导致这种尝试失败，将会回退到 SSTP。\n,Azure 是否支持使用 Windows 的 IKEv2 VPN？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
不可以。 只能将 Windows 上的本机 VPN 客户端用于 SSTP，只能将 Mac 上的本机 VPN 客户端用于 IKEv2。 请参阅支持的客户端操作系统的列表。,是否可以将任何软件 VPN 客户端用于支持 SSTP 和/或 IKEv2 的点到站点配置？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
很难维持 VPN 隧道的准确吞吐量。 IPsec 和 SSTP 是重重加密的 VPN 协议。 本地网络与 Internet 之间的延迟和带宽也限制了吞吐量。 对于仅具有 IKEv2 点到站点 VPN 连接的 VPN 网关，期望可以实现的总吞吐量取决于网关 SKU。 有关吞吐量的详细信息，请参阅[网关 SKU](https://docs.azure.cn/vpn-gateway/vpn-gateway-about-vpngateways#gwsku)。,预计通过站点到站点连接或点到站点连接的吞吐量有多少？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
不可以。 点到站点客户端只能连接到虚拟网络网关所在的 VNet 中的资源。,是否可以将点到站点客户端配置为同时连接到多个虚拟网络？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是的。 对于资源管理器部署模型，必须为网关使用 RouteBased VPN 类型。 对于经典部署模型，需要一个动态网关。 不支持将点到站点配置用于静态路由 VPN 网关或 PolicyBased VPN 网关。,对于同一虚拟网络，站点到站点和点到站点配置能否共存？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
点到站点 VPN 中当前不支持自动重新连接和 DDNS。,点到站点在 VPN 客户端上是否支持自动重新连接和 DDNS？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
默认情况下，客户端计算机不自动重新建立 VPN 连接。,如果重新启动进行过点到站点配置的客户端计算机，是否会自动重新连接 VPN？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
\n\nAzure 支持两种类型的点到站点 VPN 选项：\n\n*   \n\n安全套接字隧道协议 (SSTP)。 SSTP 是 Microsoft 专有的基于 SSL 的解决方案，它可以穿透防火墙，因为大多数防火墙都打开了 443 SSL 使用的 TCP 端口。\n\n*   \n\nIKEv2 VPN。 IKEv2 VPN 是一个基于标准的 IPsec VPN 解决方案，它使用 UDP 端口 500 和 4500 以及 IP 协议号 50。 防火墙并非始终打开这些端口，因此，IKEv2 VPN 有可能无法穿过代理和防火墙。\n,是否可以使用点到站点功能穿越代理和防火墙？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
我们最多支持 128 个 VPN 客户端可同时连接到一个虚拟网络。,在我的点到站点配置中，可以有多少 VPN 客户端终结点？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
是。 以前只可使用自签名根证书。 仍可上传 20 个根证书。,是否可以将我自己的内部 PKI 根 CA 用于点到站点连接？,vpn gateway,https://docs.azure.cn/vpn-gateway/vpn-gateway-vpn-faq
"\n\n可以，客户在 12 个月宽限期内具有完全访问权限，可以使用""即将""停用的 Azure Cosmos DB SDK 创作、部署和修改应用程序。 在 12 个月宽限期内，建议客户根据相应情况迁移到支持的较新版本 Azure Cosmos DB SDK。\n\n3.在 12 个月通知期之后，客户是否可以使用已停用的 Azure Cosmos DB SDK 创建和修改应用程序？\n\n在 12 个月通知期之后，SDK 会停用。 Azure Cosmos DB 平台不允许使用已停用 SDK 的应用程序对 Azure Cosmos DB 进行任何访问。 此外，Microsoft 不会对已停用的 SDK 提供客户支持。\n\n4.如果客户运行使用不支持的 Azure Cosmos DB SDK 版本的应用程序，会发生什么情况？\n\n任何使用已停用 SDK 版本连接 Azure Cosmos DB 服务的尝试都会被拒绝。 \n\n5.新特性和功能是否会适用于所有未停用的 SDK？\n\n新特性和功能只添加到新版本。 如果使用的是未停用的旧版本 SDK，则对 Azure Cosmos DB 进行的请求仍会与以前一样正常工作，但是你无法访问任何新功能。 \n\n6.如果无法在截止日期之前更新应用程序，该怎么办？\n\n我们建议尽早升级到最新 SDK。 SDK 标记为要停用之后，会有 12 个月来更新应用程序。 如果由于任何原因而无法在此时间范围内完成应用程序更新，请在截止日期之前与 [Cosmos DB 团队](mailto:askcosmosdb@microsoft.com)联系并请求其帮助。\n\n## 另请参阅\n\n若要了解有关 Cosmos DB 的详细信息，请参阅 [Azure Cosmos DB](https://www.azure.cn/home/features/cosmos-db/) 服务页。\n\n","2.在这 12 个月期间，客户是否可以使用""即将""停用的 Azure Cosmos DB SDK 来创作应用程序？",cosmos-db,https://docs.azure.cn/zh-cn/cosmos-db/documentdb-sdk-dotnet
"\n\nMicrosoft 会在即将停用的 SDK 的支持结束之前提前 12 个月进行通知，以便协助平稳地转换到支持的 SDK。 此外，会通过各种通信渠道（Azure 管理门户、开发人员中心、博客文章以及与分配的服务管理员的直接通信）来通知客户。\n\n2.在这 12 个月期间，客户是否可以使用""即将""停用的 Azure Cosmos DB SDK 来创作应用程序？ \n\n可以，客户在 12 个月宽限期内具有完全访问权限，可以使用""即将""停用的 Azure Cosmos DB SDK 创作、部署和修改应用程序。 在 12 个月宽限期内，建议客户根据相应情况迁移到支持的较新版本 Azure Cosmos DB SDK。\n\n3.在 12 个月通知期之后，客户是否可以使用已停用的 Azure Cosmos DB SDK 创建和修改应用程序？\n\n在 12 个月通知期之后，SDK 会停用。 Azure Cosmos DB 平台不允许使用已停用 SDK 的应用程序对 Azure Cosmos DB 进行任何访问。 此外，Microsoft 不会对已停用的 SDK 提供客户支持。\n\n4.如果客户运行使用不支持的 Azure Cosmos DB SDK 版本的应用程序，会发生什么情况？\n\n任何使用已停用 SDK 版本连接 Azure Cosmos DB 服务的尝试都会被拒绝。 \n\n5.新特性和功能是否会适用于所有未停用的 SDK？\n\n新特性和功能只添加到新版本。 如果使用的是未停用的旧版本 SDK，则对 Azure Cosmos DB 进行的请求仍会与以前一样正常工作，但是你无法访问任何新功能。 \n\n6.如果无法在截止日期之前更新应用程序，该怎么办？\n\n我们建议尽早升级到最新 SDK。 SDK 标记为要停用之后，会有 12 个月来更新应用程序。 如果由于任何原因而无法在此时间范围内完成应用程序更新，请在截止日期之前与 [Cosmos DB 团队](mailto:askcosmosdb@microsoft.com)联系并请求其帮助。\n\n## 另请参阅\n\n若要了解有关 Cosmos DB 的详细信息，请参阅 [Azure Cosmos DB](https://www.azure.cn/home/features/cosmos-db/) 服务页。\n\n",1.如何向客户通知即将停用的 SDK？,cosmos-db,https://docs.azure.cn/zh-cn/cosmos-db/documentdb-sdk-dotnet
\n\n任何使用已停用 SDK 版本连接 Azure Cosmos DB 服务的尝试都会被拒绝。 \n\n5.新特性和功能是否会适用于所有未停用的 SDK？\n\n新特性和功能只添加到新版本。 如果使用的是未停用的旧版本 SDK，则对 Azure Cosmos DB 进行的请求仍会与以前一样正常工作，但是你无法访问任何新功能。 \n\n6.如果无法在截止日期之前更新应用程序，该怎么办？\n\n我们建议尽早升级到最新 SDK。 SDK 标记为要停用之后，会有 12 个月来更新应用程序。 如果由于任何原因而无法在此时间范围内完成应用程序更新，请在截止日期之前与 [Cosmos DB 团队](mailto:askcosmosdb@microsoft.com)联系并请求其帮助。\n\n## 另请参阅\n\n若要了解有关 Cosmos DB 的详细信息，请参阅 [Azure Cosmos DB](https://www.azure.cn/home/features/cosmos-db/) 服务页。\n\n,4.如果客户运行使用不支持的 Azure Cosmos DB SDK 版本的应用程序，会发生什么情况？,cosmos-db,https://docs.azure.cn/zh-cn/cosmos-db/documentdb-sdk-dotnet
\n\n新特性和功能只添加到新版本。 如果使用的是未停用的旧版本 SDK，则对 Azure Cosmos DB 进行的请求仍会与以前一样正常工作，但是你无法访问任何新功能。 \n\n6.如果无法在截止日期之前更新应用程序，该怎么办？\n\n我们建议尽早升级到最新 SDK。 SDK 标记为要停用之后，会有 12 个月来更新应用程序。 如果由于任何原因而无法在此时间范围内完成应用程序更新，请在截止日期之前与 [Cosmos DB 团队](mailto:askcosmosdb@microsoft.com)联系并请求其帮助。\n\n## 另请参阅\n\n若要了解有关 Cosmos DB 的详细信息，请参阅 [Azure Cosmos DB](https://www.azure.cn/home/features/cosmos-db/) 服务页。\n\n,5.新特性和功能是否会适用于所有未停用的 SDK？,cosmos-db,https://docs.azure.cn/zh-cn/cosmos-db/documentdb-sdk-dotnet
\n\n我们建议尽早升级到最新 SDK。 SDK 标记为要停用之后，会有 12 个月来更新应用程序。 如果由于任何原因而无法在此时间范围内完成应用程序更新，请在截止日期之前与 [Cosmos DB 团队](mailto:askcosmosdb@microsoft.com)联系并请求其帮助。\n\n## 另请参阅\n\n若要了解有关 Cosmos DB 的详细信息，请参阅 [Azure Cosmos DB](https://www.azure.cn/home/features/cosmos-db/) 服务页。\n\n,6.如果无法在截止日期之前更新应用程序，该怎么办？,cosmos-db,https://docs.azure.cn/zh-cn/cosmos-db/documentdb-sdk-dotnet
\n\n在 12 个月通知期之后，SDK 会停用。 Azure Cosmos DB 平台不允许使用已停用 SDK 的应用程序对 Azure Cosmos DB 进行任何访问。 此外，Microsoft 不会对已停用的 SDK 提供客户支持。\n\n4.如果客户运行使用不支持的 Azure Cosmos DB SDK 版本的应用程序，会发生什么情况？\n\n任何使用已停用 SDK 版本连接 Azure Cosmos DB 服务的尝试都会被拒绝。 \n\n5.新特性和功能是否会适用于所有未停用的 SDK？\n\n新特性和功能只添加到新版本。 如果使用的是未停用的旧版本 SDK，则对 Azure Cosmos DB 进行的请求仍会与以前一样正常工作，但是你无法访问任何新功能。 \n\n6.如果无法在截止日期之前更新应用程序，该怎么办？\n\n我们建议尽早升级到最新 SDK。 SDK 标记为要停用之后，会有 12 个月来更新应用程序。 如果由于任何原因而无法在此时间范围内完成应用程序更新，请在截止日期之前与 [Cosmos DB 团队](mailto:askcosmosdb@microsoft.com)联系并请求其帮助。\n\n## 另请参阅\n\n若要了解有关 Cosmos DB 的详细信息，请参阅 [Azure Cosmos DB](https://www.azure.cn/home/features/cosmos-db/) 服务页。\n\n,3.在 12 个月通知期之后，客户是否可以使用已停用的 Azure Cosmos DB SDK 创建和修改应用程序？,cosmos-db,https://docs.azure.cn/zh-cn/cosmos-db/documentdb-sdk-dotnet
\n\n用户使用 Windows 和 Mac 设备上的本机 VPN 客户端建立 P2S 连接。 Azure 提供一个 VPN 客户端配置 zip 文件，其中包含这些本机客户端连接到 Azure 时所需的设置。\n\n*   对于 Windows 设备，VPN 客户端配置包括用户在其设备上安装的安装程序包。\n*   对于 Mac 设备，该配置包括用户在其设备上安装的 mobileconfig 文件。\n\n该 zip 文件还提供 Azure 端上的一些重要设置的值，使用这些设置可为这些设备创建你自己的配置文件。 其中一些值包括 VPN 网关地址、配置的隧道类型、路由，以及用于网关验证的根证书。\n,客户端设备的配置要求,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
"SKUP2S 连接聚合吞吐量基准RADIUS 身份验证IKEv2 P2S VPNVpnGw1128650 Mbps支持支持VpnGw21281Gbps支持支持VpnGw31281.25 Gbps支持支持基本128100 Mbps不支持不支持\n\n*   聚合吞吐量基准基于对通过单个网关聚合的多个隧道的测量。 受 Internet 流量情况和应用程序行为影响，该吞吐量无法保证。\n*   可在""定价""页上找到定价信息 \n*   可在""SLA""页上查看 SLA（服务级别协议）信息。\n\n## 本机 Azure 证书身份验证常见问题解答\n\n",哪些网关 SKU 支持 P2S VPN？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
\n\n支持以下客户端操作系统：\n\n*   Windows 7（32 位和 64 位）\n*   Windows Server 2008 R2（仅 64 位）\n*   Windows 8（32 位和 64 位）\n*   Windows 8.1（32 位和 64 位）\n*   Windows Server 2012（仅 64 位）\n*   Windows Server 2012 R2（仅 64 位）\n*   Windows Server 2016（仅 64 位）\n*   Windows 10\n*   适用于 Mac 的 OSX 版本 10.11 (El Capitan)\n*   适用于 Mac 的 macOS 版本 10.12 (Sierra),点到站点连接可以用于哪些客户端操作系统？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
我们最多支持 128 个 VPN 客户端可同时连接到一个虚拟网络。,在我的点到站点配置中，可以有多少 VPN 客户端终结点？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
\n\nAzure 支持两种类型的点到站点 VPN 选项：\n\n*   \n\n安全套接字隧道协议 (SSTP)。 SSTP 是 Microsoft 专有的基于 SSL 的解决方案，它可以穿透防火墙，因为大多数防火墙都打开了 443 SSL 使用的 TCP 端口。\n\n*   \n\nIKEv2 VPN。 IKEv2 VPN 是一个基于标准的 IPsec VPN 解决方案，它使用 UDP 端口 500 和 4500 以及 IP 协议号 50。 防火墙并非始终打开这些端口，因此，IKEv2 VPN 有可能无法穿过代理和防火墙。\n,是否可以使用点到站点功能穿越代理和防火墙？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
默认情况下，客户端计算机不自动重新建立 VPN 连接。,如果重新启动进行过点到站点配置的客户端计算机，是否会自动重新连接 VPN？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
点到站点 VPN 中当前不支持自动重新连接和 DDNS。,点到站点在 VPN 客户端上是否支持自动重新连接和 DDNS？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
是的。 对于资源管理器部署模型，必须为网关使用 RouteBased VPN 类型。 对于经典部署模型，需要一个动态网关。 不支持将点到站点配置用于静态路由 VPN 网关或 PolicyBased VPN 网关。,对于同一虚拟网络，站点到站点和点到站点配置能否共存？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
不可以。 点到站点客户端只能连接到虚拟网络网关所在的 VNet 中的资源。,是否可以将点到站点客户端配置为同时连接到多个虚拟网络？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
很难维持 VPN 隧道的准确吞吐量。 IPsec 和 SSTP 是重重加密的 VPN 协议。 本地网络与 Internet 之间的延迟和带宽也限制了吞吐量。 对于仅具有 IKEv2 点到站点 VPN 连接的 VPN 网关，期望可以实现的总吞吐量取决于网关 SKU。 有关吞吐量的详细信息，请参阅[网关 SKU](https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-about-vpngateways#gwsku)。,预计通过站点到站点连接或点到站点连接的吞吐量有多少？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
不可以。 只能将 Windows 上的本机 VPN 客户端用于 SSTP，只能将 Mac 上的本机 VPN 客户端用于 IKEv2。 请参阅支持的客户端操作系统的列表。,是否可以将任何软件 VPN 客户端用于支持 SSTP 和/或 IKEv2 的点到站点配置？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
\n\n用户可以使用支持 IKEv2 的内置 Windows VPN 客户端连接到 Azure。 但是，在以下情况下，从 Windows 设备建立的 IKEv2 连接不起作用：\n\n 如果用户的设备包含大量的受信任根证书，在 IKE 交换期间，消息有效负载会很大，导致 IP 层碎片化。 碎片会在 Azure 端被拒绝，导致连接失败。 导致此问题的确切证书数目很难估算。 因此，无法保证从 Windows 设备建立的 IKEv2 连接可行。 在混合环境（包括 Windows 和 Mac 设备）中配置 SSTP 和 IKEv2 时，Windows VPN 配置文件始终会先尝试 IKEv2 隧道。 如果由于此处所述的问题而导致这种尝试失败，将会回退到 SSTP。\n,Azure 是否支持使用 Windows 的 IKEv2 VPN？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
Azure 仅支持在 Windows 和 Mac 上使用 P2S VPN。,除了 Windows 和 Mac 以外，Azure 还支持在其他哪些平台上使用 P2S VPN？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
是。 以前只可使用自签名根证书。 仍可上传 20 个根证书。,是否可以将我自己的内部 PKI 根 CA 用于点到站点连接？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
可以使用企业 PKI 解决方案（内部 PKI）、Azure PowerShell、MakeCert 和 OpenSSL。,可以使用哪些工具来创建证书？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
\n\n*   \n\n内部 PKI/企业 PKI 解决方案：请参阅[生成证书](https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal#generatecert)的步骤。\n\n*   \n\nAzure PowerShell：请参阅 [Azure PowerShell](https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-certificates-point-to-site) 一文了解相关步骤。\n\n*   \n\nMakeCert：请参阅 [MakeCert](https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-certificates-point-to-site-makecert) 一文了解相关步骤。\n\n*   \n\nOpenSSL： \n\n    *   \n\n导出证书时，请务必将根证书转换为 Base64。\n\n    *   \n\n对于客户端证书：\n\n    *   创建私钥时，请将长度指定为 4096。\n    *   创建证书时，对于 -extensions 参数，指定 usr_cert。\n\n## RADIUS 身份验证常见问题解答\n\n,是否有证书设置和参数的说明？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
VpnGw1、VpnGw2 和 VpnGw3 SKU 支持 RADIUS 身份验证。 如果使用的是旧版 SKU，则标准和高性能 SKU 支持 RADIUS 身份验证。 基本网关 SKU 不支持该身份验证。,是否所有 Azure VPN 网关 SKU 都支持 RADIUS 身份验证？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
不可以。 经典部署模型不支持 RADIUS 身份验证。,经典部署模型是否支持 RADIUS 身份验证？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
是的，支持第三方 RADIUS 服务器。,是否支持第三方 RADIUS 服务器？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
需要具有到本地站点的 VPN 站点到站点连接，并且需要配置正确的路由。,若要确保 Azure 网关能够访问本地 RADIUS 服务器，对连接有何要求？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
不可以。 它只能通过站点到站点连接进行传送。,是否可以通过 ExpressRoute 连接来传送（从 Azure VPN 网关）流向本地 RADIUS 服务器的流量？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
RADIUS 身份验证在网关上支持的最大 SSTP 连接数没有变化。 它保持为 128。 不管网关是针对 SSTP、IKEv2 还是针对两者配置的，支持的最大连接数都是 128。,RADIUS 身份验证支持的 SSTP 连接数是否有变化？ 支持的最大 SSTP 和 IKEv2 连接数是多少？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
\n\n在 RADIUS 证书身份验证中，身份验证请求被转发到处理实际证书验证的 RADIUS 服务器。 如果希望通过 RADIUS 与已有的证书身份验证基础结构进行集成，则此选项非常有用。\n\n使用 Azure 进行证书身份验证时，由 Azure VPN 网关执行证书验证。 需要将证书公钥上传到网关。 还可以指定不允许进行连接的已吊销证书的列表。\n,使用 RADIUS 服务器执行证书身份验证与使用 Azure 本机证书身份验证执行身份验证（通过将受信任的证书上传到 Azure）之间有何区别？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
\n\n是的，IKEv2 和 SSTP VPN 都支持 RADIUS 身份验证。 \n\n## 后续步骤\n\n[配置 P2S 连接 - RADIUS 身份验证](https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-how-to-radius-ps)\n\n[配置 P2S 连接 - Azure 本机证书身份验证](https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-howto-point-to-site-rm-ps)\n,RADIUS 身份验证是否同时适用于 IKEv2 和 SSTP VPN？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
\n\nAD 域身份验证可让用户使用其组织域凭据连接到 Azure。 它需要一台与 AD 服务器集成的 RADIUS 服务器。 组织也可以利用其现有的 RADIUS 部署。 可将 RADIUS 服务器部署在本地或 Azure VNET 中。 在身份验证期间，Azure VPN 网关充当传递设备，在 RADIUS 服务器与连接方设备之间来回转发身份验证消息。 因此，RADIUS 服务器必须能够访问网关。 如果 RADIUS 服务器位于本地，需要建立从 Azure 到本地站点的 VPN S2S 连接，才能实现这种访问。 RADIUS 服务器还能与 AD 证书服务集成。 这样，便可以使用 RADIUS 服务器以及用于 P2S 证书身份验证的企业证书部署，作为 Azure 证书身份验证的替代方法。 此方法的优点是不需要将根证书和吊销的证书上传到 Azure。\n\nRADIUS 服务器还能与其他外部标识系统集成。 这样就为 P2S VPN 提供了大量的身份验证选项，包括多重身份验证选项。\n\n\nNote\n\n适用于 P2S 的 RADIUS 身份验证目前处于预览状态。\n,使用 Active Directory (AD) 域服务器进行身份验证,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
是的，可以通过 Powershell 和 Azure 门户，在已部署的网关启用这些新功能。,我已部署 Azure VPN 网关。 是否可在该网关上启用 RADIUS 和/或 IKEv2 VPN？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
\n\n使用本机 Azure 证书身份验证时，设备上的客户端证书用于对连接方用户进行身份验证。 客户端证书从受信任的根证书生成，并安装在每台客户端计算机上。 可以使用通过企业解决方案生成的根证书，也可以生成自签名证书。\n\n客户端证书的验证由 VPN 网关执行，在建立 P2S VPN 连接期间发生。 验证时需要使用根证书，必须将该证书上传到 Azure。 \n,使用本机 Azure 证书身份验证进行身份验证,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/point-to-site-about
自定义 IPsec/IKE 策略在 Azure VpnGw1、VpnGw2、VpnGw3、标准 VPN 网关和高性能 VPN 网关上受支持。 基本 SKU。,是否所有 Azure VPN 网关 SKU 都支持自定义 IPsec/IKE 策略？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-about-compliance-crypto
是的。 VNet 到 VNet 隧道包含 Azure 中的两个连接资源，一个方向一个资源。 需确保两个连接资源的策略相同，否则无法建立 VNet 到 VNet 连接。,是否需在两个 VNet 到 VNet 连接资源上指定同一策略？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-about-compliance-crypto
\n\n不可以。 只能通过 Azure VPN 网关在 S2S VPN 和 VNet 到 VNet 连接上使用 IPsec/IKE 策略。\n\n## 后续步骤\n\n若要了解在连接上配置自定义 IPsec/IKE 策略的分步说明，请参阅[配置 IPsec/IKE 策略](https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-ipsecikepolicy-rm-powershell)。\n\n另请参阅[连接多个基于策略的 VPN 设备](https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-connect-multiple-policybased-rm-ps)，了解有关 UsePolicyBasedTrafficSelectors 选项的详细信息。\n,能否在 ExpressRoute 连接上使用自定义 IPsec/IKE 策略？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-about-compliance-crypto
否，必须指定 IKE（主模式）和 IPsec（快速模式）的所有算法和参数。 不允许指定部分策略。,能否在一个连接上指定部分策略？ （例如，仅指定 IKE 算法，不指定 IPsec）,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-about-compliance-crypto
"\n\n下表列出了支持的加密算法和密钥强度，可供客户配置。 必须为每个字段选择一个选项。\nIPsec/IKEv2选项IKEv2 加密AES256、AES192、AES128、DES3、DESIKEv2 完整性SHA384、SHA256、SHA1、MD5DH 组DHGroup24、ECP384、ECP256、DHGroup14 (DHGroup2048)、DHGroup2、DHGroup1、无IPsec 加密GCMAES256、GCMAES192、GCMAES128、AES256、AES192、AES128、DES3、DES、无IPsec 完整性GCMAES256、GCMAES192、GCMAES128、SHA256、SHA1、MD5PFS 组PFS24、ECP384、ECP256、PFS2048、PFS2、PFS1、无QM SA 生存期秒（整数；至少为 300 秒/默认为 27000 秒）KB（整数；至少为 1024 KB/默认为 102400000 KB）流量选择器UsePolicyBasedTrafficSelectors ($True/$False; default $False)\n\nImportant\n\n1.  在 IKE 和 IPsec PFS 中，DHGroup2048 和 PFS2048 与 Diffie-Hellman 组 14 相同。 如需完整的映射，请参阅 [Diffie-Hellman 组](https://docs.azure.cn/zh-cn/vpn-gateway/#DH)。\n2.  对于 GCMAES 算法，必须为 IPsec 加密和完整性指定相同的 GCMAES 算法和密钥长度。\n3.  在 Azure VPN 网关上，IKEv2 主模式 SA 生存期固定为 28,800 秒\n4.  QM SA 生存期是可选参数。 如果未指定，则使用默认值 27,000 秒（7.5 小时）和 102400000 KB (102GB)。\n5.  UsePolicyBasedTrafficSelector 是连接的可选参数。 请参阅下一针对""UsePolicyBasedTrafficSelectors""的常见问题解答项",自定义策略中支持的算法和密钥强度有哪些？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-about-compliance-crypto
\n\n本地 VPN 设备配置必须匹配，或者必须包含可在 Azure IPsec/IKE 策略中指定的以下算法和参数：\n\n*   IKE 加密算法\n*   IKE 完整性算法\n*   DH 组\n*   IPsec 加密算法\n*   IPsec 完整性算法\n*   PFS 组\n*   流量选择器 (*)\n\nSA 生存期是本地规范，不需匹配。\n\n如果启用 UsePolicyBasedTrafficSelectors，则需确保对于本地网络（本地网关）前缀与 Azure 虚拟网络前缀的所有组合，VPN 设备都定义了与之匹配的流量选择器（而不是任意到任意）。 例如，如果本地网络前缀为 10.1.0.0/16 和 10.2.0.0/16，虚拟网络前缀为 192.168.0.0/16 和 172.16.0.0/16，则需指定以下流量选择器：\n\n*   10.1.0.0/16  192.168.0.0/16\n*   10.1.0.0/16  172.16.0.0/16\n*   10.2.0.0/16  192.168.0.0/16\n*   10.2.0.0/16  172.16.0.0/16\n\n有关如何使用此选项的更多详细信息，请参阅[连接多个基于策略的本地 VPN 设备](https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-connect-multiple-policybased-rm-ps)。\n,Azure VPN 网关策略与本地 VPN 设备配置是否需完全匹配？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-about-compliance-crypto
\n\n下表列出了支持的 Diffie-Hellman 组，分别针对 IKE (DHGroup) 和 IPsec (PFSGroup)：\nDiffie-Hellman 组DHGroupPFSGroup密钥长度1DHGroup1PFS1768 位 MODP2DHGroup2PFS21024 位 MODP14DHGroup14DHGroup2048PFS20482048 位 MODP19ECP256ECP256256 位 ECP20ECP384ECP284384 位 ECP24DHGroup24PFS242048 位 MODP\n\n有关更多详细信息，请参阅 [RFC3526](https://tools.ietf.org/html/rfc3526) 和 [RFC5114](https://tools.ietf.org/html/rfc5114)。\n,支持哪些 Diffie-Hellman 组？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-about-compliance-crypto
一个给定的连接只能指定一个策略组合。,在一个连接上可以指定多少个策略？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-about-compliance-crypto
否。连接仍受 IPsec/IKE 保护。 从连接中删除自定义策略以后，Azure VPN 网关会还原为[默认的 IPsec/IKE 提议列表](https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-about-vpn-devices)，并再次重启与本地 VPN 设备的 IKE 握手。,如果删除自定义 IPsec/IKE 策略，连接是否会变得不受保护？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-about-compliance-crypto
是的。那样会导致短时中断（数秒），因为 Azure VPN 网关会断开现有连接并重启 IKE 握手，以便使用新的加密算法和参数重建 IPsec 隧道。 请确保也使用匹配的算法和密钥强度对本地 VPN 设备进行配置，尽量减少中断。,添加或更新 IPsec/IKE 策略是否会中断 VPN 连接？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-about-compliance-crypto
是的。 自定义策略是在单个连接的基础上应用的。 可以在不同的连接上创建并应用不同的 IPsec/IKE 策略。 也可选择在连接子集上应用自定义策略。 剩余连接将使用 Azure 默认 IPsec/IKE 策略集。,是否可以在不同的连接上使用不同的策略？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-about-compliance-crypto
是的。可以在 IPsec 跨界连接或 VNet 到 VNet 连接上应用自定义策略。,是否也可在 VNet 到 VNet 连接上使用自定义策略？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-about-compliance-crypto
是的。一旦在连接上指定自定义策略，Azure VPN 网关就会只使用该连接的策略，既充当 IKE 发起方，又充当 IKE 响应方。,自定义策略是否会替换 Azure VPN 网关的默认 IPsec/IKE 策略集？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-about-compliance-crypto
\n\n是的。\n\n请注意，这样会强制所有的 VNet 出口流量流向本地站点，并且会阻止 VNet VM 接受直接来自 Internet 的公共通信，例如从 Internet 发往 VM 的 RDP 或 SSH。\n,能否将默认路由 (0.0.0.0/0) 播发给 Azure VPN 网关？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
\n\nBGP 是可用于 Azure 基于路由的 VPN 网关的可选功能。在启用此功能之前，你还应确保本地 VPN 设备支持 BGP。你可以继续使用不带 BGP 的 Azure VPN 网关和本地 VPN 设备。它等效于在你的网络与 Azure 之间使用静态路由（不带 BGP）与使用带 BGP 的动态路由。\n\n使用 BGP 有几个优点和新功能：\n\n#### 支持自动和灵活的前缀更新\n\n使用 BGP，你只需通过 IPsec S2S VPN 隧道为特定 BGP 对等节点声明最小前缀。它最小可为本地 VPN 设备的 BGP 对等节点 IP 地址的主机前缀（/32）。你可以控制要将哪些本地网络前缀播发到 Azure 以允许 Azure 虚拟网络访问。\n\n你还可以播发更大的前缀，可以包括一些 VNet 地址前缀，如大型专用 IP 地址空间（例如，10.0.0.0/8）。但请注意，这些前缀不能与任一 VNet 前缀相同。与 VNet 前缀相同的这些路由将被拒绝。\n\n\nImportant\n\n目前，向 Azure VPN 网关播发默认路由 (0.0.0.0/0) 将被阻止。启用此功能后，将提供进一步更新。\n\n\n#### 支持 VNet 与本地站点之间的多个隧道基于 BGP 自动进行故障转移\n\n你可以在同一位置的 Azure VNet 和本地 VPN 设备之间建立多个连接。在主-主配置中，此功能在两个网络之间提供多个隧道（路径）。如果其中一个隧道断开连接，则将通过 BGP 撤消相应的路由，流量将会自动转移到其余隧道。\n\n下图显示了此高度可用设置的简单示例：\n\n#### 支持本地网络与多个 Azure VNet 之间的传输路由\n\nBGP 使多个网关可以从不同网络获知和传播前缀，而无论它们是直接还是间接连接。这可以为本地站点之间或跨多个 Azure 虚拟网络的 Azure VPN 网关启用传输路由。\n\n下图显示了多跃点拓扑的示例，其中的多个路径可以通过 Microsoft 网络中的 Azure VPN 网关在两个本地网络之间传输流量：\n\n## BGP 常见问题\n\n,为什么使用 BGP？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
否，BGP 在 Azure 标准 VPN 网关和高性能 VPN 网关上受支持 。 基本 SKU。,BGP 是否在所有 Azure VPN 网关 SKU 上受支持？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
否，只有基于路由的 VPN 网关支持 BGP。,能否将 BGP 用于 Azure 基于策略的 VPN 网关？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
能，可以将自己的公共 ASN 或专用 ASN 同时用于本地网络和 Azure 虚拟网络。,能否使用专用 ASN（自治系统编号）？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
\n\n是，Azure 保留了以下 ASN 用于内部和外部的对等互连：\n\n*   公用 ASN：8075、8076、12076\n*   专用 ASN：65515、65517、65518、65519、65520\n\n连接到 Azure VPN 网关时，不能为本地 VPN 设备指定这些 ASN。\n,是否存在由 Azure 保留的 ASN？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
\n\n是的。以下 ASN 是 [IANA 保留](http://www.iana.org/assignments/iana-as-numbers-special-registry/iana-as-numbers-special-registry.xhtml)的，不能在 Azure VPN 网关上配置：\n\n23456、64496-64511、65535-65551 和 429496729\n,是否有任何其他不能使用的 ASN？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
\n\nAzure VPN 网关会将以下路由播发到本地 BGP 设备：\n\n*   VNet 地址前缀\n*   已连接到 Azure VPN 网关的每个本地网关的地址前缀\n*   从连接到 Azure VPN 网关的其他 BGP 对等会话获知的路由， 默认路由或与任何 VNet 前缀重叠的路由除外。,Azure VPN 网关会播发给我哪些地址前缀？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
\n\n不能，Azure 平台会阻止播发与任一虚拟网络地址前缀相同的前缀或对其进行筛选。 但是，可播发属于虚拟网络内所拥有内容超集的前缀。 \n\n例如，如果虚拟网络可使用地址空间 10.0.0.0/16，则可以播发 10.0.0.0/8， 但不能播发 10.0.0.0/16 或 10.0.0.0/24。\n,能否播发与虚拟网络前缀完全相同的前缀？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
是的。,能否在 ExpressRoute/S2S VPN 共存配置中对 S2S VPN 使用 BGP？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
能，可以将 BGP 连接和非 BGP 连接混合用于同一 Azure VPN 网关。,能否将 BGP 连接与非 BGP 连接混合用于 Azure VPN 网关？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
是，支持 BGP 传输路由，但例外是 Azure VPN 网关不会将默认路由播发到其他 BGP 对等节点。 若要启用跨多个 Azure VPN 网关的传输路由，必须在所有中间 VNet 到 VNet 连接上启用 BGP。,Azure VPN 网关是否支持 BGP 传输路由？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
\n\n能，可以在 Azure VPN 网关和本地网络之间建立多个 S2S VPN 隧道。 请注意，所有这些隧道都会计入 Azure VPN 网关的隧道总数，而且必须在两个隧道上启用 BGP。\n\n例如，如果在 Azure VPN 网关与一个本地网络之间有两个冗余隧道，它们会占用 Azure VPN 网关的总配额（标准为 10 个，高性能为 30 个）中的 2 个隧道。\n,在 Azure VPN 网关和我的本地网络之间能否有多个隧道？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
是，但其中至少一个虚拟网络网关必须采用主动-主动配置。,在两个使用 BGP 的 Azure VNet 之间能否有多个隧道？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
Azure VPN 网关将从为虚拟网络定义的 GatewaySubnet 范围内分配单个 IP 地址。 默认情况下，它是该范围的倒数第二个地址。 例如，如果 GatewaySubnet 是 10.12.255.0/27（范围从 10.12.255.0 到 10.12.255.31），则 Azure VPN 网关上的 BGP 对等 IP 地址是 10.12.255.30。 当列出 Azure VPN 网关信息时，可以找到此信息。,Azure VPN 网关将哪个地址用于 BGP 对等节点 IP？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
本地 BGP 对等节点地址 不能 与 VPN 设备的公共 IP 地址相同。 在 VPN 设备上对 BGP 对等节点 IP 使用不同的 IP 地址。 它可以是分配给该设备上环回接口的地址。 在表示该位置的相应本地网关中指定此地址。,VPN 设备上的 BGP 对等节点 IP 地址的要求是什么？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
"Azure 本地网关为本地网络指定初始地址前缀。 使用 BGP 时，必须分配 BGP 对等节点 IP 地址的主机前缀（/32 前缀）作为本地网络的地址空间。 如果 BGP 对等节点 IP 为 10.52.255.254，则应指定""10.52.255.254/32""作为表示此本地网络的本地网关的 localNetworkAddressSpace。 这是为了确保 Azure VPN 网关通过 S2S VPN 隧道建立 BGP 会话。",使用 BGP 时应将什么指定为本地网关的地址前缀？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
"\n\n应在指向 IPsec S2S VPN 隧道的 VPN 设备上添加 Azure BGP 对等节点 IP 地址的主机路由。 例如，如果 Azure VPN 对等节点 IP 为""10.12.255.30""，则应在 VPN 设备上添加""10.12.255.30""的主机路由（包含匹配的 IPsec 隧道接口的下一跃点接口）。\n\n## 后续步骤\n\n有关为跨界连接和 VNet 到 VNet 连接配置 BGP 的步骤，请参阅[在 Azure VPN 网关上使用 BGP 入门](https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-resource-manager-ps)。\n",应为 BGP 对等会话添加到本地 VPN 设备什么内容？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
能，可以将 BGP 同时用于跨界连接和 VNet 到 VNet 连接。,能否将 BGP 用于 VNet 到 VNet 连接？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
否，必须在本地网络和 Azure VNet 之间分配不同 ASN（如果要使用 BGP 将它们连接在一起）。 无论是否为跨界连接启用了 BGP，都会为 Azure VPN 网关分配默认 ASN（即 65515）。 可以通过在创建 VPN 网关时分配不同 ASN，或者在创建网关后更改 ASN 来覆盖此默认值。 需要将本地 ASN 分配给相应的 Azure 本地网关。,能否将同一个 ASN 同时用于本地 VPN 网络和 Azure VNet？,vpn-gateway,https://docs.azure.cn/zh-cn/vpn-gateway/vpn-gateway-bgp-overview
